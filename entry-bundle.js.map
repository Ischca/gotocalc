{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@aurelia/metadata/dist/esnext/index.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/functions.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/resource.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/di.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/logger.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/profiler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/eventaggregator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/attribute-pattern.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/attribute-parser.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/attribute-patterns.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding-command.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/subscriber-collection.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/proxy-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/setter-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/binding-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/signaler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/connectable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behavior.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converter.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ast.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-length-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/array-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/computed-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/dirty-checker.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-size-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/map-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/primitive-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/property-accessor.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/set-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/property-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/call-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/expression-parser.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/interpolation-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/let-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ref-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/bindable-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/binding-mode.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/debounce.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/signals.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/throttle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/bindable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attribute.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/if.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/repeat.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/with.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/children.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-element.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-elements/au-slot.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/sanitize.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/renderer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/render-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle-task.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/controller.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/activator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/aurelia.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resource-model.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/listener.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/attribute.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/attribute-ns-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/checked-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/class-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/data-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-property-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/event-manager.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/select-value-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/style-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/svg-analyzer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/value-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/attr.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/self.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/update-trigger.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-styles.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/projectors.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/blur.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/focus.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/portal.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/create-element.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-elements/compose.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/template-binder.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/template-element-factory.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/template-compiler.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/html-renderer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/html-attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-registry.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/now.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/types.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/log.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/task.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/scheduler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/platform.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/binding/unparser.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/tracer.js","webpack:///./node_modules/@aurelia/scheduler-dom/dist/esnext/index.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/index.js","webpack:///./node_modules/aurelia/dist/esnext/quick-start.js","webpack:///./node_modules/process/browser.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/retry-interceptor.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client-configuration.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client.js","webpack:///./node_modules/@aurelia/router/dist/esnext/link-handler.js","webpack:///./node_modules/@aurelia/router/dist/esnext/utils.js","webpack:///./node_modules/@aurelia/router/dist/esnext/parser.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigation.js","webpack:///./node_modules/@aurelia/router/dist/esnext/runner.js","webpack:///./node_modules/@aurelia/router/dist/esnext/open-promise.js","webpack:///./node_modules/@aurelia/router/dist/esnext/awaitable-map.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-content.js","webpack:///./node_modules/@aurelia/route-recognizer/dist/esnext/index.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/found-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/collection.js","webpack:///./node_modules/@aurelia/router/dist/esnext/route-recognizer.js","webpack:///./node_modules/@aurelia/router/dist/esnext/scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/type-resolvers.js","webpack:///./node_modules/@aurelia/router/dist/esnext/router-options.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-instruction.js","webpack:///./node_modules/@aurelia/router/dist/esnext/instruction-resolver.js","webpack:///./node_modules/@aurelia/router/dist/esnext/interfaces.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook-manager.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-viewer-store.js","webpack:///./node_modules/@aurelia/router/dist/esnext/state-coordinator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigation-coordinator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/router.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/goto.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/load.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/href.js","webpack:///./node_modules/@aurelia/router/dist/esnext/configuration.js","webpack:///./src/jump.html","webpack:///./src/jump.ts","webpack:///./src/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isObject","isNullOrUndefined","metadataInternalSlot","WeakMap","$typeError","operation","args","paramName","actualValue","expectedType","TypeError","map","String","join","toString","toPropertyKeyOrUndefined","propertyKey","GetOrCreateMetadataMap","O","P","Create","targetMetadata","Map","set","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","has","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","keys","keysObj","k","metadata","metadataKey","metadataValue","target","ensurePropertyKeyOrUndefined","decorate","decorators","attributes","Array","isArray","descriptor","length","decorated","decorator","DecorateProperty","toPropertyKey","DecorateConstructor","$define","$has","OrdinaryHasMetadata","parent","getPrototypeOf","$hasOwn","$get","OrdinaryGetMetadata","$getOwn","$getKeys","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeysLen","parentKeysLen","Set","add","$getOwnKeys","$delete","delete","OrdinaryDeleteMetadata","Metadata","define","hasOwn","getOwn","getKeys","getOwnKeys","obj","writable","configurable","Reflect","Error","$applyMetadataPolyfill","reflect","isNumericLookup","isArrayIndex","result","ch","charCodeAt","isNumberOrBigInt","isStringOrDate","Date","baseCase","CharKind","isDigit","assign","charToKind","char","toUpperCase","toLowerCase","input","cb","len","prevKind","sep","output","curChar","curKind","nextChar","charAt","nextKind","camelCase","cache","callback","pascalCase","slice","kebabCase","toArray","arr","ids","nextId","context","compareNumber","a","b","emptyArray","bound","boundFn","this","mergeArrays","arrays","arraysLen","array","arrayLen","j","firstDefined","values","getPrototypeChain","functionPrototype","Function","proto","chain","Type","toLookup","objs","isNativeFunction","lookup","isNative","sourceText","fn","onResolve","maybePromise","resolveCallback","Promise","then","resolveAll","maybePromises","firstPromise","promises","ii","push","all","LogLevel","Reporter","level","code","params","error","Tracer","enabled","liveLoggingEnabled","liveWriter","objName","methodName","writer","enableLiveLogging","optionsOrWriter","annotation","prop","keyFor","isKey","startsWith","resource","Protocol","fromAnnotationOrDefinitionOrTypeOrDefault","def","getDefault","fromAnnotationOrTypeOrDefault","fromDefinitionOrDefault","throwIfConflict","forceOverwrite","hasInternalSlot","presentProps","filter","implementationSummary","applyMetadataPolyfill","ResolverBuilder","container","registerResolver","cacheCallbackResult","destinationKey","strategy","state","cloneArrayWithPossibleProps","source","clone","DefaultContainerConfiguration","defaultResolver","singleton","transient","DI","createContainer","config","getDesignParamtypes","annotationParamtypes","appendTo","dependencies","inject","designParamtypes","getAnnotationParamtypes","Proto","getDependencies","auAnnotationParamtype","friendlyName","Interface","index","undefined","getOrCreateAnnotationParamTypes","$isInterface","noDefault","withDefault","configure","register","dep","constructor","Registration","registerInRequester","options","defaultSingletonOptions","scoped","IContainer","createInterface","IServiceLocator","createResolver","resolver","$isResolver","resolve","handler","requestor","getAll","optional","ignore","instance","createNewInstance","instanceProvider","prepare","_requestor","factory","getFactory","construct","ResolverStrategy","resolving","getResolver","Factory","invoker","transformers","dynamicDependencies","invokeWithDynamicDependencies","invoke","transformer","createFactory","staticDependencies","concat","classInvokers","deps","fallbackInvoker","write","containerResolver","isRegistry","isRegisterInRequester","isSelfRegistry","InstrinsicTypeNames","factoryAnnotationKey","registerDepth","disposableResolvers","root","resolvers","resourceResolvers","current","jj","defs","isDisposable","validateKey","indexOf","isResourceKey","registerTransformer","autoRegister","jitRegister","searchAncestors","buildAllResponse","_a","disposables","from","pop","dispose","_b","_c","_d","disposeResolvers","clear","keyAsValue","registrationResolver","newResolver","ParameterizedRegistry","x","fun","cachedCallback","aliasTo","originalKey","aliasKey","defer","results","ColorOptions","__decorate","desc","arguments","getOwnPropertyDescriptor","__metadata","v","__param","paramIndex","ILogConfig","LogConfig","ISink","ILogEventFactory","DefaultLogEventFactory","ILogger","ILogScopes","LoggerSink","freeze","definition","handles","format","red","str","green","yellow","blue","magenta","cyan","white","grey","colorOptions","getLogLevelString","logLevelString","TRC","DBG","INF","WRN","ERR","FTL","QQQ","getIsoString","timestamp","toISOString","DefaultLogEvent","severity","message","optionalParams","scope","getScopeString","logger","now","ConsoleSink","$console","handleEvent","event","debug","info","warn","DefaultLogger","sinks","_e","_f","traceSinks","debugSinks","infoSinks","warnSinks","errorSinks","fatalSinks","scopedLoggers","$sink","getHandles","includes","emit","$sinks","msgOrGetMsg","createLogEvent","trace","messageOrGetMessage","fatal","scopedLogger","timers","profileMap","profiler","createTimer","depth","mark","enter","topLevelCount","totalCount","leave","duration","enable","timer","disable","report","sort","forEach","Handler","messageType","invokeCallback","channel","e","invokeHandler","handle","eventLookup","messageHandlers","channelOrInstance","subscribers","channelOrType","idx","splice","sub","subscribe","CharSpec","chars","repeat","isSymbol","isInverted","hasOfNoneInverse","hasOfSingleInverse","hasOfMultipleInverse","hasOfNone","hasOfSingle","hasOfMultiple","other","parts","_pattern","currentRecord","partsRecord","pattern","State","charSpec","patterns","nextStates","types","isEndpoint","child","equals","findChild","interpretation","childLen","next","append","StaticSegment","text","specs","DynamicSegment","symbols","spec","SymbolSegment","SegmentTypes","statics","dynamics","ISyntaxInterpreter","SyntaxInterpreter","rootState","initialStates","defOrDefs","currentState","segments","parse","eachChar","states","getNextStates","aTypes","bTypes","findMatches","start","IAttributePattern","attributePattern","patternDefs","AttributePattern","definitionAnnotationKey","validatePrototype","getPatternDefinitions","AttrSyntax","rawName","rawValue","command","IAttributeParser","AttributeParser","interpreter","attrPatterns","attrPattern","interpret","DotSeparatedAttributePattern","RefAttributePattern","ColonPrefixedBindAttributePattern","AtPrefixedTriggerAttributePattern","TargetedInstructionType","ITargetedInstruction","HooksDefinition","hasCreate","hasBeforeCompile","hasAfterCompile","hasAfterCompileChildren","hasBeforeBind","hasAfterBind","hasAfterAttach","hasAfterAttachChildren","hasBeforeDetach","hasBeforeUnbind","hasAfterUnbind","hasAfterUnbindChildren","hasDispose","hasAccept","none","registerAliases","aliases","keyFrom","bindingCommand","nameOrDefinition","BindingCommand","type","nameOrDef","getAnnotation","isType","getTarget","binding","makeCamelCase","flags","bindable","propName","syntax","BindingMode","BindingStrategy","LifecycleFlags","ExpressionKind","SymbolFlags","InterpolationInstruction","to","oneTime","toView","fromView","twoWay","IteratorBindingInstruction","CallBindingInstruction","RefBindingInstruction","SetPropertyInstruction","HydrateElementInstruction","res","instructions","slotInfo","HydrateAttributeInstruction","HydrateTemplateController","link","LetElementInstruction","toBindingContext","LetBindingInstruction","createMarker","dom","marker","createElement","makeTarget","TemplateControllerSymbol","physicalNode","template","templateController","_bindings","ProjectionSymbol","CustomAttributeSymbol","PlainAttributeSymbol","expression","BindingSymbol","CustomElementSymbol","bindables","isTarget","_customAttributes","_plainAttributes","_childNodes","_projections","containerless","isContainerless","LetElementSymbol","PlainElementSymbol","hasSlots","TextSymbol","interpolation","OneTimeBindingCommand","bindingType","ToViewBindingCommand","FromViewBindingCommand","TwoWayBindingCommand","DefaultBindingCommand","default","compile","CallBindingCommand","ForBindingCommand","subscriberCollection","_subscriberFlags","addSubscriber","removeSubscriber","hasSubscriber","hasSubscribers","callSubscribers","unsubscribe","collectionSubscriberCollection","_collectionSubscriberFlags","addCollectionSubscriber","removeCollectionSubscriber","hasCollectionSubscriber","hasCollectionSubscribers","callCollectionSubscribers","subscribeToCollection","unsubscribeFromCollection","subscriber","subscriberFlags","_subscriber0","_subscriber1","_subscriber2","_subscribersRest","addProxySubscriber","hasProxySubscriber","_proxySubscriberFlags","_proxySubscriber0","_proxySubscriber1","_proxySubscriber2","_proxySubscribersRest","_collectionSubscriber0","_collectionSubscriber1","_collectionSubscriber2","_collectionSubscribersRest","removeProxySubscriber","hasProxySubscribers","newValue","previousValue","subscriber0","subscriber1","subscriber2","callSubscriber","id","ownFlags","handleChange","callProxySubscribers","handleProxyChange","indexMap","handleCollectionChange","ProxySubscriberCollection","proxy","raw","inBatch","getOrCreate","oldValue","ProxyObserver_1","ProxyObserver","Proxy","$raw","proxyObserver","$observer","getRawIfProxy","receiver","callPropertySubscribers","deleteProperty","thisArg","argArray","apply","subscribeToProxy","unsubscribeFromProxy","ViewModelKind","stringifyState","names","IController","MountStrategy","IViewFactory","ILifecycle","BatchQueue","lifecycle","queue","process","begin","end","batch","flushBatch","SetterObserver","currentValue","observing","persistentFlags","getValue","setValue","Number","RuntimeError","keyOrObj","$synthetic","bc","ancestor","hostScope","chooseContext","bindingContext","overrideContext","$observers","currentScope","parentScope","oc","OverrideContext","ps","ISignaler","Signaler","signals","listeners","listener","slotNames","versionSlotNames","lastSlot","ensureEnoughSlotNames","currentSlot","addObserver","observer","observerSlots","version","observeProperty","propertyName","observerLocator","getObserver","unobserve","slots","slotName","connectableDecorator","connectable","assignIdTo","BindingBehaviorStrategy","bindingBehavior","BindingBehavior","inheritsFromInterceptor","expr","BindingInterceptor","interceptor","locator","$scope","isBound","updateTarget","updateSource","callSource","$bind","$unbind","valueConverter","ValueConverter","chooseScope","accessHostScope","CustomExpression","behaviorKey","evaluate","connect","hasBind","behavior","evalList","unbind","hasUnbind","visitor","visitBindingBehavior","converterKey","converter","signaler","addSignalListener","removeSignalListener","visitValueConverter","AssignExpression","visitAssign","ConditionalExpression","condition","yes","no","visitConditional","AccessThisExpression","$host","visitAccessThis","$this","$parent","evaluatedValue","visitAccessScope","AccessMemberExpression","visitAccessMember","AccessKeyedExpression","visitAccessKeyed","func","getFunction","visitCallScope","CallMemberExpression","visitCallMember","visitCallFunction","left","right","f","hs","visitBinary","visitUnary","PrimitiveLiteralExpression","visitPrimitiveLiteral","$undefined","$null","$true","$false","$empty","HtmlLiteralExpression","elements","rojection","visitHtmlLiteral","ArrayLiteralExpression","visitArrayLiteral","ObjectLiteralExpression","visitObjectLiteral","TemplateExpression","cooked","expressions","visitTemplate","visitTaggedTemplate","ArrayBindingPattern","visitArrayBindingPattern","ObjectBindingPattern","visitObjectBindingPattern","BindingIdentifier","visitBindingIdentifier","declaration","iterable","size","$array","entry","entries","$map","$number","visitForOfStatement","isMulti","firstExpression","visitInterpolation","list","rawArray","item","SubscriberFlags","DelegationStrategy","CollectionKind","AccessorType","createIndexMap","deletedItems","isIndexMap","CollectionLengthObserver","task","observerLookup","sortCompare","y","preSortCompare","insertionSort","compareFn","velement","ielement","vtmp","itmp","order","quickSort","v0","v1","v2","i0","i1","i2","c01","c02","c12","vpivot","ipivot","lowEnd","highStart","vtopElement","thirdIndex","partition","$push","$unshift","unshift","$pop","$shift","shift","$splice","$reverse","reverse","$sort","methods","observe","argCount","notify","inserts","element","deleteCount","relativeStart","actualStart","Math","max","min","actualDeleteCount","itemCount","deleted","middle","lower","upper","lowerValue","lowerIndex","upperValue","upperIndex","descriptorProps","method","enableArrayObservationCalled","ArrayObserver","enableArrayObservation","indexObservers","collection","lengthObserver","getOrCreateIndexObserver","indexObserver","ArrayIndexObserver","owner","subscriberCount","arrayObserver","prevValue","currValue","addIndexObserver","removeIndexObserver","getArrayObserver","computedOverrideDefaults","static","volatile","CustomSetterObserver","convertProperty","GetterObserver","overrides","propertyDeps","collectionDeps","isCollecting","createGetterTraps","subscribable","getValueAndCollectDependencies","unsubscribeAllDependencies","requireCollect","doNotCollect","addCollectionDep","proxyOrValue","getMapObserver","getSetObserver","addPropertyDep","IDirtyChecker","DirtyCheckSettings","framesPerCheck","disabled","throw","DirtyChecker","scheduler","tracked","elapsedFrames","queueRenderTask","check","persistent","cancel","delta","isDirty","flush","DirtyCheckProperty","dirtyChecker","addProperty","removeProperty","CollectionSizeObserver","$clear","oldSize","deleteResult","enableMapObservationCalled","MapObserver","enableMapObservation","noop","PrimitiveObserver","doNotCache","getStringLength","returnUndefined","PropertyAccessor","setValueDirect","$add","enableSetObservationCalled","SetObserver","observedSet","enableSetObservation","IObserverLocator","ITargetObserverLocator","ITargetAccessorLocator","ObserverLocator","targetObserverLocator","targetAccessorLocator","adapters","isBindingContext","getObservers","observersLookup","createPropertyObserver","getOrCreateObserversLookup","adapter","overridesAccessor","getAccessor","observedArray","observedMap","createObserversLookup","isNode","getLengthObserver","getIndexObserver","subject","pd","getPropertyDescriptor","adapterObserver","getAdapterObserver","createProperty","computed","givenOverrides","createComputedObserver","getCollectionObserver","rawCollection","toViewOrOneTime","updateTaskOpts","reusable","preempt","PropertyBinding","sourceExpression","targetProperty","$hostScope","targetObserver","$lifecycle","$scheduler","_previousValue","$kind","shouldQueueFlush","flushChanges","$mode","CallBinding","$args","IExpressionParser","expressionLookup","forOfLookup","interpolationLookup","found","$parse","$state","currentChar","Char","Access","Precedence","Token","unescapeCode","BindingType","startIndex","lastIndex","currentToken","tokenValue","assignable","SyntaxError","SemanticError","access","minPrecedence","nextToken","fromCharCode","parseInterpolation","op","TokenValues","primary","consumeOpt","consume","parseArrayLiteralExpression","parseObjectLiteralExpression","parseTemplate","statement","parseForOfStatement","strings","opToken","tokenRaw","tagged","scanTemplateTail","CharScanners","scanNumber","isFloat","parseInt","parseFloat","scanTemplate","tail","token","expected","KeywordLookup","true","null","false","in","instanceof","typeof","void","of","codes","decompress","$set","compressed","rangeCount","fill","returnToken","unexpectedCharacter","notMapped","IdParts","Uint8Array","quote","unescaped","buffer","last","unescapedStr","scanString","queueTaskOptions","MultiInterpolationBinding","InterpolationBinding","isFirst","_newValue","Boolean","LetBinding","RefBinding","BindableObserver","cbName","isProxy","propertyChangedCallback","propertyChanged","hasPropertyChangedCallback","shouldInterceptSet","createGetterSetter","is","BindingModeBehavior","originalModes","OneTimeBindingBehavior","super","ToViewBindingBehavior","FromViewBindingBehavior","TwoWayBindingBehavior","DebounceBindingBehavior","opts","delay","firstArg","taskQueue","getPostRenderTaskQueue","queueTask","isNaN","SignalBindingBehavior","signal","ThrottleBindingBehavior","lastCall","nextDelay","configOrTarget","$target","$prop","Bindable","isBindableAnnotation","bindableLists","addName","maybeList","addDescription","builder","configOrProp","attribute","setInterpreter","propStart","prototypeChain","keysLen","Class","iProto","iDefs","customAttribute","CustomAttribute","isTemplateController","defaultBindingMode","hooks","noMultiBindings","for","node","INode","IRenderLocation","IDOM","ni","niDOM","addEventListener","appendChild","cloneNode","convertToRenderLocation","createDocumentFragment","createNodeSequence","createCustomEvent","dispatchEvent","createNodeObserver","createTemplate","createTextNode","getEffectiveParentNode","setEffectiveParentNode","insertBefore","isMarker","isNodeInstance","isRenderLocation","registerElementResolver","remove","removeEventListener","setAttribute","DOM","isInitialized","descriptors","protos","getOwnPropertyDescriptors","location","view","setLocation","initiator","$controller","activate","deactivate","accept","InfrequentMutations","FrequentMutations","ObserveShallow","If","ifFactory","elseFactory","elseView","ifView","updateView","isActive","ret","catch","err","ensureView","Else","ifBehavior","viewModel","disposable","Repeat","renderable","hasPendingInstanceMutation","views","normalizedItems","checkCollectionObserver","bindings","forOf","local","normalizeToArray","activateAllViews","deactivateAllViews","oldLength","offset","applyMutationsToIndices","deactivateAndRemoveViewsByKey","createAndActivateAndSortViewsByKey","oldObserver","newObserver","items","iterate","viewScope","newLen","count","nodes","unlink","fromParent","setContextualProperties","release","deletedLen","mapLen","copy","synchronizeIndices","seq","maxLen","prevIndices","Int32Array","tailIndices","cursor","cur","prev","low","high","mid","longestIncreasingSubsequence","seqLen","isLast","isEven","$index","$first","$last","$middle","$even","$odd","$length","With","activateView","isChildrenObserverAnnotation","Children","childrenObserverLists","childrenObservers","query","ChildrenObserver","controller","defaultChildQuery","defaultChildFilter","defaultChildMap","children","tryStartObserving","projector","filterChildren","subscribeToChildrenChange","onChildrenChanged","forOpts","CustomElement","customElement","definitionLookup","injectable","needsCompile","surrogates","isStrictBinding","shadowOptions","enhance","projectionsMap","generateName","generateType","partialDefinition","defaultForOpts","searchParents","foundAController","$injectable","nameDescriptor","defaultProto","IProjectorLocator","AuSlotContentType","SlotInfo","projectionContext","ProjectionContext","content","RegisteredProjections","projections","IProjectionProvider","projectionMap","instruction","$projections","AuSlot","isProjection","contentType","Projection","outerScope","projectionScope","SCRIPT_REGEX","ISanitizer","replace","SanitizeValueConverter","sanitizer","untrustedMarkup","sanitize","ITemplateCompiler","IInstructionRenderer","IRenderer","instructionRenderer","instructionType","decoratedTarget","metadataKeys","ownProperties","Renderer","instructionRenderers","record","render","targets","host","targetInstructions","renderInstructions","ensureExpression","parser","srcOrExpr","potentialTarget","SetPropertyRenderer","CustomElementRenderer","viewFactory","projectionCtx","getRenderContext","getViewFactory","getComponentFactory","component","createComponent","childController","forCustomElement","getProjectionFor","addController","CustomAttributeRenderer","forCustomAttribute","TemplateControllerRenderer","parentContext","renderLocation","componentFactory","LetElementRenderer","childInstructions","childInstruction","applyBindingBehavior","addBinding","CallBindingRenderer","RefBindingRenderer","refHost","refTargetName","caController","ceController","getRefTarget","InterpolationBindingRenderer","PropertyBindingRenderer","IteratorBindingRenderer","behaviorExpressionIndex","behaviorExpressions","behaviorExpression","behaviorOrFactory","definitionContainerLookup","definitionContainerProjectionsLookup","fragmentCache","isRenderContext","parentContainer","containerLookup","containerProjectionsLookup","projectionsLookup","viewModelProvider","fragment","isCompiled","compiledDefinition","createChild","renderer","projectionProvider","factoryProvider","parentControllerProvider","instructionProvider","renderLocationProvider","elementProvider","registerFactory","targetedProjections","compiler","parentController","resourceKey","templateDefinition","registerProjections","_handler","LifecycleTask","done","wait","TaskSlot","IStartTask","TaskType","StartTask","$StartTask","_slot","_promiseOrTask","_container","_key","_callback","_task","promiseOrTask","at","slot","ProviderTask","TerminalTask","IStartTaskManager","StartTaskManager","beforeCompileChildrenQueued","run","tasks","startTask","resolveTask","AggregateTerminalTask","promise","maybePromiseOrTask","ContinuationTask","antecedent","nextResult","antecedents","hasAsyncWork","callDispose","controllerLookup","vmKind","head","hasLockedScope","mountStrategy","reject","fullyNamed","canceling","parentName","getCached","hydrate","getDefinition","getBindingContext","hydrateCustomElement","hydrateCustomAttribute","hydrateSynthetic","scopeTo","createObservers","childObserverNames","getOwnPropertyNames","observers","getLookup","childrenDescription","createChildrenObservers","beginChildComponentOperation","beforeCompile","compiledContext","projectorLocator","getElementProjector","createNodes","afterCompile","runBeforeCompileChildren","findTargets","afterCompileChildren","onCancel","$activateChildren","beforeBind","afterUnbind","afterBind","attach","beforeUnbind","project","afterAttach","activateChildren","endActivate","clearLinks","beforeDetach","resolvePromise","afterAttachChildren","$deactivateChildren","detach","take","deactivateChildren","endDeactivate","afterUnbindChildren","tryReturnToCache","find","noProxy","observableNames","isCustomElementController","isCustomElementViewModel","ViewFactory","isCaching","cacheSize","doNotOverrideIfAlreadySet","maxCacheSize","canReturnToCache","forSyntheticView","seenViews","WeakSet","notYetSeen","$view","toCustomElementDefinition","Views","definitions","$views","IViewLocator","ViewValueConverter","viewLocator","viewNameOrSelector","getViewComponentForObject","IActivator","Activator","taskManager","mgr","runBeforeRender","runBeforeBind","activateController","runAfterAttach","getCachedOrThrow","rootProvider","initializer","IDOMInitializer","initialize","activator","beforeCreateTask","runBeforeCreate","enhanceDefinition","createTask","combinedAntecedent","enqueueBeforeCompileChildren","_isRunning","_isStarting","_isStopping","_root","configureRoot","stop","onBeforeStart","onAfterStart","onBeforeStop","onAfterStop","isRunning","detail","bubbles","cancelable","global","Aurelia","DefaultBindingSyntax","DefaultBindingLanguage","DefaultComponents","modelInstanceToBoundComponent","modelTypeToUnboundComponent","availableViews","resolvedViewName","getViewName","getOrCreateBoundComponent","BoundComponent","UnboundComponent","getOrCreateUnboundComponent","getView","vm","requestedName","DefaultResources","DefaultRenderers","RuntimeConfiguration","BindableInfo","attr","bindableInfo","hasPrimary","isPrimary","contextLookup","elementLookup","attributeLookup","commandLookup","rootContainer","rootResourceResolvers","model","kind","IAttrSyntaxTransformer","TextBindingInstruction","preventDefault","bubbling","capturing","SetAttributeInstruction","SetClassAttributeInstruction","SetStyleAttributeInstruction","AttributeBindingInstruction","TriggerBindingCommand","DelegateBindingCommand","CaptureBindingCommand","AttrBindingCommand","StyleBindingCommand","ClassBindingCommand","RefBindingCommand","Listener","targetEvent","delegationStrategy","eventManager","$event","AttributeObserver","targetAttribute","hasChanges","classList","priority","style","setProperty","mutationRecords","shouldProcess","attributeName","contains","getPropertyValue","getAttribute","startObservation","stopObservation","subscription","$eMObservers","$mObserver","handleMutation","disconnect","invokeHandleMutation","taskOptions","AttributeBinding","projection","AttributeNSAccessor","namespace","removeAttributeNS","setAttributeNS","getAttributeNS","defaultMatcher","CheckedObserver","collectionObserver","valueObserver","synchronizeElement","elementValue","isRadio","matcher","checked","hasMatch","findIndex","pair","existingItem","$isChecked","isChecked","toStringRet","unset","currItem","ClassAttributeAccessor","nameIndex","classesToAdd","getClassesToAdd","addClassesAndUpdateIndex","classes","className","splitClassString","classString","matches","match","DataAttributeAccessor","removeAttribute","ElementPropertyAccessor","findOriginalEventTarget","composedPath","deepPath","path","stopPropagation","standardStopPropagation","propagationStopped","handleCapturedEvent","orderedCallbacks","capturedCallbacks","parentNode","orderedCallback","handleDelegatedEvent","delegatedCallbacks","ListenerTracker","eventName","capture","DelegateOrCaptureSubscription","decrement","TriggerSubscription","EventSubscriber","events","callbackOrListener","IEventManager","delegatedHandlers","capturedHandlers","handlerEntry","increment","childObserverOptions","childList","subtree","characterData","SelectValueObserver","nodeObserver","multiple","synchronizeOptions","synchronizeValue","option","optionValue","selected","handleNodeChange","styles","cssText","styleTuples","rx","exec","getStyleTuples","getStyleTuplesFromString","getStyleTuplesFromArray","getStyleTuplesFromObject","tuple","ISVGAnalyzer","ValueAttributeObserver","xlinkNS","xmlNS","xmlnsNS","nsAttributes","inputEvents","selectEvents","contentEvents","scrollEvents","overrideProps","TargetObserverLocator","svgAnalyzer","tagName","nsProps","isDataAttribute","TargetAccessorLocator","IsDataAttribute","prefix","isStandardSvgAttribute","AttrBindingBehavior","_scope","_hostScope","handleSelfEvent","selfEventCallSource","SelfBindingBehavior","UpdateTriggerBindingBehavior","originalHandler","noopShadowDOMStyles","applyTo","IShadowDOMStyles","IShadowDOMGlobalStyles","AdoptedStyleSheetsStyles","localStyles","styleSheetCache","sharedStyles","styleSheets","sheet","CSSStyleSheet","replaceSync","ShadowRoot","shadowRoot","adoptedStyleSheets","StyleElementStyles","innerHTML","prepend","defaultShadowOptions","attachShadow","childNodes","getRootNode","NodeType","effectiveParentNodeOverrides","window","document","TNode","TElement","THTMLElement","TCustomEvent","TCSSStyleSheet","TShadowRoot","Node","Element","HTMLElement","CustomEvent","destroy","emptyNodes","FragmentNodeSequence","publisher","deep","locationEnd","createComment","locationStart","replaceChild","$start","$nodes","markupOrNode","init","fetch","eventType","evt","MutationObserver","takeRecords","markup","containerlessOffset","nextSibling","nodeType","textContent","childNodeOrNodeSequence","nodeToInsert","referenceNode","nodeName","potentialNode","removeChild","$DOM","isMounted","isLinked","refNode","targetNodeList","querySelectorAll","childNodeList","firstChild","lastChild","addToLinked","obtainRefNode","previousSibling","IWindow","ILocation","IHistory","history","defaultCaptureEventInit","passive","defaultBubbleEventInit","blurDocMap","BlurManager","blurs","createHandler","blur","addListeners","removeListeners","doc","win","navigator","pointerEnabled","Blur","linkedMultiple","searchSubTree","linkingContext","manager","createFor","unregister","triggerBlur","els","containsElementOrShadowRoot","linkedWith","links","contextNode","querySelector","body","el","onBlur","checkTargets","hasChecked","revertCheckage","markChecked","handleMousedown","composed","handleEventTarget","onpointerdown","ontouchstart","onmousedown","onfocus","onblur","Focus","needsApply","valueChanged","activeElement","focus","Portal","originalLoc","strict","currentTarget","callbackContext","newTarget","resolveTarget","$activating","$deactivating","oldTarget","activating","$activated","activated","deactivating","$deactivated","deactivated","$document","renderContext","queryContext","HTMLTargetedInstructionType","isHTMLTargetedInstruction","tagOrType","props","allInstructions","hasInstructions","addChildren","createElementForTag","createElementForType","lazyDefinition","getContext","mergeInto","acc","Compose","composing","lastSubject","properties","reduce","compose","resolvedSubject","resolveView","resolvedView","provideViewFor","lockScope","isController","createView","invalidSurrogateAttribute","attributesToIgnore","hasInlineBindings","isTemplateControllerOf","manifest","resources","attrParser","exprParser","attrSyntaxTransformer","surrogate","attrSyntax","getBindingCommand","attrInfo","getAttributeInfo","transform","bindPlainAttribute","bindCustomAttribute","bindChildNodes","parentManifest","manifestRoot","parentManifestRoot","isAuSlot","bindLetElement","elementInfo","getElementInfo","ceSymbol","bindAttributes","symbol","manifestProxy","previousController","currentController","declareTemplateController","ensureAttributeOrder","hasProjection","manifestNode","currentTemplate","processTemplateControllers","projectionOwner","plainAttributes","modelOrValueIndex","checkedIndex","childNode","nextChild","bindManifest","bindText","textNode","wholeText","processInterpolationText","attrRawValue","bindMultiAttribute","customAttributes","valueLength","attrName","attrValue","attrTarget","ITemplateElementFactory","markupCache","HTMLTemplateElementFactory","firstElementChild","nextElementSibling","LocalTemplateBindableAttributes","allowedLocalTemplateBindableAttributes","TemplateCompiler","attrSyntaxModifier","binder","hasAttribute","localTemplates","numLocalTemplates","childElementCount","localTemplateNames","localTemplate","getTemplateName","localTemplateType","bindableEls","bindableInstructions","bindableEl","outerHTML","getBindingMode","ignoredAttributes","getAttributeNames","div","localTemplateDefinition","processLocalTemplates","compilation","customAttributeLength","plainAttributeLength","compileCustomAttribute","compilePlainAttribute","compileChildNodes","toDefinition","instructionRows","compileParentNode","instructionRow","compileAttributes","targetedProjection","Fallback","compileProjectionFallback","compileBindings","compiledProjections","compileProjections","compileCustomElement","compilePlainElement","compileTemplateController","controllerInstructionRows","bindingInstructions","compileBinding","attributeInstructions","plainAttributesLength","isOnSurrogate","_template","TextBindingRenderer","ListenerBindingRenderer","SetAttributeRenderer","SetClassAttributeRenderer","addClasses","SetStyleAttributeRenderer","StylePropertyBindingRenderer","AttributeBindingRenderer","shouldDefaultToTwoWay","$component","RuntimeHtmlConfiguration","factoryCache","IShadowDOMStyleFactory","createStyleFactory","css","createStyles","supported","AdoptedStyleSheetsStylesFactory","StyleElementStylesFactory","some","defaultNow","Now","TaskQueuePriority","defaultQueueTaskOptions","async","$resolve","$reject","executor","createExposedPromise","TaskAbortError","createdTime","queueTime","_result","_status","$ret","resetPersistentTask","returnToPool","completeAsyncTask","isEmpty","time","flushRequestorFactory","processingSize","processingHead","processingTail","processingAsync","pendingSize","pendingHead","pendingTail","delayedSize","delayedHead","delayedTail","flushRequested","yieldPromise","taskPool","taskPoolSize","lastRequest","microTaskRequestFlushTask","flushRequestor","requestFlush","movePendingToProcessing","moveDelayedToProcessing","status","requestFlushClamped","hasNoMoreFiniteWork","reuse","addToProcessing","addToPending","addToDelayed","removeFromProcessing","removeFromDelayed","removeFromPending","reset","finish","request","queueMacroTask","microTaskRequestFlushTaskOptions","store","IScheduler","microtaskFactory","renderFactory","macroTaskFactory","postRenderFactory","idleFactory","taskQueues","microtask","macroTask","postRender","idle","yieldMicroTask","yieldRenderTask","yieldMacroTask","yieldPostRenderTask","yieldIdleTask","yieldAll","yield","$global","self","isBrowserLike","isWebWorkerLike","isNodeLike","versions","$now","getNanoSeconds","hrtime","moduleLoadTime","nodeLoadTime","upTime","performance","$performance","hr","uptime","emptyObject","$PLATFORM","PLATFORM","getMessageInfoForCode","codeLookup","createInvalidCodeMessageInfo","0","1","2","3","4","5","6","7","8","9","10","11","12","14","15","16","17","18","19","20","21","22","30","31","100","101","102","103","104","105","106","107","108","109","110","111","150","151","401","402","800","801","2000","2001","2002","2003","2004","1001","10000","TraceInfo","stack","defaultOptions","rendering","observation","attaching","mounting","di","jit","flagsText","flagNames","stringifyLifecycleFlags","_ctorName","description","ctorName","scopeText","$ctorName","keyText","$key","primitive","RenderingArgsProcessor","$hydrate","addComponent","BindingArgsProcessor","lockedBind","lockedUnbind","InternalObserversLookup","ObservationArgsProcessor","valueText","AttachingArgsProcessor","$attach","$detach","$cache","MountingArgsProcessor","DIArgsProcessor","LifecycleArgsProcessor","JitArgsProcessor","TemplateBinder","createDOMScheduler","w","requested","canceled","cancelAnimationFrame","requestAnimationFrame","createRequestAnimationFrameFlushRequestor","clearTimeout","setTimeout","createSetTimeoutFlushRequestorFactory","rafHandle","timeoutHandle","queueFlush","createPostRequestAnimationFrameFlushRequestor","requestIdleCallback","cancelIdleCallback","createRequestIdleCallbackFlushRequestor","BrowserDOMInitializer","ownerDocument","RuntimeHtmlBrowserConfiguration","createAurelia","au","env","app","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","runClearTimeout","Item","nextTick","title","browser","argv","on","addListener","once","off","removeListener","removeAllListeners","prependListener","prependOnceListener","cwd","chdir","dir","umask","g","retryStrategy","defaultRetryConfig","maxRetries","interval","retryConfig","counter","requestClone","response","httpClient","doRetry","minRandomInterval","maxRandomInterval","retryStrategies","calculateDelay","newRequest","beforeRetry","retryableRequest","retryCount","random","baseUrl","defaults","interceptors","credentials","rejectErrorResponses","withInterceptor","rejectOnError","ok","absoluteUrlRegexp","HttpClient","activeRequestCount","isRequesting","isConfigured","normalizedConfig","isPrototypeOf","Headers","headers","retryInterceptorIndex","trackRequestStart","buildRequest","processRequest","Response","Request","processResponse","trackRequestEnd","requestContentType","parsedDefaultHeaders","parsedHeaders","$headers","parseHeaderValues","bodyObj","requestInit","url","test","getRequestUrl","JSON","isJSON","defaultHeaders","$defaultHeaders","setDefaultHeaders","Blob","callFetch","applyInterceptors","successName","errorName","interceptorArgs","successHandler","errorHandler","identity","reason","thrower","LinkHandler","useHref","getEventInfo","shouldHandleEvent","anchor","targetIsThisWindow","altKey","ctrlKey","metaKey","shiftKey","gotoAttr","goto","loadAttr","load","href","leftButtonClicked","button","targetWindow","arrayRemove","removed","arrIndex","deprecationWarning","oldFeature","newFeature","console","parseQuery","parameters","split","param","decodeURIComponent","Navigation","fullStateInstruction","navigation","first","new","refresh","forward","back","repeating","fromBrowser","origin","replacing","refreshing","untracked","historyMovement","firstEntry","route","data","Runner","isDone","isCancelled","isResolved","isRejected","isAsync","steps","$runner","$run","runners","runner","$runAll","step","resolvedValue","runOne","OpenPromise","isPending","rej","openPromise","ContentStatus","SegmentKind","connectedCE","contentStates","loaded","fromCache","fromHistory","reentry","isComponentType","componentType","toComponentType","componentInstance","viewport","sameComponent","reentryBehavior","fallback","toComponentInstance","setParameters","componentName","setComponent","ee","contentController","previousInstruction","canLoad","typeParameters","toSpecifiedParameters","merged","router","createViewportInstruction","nextInstruction","canUnload","await","unload","parentActivated","getElementsByTagName","top","scrollTo","stateful","scrollTop","scrollLeft","deactivateComponent","disposeComponent","owningScope","rootComponentType","catches","nextContent","available","sourceItem","sourceItemIndex","connectedScope","enabledChildren","isViewportScope","viewportScope","nextContentActivated","contentName","nextContentName","viewportInstruction","instructionResolver","isClearViewportInstruction","isClearAllViewportsInstruction","isAddViewportInstruction","coordinator","addEntityState","removeSourceItem","segment","clearViewportInstruction","addViewportInstruction","getAvailableSourceItem","siblings","every","sibling","routes","FoundRoute","matching","remaining","currentIndex","ConfigurableRoute","caseSensitive","Endpoint","paramNames","RecognizedRoute","endpoint","searchParams","isDynamic","queryString","Candidate","skippedStates","stateToAdd","matchCount","$process","nextState","skippedState","isMatch","isOptional","separator","isSeparator","$nextState","collectSkippedStates","statesA","statesB","iA","iB","stateA","stateB","segmentA","segmentB","skippedStatesA","skippedStatesB","skippedStatesALen","skippedStatesBLen","skippedStateA","skippedStateB","hasEndpoint","candidate","compareChains","compareTo","RecognizeResult","candidates","finalize","advance","prevState","setEndpoint","isNotEmpty","StarSegment","routeOrRoutes","$route","part","endsWith","queryStart","URLSearchParams","decodeURI","getSolution","getParams","hasScope","replacedChildren","childCollections","recurse","passThroughScope","isViewport","scopes","parentAction","nextContentAction","parentNextContentAction","viewportScopes","viewports","includeDisabled","allViewports","allScopes","getOwnedScopes","parseViewportInstructions","useConfiguredRoutes","hasSiblingInstructions","foundRoute","findMatchingRoute","foundConfiguration","useDirectRoutes","nextInstructions","nextScopeInstructions","stringifyViewportInstructions","instr","alreadyFound","disregardViewports","foundViewports","remainingInstructions","ownedScopes","availableViewportScopes","availableViewports","getEnabledViewports","viewportName","viewportInstructions","foundViewportScope","removeCurrent","foundViewport","acceptSegment","addSourceItem","needsViewportDescribed","wantComponent","ownsScope","acceptComponent","remainingViewports","rem","withoutViewports","doesntNeedViewportDescribed","setViewport","getOwnedViewports","addChild","setConnectedCE","vp","includeReplaced","hoistedChildren","reparentViewportInstructions","findMatchingRouteInRoutes","getRoutes","runAll","resolvedResults","removeContent","cRoutes","ensureProperRoute","cRoute","recognizer","recognize","$params","remainingPath","cloneViewportInstructions","addParameters","NavigationInstructionResolver","toViewportInstructions","forceRemove","connectionResolve","previousViewportState","historyCache","cached","isCacheEqual","clearReplacedChildren","equalComponent","disableReplacedChildren","equalParameters","clearState","usedBy","noLink","noTitle","noHistory","freeContent","doForceRemove","statefulHistory","removes","guarded","checkingSyncState","performLoad","performSwap","guardSteps","canUnloadResult","isRestrictedNavigation","syncState","canLoadResult","abortContentChange","routingSteps","lifecycleSteps","swapStrategy","addContent","canUnloadChildren","waitForConnected","connectedController","parentNextContentActivated","activeContent","reenableReplacedChildren","activateComponent","getComponentType","navigationInstruction","typeTitle","getComponentInstance","useComponentNames","getContentInstruction","componentPrefix","toLocaleUpperCase","transformTitle","ComponentAppellationResolver","isName","isInstance","getName","getType","getInstance","ViewportHandleResolver","navigationInstructions","findScope","rootScope","viewportComponent","newInstruction","RouterOptions","separators","scopeStart","scopeEnd","noScope","parametersEnd","parameterSeparator","parameterKeySeparator","parameter","action","useUrlFragmentHash","statefulHistoryLength","additiveInstructionDefault","appTitle","appTitleSeparator","componentTitleOrder","componentTitleSeparator","navigationSyncStates","routingHookIntegration","ParametersType","ViewportInstruction","parametersString","parametersRecord","parametersList","parametersType","topInstruction","setInstructionResolver","parseComponentParameters","typedParameters","stringifyComponentParameters","getNewName","isComponentName","isComponentInstance","getViewport","specifications","specified","sorted","compareParameters","compareType","sameParameters","mine","others","resolvedComponent","parsedInstructions","parseViewportInstructionsWorker","excludeViewport","viewportContext","stringifyViewportInstruction","stringifyAViewportInstruction","excludeCurrentViewport","excludeCurrentComponent","forceDescription","stringified","nextStringified","stringifyScopedViewportInstructions","encodeURIComponent","scopeContext","clearViewports","newPath","parseViewportInstruction","merge","sameViewport","flat","flattenViewportInstructions","keepInstances","clones","uriComponent","seps","matchScope","active","matchChildren","grouped","guard","parseAViewportInstruction","tokens","pos","specials","special","findNextToken","excludeComponent","instructionString","specification","toSortedParameters","ReentryBehavior","HookTypes","Hook","hook","includeTargets","excludeTargets","include","exclude","arg","cvTarget","beforeNavigation","transformFromUrl","transformToUrl","setTitle","lastIdentity","hookFunction","wantsMatch","outcome","nav","linkVisible","linkActive","visible","meta","parseRoute","computeLink","consideredActive","execute","update","computeVisible","computeActive","activeChild","components","activeComponents","addRoute","updateRoutes","newRoute","Queue","pending","processing","allowedExecutionCostWithinTick","currentExecutionCostInCurrentTick","dequeue","itemOrItems","costOrCosts","costs","qItem","cost","processNavigations","qEntry","navigationFlags","currentEntry","uninitializedEntry","loadState","pendingNavigations","enqueue","navigate","movement","newIndex","saveState","getState","storedEntry","toStored","serializeEntry","toStoreableEntry","pushNavigatorState","replaceNavigatorState","previous","storableEntry","popNavigatorState","serializeCallback","indexPreserve","go","previousEntry","storeable","preservedEntries","excludeComponents","preservedEntry","alreadyDone","freeInstructionComponents","QueueTask","TaskQueue","createQueueTask","BrowserViewerStore","forwardedState","eventTask","suppressPopstate","handlePopstate","pendingCalls","ev","evTask","suppressPopstateEvent","popstate","pathname","search","hash","doneTask","forwardState","titleOrEmpty","pushState","replaceState","popState","viewerState","Entity","entity","running","checkedStates","syncPromise","entities","hasAllEntities","syncStates","checkedSyncStates","ent","resetSyncStates","addEntity","checkSyncState","_promise","addSyncState","transition","finalizeContentChange","abort","processingNavigation","IRouter","ClosestScope","Router","linkHandler","hookManager","navs","appendedInstructions","pendingConnects","loadedFirst","lastNavigation","staleChecks","starters","linkCallback","navigatorCallback","navigatorSerializeCallback","serialized","freeComponents","browserNavigatorCallback","browserNavigationEvent","qInstruction","reportCallback","transformedInstruction","useFullStateInstruction","invokeTransformFromUrl","configuredRoute","findInstructions","configuredRoutePath","foundInstructions","unknownRoute","isAddAllViewportsInstruction","clearScopeOwners","clearViewportScopes","clearInstruction","addInstruction","updatedScopeOwners","alreadyFoundInstructions","findViewports","log","changedScopeOwners","hooked","invokeBeforeNavigation","scopeOwner","setNextContent","dontClear","finalEntity","hasRemaining","configured","routeScopeOwners","appendInstructions","appendedInstruction","existingAlreadyFound","existingFound","existingRemaining","replacePaths","titleOptions","separatorOptions","addHooks","ensureRootScope","starter","getClosestScope","viewModelOrContainer","getContainer","viewModelOrElement","getClosestContainer","findParentScope","parentViewportScope","parentViewport","getClosestCustomElement","addViewport","setClosestScope","removeViewport","unsetClosestScope","addViewportScope","removeViewportScope","toOptions","createViewportInstructions","findNav","addNav","addRoutes","addHook","staleCheck","activeRoute","invokeTransformToUrl","fullViewportStates","getTitle","invokeSetTitle","componentTitles","stringifyTitles","stringifyTitle","resolveTitle","routeTitle","CustomElementFor","nodeResourceName","NavCustomElement","ul","li","ulActive","liActive","aActive","ParentViewportScope","createInjectable","ViewportScopeCustomElement_1","ViewportScopeCustomElement","routingContainer","connectViewportScope","disconnectViewportScope","checkExists","ParentViewport","ViewportCustomElement_1","ViewportCustomElement","waitForRouterStart","connectViewport","disconnectViewport","GotoCustomAttribute","hasHref","activeClass","updateValue","stringify","created","checkActive","LoadCustomAttribute","HrefCustomAttribute","eventListener","hasGoto","configurationOptions","configurationCall","routerConfiguration","with","loadUrl","Jump"],"mappings":"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","file":"entry-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","/**\n * Determine whether a value is an object.\n *\n * Uses `typeof` to guarantee this works cross-realm, which is where `instanceof Object` might fail.\n *\n * Some environments where these issues are known to arise:\n * - same-origin iframes (accessing the other realm via `window.top`)\n * - `jest`.\n *\n * The exact test is:\n * ```ts\n * typeof value === 'object' && value !== null || typeof value === 'function'\n * ```\n *\n * @param value - The value to test.\n * @returns `true` if the value is an object, otherwise `false`.\n * Also performs a type assertion that defaults to `value is Object | Function` which, if the input type is a union with an object type, will infer the correct type.\n * This can be overridden with the generic type argument.\n *\n * @example\n *\n * ```ts\n * class Foo {\n *   bar = 42;\n * }\n *\n * function doStuff(input?: Foo | null) {\n *   input.bar; // Object is possibly 'null' or 'undefined'\n *\n *   // input has an object type in its union (Foo) so that type will be extracted for the 'true' condition\n *   if (isObject(input)) {\n *     input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n *\n * function doOtherStuff(input: unknown) {\n *   input.bar; // Object is of type 'unknown'\n *\n *   // input is 'unknown' so there is no union type to match and it will default to 'Object | Function'\n *   if (isObject(input)) {\n *     input.bar; // Property 'bar' does not exist on type 'Object | Function'\n *   }\n *\n *   // if we know for sure that, if input is an object, it must be a specific type, we can explicitly tell the function to assert that for us\n *   if (isObject<Foo>(input)) {\n *    input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n * ```\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isObject(value) {\n    return typeof value === 'object' && value !== null || typeof value === 'function';\n}\n/**\n * Determine whether a value is `null` or `undefined`.\n *\n * @param value - The value to test.\n * @returns `true` if the value is `null` or `undefined`, otherwise `false`.\n * Also performs a type assertion that ensures TypeScript treats the value appropriately in the `if` and `else` branches after this check.\n */\nexport function isNullOrUndefined(value) {\n    return value === null || value === void 0;\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nconst metadataInternalSlot = new WeakMap();\nfunction $typeError(operation, args, paramName, actualValue, expectedType) {\n    return new TypeError(`${operation}(${args.map(String).join(',')}) - Expected '${paramName}' to be of type ${expectedType}, but got: ${Object.prototype.toString.call(actualValue)} (${String(actualValue)})`);\n}\nfunction toPropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction toPropertyKey(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction ensurePropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            throw new TypeError(`Invalid metadata propertyKey: ${propertyKey}.`);\n    }\n}\nfunction GetOrCreateMetadataMap(O, P, Create) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let targetMetadata be the value of O's [[Metadata]] internal slot.\n    let targetMetadata = metadataInternalSlot.get(O);\n    // 3. If targetMetadata is undefined, then\n    if (targetMetadata === void 0) {\n        // 3. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 3. b. Set targetMetadata to be a newly created Map object.\n        targetMetadata = new Map();\n        // 3. c. Set the [[Metadata]] internal slot of O to targetMetadata.\n        metadataInternalSlot.set(O, targetMetadata);\n    }\n    // 4. Let metadataMap be ? Invoke(targetMetadata, \"get\", P).\n    let metadataMap = targetMetadata.get(P);\n    // 5. If metadataMap is undefined, then\n    if (metadataMap === void 0) {\n        // 5. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 5. b. Set metadataMap to be a newly created Map object.\n        metadataMap = new Map();\n        // 5. c. Perform ? Invoke(targetMetadata, \"set\", P, metadataMap).\n        targetMetadata.set(P, metadataMap);\n    }\n    // 6. Return metadataMap.\n    return metadataMap;\n}\n// 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\nfunction OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? ToBoolean(? Invoke(metadataMap, \"has\", MetadataKey)).\n    return metadataMap.has(MetadataKey);\n}\n// 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\nfunction OrdinaryHasMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return true.\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return true;\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, Return ? parent.[[HasMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryHasMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return false.\n    return false;\n}\n// 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\nfunction OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return undefined.\n    if (metadataMap === void 0) {\n        return void 0;\n    }\n    // 4. Return ? Invoke(metadataMap, \"get\", MetadataKey).\n    return metadataMap.get(MetadataKey);\n}\n// 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\nfunction OrdinaryGetMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return ? OrdinaryGetOwnMetadata(MetadataKey, O, P).\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, return ? parent.[[GetMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryGetMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return undefined.\n    return void 0;\n}\n// 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\nfunction OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, true).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ true);\n    // 3. Return ? Invoke(metadataMap, \"set\", MetadataKey, MetadataValue).\n    metadataMap.set(MetadataKey, MetadataValue);\n}\n// 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\nfunction OrdinaryOwnMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 3. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 4. If metadataMap is undefined, return keys.\n    if (metadataMap === void 0) {\n        return keys;\n    }\n    // 5. Let keysObj be ? Invoke(metadataMap, \"keys\").\n    const keysObj = metadataMap.keys();\n    // 6. Let iterator be ? GetIterator(keysObj).\n    // 7. Let k be 0.\n    let k = 0;\n    // 8. Repeat\n    for (const key of keysObj) {\n        // 8. a. Let Pk be ! ToString(k).\n        // 8. b. Let next be ? IteratorStep(iterator).\n        // 8. c. If next is false, then\n        // 8. c. i. Let setStatus be ? Set(keys, \"length\", k, true).\n        // 8. c. ii. Assert: setStatus is true.\n        // 8. c. iii. Return keys.\n        // 8. d. Let nextValue be ? IteratorValue(next).\n        // 8. e. Let defineStatus be CreateDataPropertyOrThrow(keys, Pk, nextValue).\n        keys[k] = key;\n        // 8. f. If defineStatus is an abrupt completion, return ? IteratorClose(iterator, defineStatus).\n        // 8. g. Increase k by 1.\n        ++k;\n    }\n    return keys;\n}\n// 3.1.6.1 OrdinaryMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\nfunction OrdinaryMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let ownKeys be ? OrdinaryOwnMetadataKeys(O, P).\n    const ownKeys = OrdinaryOwnMetadataKeys(O, P);\n    // 3. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 4. If parent is null, then return ownKeys.\n    if (parent === null) {\n        return ownKeys;\n    }\n    // 5. Let parentKeys be ? O.[[OrdinaryMetadataKeys]](P).\n    const parentKeys = OrdinaryMetadataKeys(parent, P);\n    // 6. Let ownKeysLen = ? Get(ownKeys, \"length\").\n    const ownKeysLen = ownKeys.length;\n    // 7. If ownKeysLen is 0, return parentKeys.\n    if (ownKeysLen === 0) {\n        return parentKeys;\n    }\n    // 8. Let parentKeysLen = ? Get(parentKeys, \"length\").\n    const parentKeysLen = parentKeys.length;\n    // 9. If parentKeysLen is 0, return ownKeys.\n    if (parentKeysLen === 0) {\n        return ownKeys;\n    }\n    // 10. Let set be a newly created Set object.\n    const set = new Set();\n    // 11. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 12. Let k be 0.\n    let k = 0;\n    // 13. For each element key of ownKeys\n    let key;\n    for (let i = 0; i < ownKeysLen; ++i) {\n        key = ownKeys[i];\n        // 13. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 13. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 13. b. i. Let Pk be ! ToString(k).\n            // 13. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 13. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 13. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 13. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 14. For each element key of parentKeys\n    for (let i = 0; i < parentKeysLen; ++i) {\n        key = parentKeys[i];\n        // 14. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 14. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 14. b. i. Let Pk be ! ToString(k).\n            // 14. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 14. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 14. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 14. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 15. Perform ? Set(keys, \"length\", k).\n    // 16. return keys.\n    return keys;\n}\n// 3.1.8 DeleteMetadata(MetadataKey, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots-deletemetadata\nfunction OrdinaryDeleteMetadata(O, MetadataKey, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? Invoke(metadataMap, \"delete\", MetadataKey).\n    return metadataMap.delete(MetadataKey);\n}\n// 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n// https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n/**\n * A default metadata decorator factory that can be used on a class, class member, or parameter.\n *\n * @param metadataKey - The key for the metadata entry.\n * If `metadataKey` is already defined for the target and target key, the\n * metadataValue for that key will be overwritten.\n * @param metadataValue - The value for the metadata entry.\n * @returns A decorator function.\n */\nexport function metadata(metadataKey, metadataValue) {\n    function decorator(target, propertyKey) {\n        // 1. Assert: F has a [[MetadataKey]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 2. Assert: F has a [[MetadataValue]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 3. If Type(target) is not Object, throw a TypeError exception.\n        if (!isObject(target)) {\n            throw $typeError('@metadata', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n        }\n        // 4. If key is not undefined and IsPropertyKey(key) is false, throw a TypeError exception.\n        // 5. Let metadataKey be the value of F's [[MetadataKey]] internal slot.\n        // 6. Let metadataValue be the value of F's [[MetadataValue]] internal slot.\n        // 7. Perform ? target.[[DefineMetadata]](metadataKey, metadataValue, target, key).\n        OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, ensurePropertyKeyOrUndefined(propertyKey));\n        // 8. Return undefined.\n    }\n    return decorator;\n}\nfunction decorate(decorators, target, propertyKey, attributes) {\n    if (propertyKey !== void 0) {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (!isObject(target)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Object or Function');\n        }\n        if (!isObject(attributes) && !isNullOrUndefined(attributes)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'attributes', attributes, 'Object, Function, null, or undefined');\n        }\n        if (attributes === null) {\n            attributes = void 0;\n        }\n        propertyKey = toPropertyKey(propertyKey);\n        return DecorateProperty(decorators, target, propertyKey, attributes);\n    }\n    else {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (typeof target !== 'function') {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Function');\n        }\n        return DecorateConstructor(decorators, target);\n    }\n}\nfunction DecorateConstructor(decorators, target) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target);\n        if (!isNullOrUndefined(decorated)) {\n            if (typeof decorated !== 'function') {\n                throw $typeError('DecorateConstructor', [decorators, target], 'decorated', decorated, 'Function, null, or undefined');\n            }\n            target = decorated;\n        }\n    }\n    return target;\n}\nfunction DecorateProperty(decorators, target, propertyKey, descriptor) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target, propertyKey, descriptor);\n        if (!isNullOrUndefined(decorated)) {\n            if (!isObject(decorated)) {\n                throw $typeError('DecorateProperty', [decorators, target, propertyKey, descriptor], 'decorated', decorated, 'Object, Function, null, or undefined');\n            }\n            descriptor = decorated;\n        }\n    }\n    return descriptor;\n}\nfunction $define(metadataKey, metadataValue, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.define', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DefineMetadata]](metadataKey, metadataValue, propertyKey).\n    return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $has(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.has', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasMetadata]](metadataKey, propertyKey).\n    return OrdinaryHasMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $hasOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.hasOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasOwn]](metadataKey, propertyKey).\n    return OrdinaryHasOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $get(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.get', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadataKeys]](propertyKey).\n    return OrdinaryMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwnKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwnKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadataKeys]](propertyKey).\n    return OrdinaryOwnMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $delete(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.delete', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DeleteMetadata]](metadataKey, propertyKey).\n    return OrdinaryDeleteMetadata(target, metadataKey, toPropertyKeyOrUndefined(propertyKey));\n}\nexport const Metadata = {\n    define: $define,\n    has: $has,\n    hasOwn: $hasOwn,\n    get: $get,\n    getOwn: $getOwn,\n    getKeys: $getKeys,\n    getOwnKeys: $getOwnKeys,\n    delete: $delete,\n};\nfunction def(obj, key, value, writable, configurable) {\n    if (!Reflect.defineProperty(obj, key, {\n        writable,\n        enumerable: false,\n        configurable,\n        value,\n    })) {\n        throw new Error(`Unable to apply metadata polyfill: could not add property '${key}' to the global Reflect object`);\n    }\n}\nconst internalSlotName = '[[$au]]';\nfunction hasInternalSlot(reflect) {\n    return internalSlotName in reflect;\n}\nfunction $applyMetadataPolyfill(reflect, writable, configurable) {\n    def(reflect, internalSlotName, metadataInternalSlot, writable, configurable);\n    def(reflect, 'metadata', metadata, writable, configurable);\n    def(reflect, 'decorate', decorate, writable, configurable);\n    def(reflect, 'defineMetadata', $define, writable, configurable);\n    def(reflect, 'hasMetadata', $has, writable, configurable);\n    def(reflect, 'hasOwnMetadata', $hasOwn, writable, configurable);\n    def(reflect, 'getMetadata', $get, writable, configurable);\n    def(reflect, 'getOwnMetadata', $getOwn, writable, configurable);\n    def(reflect, 'getMetadataKeys', $getKeys, writable, configurable);\n    def(reflect, 'getOwnMetadataKeys', $getOwnKeys, writable, configurable);\n    def(reflect, 'deleteMetadata', $delete, writable, configurable);\n}\nexport function applyMetadataPolyfill(reflect, throwIfConflict = true, forceOverwrite = false, writable = true, configurable = true) {\n    if (hasInternalSlot(reflect)) {\n        if (reflect[internalSlotName] === metadataInternalSlot) {\n            return;\n        }\n        throw new Error(`Conflicting @aurelia/metadata module import detected. Please make sure you have the same version of all Aurelia packages in your dependency tree.`);\n    }\n    const presentProps = [\n        'metadata',\n        'decorate',\n        'defineMetadata',\n        'hasMetadata',\n        'hasOwnMetadata',\n        'getMetadata',\n        'getOwnMetadata',\n        'getMetadataKeys',\n        'getOwnMetadataKeys',\n        'deleteMetadata',\n    ].filter(function (p) {\n        return p in Reflect;\n    });\n    if (presentProps.length > 0) {\n        if (throwIfConflict) {\n            const implementationSummary = presentProps.map(function (p) {\n                const impl = `${Reflect[p].toString().slice(0, 100)}...`;\n                return `${p}:\\n${impl}`;\n            }).join('\\n\\n');\n            throw new Error(`Conflicting reflect.metadata polyfill found. If you have 'reflect-metadata' or any other reflect polyfill imported, please remove it, if not (or if you must use a specific polyfill) please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario. Implementation summary:\\n\\n${implementationSummary}`);\n        }\n        else if (forceOverwrite) {\n            $applyMetadataPolyfill(reflect, writable, configurable);\n        }\n    }\n    else {\n        $applyMetadataPolyfill(reflect, writable, configurable);\n    }\n}\n//# sourceMappingURL=index.js.map","import { PLATFORM } from './platform';\nconst isNumericLookup = {};\n/**\n * Efficiently determine whether the provided property key is numeric\n * (and thus could be an array indexer) or not.\n *\n * Always returns true for values of type `'number'`.\n *\n * Otherwise, only returns true for strings that consist only of positive integers.\n *\n * Results are cached.\n */\nexport function isArrayIndex(value) {\n    switch (typeof value) {\n        case 'number':\n            return value >= 0 && (value | 0) === value;\n        case 'string': {\n            const result = isNumericLookup[value];\n            if (result !== void 0) {\n                return result;\n            }\n            const length = value.length;\n            if (length === 0) {\n                return isNumericLookup[value] = false;\n            }\n            let ch = 0;\n            for (let i = 0; i < length; ++i) {\n                ch = value.charCodeAt(i);\n                if (i === 0 && ch === 0x30 && length > 1 /* must not start with 0 */ || ch < 0x30 /* 0 */ || ch > 0x39 /* 9 */) {\n                    return isNumericLookup[value] = false;\n                }\n            }\n            return isNumericLookup[value] = true;\n        }\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isNumberOrBigInt(value) {\n    switch (typeof value) {\n        case 'number':\n        case 'bigint':\n            return true;\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isStringOrDate(value) {\n    switch (typeof value) {\n        case 'string':\n            return true;\n        case 'object':\n            return value instanceof Date;\n        default:\n            return false;\n    }\n}\n/**\n * Base implementation of camel and kebab cases\n */\nconst baseCase = (function () {\n    let CharKind;\n    (function (CharKind) {\n        CharKind[CharKind[\"none\"] = 0] = \"none\";\n        CharKind[CharKind[\"digit\"] = 1] = \"digit\";\n        CharKind[CharKind[\"upper\"] = 2] = \"upper\";\n        CharKind[CharKind[\"lower\"] = 3] = \"lower\";\n    })(CharKind || (CharKind = {}));\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const isDigit = Object.assign(Object.create(null), {\n        '0': true,\n        '1': true,\n        '2': true,\n        '3': true,\n        '4': true,\n        '5': true,\n        '6': true,\n        '7': true,\n        '8': true,\n        '9': true,\n    });\n    function charToKind(char) {\n        if (char === '') {\n            // We get this if we do charAt() with an index out of range\n            return 0 /* none */;\n        }\n        if (char !== char.toUpperCase()) {\n            return 3 /* lower */;\n        }\n        if (char !== char.toLowerCase()) {\n            return 2 /* upper */;\n        }\n        if (isDigit[char] === true) {\n            return 1 /* digit */;\n        }\n        return 0 /* none */;\n    }\n    return function (input, cb) {\n        const len = input.length;\n        if (len === 0) {\n            return input;\n        }\n        let sep = false;\n        let output = '';\n        let prevKind;\n        let curChar = '';\n        let curKind = 0 /* none */;\n        let nextChar = input.charAt(0);\n        let nextKind = charToKind(nextChar);\n        for (let i = 0; i < len; ++i) {\n            prevKind = curKind;\n            curChar = nextChar;\n            curKind = nextKind;\n            nextChar = input.charAt(i + 1);\n            nextKind = charToKind(nextChar);\n            if (curKind === 0 /* none */) {\n                if (output.length > 0) {\n                    // Only set sep to true if it's not at the beginning of output.\n                    sep = true;\n                }\n            }\n            else {\n                if (!sep && output.length > 0 && curKind === 2 /* upper */) {\n                    // Separate UAFoo into UA Foo.\n                    // Separate uaFOO into ua FOO.\n                    sep = prevKind === 3 /* lower */ || nextKind === 3 /* lower */;\n                }\n                output += cb(curChar, sep);\n                sep = false;\n            }\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to camelCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert DOM attribute names to ViewModel property names.\n *\n * Results are cached.\n */\nexport const camelCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? char.toUpperCase() : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to PascalCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert element names to class names for synthetic types.\n *\n * Results are cached.\n */\nexport const pascalCase = (function () {\n    const cache = Object.create(null);\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = camelCase(input);\n            if (output.length > 0) {\n                output = output[0].toUpperCase() + output.slice(1);\n            }\n            cache[input] = output;\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to kebab-case.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert ViewModel property names to DOM attribute names.\n *\n * Results are cached.\n */\nexport const kebabCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? `-${char.toLowerCase()}` : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently (up to 10x faster than `Array.from`) convert an `ArrayLike` to a real array.\n *\n * Primarily used by Aurelia to convert DOM node lists to arrays.\n */\nexport function toArray(input) {\n    // benchmark: http://jsben.ch/xjsyF\n    const { length } = input;\n    const arr = Array(length);\n    for (let i = 0; i < length; ++i) {\n        arr[i] = input[i];\n    }\n    return arr;\n}\nconst ids = {};\n/**\n * Retrieve the next ID in a sequence for a given string, starting with `1`.\n *\n * Used by Aurelia to assign unique ID's to controllers and resources.\n *\n * Aurelia will always prepend the context name with `au$`, so as long as you avoid\n * using that convention you should be safe from collisions.\n */\nexport function nextId(context) {\n    if (ids[context] === void 0) {\n        ids[context] = 0;\n    }\n    return ++ids[context];\n}\n/**\n * Reset the ID for the given string, so that `nextId` will return `1` again for the next call.\n *\n * Used by Aurelia to reset ID's in between unit tests.\n */\nexport function resetId(context) {\n    ids[context] = 0;\n}\n/**\n * A compare function to pass to `Array.prototype.sort` for sorting numbers.\n * This is needed for numeric sort, since the default sorts them as strings.\n */\nexport function compareNumber(a, b) {\n    return a - b;\n}\nconst emptyArray = PLATFORM.emptyArray;\n/**\n * Efficiently merge and deduplicate the (primitive) values in two arrays.\n *\n * Does not deduplicate existing values in the first array.\n *\n * Guards against null or undefined arrays.\n *\n * Returns `PLATFORM.emptyArray` if both arrays are either `null`, `undefined` or `PLATFORM.emptyArray`\n *\n * @param slice - If `true`, always returns a new array copy (unless neither array is/has a value)\n */\nexport function mergeDistinct(arr1, arr2, slice) {\n    if (arr1 === void 0 || arr1 === null || arr1 === emptyArray) {\n        if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n            return emptyArray;\n        }\n        else {\n            return slice ? arr2.slice(0) : arr2;\n        }\n    }\n    else if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n        return slice ? arr1.slice(0) : arr1;\n    }\n    const lookup = {};\n    const arr3 = slice ? arr1.slice(0) : arr1;\n    let len1 = arr1.length;\n    let len2 = arr2.length;\n    while (len1-- > 0) {\n        lookup[arr1[len1]] = true;\n    }\n    let item;\n    while (len2-- > 0) {\n        item = arr2[len2];\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (lookup[item] === void 0) {\n            arr3.push(item);\n            lookup[item] = true;\n        }\n    }\n    return arr3;\n}\n/**\n * Decorator. (lazily) bind the method to the class instance on first call.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bound(target, key, descriptor) {\n    return {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get() {\n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            const boundFn = descriptor.value.bind(this);\n            Reflect.defineProperty(this, key, {\n                value: boundFn,\n                writable: true,\n                configurable: true,\n                enumerable: descriptor.enumerable,\n            });\n            return boundFn;\n        },\n    };\n}\nexport function mergeArrays(...arrays) {\n    const result = [];\n    let k = 0;\n    const arraysLen = arrays.length;\n    let arrayLen = 0;\n    let array;\n    for (let i = 0; i < arraysLen; ++i) {\n        array = arrays[i];\n        if (array !== void 0) {\n            arrayLen = array.length;\n            for (let j = 0; j < arrayLen; ++j) {\n                result[k++] = array[j];\n            }\n        }\n    }\n    return result;\n}\nexport function mergeObjects(...objects) {\n    const result = {};\n    const objectsLen = objects.length;\n    let object;\n    let key;\n    for (let i = 0; i < objectsLen; ++i) {\n        object = objects[i];\n        if (object !== void 0) {\n            for (key in object) {\n                result[key] = object[key];\n            }\n        }\n    }\n    return result;\n}\nexport function firstDefined(...values) {\n    const len = values.length;\n    let value;\n    for (let i = 0; i < len; ++i) {\n        value = values[i];\n        if (value !== void 0) {\n            return value;\n        }\n    }\n    throw new Error(`No default value found`);\n}\nexport const getPrototypeChain = (function () {\n    const functionPrototype = Function.prototype;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const getPrototypeOf = Object.getPrototypeOf;\n    const cache = new WeakMap();\n    let proto = functionPrototype;\n    let i = 0;\n    let chain = void 0;\n    return function (Type) {\n        chain = cache.get(Type);\n        if (chain === void 0) {\n            cache.set(Type, chain = [proto = Type]);\n            i = 0;\n            while ((proto = getPrototypeOf(proto)) !== functionPrototype) {\n                chain[++i] = proto;\n            }\n        }\n        return chain;\n    };\n})();\nexport function toLookup(...objs) {\n    return Object.assign(Object.create(null), ...objs);\n}\n/**\n * Determine whether the value is a native function.\n *\n * @param fn - The function to check.\n * @returns `true` is the function is a native function, otherwise `false`\n */\nexport const isNativeFunction = (function () {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    const lookup = new WeakMap();\n    let isNative = false;\n    let sourceText = '';\n    let i = 0;\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (fn) {\n        isNative = lookup.get(fn);\n        if (isNative === void 0) {\n            sourceText = fn.toString();\n            i = sourceText.length;\n            // http://www.ecma-international.org/ecma-262/#prod-NativeFunction\n            isNative = (\n            // 29 is the length of 'function () { [native code] }' which is the smallest length of a native function string\n            i >= 29 &&\n                // 100 seems to be a safe upper bound of the max length of a native function. In Chrome and FF it's 56, in Edge it's 61.\n                i <= 100 &&\n                // This whole heuristic *could* be tricked by a comment. Do we need to care about that?\n                sourceText.charCodeAt(i - 1) === 0x7D && // }\n                // TODO: the spec is a little vague about the precise constraints, so we do need to test this across various browsers to make sure just one whitespace is a safe assumption.\n                sourceText.charCodeAt(i - 2) <= 0x20 && // whitespace\n                sourceText.charCodeAt(i - 3) === 0x5D && // ]\n                sourceText.charCodeAt(i - 4) === 0x65 && // e\n                sourceText.charCodeAt(i - 5) === 0x64 && // d\n                sourceText.charCodeAt(i - 6) === 0x6F && // o\n                sourceText.charCodeAt(i - 7) === 0x63 && // c\n                sourceText.charCodeAt(i - 8) === 0x20 && //\n                sourceText.charCodeAt(i - 9) === 0x65 && // e\n                sourceText.charCodeAt(i - 10) === 0x76 && // v\n                sourceText.charCodeAt(i - 11) === 0x69 && // i\n                sourceText.charCodeAt(i - 12) === 0x74 && // t\n                sourceText.charCodeAt(i - 13) === 0x61 && // a\n                sourceText.charCodeAt(i - 14) === 0x6E && // n\n                sourceText.charCodeAt(i - 15) === 0x58 // [\n            );\n            lookup.set(fn, isNative);\n        }\n        return isNative;\n    };\n})();\n/**\n * Normalize a potential promise via a callback, to ensure things stay synchronous when they can.\n *\n * If the value is a promise, it is `then`ed before the callback is invoked. Otherwise the callback is invoked synchronously.\n */\nexport function onResolve(maybePromise, resolveCallback) {\n    if (maybePromise instanceof Promise) {\n        return maybePromise.then(resolveCallback);\n    }\n    return resolveCallback(maybePromise);\n}\n/**\n * Normalize an array of potential promises, to ensure things stay synchronous when they can.\n *\n * If exactly one value is a promise, then that promise is returned.\n *\n * If more than one value is a promise, a new `Promise.all` is returned.\n *\n * If none of the values is a promise, nothing is returned, to indicate that things can stay synchronous.\n */\nexport function resolveAll(...maybePromises) {\n    let maybePromise = void 0;\n    let firstPromise = void 0;\n    let promises = void 0;\n    for (let i = 0, ii = maybePromises.length; i < ii; ++i) {\n        maybePromise = maybePromises[i];\n        if ((maybePromise = maybePromises[i]) instanceof Promise) {\n            if (firstPromise === void 0) {\n                firstPromise = maybePromise;\n            }\n            else if (promises === void 0) {\n                promises = [firstPromise, maybePromise];\n            }\n            else {\n                promises.push(maybePromise);\n            }\n        }\n    }\n    if (promises === void 0) {\n        return firstPromise;\n    }\n    return Promise.all(promises);\n}\n//# sourceMappingURL=functions.js.map","export var LogLevel;\n(function (LogLevel) {\n    /**\n     * The most detailed information about internal app state.\n     *\n     * Disabled by default and should never be enabled in a production environment.\n     */\n    LogLevel[LogLevel[\"trace\"] = 0] = \"trace\";\n    /**\n     * Information that is useful for debugging during development and has no long-term value.\n     */\n    LogLevel[LogLevel[\"debug\"] = 1] = \"debug\";\n    /**\n     * Information about the general flow of the application that has long-term value.\n     */\n    LogLevel[LogLevel[\"info\"] = 2] = \"info\";\n    /**\n     * Unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n     */\n    LogLevel[LogLevel[\"warn\"] = 3] = \"warn\";\n    /**\n     * Unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n     */\n    LogLevel[LogLevel[\"error\"] = 4] = \"error\";\n    /**\n     * Unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n     */\n    LogLevel[LogLevel[\"fatal\"] = 5] = \"fatal\";\n    /**\n     * No messages should be written.\n     */\n    LogLevel[LogLevel[\"none\"] = 6] = \"none\";\n})(LogLevel || (LogLevel = {}));\nexport const Reporter = {\n    level: 3 /* warn */,\n    write(code, ...params) { return; },\n    error(code, ...params) { return new Error(`Code ${code}`); }\n};\nexport const Tracer = {\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) { return; },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() { return; },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) { return; },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) { return; },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() { return; }\n};\nfunction enableLiveLogging(optionsOrWriter) { return; }\n//# sourceMappingURL=reporter.js.map","import { Metadata } from '@aurelia/metadata';\nimport { PLATFORM } from './platform';\nconst annotation = {\n    name: 'au:annotation',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    set(target, prop, value) {\n        Metadata.define(annotation.keyFor(prop), value, target);\n    },\n    get(target, prop) {\n        return Metadata.getOwn(annotation.keyFor(prop), target);\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(annotation.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${annotation.name}:${name}`;\n        }\n        return `${annotation.name}:${name}:${context}`;\n    },\n};\nconst resource = {\n    name: 'au:resource',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    has(target) {\n        return Metadata.hasOwn(resource.name, target);\n    },\n    getAll(target) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            return PLATFORM.emptyArray;\n        }\n        else {\n            return keys.map(k => Metadata.getOwn(k, target));\n        }\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(resource.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${resource.name}:${name}`;\n        }\n        return `${resource.name}:${name}:${context}`;\n    },\n};\nexport const Protocol = {\n    annotation,\n    resource,\n};\n// eslint-disable-next-line @typescript-eslint/unbound-method\nconst hasOwn = Object.prototype.hasOwnProperty;\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override the definition as well as static properties on the type.\n * 2. Definition properties (usually set by the customElement decorator object literal) come next. They override static properties on the type.\n * 3. Static properties on the type come last. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 4. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrDefinitionOrTypeOrDefault(name, def, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = def[name];\n        if (value === void 0) {\n            value = Type[name];\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n            if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n                return getDefault();\n            }\n            return value;\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override static properties on the type.\n * 2. Static properties on the typ. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 3. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrTypeOrDefault(name, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = Type[name];\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n            return getDefault();\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Definition properties.\n * 2. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromDefinitionOrDefault(name, def, getDefault) {\n    const value = def[name];\n    if (value === void 0) {\n        return getDefault();\n    }\n    return value;\n}\n//# sourceMappingURL=resource.js.map","import { Metadata, isObject, applyMetadataPolyfill } from '@aurelia/metadata';\napplyMetadataPolyfill(Reflect);\nimport { isArrayIndex, isNativeFunction } from './functions';\nimport { PLATFORM } from './platform';\nimport { Reporter } from './reporter';\nimport { Protocol } from './resource';\nexport class ResolverBuilder {\n    constructor(container, key) {\n        this.container = container;\n        this.key = key;\n    }\n    instance(value) {\n        return this.registerResolver(0 /* instance */, value);\n    }\n    singleton(value) {\n        return this.registerResolver(1 /* singleton */, value);\n    }\n    transient(value) {\n        return this.registerResolver(2 /* transient */, value);\n    }\n    callback(value) {\n        return this.registerResolver(3 /* callback */, value);\n    }\n    cachedCallback(value) {\n        return this.registerResolver(3 /* callback */, cacheCallbackResult(value));\n    }\n    aliasTo(destinationKey) {\n        return this.registerResolver(5 /* alias */, destinationKey);\n    }\n    registerResolver(strategy, state) {\n        const { container, key } = this;\n        this.container = this.key = (void 0);\n        return container.registerResolver(key, new Resolver(key, strategy, state));\n    }\n}\nfunction cloneArrayWithPossibleProps(source) {\n    const clone = source.slice();\n    const keys = Object.keys(source);\n    const len = keys.length;\n    let key;\n    for (let i = 0; i < len; ++i) {\n        key = keys[i];\n        if (!isArrayIndex(key)) {\n            clone[key] = source[key];\n        }\n    }\n    return clone;\n}\nexport const DefaultResolver = {\n    none(key) { throw Error(`${key.toString()} not registered, did you forget to add @singleton()?`); },\n    singleton(key) { return new Resolver(key, 1 /* singleton */, key); },\n    transient(key) { return new Resolver(key, 2 /* transient */, key); },\n};\nexport const DefaultContainerConfiguration = {\n    defaultResolver: DefaultResolver.singleton,\n};\nexport const DI = {\n    createContainer(config = DefaultContainerConfiguration) {\n        return new Container(null, config);\n    },\n    getDesignParamtypes(Type) {\n        return Metadata.getOwn('design:paramtypes', Type);\n    },\n    getAnnotationParamtypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        return Metadata.getOwn(key, Type);\n    },\n    getOrCreateAnnotationParamTypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        let annotationParamtypes = Metadata.getOwn(key, Type);\n        if (annotationParamtypes === void 0) {\n            Metadata.define(key, annotationParamtypes = [], Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return annotationParamtypes;\n    },\n    getDependencies(Type) {\n        // Note: Every detail of this getDependencies method is pretty deliberate at the moment, and probably not yet 100% tested from every possible angle,\n        // so be careful with making changes here as it can have a huge impact on complex end user apps.\n        // Preferably, only make changes to the dependency resolution process via a RFC.\n        const key = Protocol.annotation.keyFor('di:dependencies');\n        let dependencies = Metadata.getOwn(key, Type);\n        if (dependencies === void 0) {\n            // Type.length is the number of constructor parameters. If this is 0, it could mean the class has an empty constructor\n            // but it could also mean the class has no constructor at all (in which case it inherits the constructor from the prototype).\n            // Non-zero constructor length + no paramtypes means emitDecoratorMetadata is off, or the class has no decorator.\n            // We're not doing anything with the above right now, but it's good to keep in mind for any future issues.\n            const inject = Type.inject;\n            if (inject === void 0) {\n                // design:paramtypes is set by tsc when emitDecoratorMetadata is enabled.\n                const designParamtypes = DI.getDesignParamtypes(Type);\n                // au:annotation:di:paramtypes is set by the parameter decorator from DI.createInterface or by @inject\n                const annotationParamtypes = DI.getAnnotationParamtypes(Type);\n                if (designParamtypes === void 0) {\n                    if (annotationParamtypes === void 0) {\n                        // Only go up the prototype if neither static inject nor any of the paramtypes is defined, as\n                        // there is no sound way to merge a type's deps with its prototype's deps\n                        const Proto = Object.getPrototypeOf(Type);\n                        if (typeof Proto === 'function' && Proto !== Function.prototype) {\n                            dependencies = cloneArrayWithPossibleProps(DI.getDependencies(Proto));\n                        }\n                        else {\n                            dependencies = [];\n                        }\n                    }\n                    else {\n                        // No design:paramtypes so just use the au:annotation:di:paramtypes\n                        dependencies = cloneArrayWithPossibleProps(annotationParamtypes);\n                    }\n                }\n                else if (annotationParamtypes === void 0) {\n                    // No au:annotation:di:paramtypes so just use the design:paramtypes\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                }\n                else {\n                    // We've got both, so merge them (in case of conflict on same index, au:annotation:di:paramtypes take precedence)\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                    let len = annotationParamtypes.length;\n                    let auAnnotationParamtype;\n                    for (let i = 0; i < len; ++i) {\n                        auAnnotationParamtype = annotationParamtypes[i];\n                        if (auAnnotationParamtype !== void 0) {\n                            dependencies[i] = auAnnotationParamtype;\n                        }\n                    }\n                    const keys = Object.keys(annotationParamtypes);\n                    len = keys.length;\n                    let key;\n                    for (let i = 0; i < len; ++i) {\n                        key = keys[i];\n                        if (!isArrayIndex(key)) {\n                            dependencies[key] = annotationParamtypes[key];\n                        }\n                    }\n                }\n            }\n            else {\n                // Ignore paramtypes if we have static inject\n                dependencies = cloneArrayWithPossibleProps(inject);\n            }\n            Metadata.define(key, dependencies, Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return dependencies;\n    },\n    /**\n     * creates a decorator that also matches an interface and can be used as a {@linkcode Key}.\n     * ```ts\n     * const ILogger = DI.createInterface<Logger>('Logger').noDefault();\n     * container.register(Registration.singleton(ILogger, getSomeLogger()));\n     * const log = container.get(ILogger);\n     * log.info('hello world');\n     * class Foo {\n     *   constructor( @ILogger log: ILogger ) {\n     *     log.info('hello world');\n     *   }\n     * }\n     * ```\n     * you can also build default registrations into your interface.\n     * ```ts\n     * export const ILogger = DI.createInterface<Logger>('Logger')\n     *        .withDefault( builder => builder.cachedCallback(LoggerDefault));\n     * const log = container.get(ILogger);\n     * log.info('hello world');\n     * class Foo {\n     *   constructor( @ILogger log: ILogger ) {\n     *     log.info('hello world');\n     *   }\n     * }\n     * ```\n     * but these default registrations won't work the same with other decorators that take keys, for example\n     * ```ts\n     * export const MyStr = DI.createInterface<string>('MyStr')\n     *        .withDefault( builder => builder.instance('somestring'));\n     * class Foo {\n     *   constructor( @optional(MyStr) public readonly str: string ) {\n     *   }\n     * }\n     * container.get(Foo).str; // returns undefined\n     * ```\n     * to fix this add this line somewhere before you do a `get`\n     * ```ts\n     * container.register(MyStr);\n     * container.get(Foo).str; // returns 'somestring'\n     * ```\n     *\n     * - @param friendlyName used to improve error messaging\n     */\n    createInterface(friendlyName) {\n        const Interface = function (target, property, index) {\n            if (target == null || new.target !== undefined) {\n                throw new Error(`No registration for interface: '${Interface.friendlyName}'`); // TODO: add error (trying to resolve an InterfaceSymbol that has no registrations)\n            }\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = Interface;\n            return target;\n        };\n        Interface.$isInterface = true;\n        Interface.friendlyName = friendlyName == null ? '(anonymous)' : friendlyName;\n        Interface.noDefault = function () {\n            return Interface;\n        };\n        Interface.withDefault = function (configure) {\n            Interface.withDefault = function () {\n                throw Reporter.error(17, Interface);\n            };\n            Interface.register = function (container, key) {\n                return configure(new ResolverBuilder(container, key !== null && key !== void 0 ? key : Interface));\n            };\n            return Interface;\n        };\n        Interface.toString = function toString() {\n            return `InterfaceSymbol<${Interface.friendlyName}>`;\n        };\n        return Interface;\n    },\n    inject(...dependencies) {\n        return function (target, key, descriptor) {\n            if (typeof descriptor === 'number') { // It's a parameter decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[descriptor] = dep;\n                }\n            }\n            else if (key) { // It's a property decorator. Not supported by the container without plugins.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target.constructor);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[key] = dep;\n                }\n            }\n            else if (descriptor) { // It's a function decorator (not a Class constructor)\n                const fn = descriptor.value;\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(fn);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n            else { // It's a class decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n        };\n    },\n    /**\n     * Registers the `target` class as a transient dependency; each time the dependency is resolved\n     * a new instance will be created.\n     *\n     * @param target - The class / constructor function to register as transient.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     *\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.transient(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.transient(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    transient(target) {\n        target.register = function register(container) {\n            const registration = Registration.transient(target, target);\n            return registration.register(container, target);\n        };\n        target.registerInRequester = false;\n        return target;\n    },\n    /**\n     * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n     * consecutive time the dependency is resolved, the same instance will be returned.\n     *\n     * @param target - The class / constructor function to register as a singleton.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.singleton(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.singleton(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    singleton(target, options = defaultSingletonOptions) {\n        target.register = function register(container) {\n            const registration = Registration.singleton(target, target);\n            return registration.register(container, target);\n        };\n        target.registerInRequester = options.scoped;\n        return target;\n    },\n};\nexport const IContainer = DI.createInterface('IContainer').noDefault();\nexport const IServiceLocator = IContainer;\nfunction createResolver(getter) {\n    return function (key) {\n        const resolver = function (target, property, descriptor) {\n            DI.inject(resolver)(target, property, descriptor);\n        };\n        resolver.$isResolver = true;\n        resolver.resolve = function (handler, requestor) {\n            return getter(key, handler, requestor);\n        };\n        return resolver;\n    };\n}\nexport const inject = DI.inject;\nfunction transientDecorator(target) {\n    return DI.transient(target);\n}\nexport function transient(target) {\n    return target == null ? transientDecorator : transientDecorator(target);\n}\nconst defaultSingletonOptions = { scoped: false };\nfunction singletonDecorator(target) {\n    return DI.singleton(target);\n}\nexport function singleton(targetOrOptions) {\n    if (typeof targetOrOptions === 'function') {\n        return DI.singleton(targetOrOptions);\n    }\n    return function ($target) {\n        return DI.singleton($target, targetOrOptions);\n    };\n}\nexport const all = createResolver((key, handler, requestor) => requestor.getAll(key));\n/**\n * Lazily inject a dependency depending on whether the [[`Key`]] is present at the time of function call.\n *\n * You need to make your argument a function that returns the type, for example\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => number )\n * }\n * const foo = container.get(Foo); // instanceof Foo\n * foo.random(); // throws\n * ```\n * would throw an exception because you haven't registered `'random'` before calling the method. This, would give you a\n * new [['Math.random()']] number each time.\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => random )\n * }\n * container.register(Registration.callback('random', Math.random ));\n * container.get(Foo).random(); // some random number\n * container.get(Foo).random(); // another random number\n * ```\n * `@lazy` does not manage the lifecycle of the underlying key. If you want a singleton, you have to register as a\n * `singleton`, `transient` would also behave as you would expect, providing you a new instance each time.\n *\n * - @param key [[`Key`]]\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const lazy = createResolver((key, handler, requestor) => {\n    return () => requestor.get(key);\n});\n/**\n * Allows you to optionally inject a dependency depending on whether the [[`Key`]] is present, for example\n * ```ts\n * class Foo {\n *   constructor( @inject('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo); // throws\n * ```\n * would fail\n * ```ts\n * class Foo {\n *   constructor( @optional('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo).str // somestring\n * ```\n * if you use it without a default it will inject `undefined`, so rember to mark your input type as\n * possibly `undefined`!\n *\n * - @param key: [[`Key`]]\n *\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const optional = createResolver((key, handler, requestor) => {\n    if (requestor.has(key, true)) {\n        return requestor.get(key);\n    }\n    else {\n        return undefined;\n    }\n});\n/**\n * ignore tells the container not to try to inject a dependency\n */\nexport function ignore(target, property, descriptor) {\n    DI.inject(ignore)(target, property, descriptor);\n}\nignore.$isResolver = true;\nignore.resolve = () => undefined;\nexport const newInstanceForScope = createResolver((key, handler, requestor) => {\n    const instance = createNewInstance(key, handler);\n    const instanceProvider = new InstanceProvider();\n    instanceProvider.prepare(instance);\n    requestor.registerResolver(key, instanceProvider, true);\n    return instance;\n});\nexport const newInstanceOf = createResolver((key, handler, _requestor) => createNewInstance(key, handler));\nfunction createNewInstance(key, handler) {\n    const factory = handler.getFactory(key);\n    if (factory === null) {\n        throw new Error(`No factory registered for ${key}`);\n    }\n    return factory.construct(handler);\n}\n/** @internal */\nexport var ResolverStrategy;\n(function (ResolverStrategy) {\n    ResolverStrategy[ResolverStrategy[\"instance\"] = 0] = \"instance\";\n    ResolverStrategy[ResolverStrategy[\"singleton\"] = 1] = \"singleton\";\n    ResolverStrategy[ResolverStrategy[\"transient\"] = 2] = \"transient\";\n    ResolverStrategy[ResolverStrategy[\"callback\"] = 3] = \"callback\";\n    ResolverStrategy[ResolverStrategy[\"array\"] = 4] = \"array\";\n    ResolverStrategy[ResolverStrategy[\"alias\"] = 5] = \"alias\";\n})(ResolverStrategy || (ResolverStrategy = {}));\n/** @internal */\nexport class Resolver {\n    constructor(key, strategy, state) {\n        this.key = key;\n        this.strategy = strategy;\n        this.state = state;\n        this.resolving = false;\n    }\n    get $isResolver() { return true; }\n    register(container, key) {\n        return container.registerResolver(key || this.key, this);\n    }\n    resolve(handler, requestor) {\n        switch (this.strategy) {\n            case 0 /* instance */:\n                return this.state;\n            case 1 /* singleton */: {\n                if (this.resolving) {\n                    throw new Error(`Cyclic dependency found: ${this.state.name}`);\n                }\n                this.resolving = true;\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                this.state = factory.construct(requestor);\n                this.strategy = 0 /* instance */;\n                this.resolving = false;\n                return this.state;\n            }\n            case 2 /* transient */: {\n                // Always create transients from the requesting container\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return factory.construct(requestor);\n            }\n            case 3 /* callback */:\n                return this.state(handler, requestor, this);\n            case 4 /* array */:\n                return this.state[0].resolve(handler, requestor);\n            case 5 /* alias */:\n                return handler.get(this.state);\n            default:\n                throw Reporter.error(6, this.strategy);\n        }\n    }\n    getFactory(container) {\n        let resolver;\n        switch (this.strategy) {\n            case 1 /* singleton */:\n            case 2 /* transient */:\n                return container.getFactory(this.state);\n            case 5 /* alias */:\n                resolver = container.getResolver(this.state);\n                if (resolver == null || resolver.getFactory === void 0) {\n                    return null;\n                }\n                return resolver.getFactory(container);\n            default:\n                return null;\n        }\n    }\n    dispose() {\n        this.key = this.state = null;\n    }\n}\n/** @internal */\nexport class Factory {\n    constructor(Type, invoker, dependencies) {\n        this.Type = Type;\n        this.invoker = invoker;\n        this.dependencies = dependencies;\n        this.transformers = null;\n    }\n    construct(container, dynamicDependencies) {\n        const transformers = this.transformers;\n        let instance = dynamicDependencies !== void 0\n            ? this.invoker.invokeWithDynamicDependencies(container, this.Type, this.dependencies, dynamicDependencies)\n            : this.invoker.invoke(container, this.Type, this.dependencies);\n        if (transformers == null) {\n            return instance;\n        }\n        for (let i = 0, ii = transformers.length; i < ii; ++i) {\n            instance = transformers[i](instance);\n        }\n        return instance;\n    }\n    registerTransformer(transformer) {\n        if (this.transformers == null) {\n            this.transformers = [];\n        }\n        this.transformers.push(transformer);\n        return true;\n    }\n}\nconst createFactory = (function () {\n    function invokeWithDynamicDependencies(container, Type, staticDependencies, dynamicDependencies) {\n        let i = staticDependencies.length;\n        let args = new Array(i);\n        let lookup;\n        while (i-- > 0) {\n            lookup = staticDependencies[i];\n            if (lookup == null) {\n                throw Reporter.error(7, `Index ${i}.`);\n            }\n            else {\n                args[i] = container.get(lookup);\n            }\n        }\n        if (dynamicDependencies !== void 0) {\n            args = args.concat(dynamicDependencies);\n        }\n        return Reflect.construct(Type, args);\n    }\n    const classInvokers = [\n        {\n            invoke(container, Type) {\n                return new Type();\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));\n            },\n            invokeWithDynamicDependencies\n        }\n    ];\n    const fallbackInvoker = {\n        invoke: invokeWithDynamicDependencies,\n        invokeWithDynamicDependencies\n    };\n    return function (Type) {\n        if (isNativeFunction(Type)) {\n            Reporter.write(5, Type.name);\n        }\n        const dependencies = DI.getDependencies(Type);\n        const invoker = classInvokers.length > dependencies.length ? classInvokers[dependencies.length] : fallbackInvoker;\n        return new Factory(Type, invoker, dependencies);\n    };\n})();\nconst containerResolver = {\n    $isResolver: true,\n    resolve(handler, requestor) {\n        return requestor;\n    }\n};\nfunction isRegistry(obj) {\n    return typeof obj.register === 'function';\n}\nfunction isSelfRegistry(obj) {\n    return isRegistry(obj) && typeof obj.registerInRequester === 'boolean';\n}\nfunction isRegisterInRequester(obj) {\n    return isSelfRegistry(obj) && obj.registerInRequester;\n}\nfunction isClass(obj) {\n    return obj.prototype !== void 0;\n}\nfunction isResourceKey(key) {\n    return typeof key === 'string' && key.indexOf(':') > 0;\n}\nconst InstrinsicTypeNames = new Set([\n    'Array',\n    'ArrayBuffer',\n    'Boolean',\n    'DataView',\n    'Date',\n    'Error',\n    'EvalError',\n    'Float32Array',\n    'Float64Array',\n    'Function',\n    'Int8Array',\n    'Int16Array',\n    'Int32Array',\n    'Map',\n    'Number',\n    'Object',\n    'Promise',\n    'RangeError',\n    'ReferenceError',\n    'RegExp',\n    'Set',\n    'SharedArrayBuffer',\n    'String',\n    'SyntaxError',\n    'TypeError',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Uint16Array',\n    'Uint32Array',\n    'URIError',\n    'WeakMap',\n    'WeakSet',\n]);\nconst factoryKey = 'di:factory';\nconst factoryAnnotationKey = Protocol.annotation.keyFor(factoryKey);\n/** @internal */\nexport class Container {\n    constructor(parent, config = DefaultContainerConfiguration) {\n        this.parent = parent;\n        this.config = config;\n        this.registerDepth = 0;\n        this.disposableResolvers = new Set();\n        if (parent === null) {\n            this.root = this;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.create(null);\n        }\n        else {\n            this.root = parent.root;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.assign(Object.create(null), this.root.resourceResolvers);\n        }\n        this.resolvers.set(IContainer, containerResolver);\n    }\n    register(...params) {\n        if (++this.registerDepth === 100) {\n            throw new Error('Unable to autoregister dependency');\n            // TODO: change to reporter.error and add various possible causes in description.\n            // Most likely cause is trying to register a plain object that does not have a\n            // register method and is not a class constructor\n        }\n        let current;\n        let keys;\n        let value;\n        let j;\n        let jj;\n        for (let i = 0, ii = params.length; i < ii; ++i) {\n            current = params[i];\n            if (!isObject(current)) {\n                continue;\n            }\n            if (isRegistry(current)) {\n                current.register(this);\n            }\n            else if (Protocol.resource.has(current)) {\n                const defs = Protocol.resource.getAll(current);\n                if (defs.length === 1) {\n                    // Fast path for the very common case\n                    defs[0].register(this);\n                }\n                else {\n                    const len = defs.length;\n                    for (let d = 0; d < len; ++d) {\n                        defs[d].register(this);\n                    }\n                }\n            }\n            else if (isClass(current)) {\n                Registration.singleton(current, current).register(this);\n            }\n            else {\n                keys = Object.keys(current);\n                j = 0;\n                jj = keys.length;\n                for (; j < jj; ++j) {\n                    value = current[keys[j]];\n                    if (!isObject(value)) {\n                        continue;\n                    }\n                    // note: we could remove this if-branch and call this.register directly\n                    // - the extra check is just a perf tweak to create fewer unnecessary arrays by the spread operator\n                    if (isRegistry(value)) {\n                        value.register(this);\n                    }\n                    else {\n                        this.register(value);\n                    }\n                }\n            }\n        }\n        --this.registerDepth;\n        return this;\n    }\n    registerResolver(key, resolver, isDisposable = false) {\n        validateKey(key);\n        const resolvers = this.resolvers;\n        const result = resolvers.get(key);\n        if (result == null) {\n            resolvers.set(key, resolver);\n            if (isResourceKey(key)) {\n                this.resourceResolvers[key] = resolver;\n            }\n        }\n        else if (result instanceof Resolver && result.strategy === 4 /* array */) {\n            result.state.push(resolver);\n        }\n        else {\n            resolvers.set(key, new Resolver(key, 4 /* array */, [result, resolver]));\n        }\n        if (isDisposable) {\n            this.disposableResolvers.add(resolver);\n        }\n        return resolver;\n    }\n    // public deregisterResolverFor<K extends Key, T = K>(key: K): void {\n    //   // const console =  (globalThis as any).console;\n    //   // console.group(\"deregisterResolverFor\");\n    //   validateKey(key);\n    //   let current: Container = this;\n    //   let resolver: IResolver | undefined;\n    //   while (current != null) {\n    //     resolver = current.resolvers.get(key);\n    //     if (resolver != null) { break; }\n    //     if (current.parent == null) { return; }\n    //     current = current.parent;\n    //   }\n    //   if (resolver === void 0) { return; }\n    //   if (resolver instanceof Resolver && resolver.strategy === ResolverStrategy.array) {\n    //     throw new Error('Cannot deregister a resolver with array strategy');\n    //   }\n    //   if (this.disposableResolvers.has(resolver as IDisposableResolver<T>)) {\n    //     (resolver as IDisposableResolver<T>).dispose();\n    //   }\n    //   if (isResourceKey(key)) {\n    //     // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n    //     delete this.resourceResolvers[key];\n    //   }\n    //   // console.log(`BEFORE delete ${Array.from(current.resolvers.keys()).map((k) => k.toString())}`);\n    //   current.resolvers.delete(key);\n    //   // console.log(`AFTER delete ${Array.from(current.resolvers.keys()).map((k) => k.toString())}`);\n    //   // console.groupEnd();\n    // }\n    registerTransformer(key, transformer) {\n        const resolver = this.getResolver(key);\n        if (resolver == null) {\n            return false;\n        }\n        if (resolver.getFactory) {\n            const factory = resolver.getFactory(this);\n            if (factory == null) {\n                return false;\n            }\n            // This type cast is a bit of a hacky one, necessary due to the duplicity of IResolverLike.\n            // Problem is that that interface's type arg can be of type Key, but the getFactory method only works on\n            // type Constructable. So the return type of that optional method has this additional constraint, which\n            // seems to confuse the type checker.\n            return factory.registerTransformer(transformer);\n        }\n        return false;\n    }\n    getResolver(key, autoRegister = true) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key;\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    const handler = (isRegisterInRequester(key)) ? this : current;\n                    return autoRegister ? this.jitRegister(key, handler) : null;\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver;\n            }\n        }\n        return null;\n    }\n    has(key, searchAncestors = false) {\n        return this.resolvers.has(key)\n            ? true\n            : searchAncestors && this.parent != null\n                ? this.parent.has(key, true)\n                : false;\n    }\n    get(key) {\n        validateKey(key);\n        if (key.$isResolver) {\n            return key.resolve(this, this);\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    const handler = (isRegisterInRequester(key)) ? this : current;\n                    resolver = this.jitRegister(key, handler);\n                    return resolver.resolve(current, this);\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver.resolve(current, this);\n            }\n        }\n        throw new Error(`Unable to resolve key: ${key}`);\n    }\n    getAll(key) {\n        validateKey(key);\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (this.parent == null) {\n                    return PLATFORM.emptyArray;\n                }\n                current = current.parent;\n            }\n            else {\n                return buildAllResponse(resolver, current, this);\n            }\n        }\n        return PLATFORM.emptyArray;\n    }\n    getFactory(Type) {\n        let factory = Metadata.getOwn(factoryAnnotationKey, Type);\n        if (factory === void 0) {\n            Metadata.define(factoryAnnotationKey, factory = createFactory(Type), Type);\n            Protocol.annotation.appendTo(Type, factoryAnnotationKey);\n        }\n        return factory;\n    }\n    registerFactory(key, factory) {\n        Protocol.annotation.set(key, factoryKey, factory);\n        Protocol.annotation.appendTo(key, factoryAnnotationKey);\n    }\n    createChild(config) {\n        return new Container(this, config !== null && config !== void 0 ? config : this.config);\n    }\n    disposeResolvers() {\n        var _a;\n        const disposables = Array.from(this.disposableResolvers);\n        while (disposables.length > 0) {\n            (_a = disposables.pop()) === null || _a === void 0 ? void 0 : _a.dispose();\n        }\n    }\n    dispose() {\n        var _a, _b, _c, _d;\n        this.disposeResolvers();\n        for (const key in this.resourceResolvers) {\n            (_b = (_a = this.resourceResolvers[key]).dispose) === null || _b === void 0 ? void 0 : _b.call(_a);\n        }\n        for (const key of this.resolvers.keys()) {\n            (_d = (_c = this.resolvers.get(key)).dispose) === null || _d === void 0 ? void 0 : _d.call(_c);\n        }\n        this.resolvers.clear();\n        this.root = this.parent = this.config = this.resolvers = this.resourceResolvers = this.disposableResolvers = null;\n    }\n    jitRegister(keyAsValue, handler) {\n        if (typeof keyAsValue !== 'function') {\n            throw new Error(`Attempted to jitRegister something that is not a constructor: '${keyAsValue}'. Did you forget to register this resource?`);\n        }\n        if (InstrinsicTypeNames.has(keyAsValue.name)) {\n            throw new Error(`Attempted to jitRegister an intrinsic type: ${keyAsValue.name}. Did you forget to add @inject(Key)`);\n        }\n        if (isRegistry(keyAsValue)) {\n            const registrationResolver = keyAsValue.register(handler, keyAsValue);\n            if (!(registrationResolver instanceof Object) || registrationResolver.resolve == null) {\n                const newResolver = handler.resolvers.get(keyAsValue);\n                if (newResolver != void 0) {\n                    return newResolver;\n                }\n                throw Reporter.error(40); // did not return a valid resolver from the static register method\n            }\n            return registrationResolver;\n        }\n        else if (Protocol.resource.has(keyAsValue)) {\n            const defs = Protocol.resource.getAll(keyAsValue);\n            if (defs.length === 1) {\n                // Fast path for the very common case\n                defs[0].register(handler);\n            }\n            else {\n                const len = defs.length;\n                for (let d = 0; d < len; ++d) {\n                    defs[d].register(handler);\n                }\n            }\n            const newResolver = handler.resolvers.get(keyAsValue);\n            if (newResolver != void 0) {\n                return newResolver;\n            }\n            throw Reporter.error(40); // did not return a valid resolver from the static register method\n        }\n        else if (keyAsValue.$isInterface) {\n            throw new Error(`Attempted to jitRegister an interface: ${keyAsValue.friendlyName}`);\n        }\n        else {\n            const resolver = this.config.defaultResolver(keyAsValue, handler);\n            handler.resolvers.set(keyAsValue, resolver);\n            return resolver;\n        }\n    }\n}\n/**\n * An implementation of IRegistry that delegates registration to a\n * separately registered class. The ParameterizedRegistry facilitates the\n * passing of parameters to the final registry.\n */\nexport class ParameterizedRegistry {\n    constructor(key, params) {\n        this.key = key;\n        this.params = params;\n    }\n    register(container) {\n        if (container.has(this.key, true)) {\n            const registry = container.get(this.key);\n            registry.register(container, ...this.params);\n        }\n        else {\n            container.register(...this.params.filter(x => typeof x === 'object'));\n        }\n    }\n}\nconst cache = new WeakMap();\nfunction cacheCallbackResult(fun) {\n    return function (handler, requestor, resolver) {\n        if (cache.has(resolver)) {\n            return cache.get(resolver);\n        }\n        const t = fun(handler, requestor, resolver);\n        cache.set(resolver, t);\n        return t;\n    };\n}\n/**\n * you can use the resulting {@linkcode IRegistration} of any of the factory methods\n * to register with the container, e.g.\n * ```\n * class Foo {}\n * const container = DI.createContainer();\n * container.register(Registration.instance(Foo, new Foo()));\n * container.get(Foo);\n * ```\n */\nexport const Registration = {\n    /**\n     * allows you to pass an instance.\n     * Every time you request this {@linkcode Key} you will get this instance back.\n     * ```\n     * Registration.instance(Foo, new Foo()));\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    instance(key, value) {\n        return new Resolver(key, 0 /* instance */, value);\n    },\n    /**\n     * Creates an instance from the class.\n     * Every time you request this {@linkcode Key} you will get the same one back.\n     * ```\n     * Registration.singleton(Foo, Foo);\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    singleton(key, value) {\n        return new Resolver(key, 1 /* singleton */, value);\n    },\n    /**\n     * Creates an instance from a class.\n     * Every time you request this {@linkcode Key} you will get a new instance.\n     * ```\n     * Registration.instance(Foo, Foo);\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    transient(key, value) {\n        return new Resolver(key, 2 /* transient */, value);\n    },\n    /**\n     * Creates an instance from the method passed.\n     * Every time you request this {@linkcode Key} you will get a new instance.\n     * ```\n     * Registration.callback(Foo, () => new Foo());\n     * Registration.callback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n     * ```\n     *\n     * @param key\n     * @param callback\n     */\n    callback(key, callback) {\n        return new Resolver(key, 3 /* callback */, callback);\n    },\n    /**\n     * Creates an instance from the method passed.\n     * On the first request for the {@linkcode Key} your callback is called and returns an instance.\n     * subsequent requests for the {@linkcode Key}, the initial instance returned will be returned.\n     * If you pass the same {@linkcode Registration} to another container the same cached value will be used.\n     * Should all references to the resolver returned be removed, the cache will expire.\n     * ```\n     * Registration.cachedCallback(Foo, () => new Foo());\n     * Registration.cachedCallback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n     * ```\n     *\n     * @param key\n     * @param callback\n     */\n    cachedCallback(key, callback) {\n        return new Resolver(key, 3 /* callback */, cacheCallbackResult(callback));\n    },\n    /**\n     * creates an alternate {@linkcode Key} to retrieve an instance by.\n     * Returns the same scope as the original {@linkcode Key}.\n     * ```\n     * Register.singleton(Foo, Foo)\n     * Register.aliasTo(Foo, MyFoos);\n     *\n     * container.getAll(MyFoos) // contains an instance of Foo\n     * ```\n     *\n     * @param originalKey\n     * @param aliasKey\n     */\n    aliasTo(originalKey, aliasKey) {\n        return new Resolver(aliasKey, 5 /* alias */, originalKey);\n    },\n    /**\n     * @internal\n     * @param key\n     * @param params\n     */\n    defer(key, ...params) {\n        return new ParameterizedRegistry(key, params);\n    }\n};\nexport class InstanceProvider {\n    constructor() {\n        this.instance = null;\n    }\n    prepare(instance) {\n        this.instance = instance;\n    }\n    get $isResolver() { return true; }\n    resolve() {\n        if (this.instance === undefined) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        return this.instance;\n    }\n    dispose() {\n        this.instance = null;\n    }\n}\n/** @internal */\nexport function validateKey(key) {\n    if (key === null || key === void 0) {\n        throw Reporter.error(5);\n    }\n}\nfunction buildAllResponse(resolver, handler, requestor) {\n    if (resolver instanceof Resolver && resolver.strategy === 4 /* array */) {\n        const state = resolver.state;\n        let i = state.length;\n        const results = new Array(i);\n        while (i--) {\n            results[i] = state[i].resolve(handler, requestor);\n        }\n        return results;\n    }\n    return [resolver.resolve(handler, requestor)];\n}\n//# sourceMappingURL=di.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, DI, ignore, optional, Registration } from './di';\nimport { toLookup } from './functions';\nimport { Protocol } from './resource';\nimport { Metadata } from '@aurelia/metadata';\n/**\n * Flags to enable/disable color usage in the logging output.\n */\nexport var ColorOptions;\n(function (ColorOptions) {\n    /**\n     * Do not use ASCII color codes in logging output.\n     */\n    ColorOptions[ColorOptions[\"noColors\"] = 0] = \"noColors\";\n    /**\n     * Use ASCII color codes in logging output. By default, timestamps and the TRC and DBG prefix are colored grey. INF white, WRN yellow, and ERR and FTL red.\n     */\n    ColorOptions[ColorOptions[\"colors\"] = 1] = \"colors\";\n})(ColorOptions || (ColorOptions = {}));\nexport const ILogConfig = DI.createInterface('ILogConfig').withDefault(x => x.instance(new LogConfig(0 /* noColors */, 3 /* warn */)));\nexport const ISink = DI.createInterface('ISink').noDefault();\nexport const ILogEventFactory = DI.createInterface('ILogEventFactory').withDefault(x => x.singleton(DefaultLogEventFactory));\nexport const ILogger = DI.createInterface('ILogger').withDefault(x => x.singleton(DefaultLogger));\nexport const ILogScopes = DI.createInterface('ILogScope').noDefault();\nexport const LoggerSink = Object.freeze({\n    key: Protocol.annotation.keyFor('logger-sink-handles'),\n    define(target, definition) {\n        Metadata.define(this.key, definition.handles, target.prototype);\n        return target;\n    },\n    getHandles(target) {\n        return Metadata.get(this.key, target);\n    },\n});\nexport function sink(definition) {\n    return function (target) {\n        return LoggerSink.define(target, definition);\n    };\n}\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\nexport const format = toLookup({\n    red(str) {\n        return `\\u001b[31m${str}\\u001b[39m`;\n    },\n    green(str) {\n        return `\\u001b[32m${str}\\u001b[39m`;\n    },\n    yellow(str) {\n        return `\\u001b[33m${str}\\u001b[39m`;\n    },\n    blue(str) {\n        return `\\u001b[34m${str}\\u001b[39m`;\n    },\n    magenta(str) {\n        return `\\u001b[35m${str}\\u001b[39m`;\n    },\n    cyan(str) {\n        return `\\u001b[36m${str}\\u001b[39m`;\n    },\n    white(str) {\n        return `\\u001b[37m${str}\\u001b[39m`;\n    },\n    grey(str) {\n        return `\\u001b[90m${str}\\u001b[39m`;\n    },\n});\nexport class LogConfig {\n    constructor(colorOptions, level) {\n        this.colorOptions = colorOptions;\n        this.level = level;\n    }\n}\nconst getLogLevelString = (function () {\n    const logLevelString = [\n        toLookup({\n            TRC: 'TRC',\n            DBG: 'DBG',\n            INF: 'INF',\n            WRN: 'WRN',\n            ERR: 'ERR',\n            FTL: 'FTL',\n            QQQ: '???',\n        }),\n        toLookup({\n            TRC: format.grey('TRC'),\n            DBG: format.grey('DBG'),\n            INF: format.white('INF'),\n            WRN: format.yellow('WRN'),\n            ERR: format.red('ERR'),\n            FTL: format.red('FTL'),\n            QQQ: format.grey('???'),\n        }),\n    ];\n    return function (level, colorOptions) {\n        if (level <= 0 /* trace */) {\n            return logLevelString[colorOptions].TRC;\n        }\n        if (level <= 1 /* debug */) {\n            return logLevelString[colorOptions].DBG;\n        }\n        if (level <= 2 /* info */) {\n            return logLevelString[colorOptions].INF;\n        }\n        if (level <= 3 /* warn */) {\n            return logLevelString[colorOptions].WRN;\n        }\n        if (level <= 4 /* error */) {\n            return logLevelString[colorOptions].ERR;\n        }\n        if (level <= 5 /* fatal */) {\n            return logLevelString[colorOptions].FTL;\n        }\n        return logLevelString[colorOptions].QQQ;\n    };\n})();\nfunction getScopeString(scope, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return scope.join('.');\n    }\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    return scope.map(format.cyan).join('.');\n}\nfunction getIsoString(timestamp, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return new Date(timestamp).toISOString();\n    }\n    return format.grey(new Date(timestamp).toISOString());\n}\nexport class DefaultLogEvent {\n    constructor(severity, message, optionalParams, scope, colorOptions, timestamp) {\n        this.severity = severity;\n        this.message = message;\n        this.optionalParams = optionalParams;\n        this.scope = scope;\n        this.colorOptions = colorOptions;\n        this.timestamp = timestamp;\n    }\n    toString() {\n        const { severity, message, scope, colorOptions, timestamp } = this;\n        if (scope.length === 0) {\n            return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)}] ${message}`;\n        }\n        return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)} ${getScopeString(scope, colorOptions)}] ${message}`;\n    }\n}\nlet DefaultLogEventFactory = /** @class */ (() => {\n    let DefaultLogEventFactory = class DefaultLogEventFactory {\n        constructor(config) {\n            this.config = config;\n        }\n        createLogEvent(logger, level, message, optionalParams) {\n            return new DefaultLogEvent(level, message, optionalParams, logger.scope, this.config.colorOptions, Date.now());\n        }\n    };\n    DefaultLogEventFactory = __decorate([\n        __param(0, ILogConfig),\n        __metadata(\"design:paramtypes\", [Object])\n    ], DefaultLogEventFactory);\n    return DefaultLogEventFactory;\n})();\nexport { DefaultLogEventFactory };\nexport class ConsoleSink {\n    constructor($console) {\n        this.handleEvent = function emit(event) {\n            const optionalParams = event.optionalParams;\n            if (optionalParams === void 0 || optionalParams.length === 0) {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString());\n                    case 2 /* info */:\n                        return $console.info(event.toString());\n                    case 3 /* warn */:\n                        return $console.warn(event.toString());\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString());\n                }\n            }\n            else {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString(), ...optionalParams);\n                    case 2 /* info */:\n                        return $console.info(event.toString(), ...optionalParams);\n                    case 3 /* warn */:\n                        return $console.warn(event.toString(), ...optionalParams);\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString(), ...optionalParams);\n                }\n            }\n        };\n    }\n}\nlet DefaultLogger = /** @class */ (() => {\n    let DefaultLogger = class DefaultLogger {\n        constructor(config, factory, sinks, scope = [], parent = null) {\n            var _a, _b, _c, _d, _e, _f;\n            this.config = config;\n            this.factory = factory;\n            this.scope = scope;\n            this.scopedLoggers = Object.create(null);\n            let traceSinks;\n            let debugSinks;\n            let infoSinks;\n            let warnSinks;\n            let errorSinks;\n            let fatalSinks;\n            if (parent === null) {\n                this.root = this;\n                this.parent = this;\n                traceSinks = this.traceSinks = [];\n                debugSinks = this.debugSinks = [];\n                infoSinks = this.infoSinks = [];\n                warnSinks = this.warnSinks = [];\n                errorSinks = this.errorSinks = [];\n                fatalSinks = this.fatalSinks = [];\n                for (const $sink of sinks) {\n                    const handles = LoggerSink.getHandles($sink);\n                    if ((_a = handles === null || handles === void 0 ? void 0 : handles.includes(0 /* trace */)) !== null && _a !== void 0 ? _a : true) {\n                        traceSinks.push($sink);\n                    }\n                    if ((_b = handles === null || handles === void 0 ? void 0 : handles.includes(1 /* debug */)) !== null && _b !== void 0 ? _b : true) {\n                        debugSinks.push($sink);\n                    }\n                    if ((_c = handles === null || handles === void 0 ? void 0 : handles.includes(2 /* info */)) !== null && _c !== void 0 ? _c : true) {\n                        infoSinks.push($sink);\n                    }\n                    if ((_d = handles === null || handles === void 0 ? void 0 : handles.includes(3 /* warn */)) !== null && _d !== void 0 ? _d : true) {\n                        warnSinks.push($sink);\n                    }\n                    if ((_e = handles === null || handles === void 0 ? void 0 : handles.includes(4 /* error */)) !== null && _e !== void 0 ? _e : true) {\n                        errorSinks.push($sink);\n                    }\n                    if ((_f = handles === null || handles === void 0 ? void 0 : handles.includes(5 /* fatal */)) !== null && _f !== void 0 ? _f : true) {\n                        fatalSinks.push($sink);\n                    }\n                }\n            }\n            else {\n                this.root = parent.root;\n                this.parent = parent;\n                traceSinks = this.traceSinks = parent.traceSinks;\n                debugSinks = this.debugSinks = parent.debugSinks;\n                infoSinks = this.infoSinks = parent.infoSinks;\n                warnSinks = this.warnSinks = parent.warnSinks;\n                errorSinks = this.errorSinks = parent.errorSinks;\n                fatalSinks = this.fatalSinks = parent.fatalSinks;\n            }\n            const emit = ($sinks, level, msgOrGetMsg, optionalParams) => {\n                const message = typeof msgOrGetMsg === 'function' ? msgOrGetMsg() : msgOrGetMsg;\n                const event = factory.createLogEvent(this, level, message, optionalParams);\n                for (let i = 0, ii = $sinks.length; i < ii; ++i) {\n                    $sinks[i].handleEvent(event);\n                }\n            };\n            this.trace = function trace(messageOrGetMessage, ...optionalParams) {\n                if (config.level <= 0 /* trace */) {\n                    emit(traceSinks, 0 /* trace */, messageOrGetMessage, optionalParams);\n                }\n            };\n            this.debug = function debug(messageOrGetMessage, ...optionalParams) {\n                if (config.level <= 1 /* debug */) {\n                    emit(debugSinks, 1 /* debug */, messageOrGetMessage, optionalParams);\n                }\n            };\n            this.info = function info(messageOrGetMessage, ...optionalParams) {\n                if (config.level <= 2 /* info */) {\n                    emit(infoSinks, 2 /* info */, messageOrGetMessage, optionalParams);\n                }\n            };\n            this.warn = function warn(messageOrGetMessage, ...optionalParams) {\n                if (config.level <= 3 /* warn */) {\n                    emit(warnSinks, 3 /* warn */, messageOrGetMessage, optionalParams);\n                }\n            };\n            this.error = function error(messageOrGetMessage, ...optionalParams) {\n                if (config.level <= 4 /* error */) {\n                    emit(errorSinks, 4 /* error */, messageOrGetMessage, optionalParams);\n                }\n            };\n            this.fatal = function fatal(messageOrGetMessage, ...optionalParams) {\n                if (config.level <= 5 /* fatal */) {\n                    emit(fatalSinks, 5 /* fatal */, messageOrGetMessage, optionalParams);\n                }\n            };\n        }\n        scopeTo(name) {\n            const scopedLoggers = this.scopedLoggers;\n            let scopedLogger = scopedLoggers[name];\n            if (scopedLogger === void 0) {\n                scopedLogger = scopedLoggers[name] = new DefaultLogger(this.config, this.factory, (void 0), this.scope.concat(name), this);\n            }\n            return scopedLogger;\n        }\n    };\n    DefaultLogger = __decorate([\n        __param(0, ILogConfig),\n        __param(1, ILogEventFactory),\n        __param(2, all(ISink)),\n        __param(3, optional(ILogScopes)),\n        __param(4, ignore),\n        __metadata(\"design:paramtypes\", [Object, Object, Array, Array, Object])\n    ], DefaultLogger);\n    return DefaultLogger;\n})();\nexport { DefaultLogger };\n/**\n * A basic `ILogger` configuration that configures a single `console` sink based on provided options.\n *\n * NOTE: You *must* register the return value of `.create` with the container / au instance, not this `LoggerConfiguration` object itself.\n *\n * @example\n * ```ts\n * container.register(LoggerConfiguration.create());\n *\n * container.register(LoggerConfiguration.create({$console: console}))\n *\n * container.register(LoggerConfiguration.create({$console: console, level: LogLevel.debug}))\n *\n * container.register(LoggerConfiguration.create({\n *  $console: {\n *     debug: PLATFORM.noop,\n *     info: PLATFORM.noop,\n *     warn: PLATFORM.noop,\n *     error: msg => {\n *       throw new Error(msg);\n *     }\n *  },\n *  level: LogLevel.debug\n * }))\n *\n * ```\n */\nexport const LoggerConfiguration = toLookup({\n    /**\n     * @param $console - The `console` object to use. Can be the native `window.console` / `global.console`, but can also be a wrapper or mock that implements the same interface.\n     * @param level - The global `LogLevel` to configure. Defaults to `warn` or higher.\n     * @param colorOptions - Whether to use colors or not. Defaults to `noColors`. Colors are especially nice in nodejs environments but don't necessarily work (well) in all environments, such as browsers.\n     */\n    create({ $console, level = 3 /* warn */, colorOptions = 0 /* noColors */, sinks = [], } = {}) {\n        return toLookup({\n            register(container) {\n                container.register(Registration.instance(ILogConfig, new LogConfig(colorOptions, level)));\n                if ($console !== void 0 && $console !== null) {\n                    container.register(Registration.instance(ISink, new ConsoleSink($console)));\n                }\n                for (const $sink of sinks) {\n                    container.register(Registration.singleton(ISink, $sink));\n                }\n                return container;\n            },\n        });\n    },\n});\n//# sourceMappingURL=logger.js.map","import { PLATFORM } from './platform';\nexport const Profiler = (function () {\n    const now = PLATFORM.now;\n    const timers = [];\n    let profileMap;\n    const profiler = {\n        createTimer,\n        enable,\n        disable,\n        report,\n        enabled: false\n    };\n    return profiler;\n    function createTimer(name) {\n        timers.push(name);\n        let depth = 0;\n        let mark = 0;\n        return {\n            enter,\n            leave\n        };\n        function enter() {\n            if (++depth === 1) {\n                mark = now();\n                ++profileMap[name].topLevelCount;\n            }\n            ++profileMap[name].totalCount;\n        }\n        function leave() {\n            if (--depth === 0) {\n                profileMap[name].duration += (now() - mark);\n            }\n        }\n    }\n    function enable() {\n        profileMap = {};\n        for (const timer of timers) {\n            profileMap[timer] = {\n                name: timer,\n                duration: 0,\n                topLevelCount: 0,\n                totalCount: 0\n            };\n        }\n        profiler.enabled = true;\n    }\n    function disable() {\n        profiler.enabled = false;\n    }\n    function report(cb) {\n        Object.keys(profileMap).map(key => profileMap[key]).sort((a, b) => b.duration - a.duration).forEach(p => {\n            cb(p.name, p.duration, p.topLevelCount, p.totalCount);\n        });\n    }\n})();\n//# sourceMappingURL=profiler.js.map","import { DI } from './di';\nimport { Reporter } from './reporter';\n/**\n * Represents a handler for an EventAggregator event.\n */\nclass Handler {\n    constructor(messageType, callback) {\n        this.messageType = messageType;\n        this.callback = callback;\n    }\n    handle(message) {\n        if (message instanceof this.messageType) {\n            this.callback.call(null, message);\n        }\n    }\n}\nfunction invokeCallback(callback, message, channel) {\n    try {\n        callback(message, channel);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nfunction invokeHandler(handler, message) {\n    try {\n        handler.handle(message);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nexport const IEventAggregator = DI.createInterface('IEventAggregator').withDefault(x => x.singleton(EventAggregator));\n/**\n * Enables loosely coupled publish/subscribe messaging.\n */\nexport class EventAggregator {\n    constructor() {\n        /** @internal */\n        this.eventLookup = {};\n        /** @internal */\n        this.messageHandlers = [];\n    }\n    publish(channelOrInstance, message) {\n        if (!channelOrInstance) {\n            throw Reporter.error(0); // TODO: create error code for 'Event was invalid.'\n        }\n        if (typeof channelOrInstance === 'string') {\n            let subscribers = this.eventLookup[channelOrInstance];\n            if (subscribers !== void 0) {\n                subscribers = subscribers.slice();\n                let i = subscribers.length;\n                while (i-- > 0) {\n                    invokeCallback(subscribers[i], message, channelOrInstance);\n                }\n            }\n        }\n        else {\n            const subscribers = this.messageHandlers.slice();\n            let i = subscribers.length;\n            while (i-- > 0) {\n                invokeHandler(subscribers[i], channelOrInstance);\n            }\n        }\n    }\n    subscribe(channelOrType, callback) {\n        if (!channelOrType) {\n            throw Reporter.error(0); // TODO: create error code for 'Event channel/type was invalid.'\n        }\n        let handler;\n        let subscribers;\n        if (typeof channelOrType === 'string') {\n            if (this.eventLookup[channelOrType] === void 0) {\n                this.eventLookup[channelOrType] = [];\n            }\n            handler = callback;\n            subscribers = this.eventLookup[channelOrType];\n        }\n        else {\n            handler = new Handler(channelOrType, callback);\n            subscribers = this.messageHandlers;\n        }\n        subscribers.push(handler);\n        return {\n            dispose() {\n                const idx = subscribers.indexOf(handler);\n                if (idx !== -1) {\n                    subscribers.splice(idx, 1);\n                }\n            }\n        };\n    }\n    subscribeOnce(channelOrType, callback) {\n        const sub = this.subscribe(channelOrType, function (message, event) {\n            sub.dispose();\n            callback(message, event);\n        });\n        return sub;\n    }\n}\n//# sourceMappingURL=eventaggregator.js.map","import { DI, Metadata, PLATFORM, Protocol, Registration, Reporter } from '@aurelia/kernel';\n/** @internal */\nexport class CharSpec {\n    constructor(chars, repeat, isSymbol, isInverted) {\n        this.chars = chars;\n        this.repeat = repeat;\n        this.isSymbol = isSymbol;\n        this.isInverted = isInverted;\n        if (isInverted) {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNoneInverse;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingleInverse;\n                    break;\n                default:\n                    this.has = this.hasOfMultipleInverse;\n            }\n        }\n        else {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNone;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingle;\n                    break;\n                default:\n                    this.has = this.hasOfMultiple;\n            }\n        }\n    }\n    equals(other) {\n        return this.chars === other.chars\n            && this.repeat === other.repeat\n            && this.isSymbol === other.isSymbol\n            && this.isInverted === other.isInverted;\n    }\n    hasOfMultiple(char) {\n        return this.chars.includes(char);\n    }\n    hasOfSingle(char) {\n        return this.chars === char;\n    }\n    hasOfNone(char) {\n        return false;\n    }\n    hasOfMultipleInverse(char) {\n        return !this.chars.includes(char);\n    }\n    hasOfSingleInverse(char) {\n        return this.chars !== char;\n    }\n    hasOfNoneInverse(char) {\n        return true;\n    }\n}\nexport class Interpretation {\n    constructor() {\n        this.parts = PLATFORM.emptyArray;\n        this._pattern = '';\n        this.currentRecord = {};\n        this.partsRecord = {};\n    }\n    get pattern() {\n        const value = this._pattern;\n        if (value === '') {\n            return null;\n        }\n        else {\n            return value;\n        }\n    }\n    set pattern(value) {\n        if (value == null) {\n            this._pattern = '';\n            this.parts = PLATFORM.emptyArray;\n        }\n        else {\n            this._pattern = value;\n            this.parts = this.partsRecord[value];\n        }\n    }\n    append(pattern, ch) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] === undefined) {\n            currentRecord[pattern] = ch;\n        }\n        else {\n            currentRecord[pattern] += ch;\n        }\n    }\n    next(pattern) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] !== undefined) {\n            const { partsRecord } = this;\n            if (partsRecord[pattern] === undefined) {\n                partsRecord[pattern] = [currentRecord[pattern]];\n            }\n            else {\n                partsRecord[pattern].push(currentRecord[pattern]);\n            }\n            currentRecord[pattern] = undefined;\n        }\n    }\n}\n/** @internal */\nexport class State {\n    constructor(charSpec, ...patterns) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n        this.types = null;\n        this.isEndpoint = false;\n        this.patterns = patterns;\n    }\n    get pattern() {\n        return this.isEndpoint ? this.patterns[0] : null;\n    }\n    findChild(charSpec) {\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let child = null;\n        for (let i = 0; i < len; ++i) {\n            child = nextStates[i];\n            if (charSpec.equals(child.charSpec)) {\n                return child;\n            }\n        }\n        return null;\n    }\n    append(charSpec, pattern) {\n        const { patterns } = this;\n        if (!patterns.includes(pattern)) {\n            patterns.push(pattern);\n        }\n        let state = this.findChild(charSpec);\n        if (state == null) {\n            state = new State(charSpec, pattern);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n    findMatches(ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const results = [];\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let childLen = 0;\n        let child = null;\n        let i = 0;\n        let j = 0;\n        for (; i < len; ++i) {\n            child = nextStates[i];\n            if (child.charSpec.has(ch)) {\n                results.push(child);\n                childLen = child.patterns.length;\n                j = 0;\n                if (child.charSpec.isSymbol) {\n                    for (; j < childLen; ++j) {\n                        interpretation.next(child.patterns[j]);\n                    }\n                }\n                else {\n                    for (; j < childLen; ++j) {\n                        interpretation.append(child.patterns[j], ch);\n                    }\n                }\n            }\n        }\n        return results;\n    }\n}\n/** @internal */\nexport class StaticSegment {\n    constructor(text) {\n        this.text = text;\n        this.text = text;\n        const len = this.len = text.length;\n        const specs = this.specs = [];\n        for (let i = 0; i < len; ++i) {\n            specs.push(new CharSpec(text[i], false, false, false));\n        }\n    }\n    eachChar(callback) {\n        const { len, specs } = this;\n        for (let i = 0; i < len; ++i) {\n            callback(specs[i]);\n        }\n    }\n}\n/** @internal */\nexport class DynamicSegment {\n    constructor(symbols) {\n        this.text = 'PART';\n        this.spec = new CharSpec(symbols, true, false, true);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SymbolSegment {\n    constructor(text) {\n        this.text = text;\n        this.spec = new CharSpec(text, false, true, false);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SegmentTypes {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.symbols = 0;\n    }\n}\nexport const ISyntaxInterpreter = DI.createInterface('ISyntaxInterpreter').withDefault(x => x.singleton(SyntaxInterpreter));\n/** @internal */\nexport class SyntaxInterpreter {\n    constructor() {\n        this.rootState = new State(null);\n        this.initialStates = [this.rootState];\n    }\n    add(defOrDefs) {\n        let i = 0;\n        if (Array.isArray(defOrDefs)) {\n            const ii = defOrDefs.length;\n            for (; i < ii; ++i) {\n                this.add(defOrDefs[i]);\n            }\n            return;\n        }\n        let currentState = this.rootState;\n        const def = defOrDefs;\n        const pattern = def.pattern;\n        const types = new SegmentTypes();\n        const segments = this.parse(def, types);\n        const len = segments.length;\n        const callback = (ch) => {\n            currentState = currentState.append(ch, pattern);\n        };\n        for (i = 0; i < len; ++i) {\n            segments[i].eachChar(callback);\n        }\n        currentState.types = types;\n        currentState.isEndpoint = true;\n    }\n    interpret(name) {\n        const interpretation = new Interpretation();\n        let states = this.initialStates;\n        const len = name.length;\n        for (let i = 0; i < len; ++i) {\n            states = this.getNextStates(states, name.charAt(i), interpretation);\n            if (states.length === 0) {\n                break;\n            }\n        }\n        states.sort((a, b) => {\n            if (a.isEndpoint) {\n                if (!b.isEndpoint) {\n                    return -1;\n                }\n            }\n            else if (b.isEndpoint) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n            const aTypes = a.types;\n            const bTypes = b.types;\n            if (aTypes.statics !== bTypes.statics) {\n                return bTypes.statics - aTypes.statics;\n            }\n            if (aTypes.dynamics !== bTypes.dynamics) {\n                return bTypes.dynamics - aTypes.dynamics;\n            }\n            if (aTypes.symbols !== bTypes.symbols) {\n                return bTypes.symbols - aTypes.symbols;\n            }\n            return 0;\n        });\n        if (states.length > 0) {\n            const state = states[0];\n            if (!state.charSpec.isSymbol) {\n                interpretation.next(state.pattern);\n            }\n            interpretation.pattern = state.pattern;\n        }\n        return interpretation;\n    }\n    getNextStates(states, ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const nextStates = [];\n        let state = null;\n        const len = states.length;\n        for (let i = 0; i < len; ++i) {\n            state = states[i];\n            nextStates.push(...state.findMatches(ch, interpretation));\n        }\n        return nextStates;\n    }\n    parse(def, types) {\n        const result = [];\n        const pattern = def.pattern;\n        const len = pattern.length;\n        let i = 0;\n        let start = 0;\n        let c = '';\n        while (i < len) {\n            c = pattern.charAt(i);\n            if (!def.symbols.includes(c)) {\n                if (i === start) {\n                    if (c === 'P' && pattern.slice(i, i + 4) === 'PART') {\n                        start = i = (i + 4);\n                        result.push(new DynamicSegment(def.symbols));\n                        ++types.dynamics;\n                    }\n                    else {\n                        ++i;\n                    }\n                }\n                else {\n                    ++i;\n                }\n            }\n            else if (i !== start) {\n                result.push(new StaticSegment(pattern.slice(start, i)));\n                ++types.statics;\n                start = i;\n            }\n            else {\n                result.push(new SymbolSegment(pattern.slice(start, i + 1)));\n                ++types.symbols;\n                start = ++i;\n            }\n        }\n        if (start !== i) {\n            result.push(new StaticSegment(pattern.slice(start, i)));\n            ++types.statics;\n        }\n        return result;\n    }\n}\nfunction validatePrototype(handler, patternDefs) {\n    for (const def of patternDefs) {\n        // note: we're intentionally not throwing here\n        if (!(def.pattern in handler)) {\n            Reporter.write(401, def.pattern); // TODO: organize error codes\n        }\n        else if (typeof handler[def.pattern] !== 'function') {\n            Reporter.write(402, def.pattern); // TODO: organize error codes\n        }\n    }\n}\nexport const IAttributePattern = DI.createInterface('IAttributePattern').noDefault();\nexport function attributePattern(...patternDefs) {\n    return function decorator(target) {\n        return AttributePattern.define(patternDefs, target);\n    };\n}\nexport class AttributePatternResourceDefinition {\n    constructor(Type) {\n        this.Type = Type;\n        this.name = (void 0);\n    }\n    register(container) {\n        Registration.singleton(IAttributePattern, this.Type).register(container);\n    }\n}\nexport const AttributePattern = Object.freeze({\n    name: Protocol.resource.keyFor('attribute-pattern'),\n    definitionAnnotationKey: 'attribute-pattern-definitions',\n    define(patternDefs, Type) {\n        validatePrototype(Type.prototype, patternDefs);\n        const definition = new AttributePatternResourceDefinition(Type);\n        const { name, definitionAnnotationKey } = AttributePattern;\n        Metadata.define(name, definition, Type);\n        Protocol.resource.appendTo(Type, name);\n        Protocol.annotation.set(Type, definitionAnnotationKey, patternDefs);\n        Protocol.annotation.appendTo(Type, definitionAnnotationKey);\n        return Type;\n    },\n    getPatternDefinitions(Type) {\n        return Protocol.annotation.get(Type, AttributePattern.definitionAnnotationKey);\n    }\n});\n//# sourceMappingURL=attribute-pattern.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, DI } from '@aurelia/kernel';\nimport { AttributePattern, IAttributePattern, ISyntaxInterpreter } from './attribute-pattern';\nexport class AttrSyntax {\n    constructor(rawName, rawValue, target, command) {\n        this.rawName = rawName;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.command = command;\n    }\n}\nexport const IAttributeParser = DI.createInterface('IAttributeParser').withDefault(x => x.singleton(AttributeParser));\n/** @internal */\nlet AttributeParser = /** @class */ (() => {\n    let AttributeParser = class AttributeParser {\n        constructor(interpreter, attrPatterns) {\n            this.interpreter = interpreter;\n            this.cache = {};\n            this.interpreter = interpreter;\n            const patterns = this.patterns = {};\n            attrPatterns.forEach(attrPattern => {\n                const defs = AttributePattern.getPatternDefinitions(attrPattern.constructor);\n                interpreter.add(defs);\n                defs.forEach(def => {\n                    patterns[def.pattern] = attrPattern;\n                });\n            });\n        }\n        parse(name, value) {\n            let interpretation = this.cache[name];\n            if (interpretation == null) {\n                interpretation = this.cache[name] = this.interpreter.interpret(name);\n            }\n            const pattern = interpretation.pattern;\n            if (pattern == null) {\n                return new AttrSyntax(name, value, name, null);\n            }\n            else {\n                return this.patterns[pattern][pattern](name, value, interpretation.parts);\n            }\n        }\n    };\n    AttributeParser = __decorate([\n        __param(0, ISyntaxInterpreter),\n        __param(1, all(IAttributePattern)),\n        __metadata(\"design:paramtypes\", [Object, Array])\n    ], AttributeParser);\n    return AttributeParser;\n})();\nexport { AttributeParser };\n//# sourceMappingURL=attribute-parser.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { AttrSyntax } from './attribute-parser';\nimport { attributePattern } from './attribute-pattern';\nlet DotSeparatedAttributePattern = /** @class */ (() => {\n    let DotSeparatedAttributePattern = class DotSeparatedAttributePattern {\n        ['PART.PART'](rawName, rawValue, parts) {\n            return new AttrSyntax(rawName, rawValue, parts[0], parts[1]);\n        }\n        ['PART.PART.PART'](rawName, rawValue, parts) {\n            return new AttrSyntax(rawName, rawValue, parts[0], parts[2]);\n        }\n    };\n    DotSeparatedAttributePattern = __decorate([\n        attributePattern({ pattern: 'PART.PART', symbols: '.' }, { pattern: 'PART.PART.PART', symbols: '.' })\n    ], DotSeparatedAttributePattern);\n    return DotSeparatedAttributePattern;\n})();\nexport { DotSeparatedAttributePattern };\nlet RefAttributePattern = /** @class */ (() => {\n    let RefAttributePattern = class RefAttributePattern {\n        ['ref'](rawName, rawValue, parts) {\n            return new AttrSyntax(rawName, rawValue, 'element', 'ref');\n        }\n        ['PART.ref'](rawName, rawValue, parts) {\n            return new AttrSyntax(rawName, rawValue, parts[0], 'ref');\n        }\n    };\n    RefAttributePattern = __decorate([\n        attributePattern({ pattern: 'ref', symbols: '' }, { pattern: 'PART.ref', symbols: '.' })\n    ], RefAttributePattern);\n    return RefAttributePattern;\n})();\nexport { RefAttributePattern };\nlet ColonPrefixedBindAttributePattern = /** @class */ (() => {\n    let ColonPrefixedBindAttributePattern = class ColonPrefixedBindAttributePattern {\n        [':PART'](rawName, rawValue, parts) {\n            return new AttrSyntax(rawName, rawValue, parts[0], 'bind');\n        }\n    };\n    ColonPrefixedBindAttributePattern = __decorate([\n        attributePattern({ pattern: ':PART', symbols: ':' })\n    ], ColonPrefixedBindAttributePattern);\n    return ColonPrefixedBindAttributePattern;\n})();\nexport { ColonPrefixedBindAttributePattern };\nlet AtPrefixedTriggerAttributePattern = /** @class */ (() => {\n    let AtPrefixedTriggerAttributePattern = class AtPrefixedTriggerAttributePattern {\n        ['@PART'](rawName, rawValue, parts) {\n            return new AttrSyntax(rawName, rawValue, parts[0], 'trigger');\n        }\n    };\n    AtPrefixedTriggerAttributePattern = __decorate([\n        attributePattern({ pattern: '@PART', symbols: '@' })\n    ], AtPrefixedTriggerAttributePattern);\n    return AtPrefixedTriggerAttributePattern;\n})();\nexport { AtPrefixedTriggerAttributePattern };\n//# sourceMappingURL=attribute-patterns.js.map","import { DI, Registration, Metadata, Protocol, } from '@aurelia/kernel';\n/**\n * TargetedInstructionType enum values become the property names for the associated renderers when they are injected\n * into the `Renderer`.\n *\n * Additional instruction types can be added as long as they are 2 characters long and do not clash with existing ones.\n *\n * By convention, the instruction types for a particular runtime start with the same first letter, and the second letter\n * starts counting from letter `a`. The standard runtime instruction types all start with the letter `r`.\n */\nexport var TargetedInstructionType;\n(function (TargetedInstructionType) {\n    TargetedInstructionType[\"hydrateElement\"] = \"ra\";\n    TargetedInstructionType[\"hydrateAttribute\"] = \"rb\";\n    TargetedInstructionType[\"hydrateTemplateController\"] = \"rc\";\n    TargetedInstructionType[\"hydrateLetElement\"] = \"rd\";\n    TargetedInstructionType[\"setProperty\"] = \"re\";\n    TargetedInstructionType[\"interpolation\"] = \"rf\";\n    TargetedInstructionType[\"propertyBinding\"] = \"rg\";\n    TargetedInstructionType[\"callBinding\"] = \"rh\";\n    TargetedInstructionType[\"letBinding\"] = \"ri\";\n    TargetedInstructionType[\"refBinding\"] = \"rj\";\n    TargetedInstructionType[\"iteratorBinding\"] = \"rk\";\n})(TargetedInstructionType || (TargetedInstructionType = {}));\nexport const ITargetedInstruction = DI.createInterface('ITargetedInstruction').noDefault();\nexport function isTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\nlet HooksDefinition = /** @class */ (() => {\n    class HooksDefinition {\n        constructor(target) {\n            this.hasCreate = 'create' in target;\n            this.hasBeforeCompile = 'beforeCompile' in target;\n            this.hasAfterCompile = 'afterCompile' in target;\n            this.hasAfterCompileChildren = 'afterCompileChildren' in target;\n            this.hasBeforeBind = 'beforeBind' in target;\n            this.hasAfterBind = 'afterBind' in target;\n            this.hasAfterAttach = 'afterAttach' in target;\n            this.hasAfterAttachChildren = 'afterAttachChildren' in target;\n            this.hasBeforeDetach = 'beforeDetach' in target;\n            this.hasBeforeUnbind = 'beforeUnbind' in target;\n            this.hasAfterUnbind = 'afterUnbind' in target;\n            this.hasAfterUnbindChildren = 'afterUnbindChildren' in target;\n            this.hasDispose = 'dispose' in target;\n            this.hasAccept = 'accept' in target;\n        }\n    }\n    HooksDefinition.none = new HooksDefinition({});\n    return HooksDefinition;\n})();\nexport { HooksDefinition };\nexport function alias(...aliases) {\n    return function (target) {\n        const key = Protocol.annotation.keyFor('aliases');\n        const existing = Metadata.getOwn(key, target);\n        if (existing === void 0) {\n            Metadata.define(key, aliases, target);\n        }\n        else {\n            existing.push(...aliases);\n        }\n    };\n}\nexport function registerAliases(aliases, resource, key, container) {\n    for (let i = 0, ii = aliases.length; i < ii; ++i) {\n        Registration.aliasTo(key, resource.keyFrom(aliases[i])).register(container);\n    }\n}\n//# sourceMappingURL=definitions.js.map","import { camelCase, Registration, mergeArrays, Protocol, firstDefined, Metadata } from '@aurelia/kernel';\nimport { registerAliases } from './definitions';\nexport function bindingCommand(nameOrDefinition) {\n    return function (target) {\n        return BindingCommand.define(nameOrDefinition, target);\n    };\n}\nexport class BindingCommandDefinition {\n    constructor(Type, name, aliases, key, type) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.type = type;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new BindingCommandDefinition(Type, firstDefined(BindingCommand.getAnnotation(Type, 'name'), name), mergeArrays(BindingCommand.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingCommand.keyFrom(name), firstDefined(BindingCommand.getAnnotation(Type, 'type'), def.type, Type.type, null));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, BindingCommand, key, container);\n    }\n}\nexport const BindingCommand = {\n    name: Protocol.resource.keyFor('binding-command'),\n    keyFrom(name) {\n        return `${BindingCommand.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingCommand.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingCommandDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingCommand.name, definition, definition.Type);\n        Metadata.define(BindingCommand.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingCommand.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingCommand.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\nexport function getTarget(binding, makeCamelCase) {\n    if (binding.flags & 256 /* isBinding */) {\n        return binding.bindable.propName;\n    }\n    else if (makeCamelCase) {\n        return camelCase(binding.syntax.target);\n    }\n    else {\n        return binding.syntax.target;\n    }\n}\n//# sourceMappingURL=binding-command.js.map","/*\n* Note: the oneTime binding now has a non-zero value for 2 reasons:\n*  - plays nicer with bitwise operations (more consistent code, more explicit settings)\n*  - allows for potentially having something like BindingMode.oneTime | BindingMode.fromView, where an initial value is set once to the view but updates from the view also propagate back to the view model\n*\n* Furthermore, the \"default\" mode would be for simple \".bind\" expressions to make it explicit for our logic that the default is being used.\n* This essentially adds extra information which binding could use to do smarter things and allows bindingBehaviors that add a mode instead of simply overwriting it\n*/\nexport var BindingMode;\n(function (BindingMode) {\n    BindingMode[BindingMode[\"oneTime\"] = 1] = \"oneTime\";\n    BindingMode[BindingMode[\"toView\"] = 2] = \"toView\";\n    BindingMode[BindingMode[\"fromView\"] = 4] = \"fromView\";\n    BindingMode[BindingMode[\"twoWay\"] = 6] = \"twoWay\";\n    BindingMode[BindingMode[\"default\"] = 8] = \"default\";\n})(BindingMode || (BindingMode = {}));\nexport var BindingStrategy;\n(function (BindingStrategy) {\n    /**\n     * Configures all components \"below\" this one to operate in getterSetter binding mode.\n     * This is the default; if no strategy is specified, this one is implied.\n     *\n     * This strategy is the most compatible, convenient and has the best performance on frequently updated bindings on components that are infrequently replaced.\n     * However, it also consumes the most resources on initialization.\n     */\n    BindingStrategy[BindingStrategy[\"getterSetter\"] = 1] = \"getterSetter\";\n    /**\n     * Configures all components \"below\" this one to operate in proxy binding mode.\n     * No getters/setters are created.\n     *\n     * This strategy consumes significantly fewer resources than `getterSetter` on initialization and has the best performance on infrequently updated bindings on\n     * components that are frequently replaced.\n     * However, it consumes more resources on updates.\n     */\n    BindingStrategy[BindingStrategy[\"proxies\"] = 2] = \"proxies\";\n})(BindingStrategy || (BindingStrategy = {}));\nconst mandatoryStrategy = 1 /* getterSetter */ | 2 /* proxies */;\nexport function ensureValidStrategy(strategy) {\n    if ((strategy & mandatoryStrategy) === 0) {\n        // TODO: probably want to validate that user isn't trying to mix getterSetter/proxy\n        // TODO: also need to make sure that strategy can be changed away from proxies inside the component tree (not here though, but just making a note)\n        return strategy | 1 /* getterSetter */;\n    }\n    return strategy;\n}\nexport var LifecycleFlags;\n(function (LifecycleFlags) {\n    LifecycleFlags[LifecycleFlags[\"none\"] = 0] = \"none\";\n    // Bitmask for flags that need to be stored on a binding during $bind for mutation\n    // callbacks outside of $bind\n    LifecycleFlags[LifecycleFlags[\"persistentBindingFlags\"] = 31751] = \"persistentBindingFlags\";\n    LifecycleFlags[LifecycleFlags[\"allowParentScopeTraversal\"] = 1024] = \"allowParentScopeTraversal\";\n    LifecycleFlags[LifecycleFlags[\"observeLeafPropertiesOnly\"] = 2048] = \"observeLeafPropertiesOnly\";\n    LifecycleFlags[LifecycleFlags[\"targetObserverFlags\"] = 12295] = \"targetObserverFlags\";\n    LifecycleFlags[LifecycleFlags[\"noTargetObserverQueue\"] = 4096] = \"noTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"persistentTargetObserverQueue\"] = 8192] = \"persistentTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"secondaryExpression\"] = 16384] = \"secondaryExpression\";\n    LifecycleFlags[LifecycleFlags[\"bindingStrategy\"] = 7] = \"bindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"getterSetterStrategy\"] = 1] = \"getterSetterStrategy\";\n    LifecycleFlags[LifecycleFlags[\"proxyStrategy\"] = 2] = \"proxyStrategy\";\n    LifecycleFlags[LifecycleFlags[\"isStrictBindingStrategy\"] = 4] = \"isStrictBindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"update\"] = 24] = \"update\";\n    LifecycleFlags[LifecycleFlags[\"updateTargetInstance\"] = 8] = \"updateTargetInstance\";\n    LifecycleFlags[LifecycleFlags[\"updateSourceExpression\"] = 16] = \"updateSourceExpression\";\n    LifecycleFlags[LifecycleFlags[\"from\"] = 96] = \"from\";\n    LifecycleFlags[LifecycleFlags[\"fromBind\"] = 32] = \"fromBind\";\n    LifecycleFlags[LifecycleFlags[\"fromUnbind\"] = 64] = \"fromUnbind\";\n    LifecycleFlags[LifecycleFlags[\"mustEvaluate\"] = 128] = \"mustEvaluate\";\n    LifecycleFlags[LifecycleFlags[\"isTraversingParentScope\"] = 256] = \"isTraversingParentScope\";\n    LifecycleFlags[LifecycleFlags[\"dispose\"] = 512] = \"dispose\";\n})(LifecycleFlags || (LifecycleFlags = {}));\nexport var ExpressionKind;\n(function (ExpressionKind) {\n    ExpressionKind[ExpressionKind[\"Connects\"] = 32] = \"Connects\";\n    ExpressionKind[ExpressionKind[\"Observes\"] = 64] = \"Observes\";\n    ExpressionKind[ExpressionKind[\"CallsFunction\"] = 128] = \"CallsFunction\";\n    ExpressionKind[ExpressionKind[\"HasAncestor\"] = 256] = \"HasAncestor\";\n    ExpressionKind[ExpressionKind[\"IsPrimary\"] = 512] = \"IsPrimary\";\n    ExpressionKind[ExpressionKind[\"IsLeftHandSide\"] = 1024] = \"IsLeftHandSide\";\n    ExpressionKind[ExpressionKind[\"HasBind\"] = 2048] = \"HasBind\";\n    ExpressionKind[ExpressionKind[\"HasUnbind\"] = 4096] = \"HasUnbind\";\n    ExpressionKind[ExpressionKind[\"IsAssignable\"] = 8192] = \"IsAssignable\";\n    ExpressionKind[ExpressionKind[\"IsLiteral\"] = 16384] = \"IsLiteral\";\n    ExpressionKind[ExpressionKind[\"IsResource\"] = 32768] = \"IsResource\";\n    ExpressionKind[ExpressionKind[\"IsForDeclaration\"] = 65536] = \"IsForDeclaration\";\n    ExpressionKind[ExpressionKind[\"Type\"] = 31] = \"Type\";\n    // ---------------------------------------------------------------------------------------------------------------------------\n    ExpressionKind[ExpressionKind[\"AccessThis\"] = 1793] = \"AccessThis\";\n    ExpressionKind[ExpressionKind[\"AccessScope\"] = 10082] = \"AccessScope\";\n    ExpressionKind[ExpressionKind[\"ArrayLiteral\"] = 17955] = \"ArrayLiteral\";\n    ExpressionKind[ExpressionKind[\"ObjectLiteral\"] = 17956] = \"ObjectLiteral\";\n    ExpressionKind[ExpressionKind[\"PrimitiveLiteral\"] = 17925] = \"PrimitiveLiteral\";\n    ExpressionKind[ExpressionKind[\"Template\"] = 17958] = \"Template\";\n    ExpressionKind[ExpressionKind[\"Unary\"] = 39] = \"Unary\";\n    ExpressionKind[ExpressionKind[\"CallScope\"] = 1448] = \"CallScope\";\n    ExpressionKind[ExpressionKind[\"CallMember\"] = 1161] = \"CallMember\";\n    ExpressionKind[ExpressionKind[\"CallFunction\"] = 1162] = \"CallFunction\";\n    ExpressionKind[ExpressionKind[\"AccessMember\"] = 9323] = \"AccessMember\";\n    ExpressionKind[ExpressionKind[\"AccessKeyed\"] = 9324] = \"AccessKeyed\";\n    ExpressionKind[ExpressionKind[\"TaggedTemplate\"] = 1197] = \"TaggedTemplate\";\n    ExpressionKind[ExpressionKind[\"Binary\"] = 46] = \"Binary\";\n    ExpressionKind[ExpressionKind[\"Conditional\"] = 63] = \"Conditional\";\n    ExpressionKind[ExpressionKind[\"Assign\"] = 8208] = \"Assign\";\n    ExpressionKind[ExpressionKind[\"ValueConverter\"] = 36913] = \"ValueConverter\";\n    ExpressionKind[ExpressionKind[\"BindingBehavior\"] = 38962] = \"BindingBehavior\";\n    ExpressionKind[ExpressionKind[\"HtmlLiteral\"] = 51] = \"HtmlLiteral\";\n    ExpressionKind[ExpressionKind[\"ArrayBindingPattern\"] = 65556] = \"ArrayBindingPattern\";\n    ExpressionKind[ExpressionKind[\"ObjectBindingPattern\"] = 65557] = \"ObjectBindingPattern\";\n    ExpressionKind[ExpressionKind[\"BindingIdentifier\"] = 65558] = \"BindingIdentifier\";\n    ExpressionKind[ExpressionKind[\"ForOfStatement\"] = 6199] = \"ForOfStatement\";\n    ExpressionKind[ExpressionKind[\"Interpolation\"] = 24] = \"Interpolation\"; //\n})(ExpressionKind || (ExpressionKind = {}));\n//# sourceMappingURL=flags.js.map","export var SymbolFlags;\n(function (SymbolFlags) {\n    SymbolFlags[SymbolFlags[\"type\"] = 1023] = \"type\";\n    SymbolFlags[SymbolFlags[\"isTemplateController\"] = 1] = \"isTemplateController\";\n    SymbolFlags[SymbolFlags[\"isProjection\"] = 2] = \"isProjection\";\n    SymbolFlags[SymbolFlags[\"isCustomAttribute\"] = 4] = \"isCustomAttribute\";\n    SymbolFlags[SymbolFlags[\"isPlainAttribute\"] = 8] = \"isPlainAttribute\";\n    SymbolFlags[SymbolFlags[\"isCustomElement\"] = 16] = \"isCustomElement\";\n    SymbolFlags[SymbolFlags[\"isLetElement\"] = 32] = \"isLetElement\";\n    SymbolFlags[SymbolFlags[\"isPlainElement\"] = 64] = \"isPlainElement\";\n    SymbolFlags[SymbolFlags[\"isText\"] = 128] = \"isText\";\n    SymbolFlags[SymbolFlags[\"isBinding\"] = 256] = \"isBinding\";\n    SymbolFlags[SymbolFlags[\"isAuSlot\"] = 512] = \"isAuSlot\";\n    SymbolFlags[SymbolFlags[\"hasMarker\"] = 1024] = \"hasMarker\";\n    SymbolFlags[SymbolFlags[\"hasTemplate\"] = 2048] = \"hasTemplate\";\n    SymbolFlags[SymbolFlags[\"hasAttributes\"] = 4096] = \"hasAttributes\";\n    SymbolFlags[SymbolFlags[\"hasBindings\"] = 8192] = \"hasBindings\";\n    SymbolFlags[SymbolFlags[\"hasChildNodes\"] = 16384] = \"hasChildNodes\";\n    SymbolFlags[SymbolFlags[\"hasProjections\"] = 32768] = \"hasProjections\";\n})(SymbolFlags || (SymbolFlags = {}));\nfunction createMarker(dom) {\n    const marker = dom.createElement('au-m');\n    dom.makeTarget(marker);\n    return marker;\n}\n/**\n * A html attribute that is associated with a registered resource, specifically a template controller.\n */\nexport class TemplateControllerSymbol {\n    constructor(dom, syntax, info, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 1 /* isTemplateController */ | 1024 /* hasMarker */;\n        this.physicalNode = null;\n        this.template = null;\n        this.templateController = null;\n        this._bindings = null;\n        this.marker = createMarker(dom);\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 8192 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\nexport class ProjectionSymbol {\n    constructor(name, template) {\n        this.name = name;\n        this.template = template;\n        this.flags = 2 /* isProjection */;\n    }\n}\n/**\n * A html attribute that is associated with a registered resource, but not a template controller.\n */\nexport class CustomAttributeSymbol {\n    constructor(syntax, info, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 4 /* isCustomAttribute */;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 8192 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * An attribute, with either a binding command or an interpolation, whose target is the html\n * attribute of the element.\n *\n * This will never target a bindable property of a custom attribute or element;\n */\nexport class PlainAttributeSymbol {\n    constructor(syntax, command, expression) {\n        this.syntax = syntax;\n        this.command = command;\n        this.expression = expression;\n        this.flags = 8 /* isPlainAttribute */;\n    }\n}\n/**\n * Either an attribute on an custom element that maps to a declared bindable property of that element,\n * a single-value bound custom attribute, or one of several bindables that were extracted from the attribute\n * value of a custom attribute with multiple bindings usage.\n *\n * This will always target a bindable property of a custom attribute or element;\n */\nexport class BindingSymbol {\n    constructor(command, bindable, expression, rawValue, target) {\n        this.command = command;\n        this.bindable = bindable;\n        this.expression = expression;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.flags = 256 /* isBinding */;\n    }\n}\n/**\n * A html element that is associated with a registered resource either via its (lowerCase) `nodeName`\n * or the value of its `as-element` attribute.\n */\nexport class CustomElementSymbol {\n    constructor(dom, physicalNode, info, res = info.name, bindables = info.bindables) {\n        this.physicalNode = physicalNode;\n        this.info = info;\n        this.res = res;\n        this.bindables = bindables;\n        this.flags = 16 /* isCustomElement */;\n        this.isTarget = true;\n        this.templateController = null;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._bindings = null;\n        this._childNodes = null;\n        this._projections = null;\n        if (info.containerless) {\n            this.isContainerless = true;\n            this.marker = createMarker(dom);\n            this.flags |= 1024 /* hasMarker */;\n        }\n        else {\n            this.isContainerless = false;\n            this.marker = null;\n        }\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 4096 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 4096 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 8192 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 16384 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n    get projections() {\n        if (this._projections === null) {\n            this._projections = [];\n            this.flags |= 32768 /* hasProjections */;\n        }\n        return this._projections;\n    }\n}\nexport class LetElementSymbol {\n    constructor(dom, physicalNode, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.marker = marker;\n        this.flags = 32 /* isLetElement */ | 1024 /* hasMarker */;\n        this.toBindingContext = false;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 8192 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * A normal html element that may or may not have attribute behaviors and/or child node behaviors.\n *\n * It is possible for a PlainElementSymbol to not yield any instructions during compilation.\n */\nexport class PlainElementSymbol {\n    constructor(dom, physicalNode) {\n        this.physicalNode = physicalNode;\n        this.flags = 64 /* isPlainElement */;\n        this.isTarget = false;\n        this.templateController = null;\n        this.hasSlots = false;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._childNodes = null;\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 4096 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 4096 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 16384 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n}\n/**\n * A standalone text node that has an interpolation.\n */\nexport class TextSymbol {\n    constructor(dom, physicalNode, interpolation, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.interpolation = interpolation;\n        this.marker = marker;\n        this.flags = 128 /* isText */ | 1024 /* hasMarker */;\n    }\n}\n//# sourceMappingURL=semantic-model.js.map","import { BindingMode } from './flags';\nexport class InterpolationInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rf\" /* interpolation */;\n    }\n}\nexport class OneTimeBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.oneTime;\n        this.oneTime = true;\n    }\n}\nexport class ToViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.toView;\n        this.oneTime = false;\n    }\n}\nexport class FromViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.fromView;\n        this.oneTime = false;\n    }\n}\nexport class TwoWayBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.twoWay;\n        this.oneTime = false;\n    }\n}\nexport class IteratorBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rk\" /* iteratorBinding */;\n    }\n}\nexport class CallBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rh\" /* callBinding */;\n    }\n}\nexport class RefBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rj\" /* refBinding */;\n        this.type = \"rj\" /* refBinding */;\n    }\n}\nexport class SetPropertyInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"re\" /* setProperty */;\n    }\n}\nexport class HydrateElementInstruction {\n    constructor(res, instructions, slotInfo) {\n        this.res = res;\n        this.instructions = instructions;\n        this.slotInfo = slotInfo;\n        this.type = \"ra\" /* hydrateElement */;\n    }\n}\nexport class HydrateAttributeInstruction {\n    constructor(res, instructions) {\n        this.res = res;\n        this.instructions = instructions;\n        this.type = \"rb\" /* hydrateAttribute */;\n    }\n}\nexport class HydrateTemplateController {\n    constructor(def, res, instructions, link) {\n        this.def = def;\n        this.res = res;\n        this.instructions = instructions;\n        this.link = link;\n        this.type = \"rc\" /* hydrateTemplateController */;\n    }\n}\nexport class LetElementInstruction {\n    constructor(instructions, toBindingContext) {\n        this.instructions = instructions;\n        this.toBindingContext = toBindingContext;\n        this.type = \"rd\" /* hydrateLetElement */;\n    }\n}\nexport class LetBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"ri\" /* letBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { bindingCommand, getTarget, } from './binding-command';\nimport { BindingMode } from './flags';\nimport { CallBindingInstruction, FromViewBindingInstruction, IteratorBindingInstruction, OneTimeBindingInstruction, ToViewBindingInstruction, TwoWayBindingInstruction, } from './instructions';\nimport { BindingSymbol, } from './semantic-model';\nlet OneTimeBindingCommand = /** @class */ (() => {\n    let OneTimeBindingCommand = class OneTimeBindingCommand {\n        constructor() {\n            this.bindingType = 49 /* OneTimeCommand */;\n        }\n        compile(binding) {\n            return new OneTimeBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    OneTimeBindingCommand = __decorate([\n        bindingCommand('one-time')\n    ], OneTimeBindingCommand);\n    return OneTimeBindingCommand;\n})();\nexport { OneTimeBindingCommand };\nlet ToViewBindingCommand = /** @class */ (() => {\n    let ToViewBindingCommand = class ToViewBindingCommand {\n        constructor() {\n            this.bindingType = 50 /* ToViewCommand */;\n        }\n        compile(binding) {\n            return new ToViewBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    ToViewBindingCommand = __decorate([\n        bindingCommand('to-view')\n    ], ToViewBindingCommand);\n    return ToViewBindingCommand;\n})();\nexport { ToViewBindingCommand };\nlet FromViewBindingCommand = /** @class */ (() => {\n    let FromViewBindingCommand = class FromViewBindingCommand {\n        constructor() {\n            this.bindingType = 51 /* FromViewCommand */;\n        }\n        compile(binding) {\n            return new FromViewBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    FromViewBindingCommand = __decorate([\n        bindingCommand('from-view')\n    ], FromViewBindingCommand);\n    return FromViewBindingCommand;\n})();\nexport { FromViewBindingCommand };\nlet TwoWayBindingCommand = /** @class */ (() => {\n    let TwoWayBindingCommand = class TwoWayBindingCommand {\n        constructor() {\n            this.bindingType = 52 /* TwoWayCommand */;\n        }\n        compile(binding) {\n            return new TwoWayBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    TwoWayBindingCommand = __decorate([\n        bindingCommand('two-way')\n    ], TwoWayBindingCommand);\n    return TwoWayBindingCommand;\n})();\nexport { TwoWayBindingCommand };\nlet DefaultBindingCommand = /** @class */ (() => {\n    let DefaultBindingCommand = class DefaultBindingCommand {\n        constructor() {\n            this.bindingType = 53 /* BindCommand */;\n        }\n        compile(binding) {\n            let mode = BindingMode.default;\n            if (binding instanceof BindingSymbol) {\n                mode = binding.bindable.mode;\n            }\n            else {\n                const command = binding.syntax.command;\n                switch (command) {\n                    case 'bind':\n                    case 'to-view':\n                        mode = BindingMode.toView;\n                        break;\n                    case 'one-time':\n                        mode = BindingMode.oneTime;\n                        break;\n                    case 'from-view':\n                        mode = BindingMode.fromView;\n                        break;\n                    case 'two-way':\n                        mode = BindingMode.twoWay;\n                        break;\n                }\n            }\n            switch (mode) {\n                case BindingMode.default:\n                case BindingMode.toView:\n                    return ToViewBindingCommand.prototype.compile(binding);\n                case BindingMode.oneTime:\n                    return OneTimeBindingCommand.prototype.compile(binding);\n                case BindingMode.fromView:\n                    return FromViewBindingCommand.prototype.compile(binding);\n                case BindingMode.twoWay:\n                    return TwoWayBindingCommand.prototype.compile(binding);\n            }\n        }\n    };\n    DefaultBindingCommand = __decorate([\n        bindingCommand('bind')\n    ], DefaultBindingCommand);\n    return DefaultBindingCommand;\n})();\nexport { DefaultBindingCommand };\nlet CallBindingCommand = /** @class */ (() => {\n    let CallBindingCommand = class CallBindingCommand {\n        constructor() {\n            this.bindingType = 153 /* CallCommand */;\n        }\n        compile(binding) {\n            return new CallBindingInstruction(binding.expression, getTarget(binding, true));\n        }\n    };\n    CallBindingCommand = __decorate([\n        bindingCommand('call')\n    ], CallBindingCommand);\n    return CallBindingCommand;\n})();\nexport { CallBindingCommand };\nlet ForBindingCommand = /** @class */ (() => {\n    let ForBindingCommand = class ForBindingCommand {\n        constructor() {\n            this.bindingType = 539 /* ForCommand */;\n        }\n        compile(binding) {\n            return new IteratorBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    ForBindingCommand = __decorate([\n        bindingCommand('for')\n    ], ForBindingCommand);\n    return ForBindingCommand;\n})();\nexport { ForBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","// TODO: see if we can de-duplicate these 3 decorators and their functions without killing performance or readability\nexport function subscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._subscriberFlags = 0 /* None */;\n        proto.addSubscriber = addSubscriber;\n        proto.removeSubscriber = removeSubscriber;\n        proto.hasSubscriber = hasSubscriber;\n        proto.hasSubscribers = hasSubscribers;\n        proto.callSubscribers = callSubscribers;\n        if (proto.subscribe === void 0)\n            proto.subscribe = addSubscriber;\n        if (proto.unsubscribe === void 0)\n            proto.unsubscribe = removeSubscriber;\n    };\n}\nexport function proxySubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._proxySubscriberFlags = 0 /* None */;\n        proto.addProxySubscriber = addProxySubscriber;\n        proto.removeProxySubscriber = removeProxySubscriber;\n        proto.hasProxySubscriber = hasProxySubscriber;\n        proto.hasProxySubscribers = hasProxySubscribers;\n        proto.callProxySubscribers = callProxySubscribers;\n        if (proto.subscribeToProxy === void 0)\n            proto.subscribeToProxy = addProxySubscriber;\n        if (proto.unsubscribeFromProxy === void 0)\n            proto.unsubscribeFromProxy = removeProxySubscriber;\n    };\n}\nexport function collectionSubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._collectionSubscriberFlags = 0 /* None */;\n        proto.addCollectionSubscriber = addCollectionSubscriber;\n        proto.removeCollectionSubscriber = removeCollectionSubscriber;\n        proto.hasCollectionSubscriber = hasCollectionSubscriber;\n        proto.hasCollectionSubscribers = hasCollectionSubscribers;\n        proto.callCollectionSubscribers = callCollectionSubscribers;\n        if (proto.subscribeToCollection === void 0)\n            proto.subscribeToCollection = addCollectionSubscriber;\n        if (proto.unsubscribeFromCollection === void 0)\n            proto.unsubscribeFromCollection = removeCollectionSubscriber;\n    };\n}\nfunction addSubscriber(subscriber) {\n    if (this.hasSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._subscriber0 = subscriber;\n        this._subscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._subscriber1 = subscriber;\n        this._subscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._subscriber2 = subscriber;\n        this._subscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._subscribersRest = [subscriber];\n        this._subscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._subscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addProxySubscriber(subscriber) {\n    if (this.hasProxySubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._proxySubscriber0 = subscriber;\n        this._proxySubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._proxySubscriber1 = subscriber;\n        this._proxySubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._proxySubscriber2 = subscriber;\n        this._proxySubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._proxySubscribersRest = [subscriber];\n        this._proxySubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._proxySubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addCollectionSubscriber(subscriber) {\n    if (this.hasCollectionSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._collectionSubscriber0 = subscriber;\n        this._collectionSubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._collectionSubscriber1 = subscriber;\n        this._collectionSubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._collectionSubscriber2 = subscriber;\n        this._collectionSubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._collectionSubscribersRest = [subscriber];\n        this._collectionSubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._collectionSubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction removeSubscriber(subscriber) {\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        this._subscriber0 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        this._subscriber1 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        this._subscriber2 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._subscriberFlags = (this._subscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        this._proxySubscriber0 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        this._proxySubscriber1 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        this._proxySubscriber2 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._proxySubscriberFlags = (this._proxySubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        this._collectionSubscriber0 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        this._collectionSubscriber1 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        this._collectionSubscriber2 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasSubscribers() {\n    return this._subscriberFlags !== 0 /* None */;\n}\nfunction hasProxySubscribers() {\n    return this._proxySubscriberFlags !== 0 /* None */;\n}\nfunction hasCollectionSubscribers() {\n    return this._collectionSubscriberFlags !== 0 /* None */;\n}\nfunction hasSubscriber(subscriber) {\n    // Flags here is just a perf tweak\n    // Compared to not using flags, it's a moderate speed-up when this collection does not have the subscriber;\n    // and minor slow-down when it does, and the former is more common than the latter.\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction callSubscribers(newValue, previousValue, flags) {\n    /**\n     * Note: change handlers may have the side-effect of adding/removing subscribers to this collection during this\n     * callSubscribers invocation, so we're caching them all before invoking any.\n     * Subscribers added during this invocation are not invoked (and they shouldn't be).\n     * Subscribers removed during this invocation will still be invoked (and they also shouldn't be,\n     * however this is accounted for via $isBound and similar flags on the subscriber objects)\n     */\n    const subscriber0 = this._subscriber0;\n    const subscriber1 = this._subscriber1;\n    const subscriber2 = this._subscriber2;\n    let subscribers = this._subscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        callSubscriber(subscriber0, newValue, previousValue, flags, subscriber0.id === void 0 ? 0 : this[subscriber0.id]);\n    }\n    if (subscriber1 !== void 0) {\n        callSubscriber(subscriber1, newValue, previousValue, flags, subscriber1.id === void 0 ? 0 : this[subscriber1.id]);\n    }\n    if (subscriber2 !== void 0) {\n        callSubscriber(subscriber2, newValue, previousValue, flags, subscriber2.id === void 0 ? 0 : this[subscriber2.id]);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                callSubscriber(subscriber, newValue, previousValue, flags, subscriber.id === void 0 ? 0 : this[subscriber.id]);\n            }\n        }\n    }\n}\nfunction callSubscriber(subscriber, newValue, previousValue, flags, ownFlags) {\n    subscriber.handleChange(newValue, previousValue, ((flags | 24 /* update */) ^ 24 /* update */) | ownFlags);\n}\nfunction callProxySubscribers(key, newValue, previousValue, flags) {\n    const subscriber0 = this._proxySubscriber0;\n    const subscriber1 = this._proxySubscriber1;\n    const subscriber2 = this._proxySubscriber2;\n    let subscribers = this._proxySubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleProxyChange(key, newValue, previousValue, flags);\n            }\n        }\n    }\n}\nfunction callCollectionSubscribers(indexMap, flags) {\n    const subscriber0 = this._collectionSubscriber0;\n    const subscriber1 = this._collectionSubscriber1;\n    const subscriber2 = this._collectionSubscriber2;\n    let subscribers = this._collectionSubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleCollectionChange(indexMap, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleCollectionChange(indexMap, flags);\n            }\n        }\n    }\n}\n//# sourceMappingURL=subscriber-collection.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { PLATFORM } from '@aurelia/kernel';\nimport { proxySubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst lookup = new WeakMap();\nlet ProxySubscriberCollection = /** @class */ (() => {\n    let ProxySubscriberCollection = class ProxySubscriberCollection {\n        constructor(proxy, raw, key) {\n            this.proxy = proxy;\n            this.raw = raw;\n            this.key = key;\n            this.inBatch = false;\n            this.subscribe = this.addSubscriber;\n            this.unsubscribe = this.removeSubscriber;\n            if (raw[key] instanceof Object) { // Ensure we observe array indices and newly created object properties\n                raw[key] = ProxyObserver.getOrCreate(raw[key]).proxy;\n            }\n        }\n        setValue(value, flags) {\n            const oldValue = this.raw[this.key];\n            if (oldValue !== value) {\n                this.raw[this.key] = value;\n                this.callSubscribers(value, oldValue, flags | 2 /* proxyStrategy */ | 8 /* updateTargetInstance */);\n            }\n        }\n        getValue() {\n            return this.raw[this.key];\n        }\n        flushBatch(flags) {\n            return;\n        }\n    };\n    ProxySubscriberCollection = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Object, Object])\n    ], ProxySubscriberCollection);\n    return ProxySubscriberCollection;\n})();\nexport { ProxySubscriberCollection };\nlet ProxyObserver = /** @class */ (() => {\n    var ProxyObserver_1;\n    let ProxyObserver = ProxyObserver_1 = class ProxyObserver {\n        constructor(obj) {\n            this.raw = obj;\n            this.proxy = new Proxy(obj, this);\n            lookup.set(obj, this.proxy);\n            this.subscribers = {};\n        }\n        static getProxyOrSelf(obj) {\n            if (obj.$raw === void 0) {\n                const proxy = lookup.get(obj);\n                if (proxy === void 0) {\n                    return obj;\n                }\n                return proxy;\n            }\n            return obj;\n        }\n        static getRawIfProxy(obj) {\n            const raw = obj.$raw;\n            if (raw === void 0) {\n                return obj;\n            }\n            return raw;\n        }\n        static getOrCreate(obj, key) {\n            let proxyObserver;\n            if (obj.$raw === void 0) {\n                const proxy = lookup.get(obj);\n                if (proxy === void 0) {\n                    proxyObserver = new ProxyObserver_1(obj);\n                }\n                else {\n                    proxyObserver = proxy.$observer;\n                }\n            }\n            else {\n                proxyObserver = obj.$observer;\n            }\n            if (key === void 0) {\n                return proxyObserver;\n            }\n            let subscribers = proxyObserver.subscribers[key];\n            if (subscribers === void 0) {\n                const raw = this.getRawIfProxy(obj);\n                const proxy = proxyObserver.proxy;\n                subscribers = proxyObserver.subscribers[key] = new ProxySubscriberCollection(proxy, raw, key);\n            }\n            return subscribers;\n        }\n        static isProxy(obj) {\n            return obj.$raw !== void 0;\n        }\n        get(target, p, receiver) {\n            if (p === '$observer') {\n                return this;\n            }\n            if (p === '$raw') {\n                return target;\n            }\n            return target[p];\n        }\n        set(target, p, value, receiver) {\n            const oldValue = target[p];\n            if (oldValue !== value) {\n                target[p] = value;\n                this.callPropertySubscribers(value, oldValue, p);\n                this.callProxySubscribers(p, value, oldValue, 2 /* proxyStrategy */ | 8 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        deleteProperty(target, p) {\n            const oldValue = target[p];\n            if (Reflect.deleteProperty(target, p)) {\n                if (oldValue !== void 0) {\n                    this.callPropertySubscribers(undefined, oldValue, p);\n                    this.callProxySubscribers(p, undefined, oldValue, 2 /* proxyStrategy */ | 8 /* updateTargetInstance */);\n                }\n                return true;\n            }\n            return false;\n        }\n        defineProperty(target, p, attributes) {\n            const oldValue = target[p];\n            if (Reflect.defineProperty(target, p, attributes)) {\n                if (attributes.value !== oldValue) {\n                    this.callPropertySubscribers(attributes.value, oldValue, p);\n                    this.callProxySubscribers(p, attributes.value, oldValue, 2 /* proxyStrategy */ | 8 /* updateTargetInstance */);\n                }\n                return true;\n            }\n            return false;\n        }\n        apply(target, thisArg, argArray = PLATFORM.emptyArray) {\n            // eslint-disable-next-line @typescript-eslint/ban-types\n            return Reflect.apply(target, target, argArray); // Reflect API dictates this\n        }\n        subscribe(subscriber, key) {\n            if (key === void 0) {\n                this.addProxySubscriber(subscriber);\n            }\n            else {\n                let subscribers = this.subscribers[key];\n                if (subscribers === void 0) {\n                    subscribers = this.subscribers[key] = new ProxySubscriberCollection(this.proxy, this.raw, key);\n                }\n                subscribers.addSubscriber(subscriber);\n            }\n        }\n        unsubscribe(subscriber, key) {\n            if (key === void 0) {\n                this.removeProxySubscriber(subscriber);\n            }\n            else {\n                const subscribers = this.subscribers[key];\n                if (subscribers !== undefined) {\n                    subscribers.removeSubscriber(subscriber);\n                }\n            }\n        }\n        callPropertySubscribers(newValue, oldValue, key) {\n            const subscribers = this.subscribers[key];\n            if (subscribers !== void 0) {\n                subscribers.callSubscribers(newValue, oldValue, 2 /* proxyStrategy */ | 8 /* updateTargetInstance */);\n            }\n        }\n    };\n    ProxyObserver = ProxyObserver_1 = __decorate([\n        proxySubscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object])\n    ], ProxyObserver);\n    return ProxyObserver;\n})();\nexport { ProxyObserver };\n//# sourceMappingURL=proxy-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration, } from '@aurelia/kernel';\nexport var ViewModelKind;\n(function (ViewModelKind) {\n    ViewModelKind[ViewModelKind[\"customElement\"] = 0] = \"customElement\";\n    ViewModelKind[ViewModelKind[\"customAttribute\"] = 1] = \"customAttribute\";\n    ViewModelKind[ViewModelKind[\"synthetic\"] = 2] = \"synthetic\";\n})(ViewModelKind || (ViewModelKind = {}));\nexport var State;\n(function (State) {\n    State[State[\"none\"] = 0] = \"none\";\n    State[State[\"activating\"] = 1] = \"activating\";\n    State[State[\"beforeBindCalled\"] = 2] = \"beforeBindCalled\";\n    State[State[\"activateChildrenCalled\"] = 4] = \"activateChildrenCalled\";\n    State[State[\"activated\"] = 14] = \"activated\";\n    State[State[\"deactivating\"] = 16] = \"deactivating\";\n    State[State[\"beforeDetachCalled\"] = 32] = \"beforeDetachCalled\";\n    State[State[\"deactivateChildrenCalled\"] = 64] = \"deactivateChildrenCalled\";\n    State[State[\"deactivated\"] = 224] = \"deactivated\";\n    State[State[\"released\"] = 256] = \"released\";\n    State[State[\"disposed\"] = 512] = \"disposed\";\n})(State || (State = {}));\nexport function stringifyState(state) {\n    const names = [];\n    if ((state & 1 /* activating */) === 1 /* activating */) {\n        names.push('activating');\n    }\n    if ((state & 14 /* activated */) === 14 /* activated */) {\n        names.push('activated');\n    }\n    else {\n        if ((state & 2 /* beforeBindCalled */) === 2 /* beforeBindCalled */) {\n            names.push('beforeBindCalled');\n        }\n        if ((state & 4 /* activateChildrenCalled */) === 4 /* activateChildrenCalled */) {\n            names.push('activateChildrenCalled');\n        }\n    }\n    if ((state & 16 /* deactivating */) === 16 /* deactivating */) {\n        names.push('deactivating');\n    }\n    if ((state & 224 /* deactivated */) === 224 /* deactivated */) {\n        names.push('deactivated');\n    }\n    else {\n        if ((state & 32 /* beforeDetachCalled */) === 32 /* beforeDetachCalled */) {\n            names.push('beforeDetachCalled');\n        }\n        if ((state & 64 /* deactivateChildrenCalled */) === 64 /* deactivateChildrenCalled */) {\n            names.push('deactivateChildrenCalled');\n        }\n    }\n    if ((state & 256 /* released */) === 256 /* released */) {\n        names.push('released');\n    }\n    if ((state & 512 /* disposed */) === 512 /* disposed */) {\n        names.push('disposed');\n    }\n    return names.length === 0 ? 'none' : names.join('|');\n}\nexport const IController = DI.createInterface('IController').noDefault();\n/**\n * Describing characteristics of a mounting operation a controller will perform\n */\nexport var MountStrategy;\n(function (MountStrategy) {\n    MountStrategy[MountStrategy[\"insertBefore\"] = 1] = \"insertBefore\";\n    MountStrategy[MountStrategy[\"append\"] = 2] = \"append\";\n})(MountStrategy || (MountStrategy = {}));\nexport const IViewFactory = DI.createInterface('IViewFactory').noDefault();\nexport const ILifecycle = DI.createInterface('ILifecycle').withDefault(x => x.singleton(Lifecycle));\nlet BatchQueue = /** @class */ (() => {\n    let BatchQueue = class BatchQueue {\n        constructor(lifecycle) {\n            this.lifecycle = lifecycle;\n            this.queue = [];\n            this.depth = 0;\n        }\n        begin() {\n            ++this.depth;\n        }\n        end(flags) {\n            if (flags === void 0) {\n                flags = 0 /* none */;\n            }\n            if (--this.depth === 0) {\n                this.process(flags);\n            }\n        }\n        inline(fn, flags) {\n            this.begin();\n            fn();\n            this.end(flags);\n        }\n        add(requestor) {\n            this.queue.push(requestor);\n        }\n        remove(requestor) {\n            const index = this.queue.indexOf(requestor);\n            if (index > -1) {\n                this.queue.splice(index, 1);\n            }\n        }\n        process(flags) {\n            while (this.queue.length > 0) {\n                const batch = this.queue.slice();\n                this.queue = [];\n                const { length } = batch;\n                for (let i = 0; i < length; ++i) {\n                    batch[i].flushBatch(flags);\n                }\n            }\n        }\n    };\n    BatchQueue = __decorate([\n        __param(0, ILifecycle),\n        __metadata(\"design:paramtypes\", [Object])\n    ], BatchQueue);\n    return BatchQueue;\n})();\nexport { BatchQueue };\nexport class Lifecycle {\n    constructor() {\n        this.batch = new BatchQueue(this);\n    }\n    static register(container) {\n        return Registration.singleton(ILifecycle, this).register(container);\n    }\n}\n//# sourceMappingURL=lifecycle.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { subscriberCollection } from './subscriber-collection';\n/**\n * Observer for the mutation of object property value employing getter-setter strategy.\n * This is used for observing object properties that has no decorator.\n */\nlet SetterObserver = /** @class */ (() => {\n    let SetterObserver = class SetterObserver {\n        constructor(lifecycle, flags, obj, propertyKey) {\n            this.lifecycle = lifecycle;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.currentValue = void 0;\n            this.oldValue = void 0;\n            this.inBatch = false;\n            this.observing = false;\n            // todo(bigopon): tweak the flag based on typeof obj (array/set/map/iterator/proxy etc...)\n            this.type = 4 /* Obj */;\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n        }\n        getValue() {\n            return this.currentValue;\n        }\n        setValue(newValue, flags) {\n            if (this.observing) {\n                const currentValue = this.currentValue;\n                this.currentValue = newValue;\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n            }\n            else {\n                // If subscribe() has been called, the target property descriptor is replaced by these getter/setter methods,\n                // so calling obj[propertyKey] will actually return this.currentValue.\n                // However, if subscribe() was not yet called (indicated by !this.observing), the target descriptor\n                // is unmodified and we need to explicitly set the property value.\n                // This will happen in one-time, to-view and two-way bindings during $bind, meaning that the $bind will not actually update the target value.\n                // This wasn't visible in vCurrent due to connect-queue always doing a delayed update, so in many cases it didn't matter whether $bind updated the target or not.\n                this.obj[this.propertyKey] = newValue;\n            }\n        }\n        flushBatch(flags) {\n            this.inBatch = false;\n            const currentValue = this.currentValue;\n            const oldValue = this.oldValue;\n            this.oldValue = currentValue;\n            this.callSubscribers(currentValue, oldValue, this.persistentFlags | flags);\n        }\n        subscribe(subscriber) {\n            if (this.observing === false) {\n                this.observing = true;\n                this.currentValue = this.obj[this.propertyKey];\n                if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                    enumerable: true,\n                    configurable: true,\n                    get: () => {\n                        return this.getValue();\n                    },\n                    set: value => {\n                        this.setValue(value, 0 /* none */);\n                    },\n                })) {\n                    Reporter.write(1, this.propertyKey, this.obj);\n                }\n            }\n            this.addSubscriber(subscriber);\n        }\n    };\n    SetterObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Number, Object, String])\n    ], SetterObserver);\n    return SetterObserver;\n})();\nexport { SetterObserver };\n//# sourceMappingURL=setter-observer.js.map","import { Reporter } from '@aurelia/kernel';\nimport { ProxyObserver } from './proxy-observer';\nimport { SetterObserver } from './setter-observer';\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n    RuntimeError[RuntimeError[\"NilOverrideContext\"] = 252] = \"NilOverrideContext\";\n    RuntimeError[RuntimeError[\"NilParentScope\"] = 253] = \"NilParentScope\";\n})(RuntimeError || (RuntimeError = {}));\nconst marker = Object.freeze({});\n/** @internal */\nexport class InternalObserversLookup {\n    getOrCreate(lifecycle, flags, obj, key) {\n        if (this[key] === void 0) {\n            this[key] = new SetterObserver(lifecycle, flags, obj, key);\n        }\n        return this[key];\n    }\n}\nexport class BindingContext {\n    constructor(keyOrObj, value) {\n        this.$synthetic = true;\n        if (keyOrObj !== void 0) {\n            if (value !== void 0) {\n                // if value is defined then it's just a property and a value to initialize with\n                this[keyOrObj] = value;\n            }\n            else {\n                // can either be some random object or another bindingContext to clone from\n                for (const prop in keyOrObj) {\n                    if (Object.prototype.hasOwnProperty.call(keyOrObj, prop)) {\n                        this[prop] = keyOrObj[prop];\n                    }\n                }\n            }\n        }\n    }\n    static create(flags, keyOrObj, value) {\n        const bc = new BindingContext(keyOrObj, value);\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(bc).proxy;\n        }\n        return bc;\n    }\n    static get(scope, name, ancestor, flags, hostScope) {\n        if (scope == null && hostScope == null) {\n            throw Reporter.error(250 /* NilScope */);\n        }\n        /* eslint-disable jsdoc/check-indentation */\n        /**\n         * This fallback is needed to support the following case:\n         * <div au-slot=\"s1\">\n         *  <let outer-host.bind=\"$host\"></let>\n         *  ${outerHost.prop}\n         * </div>\n         * To enable the `let` binding for 'hostScope', the property is added to `hostScope.overrideContext`. That enables us to use such let binding also inside a repeater.\n         * However, as the expression `${outerHost.prop}` does not start with `$host`, it is considered that to evaluate this expression, we don't need the access to hostScope.\n         * This artifact raises the need for this fallback.\n         */\n        /* eslint-enable jsdoc/check-indentation */\n        let context = chooseContext(scope, name, ancestor);\n        if (context !== null) {\n            return context;\n        }\n        if (hostScope !== scope && hostScope != null) {\n            context = chooseContext(hostScope, name, ancestor);\n            if (context !== null) {\n                return context;\n            }\n        }\n        // still nothing found. return the root binding context (or null\n        // if this is a parent scope traversal, to ensure we fall back to the\n        // correct level)\n        if (flags & 256 /* isTraversingParentScope */) {\n            return marker;\n        }\n        return scope.bindingContext || scope.overrideContext;\n    }\n    getObservers(flags) {\n        if (this.$observers == null) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\nfunction chooseContext(scope, name, ancestor) {\n    var _a, _b;\n    let overrideContext = scope.overrideContext;\n    let currentScope = scope;\n    if (ancestor > 0) {\n        // jump up the required number of ancestor contexts (eg $parent.$parent requires two jumps)\n        while (ancestor > 0) {\n            ancestor--;\n            currentScope = currentScope.parentScope;\n            if ((currentScope === null || currentScope === void 0 ? void 0 : currentScope.overrideContext) == null) {\n                return void 0;\n            }\n        }\n        overrideContext = currentScope.overrideContext;\n        return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n    }\n    // traverse the context and it's ancestors, searching for a context that has the name.\n    while (overrideContext && !(name in overrideContext) && !(overrideContext.bindingContext && name in overrideContext.bindingContext)) {\n        currentScope = (_a = currentScope.parentScope) !== null && _a !== void 0 ? _a : null;\n        overrideContext = (_b = currentScope === null || currentScope === void 0 ? void 0 : currentScope.overrideContext) !== null && _b !== void 0 ? _b : null;\n    }\n    if (overrideContext) {\n        // we located a context with the property.  return it.\n        return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n    }\n    return null;\n}\nexport class Scope {\n    constructor(parentScope, bindingContext, overrideContext) {\n        this.parentScope = parentScope;\n        this.bindingContext = bindingContext;\n        this.overrideContext = overrideContext;\n    }\n    static create(flags, bc, oc) {\n        return new Scope(null, bc, oc == null ? OverrideContext.create(flags, bc) : oc);\n    }\n    static fromOverride(flags, oc) {\n        if (oc == null) {\n            throw Reporter.error(252 /* NilOverrideContext */);\n        }\n        return new Scope(null, oc.bindingContext, oc);\n    }\n    static fromParent(flags, ps, bc) {\n        if (ps == null) {\n            throw Reporter.error(253 /* NilParentScope */);\n        }\n        return new Scope(ps, bc, OverrideContext.create(flags, bc));\n    }\n}\nexport class OverrideContext {\n    constructor(bindingContext) {\n        this.$synthetic = true;\n        this.bindingContext = bindingContext;\n    }\n    static create(flags, bc) {\n        return new OverrideContext(bc);\n    }\n    getObservers() {\n        if (this.$observers === void 0) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\n//# sourceMappingURL=binding-context.js.map","import { DI } from '@aurelia/kernel';\nexport const ISignaler = DI.createInterface('ISignaler').withDefault(x => x.singleton(Signaler));\n/** @internal */\nexport class Signaler {\n    constructor() {\n        this.signals = Object.create(null);\n    }\n    dispatchSignal(name, flags) {\n        const listeners = this.signals[name];\n        if (listeners === undefined) {\n            return;\n        }\n        for (const listener of listeners.keys()) {\n            listener.handleChange(undefined, undefined, flags | 8 /* updateTargetInstance */);\n        }\n    }\n    addSignalListener(name, listener) {\n        const signals = this.signals;\n        const listeners = signals[name];\n        if (listeners === undefined) {\n            signals[name] = new Set([listener]);\n        }\n        else {\n            listeners.add(listener);\n        }\n    }\n    removeSignalListener(name, listener) {\n        const listeners = this.signals[name];\n        if (listeners) {\n            listeners.delete(listener);\n        }\n    }\n}\n//# sourceMappingURL=signaler.js.map","// TODO: add connect-queue (or something similar) back in when everything else is working, to improve startup time\nconst slice = Array.prototype.slice;\nconst slotNames = [];\nconst versionSlotNames = [];\nlet lastSlot = -1;\nfunction ensureEnoughSlotNames(currentSlot) {\n    if (currentSlot === lastSlot) {\n        lastSlot += 5;\n        const ii = slotNames.length = versionSlotNames.length = lastSlot + 1;\n        for (let i = currentSlot + 1; i < ii; ++i) {\n            slotNames[i] = `_observer${i}`;\n            versionSlotNames[i] = `_observerVersion${i}`;\n        }\n    }\n}\nensureEnoughSlotNames(-1);\n/** @internal */\nexport function addObserver(observer) {\n    // find the observer.\n    const observerSlots = this.observerSlots == null ? 0 : this.observerSlots;\n    let i = observerSlots;\n    while (i-- && this[slotNames[i]] !== observer)\n        ;\n    // if we are not already observing, put the observer in an open slot and subscribe.\n    if (i === -1) {\n        i = 0;\n        while (this[slotNames[i]]) {\n            i++;\n        }\n        this[slotNames[i]] = observer;\n        observer.subscribe(this);\n        observer[this.id] |= 8 /* updateTargetInstance */;\n        // increment the slot count.\n        if (i === observerSlots) {\n            this.observerSlots = i + 1;\n        }\n    }\n    // set the \"version\" when the observer was used.\n    if (this.version == null) {\n        this.version = 0;\n    }\n    this[versionSlotNames[i]] = this.version;\n    ensureEnoughSlotNames(i);\n}\n/** @internal */\nexport function observeProperty(flags, obj, propertyName) {\n    const observer = this.observerLocator.getObserver(flags, obj, propertyName);\n    /* Note: we need to cast here because we can indeed get an accessor instead of an observer,\n     *  in which case the call to observer.subscribe will throw. It's not very clean and we can solve this in 2 ways:\n     *  1. Fail earlier: only let the locator resolve observers from .getObserver, and throw if no branches are left (e.g. it would otherwise return an accessor)\n     *  2. Fail silently (without throwing): give all accessors a no-op subscribe method\n     *\n     * We'll probably want to implement some global configuration (like a \"strict\" toggle) so users can pick between enforced correctness vs. ease-of-use\n     */\n    this.addObserver(observer);\n}\n/** @internal */\nexport function unobserve(all) {\n    const slots = this.observerSlots;\n    let slotName;\n    let observer;\n    if (all === true) {\n        for (let i = 0; i < slots; ++i) {\n            slotName = slotNames[i];\n            observer = this[slotName];\n            if (observer != null) {\n                this[slotName] = void 0;\n                observer.unsubscribe(this);\n                observer[this.id] &= ~8 /* updateTargetInstance */;\n            }\n        }\n    }\n    else {\n        const version = this.version;\n        for (let i = 0; i < slots; ++i) {\n            if (this[versionSlotNames[i]] !== version) {\n                slotName = slotNames[i];\n                observer = this[slotName];\n                if (observer != null) {\n                    this[slotName] = void 0;\n                    observer.unsubscribe(this);\n                    observer[this.id] &= ~8 /* updateTargetInstance */;\n                }\n            }\n        }\n    }\n}\nfunction connectableDecorator(target) {\n    const proto = target.prototype;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'observeProperty'))\n        proto.observeProperty = observeProperty;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'unobserve'))\n        proto.unobserve = unobserve;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'addObserver'))\n        proto.addObserver = addObserver;\n    return target;\n}\nexport function connectable(target) {\n    return target == null ? connectableDecorator : connectableDecorator(target);\n}\nlet value = 0;\nconnectable.assignIdTo = (instance) => {\n    instance.id = ++value;\n};\n// @connectable\nexport class BindingMediator {\n    constructor(key, binding, observerLocator, locator) {\n        this.key = key;\n        this.binding = binding;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.observeProperty = observeProperty;\n        this.unobserve = unobserve;\n        this.addObserver = addObserver;\n        connectable.assignIdTo(this);\n    }\n    $bind(flags, scope, hostScope, projection) {\n        throw new Error('Method not implemented.');\n    }\n    $unbind(flags) {\n        throw new Error('Method not implemented.');\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.binding[this.key](newValue, previousValue, flags);\n    }\n}\n//# sourceMappingURL=connectable.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Registration, Metadata, Protocol, mergeArrays, firstDefined, DI, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nimport { connectable } from '../binding/connectable';\nexport var BindingBehaviorStrategy;\n(function (BindingBehaviorStrategy) {\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"singleton\"] = 1] = \"singleton\";\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"interceptor\"] = 2] = \"interceptor\";\n})(BindingBehaviorStrategy || (BindingBehaviorStrategy = {}));\nexport function bindingBehavior(nameOrDef) {\n    return function (target) {\n        return BindingBehavior.define(nameOrDef, target);\n    };\n}\nexport class BindingBehaviorDefinition {\n    constructor(Type, name, aliases, key, strategy) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.strategy = strategy;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        const inheritsFromInterceptor = Object.getPrototypeOf(Type) === BindingInterceptor;\n        return new BindingBehaviorDefinition(Type, firstDefined(BindingBehavior.getAnnotation(Type, 'name'), name), mergeArrays(BindingBehavior.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingBehavior.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', def, Type, () => inheritsFromInterceptor ? 2 /* interceptor */ : 1 /* singleton */));\n    }\n    register(container) {\n        const { Type, key, aliases, strategy } = this;\n        switch (strategy) {\n            case 1 /* singleton */:\n                Registration.singleton(key, Type).register(container);\n                break;\n            case 2 /* interceptor */:\n                Registration.instance(key, new BindingBehaviorFactory(container, Type)).register(container);\n                break;\n        }\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, BindingBehavior, key, container);\n    }\n}\nexport class BindingBehaviorFactory {\n    constructor(container, Type) {\n        this.container = container;\n        this.Type = Type;\n        this.deps = DI.getDependencies(Type);\n    }\n    construct(binding, expr) {\n        const container = this.container;\n        const deps = this.deps;\n        switch (deps.length) {\n            case 0:\n            case 1:\n            case 2:\n                // TODO(fkleuver): fix this cast\n                return new this.Type(binding, expr);\n            case 3:\n                return new this.Type(container.get(deps[0]), binding, expr);\n            case 4:\n                return new this.Type(container.get(deps[0]), container.get(deps[1]), binding, expr);\n            default:\n                return new this.Type(...deps.map(d => container.get(d)), binding, expr);\n        }\n    }\n}\nlet BindingInterceptor = /** @class */ (() => {\n    let BindingInterceptor = class BindingInterceptor {\n        constructor(binding, expr) {\n            this.binding = binding;\n            this.expr = expr;\n            this.interceptor = this;\n            let interceptor;\n            while (binding.interceptor !== this) {\n                interceptor = binding.interceptor;\n                binding.interceptor = this;\n                binding = interceptor;\n            }\n        }\n        get id() {\n            return this.binding.id;\n        }\n        get observerLocator() {\n            return this.binding.observerLocator;\n        }\n        get locator() {\n            return this.binding.locator;\n        }\n        get $scope() {\n            return this.binding.$scope;\n        }\n        get isBound() {\n            return this.binding.isBound;\n        }\n        updateTarget(value, flags) {\n            this.binding.updateTarget(value, flags);\n        }\n        updateSource(value, flags) {\n            this.binding.updateSource(value, flags);\n        }\n        callSource(args) {\n            return this.binding.callSource(args);\n        }\n        handleChange(newValue, previousValue, flags) {\n            this.binding.handleChange(newValue, previousValue, flags);\n        }\n        $bind(flags, scope, hostScope) {\n            this.binding.$bind(flags, scope, hostScope);\n        }\n        $unbind(flags) {\n            this.binding.$unbind(flags);\n        }\n    };\n    BindingInterceptor = __decorate([\n        connectable,\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], BindingInterceptor);\n    return BindingInterceptor;\n})();\nexport { BindingInterceptor };\nexport const BindingBehavior = {\n    name: Protocol.resource.keyFor('binding-behavior'),\n    keyFrom(name) {\n        return `${BindingBehavior.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingBehavior.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingBehaviorDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingBehavior.name, definition, definition.Type);\n        Metadata.define(BindingBehavior.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingBehavior.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingBehavior.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=binding-behavior.js.map","import { Registration, Metadata, Protocol, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nexport function valueConverter(nameOrDef) {\n    return function (target) {\n        return ValueConverter.define(nameOrDef, target);\n    };\n}\nexport class ValueConverterDefinition {\n    constructor(Type, name, aliases, key) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new ValueConverterDefinition(Type, firstDefined(ValueConverter.getAnnotation(Type, 'name'), name), mergeArrays(ValueConverter.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), ValueConverter.keyFrom(name));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, ValueConverter, key, container);\n    }\n}\nexport const ValueConverter = {\n    name: Protocol.resource.keyFor('value-converter'),\n    keyFrom(name) {\n        return `${ValueConverter.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(ValueConverter.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = ValueConverterDefinition.create(nameOrDef, Type);\n        Metadata.define(ValueConverter.name, definition, definition.Type);\n        Metadata.define(ValueConverter.name, definition, definition);\n        Protocol.resource.appendTo(Type, ValueConverter.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(ValueConverter.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=value-converter.js.map","import { PLATFORM, Reporter, isNumberOrBigInt, isStringOrDate, } from '@aurelia/kernel';\nimport { BindingContext } from '../observation/binding-context';\nimport { ProxyObserver } from '../observation/proxy-observer';\nimport { ISignaler } from '../observation/signaler';\nimport { BindingBehavior, BindingBehaviorFactory, } from '../resources/binding-behavior';\nimport { ValueConverter, } from '../resources/value-converter';\nfunction chooseScope(accessHostScope, scope, hostScope) {\n    if (accessHostScope) {\n        if (hostScope === null || hostScope === void 0) {\n            throw new Error('Host scope is missing. Are you using `$host` outside the `au-slot`? Or missing the `au-slot` attribute?');\n        }\n        return hostScope;\n    }\n    return scope;\n}\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NoLocator\"] = 202] = \"NoLocator\";\n    RuntimeError[RuntimeError[\"NoBehaviorFound\"] = 203] = \"NoBehaviorFound\";\n    RuntimeError[RuntimeError[\"BehaviorAlreadyApplied\"] = 204] = \"BehaviorAlreadyApplied\";\n    RuntimeError[RuntimeError[\"NoConverterFound\"] = 205] = \"NoConverterFound\";\n    RuntimeError[RuntimeError[\"NoBinding\"] = 206] = \"NoBinding\";\n    RuntimeError[RuntimeError[\"NotAFunction\"] = 207] = \"NotAFunction\";\n    RuntimeError[RuntimeError[\"UnknownOperator\"] = 208] = \"UnknownOperator\";\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n})(RuntimeError || (RuntimeError = {}));\nexport class CustomExpression {\n    constructor(value) {\n        this.value = value;\n    }\n    evaluate(flags, scope, hostScope, locator) {\n        return this.value;\n    }\n}\nexport class BindingBehaviorExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.behaviorKey = BindingBehavior.keyFrom(name);\n    }\n    get $kind() { return 38962 /* BindingBehavior */; }\n    get hasBind() { return true; }\n    get hasUnbind() { return true; }\n    evaluate(flags, scope, hostScope, locator) {\n        return this.expression.evaluate(flags, scope, hostScope, locator);\n    }\n    assign(flags, scope, hostScope, locator, value) {\n        return this.expression.assign(flags, scope, hostScope, locator, value);\n    }\n    connect(flags, scope, hostScope, binding) {\n        this.expression.connect(flags, scope, hostScope, binding);\n    }\n    bind(flags, scope, hostScope, binding) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        if (this.expression.hasBind) {\n            this.expression.bind(flags, scope, hostScope, binding);\n        }\n        const behaviorKey = this.behaviorKey;\n        const behavior = locator.get(behaviorKey);\n        if (!behavior) {\n            throw Reporter.error(203 /* NoBehaviorFound */, this);\n        }\n        if (!(behavior instanceof BindingBehaviorFactory)) {\n            if (binding[behaviorKey] === void 0) {\n                binding[behaviorKey] = behavior;\n                behavior.bind.call(behavior, flags, scope, hostScope, binding, ...evalList(flags, scope, locator, this.args, hostScope));\n            }\n            else {\n                Reporter.write(204 /* BehaviorAlreadyApplied */, this);\n            }\n        }\n    }\n    unbind(flags, scope, hostScope, binding) {\n        const behaviorKey = this.behaviorKey;\n        if (binding[behaviorKey] !== void 0) {\n            if (typeof binding[behaviorKey].unbind === 'function') {\n                binding[behaviorKey].unbind(flags, scope, hostScope, binding);\n            }\n            binding[behaviorKey] = void 0;\n        }\n        if (this.expression.hasUnbind) {\n            this.expression.unbind(flags, scope, hostScope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitBindingBehavior(this);\n    }\n}\nexport class ValueConverterExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.converterKey = ValueConverter.keyFrom(name);\n    }\n    get $kind() { return 36913 /* ValueConverter */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return true; }\n    evaluate(flags, scope, hostScope, locator) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('toView' in converter) {\n            const args = this.args;\n            const len = args.length;\n            const result = Array(len + 1);\n            result[0] = this.expression.evaluate(flags, scope, hostScope, locator);\n            for (let i = 0; i < len; ++i) {\n                result[i + 1] = args[i].evaluate(flags, scope, hostScope, locator);\n            }\n            return converter.toView.call(converter, ...result);\n        }\n        return this.expression.evaluate(flags, scope, hostScope, locator);\n    }\n    assign(flags, scope, hostScope, locator, value) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('fromView' in converter) {\n            value = converter.fromView.call(converter, value, ...(evalList(flags, scope, locator, this.args, hostScope)));\n        }\n        return this.expression.assign(flags, scope, hostScope, locator, value);\n    }\n    connect(flags, scope, hostScope, binding) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        this.expression.connect(flags, scope, hostScope, binding);\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, hostScope, binding);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.addSignalListener(signals[i], binding);\n        }\n    }\n    unbind(flags, scope, hostScope, binding) {\n        const locator = binding.locator;\n        const converter = locator.get(this.converterKey);\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.removeSignalListener(signals[i], binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitValueConverter(this);\n    }\n}\nexport class AssignExpression {\n    constructor(target, value) {\n        this.target = target;\n        this.value = value;\n    }\n    get $kind() { return 8208 /* Assign */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        return this.target.assign(flags, scope, hostScope, locator, this.value.evaluate(flags, scope, hostScope, locator));\n    }\n    connect(flags, scope, hostScope, binding) {\n        return;\n    }\n    assign(flags, scope, hostScope, locator, value) {\n        this.value.assign(flags, scope, hostScope, locator, value);\n        return this.target.assign(flags, scope, hostScope, locator, value);\n    }\n    accept(visitor) {\n        return visitor.visitAssign(this);\n    }\n}\nexport class ConditionalExpression {\n    constructor(condition, yes, no) {\n        this.condition = condition;\n        this.yes = yes;\n        this.no = no;\n    }\n    get $kind() { return 63 /* Conditional */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        return (!!this.condition.evaluate(flags, scope, hostScope, locator))\n            ? this.yes.evaluate(flags, scope, hostScope, locator)\n            : this.no.evaluate(flags, scope, hostScope, locator);\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const condition = this.condition;\n        if (condition.evaluate(flags, scope, hostScope, binding.locator)) {\n            this.condition.connect(flags, scope, hostScope, binding);\n            this.yes.connect(flags, scope, hostScope, binding);\n        }\n        else {\n            this.condition.connect(flags, scope, hostScope, binding);\n            this.no.connect(flags, scope, hostScope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitConditional(this);\n    }\n}\nlet AccessThisExpression = /** @class */ (() => {\n    class AccessThisExpression {\n        constructor(ancestor = 0) {\n            this.ancestor = ancestor;\n        }\n        get $kind() { return 1793 /* AccessThis */; }\n        get hasBind() { return false; }\n        get hasUnbind() { return false; }\n        evaluate(flags, scope, hostScope, locator) {\n            var _a;\n            if (scope == null) {\n                throw Reporter.error(250 /* NilScope */, this);\n            }\n            if (this === AccessThisExpression.$host) {\n                scope = chooseScope(true, scope, hostScope);\n            }\n            let oc = scope.overrideContext;\n            let currentScope = scope;\n            let i = this.ancestor;\n            while (i-- && oc) {\n                currentScope = currentScope.parentScope;\n                oc = (_a = currentScope === null || currentScope === void 0 ? void 0 : currentScope.overrideContext) !== null && _a !== void 0 ? _a : null;\n            }\n            return i < 1 && oc ? oc.bindingContext : void 0;\n        }\n        assign(flags, scope, hostScope, locator, obj) {\n            return void 0;\n        }\n        connect(flags, scope, hostScope, binding) {\n            return;\n        }\n        accept(visitor) {\n            return visitor.visitAccessThis(this);\n        }\n    }\n    AccessThisExpression.$this = new AccessThisExpression(0);\n    // $host and $this are loosely the same thing. $host is used in the context of `au-slot` with the primary objective of determining the scope.\n    AccessThisExpression.$host = new AccessThisExpression(0);\n    AccessThisExpression.$parent = new AccessThisExpression(1);\n    return AccessThisExpression;\n})();\nexport { AccessThisExpression };\nexport class AccessScopeExpression {\n    constructor(name, ancestor = 0, accessHostScope = false) {\n        this.name = name;\n        this.ancestor = ancestor;\n        this.accessHostScope = accessHostScope;\n    }\n    get $kind() { return 10082 /* AccessScope */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const obj = BindingContext.get(chooseScope(this.accessHostScope, scope, hostScope), this.name, this.ancestor, flags, hostScope);\n        const evaluatedValue = obj[this.name];\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return evaluatedValue;\n        }\n        return evaluatedValue == null ? '' : evaluatedValue;\n    }\n    assign(flags, scope, hostScope, locator, value) {\n        const obj = BindingContext.get(chooseScope(this.accessHostScope, scope, hostScope), this.name, this.ancestor, flags, hostScope);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n                return value;\n            }\n            else {\n                return obj[this.name] = value;\n            }\n        }\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const context = BindingContext.get(chooseScope(this.accessHostScope, scope, hostScope), this.name, this.ancestor, flags, hostScope);\n        binding.observeProperty(flags, context, this.name);\n    }\n    accept(visitor) {\n        return visitor.visitAccessScope(this);\n    }\n}\nexport class AccessMemberExpression {\n    constructor(object, name) {\n        this.object = object;\n        this.name = name;\n    }\n    get $kind() { return 9323 /* AccessMember */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const instance = this.object.evaluate(flags, scope, hostScope, locator);\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return instance == null ? instance : instance[this.name];\n        }\n        return instance ? instance[this.name] : '';\n    }\n    assign(flags, scope, hostScope, locator, value) {\n        const obj = this.object.evaluate(flags, scope, hostScope, locator);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n            }\n            else {\n                obj[this.name] = value;\n            }\n        }\n        else {\n            this.object.assign(flags, scope, hostScope, locator, { [this.name]: value });\n        }\n        return value;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const obj = this.object.evaluate(flags, scope, hostScope, binding.locator);\n        if ((flags & 2048 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, hostScope, binding);\n        }\n        if (obj instanceof Object) {\n            binding.observeProperty(flags, obj, this.name);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessMember(this);\n    }\n}\nexport class AccessKeyedExpression {\n    constructor(object, key) {\n        this.object = object;\n        this.key = key;\n    }\n    get $kind() { return 9324 /* AccessKeyed */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const instance = this.object.evaluate(flags, scope, hostScope, locator);\n        if (instance instanceof Object) {\n            const key = this.key.evaluate(flags, scope, hostScope, locator);\n            return instance[key];\n        }\n        return void 0;\n    }\n    assign(flags, scope, hostScope, locator, value) {\n        const instance = this.object.evaluate(flags, scope, hostScope, locator);\n        const key = this.key.evaluate(flags, scope, hostScope, locator);\n        return instance[key] = value;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const obj = this.object.evaluate(flags, scope, hostScope, binding.locator);\n        if ((flags & 2048 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, hostScope, binding);\n        }\n        if (obj instanceof Object) {\n            this.key.connect(flags, scope, hostScope, binding);\n            const key = this.key.evaluate(flags, scope, hostScope, binding.locator);\n            // (note: string indexers behave the same way as numeric indexers as long as they represent numbers)\n            binding.observeProperty(flags, obj, key);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessKeyed(this);\n    }\n}\nexport class CallScopeExpression {\n    constructor(name, args, ancestor = 0, accessHostScope = false) {\n        this.name = name;\n        this.args = args;\n        this.ancestor = ancestor;\n        this.accessHostScope = accessHostScope;\n    }\n    get $kind() { return 1448 /* CallScope */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        scope = chooseScope(this.accessHostScope, scope, hostScope);\n        const args = evalList(flags, scope, locator, this.args, hostScope);\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, hostScope);\n        const func = getFunction(flags, context, this.name);\n        if (func) {\n            return func.apply(context, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, hostScope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallScope(this);\n    }\n}\nexport class CallMemberExpression {\n    constructor(object, name, args) {\n        this.object = object;\n        this.name = name;\n        this.args = args;\n    }\n    get $kind() { return 1161 /* CallMember */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const instance = this.object.evaluate(flags, scope, hostScope, locator);\n        const args = evalList(flags, scope, locator, this.args, hostScope);\n        const func = getFunction(flags, instance, this.name);\n        if (func) {\n            return func.apply(instance, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const obj = this.object.evaluate(flags, scope, hostScope, binding.locator);\n        if ((flags & 2048 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, hostScope, binding);\n        }\n        if (getFunction(flags & ~128 /* mustEvaluate */, obj, this.name)) {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, hostScope, binding);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallMember(this);\n    }\n}\nexport class CallFunctionExpression {\n    constructor(func, args) {\n        this.func = func;\n        this.args = args;\n    }\n    get $kind() { return 1162 /* CallFunction */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const func = this.func.evaluate(flags, scope, hostScope, locator);\n        if (typeof func === 'function') {\n            return func(...evalList(flags, scope, locator, this.args, hostScope));\n        }\n        if (!(flags & 128 /* mustEvaluate */) && (func == null)) {\n            return void 0;\n        }\n        throw Reporter.error(207 /* NotAFunction */, this);\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const func = this.func.evaluate(flags, scope, hostScope, binding.locator);\n        this.func.connect(flags, scope, hostScope, binding);\n        if (typeof func === 'function') {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, hostScope, binding);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallFunction(this);\n    }\n}\nexport class BinaryExpression {\n    constructor(operation, left, right) {\n        this.operation = operation;\n        this.left = left;\n        this.right = right;\n    }\n    get $kind() { return 46 /* Binary */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(f, s, hs, l) {\n        switch (this.operation) {\n            case '&&':\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n                return this.left.evaluate(f, s, hs, l) && this.right.evaluate(f, s, hs, l);\n            case '||':\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n                return this.left.evaluate(f, s, hs, l) || this.right.evaluate(f, s, hs, l);\n            case '==':\n                // eslint-disable-next-line eqeqeq\n                return this.left.evaluate(f, s, hs, l) == this.right.evaluate(f, s, hs, l);\n            case '===':\n                return this.left.evaluate(f, s, hs, l) === this.right.evaluate(f, s, hs, l);\n            case '!=':\n                // eslint-disable-next-line eqeqeq\n                return this.left.evaluate(f, s, hs, l) != this.right.evaluate(f, s, hs, l);\n            case '!==':\n                return this.left.evaluate(f, s, hs, l) !== this.right.evaluate(f, s, hs, l);\n            case 'instanceof': {\n                const right = this.right.evaluate(f, s, hs, l);\n                if (typeof right === 'function') {\n                    return this.left.evaluate(f, s, hs, l) instanceof right;\n                }\n                return false;\n            }\n            case 'in': {\n                const right = this.right.evaluate(f, s, hs, l);\n                if (right instanceof Object) {\n                    return this.left.evaluate(f, s, hs, l) in right;\n                }\n                return false;\n            }\n            // note: autoConvertAdd (and the null check) is removed because the default spec behavior is already largely similar\n            // and where it isn't, you kind of want it to behave like the spec anyway (e.g. return NaN when adding a number to undefined)\n            // this makes bugs in user code easier to track down for end users\n            // also, skipping these checks and leaving it to the runtime is a nice little perf boost and simplifies our code\n            case '+': {\n                const left = this.left.evaluate(f, s, hs, l);\n                const right = this.right.evaluate(f, s, hs, l);\n                if ((f & 4 /* isStrictBindingStrategy */) > 0) {\n                    return left + right;\n                }\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n                if (!left || !right) {\n                    if (isNumberOrBigInt(left) || isNumberOrBigInt(right)) {\n                        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n                        return (left || 0) + (right || 0);\n                    }\n                    if (isStringOrDate(left) || isStringOrDate(right)) {\n                        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n                        return (left || '') + (right || '');\n                    }\n                }\n                return left + right;\n            }\n            case '-':\n                return this.left.evaluate(f, s, hs, l) - this.right.evaluate(f, s, hs, l);\n            case '*':\n                return this.left.evaluate(f, s, hs, l) * this.right.evaluate(f, s, hs, l);\n            case '/':\n                return this.left.evaluate(f, s, hs, l) / this.right.evaluate(f, s, hs, l);\n            case '%':\n                return this.left.evaluate(f, s, hs, l) % this.right.evaluate(f, s, hs, l);\n            case '<':\n                return this.left.evaluate(f, s, hs, l) < this.right.evaluate(f, s, hs, l);\n            case '>':\n                return this.left.evaluate(f, s, hs, l) > this.right.evaluate(f, s, hs, l);\n            case '<=':\n                return this.left.evaluate(f, s, hs, l) <= this.right.evaluate(f, s, hs, l);\n            case '>=':\n                return this.left.evaluate(f, s, hs, l) >= this.right.evaluate(f, s, hs, l);\n            default:\n                throw Reporter.error(208 /* UnknownOperator */, this);\n        }\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        this.left.connect(flags, scope, hostScope, binding);\n        this.right.connect(flags, scope, hostScope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitBinary(this);\n    }\n}\nexport class UnaryExpression {\n    constructor(operation, expression) {\n        this.operation = operation;\n        this.expression = expression;\n    }\n    get $kind() { return 39 /* Unary */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(f, s, hs, l) {\n        switch (this.operation) {\n            case 'void':\n                return void this.expression.evaluate(f, s, hs, l);\n            case 'typeof':\n                return typeof this.expression.evaluate(f | 4 /* isStrictBindingStrategy */, s, hs, l);\n            case '!':\n                return !this.expression.evaluate(f, s, hs, l);\n            case '-':\n                return -this.expression.evaluate(f, s, hs, l);\n            case '+':\n                return +this.expression.evaluate(f, s, hs, l);\n            default:\n                throw Reporter.error(208 /* UnknownOperator */, this);\n        }\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        this.expression.connect(flags, scope, hostScope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitUnary(this);\n    }\n}\nlet PrimitiveLiteralExpression = /** @class */ (() => {\n    class PrimitiveLiteralExpression {\n        constructor(value) {\n            this.value = value;\n        }\n        get $kind() { return 17925 /* PrimitiveLiteral */; }\n        get hasBind() { return false; }\n        get hasUnbind() { return false; }\n        evaluate(flags, scope, hostScope, locator) {\n            return this.value;\n        }\n        assign(flags, scope, hostScope, locator, obj) {\n            return void 0;\n        }\n        connect(flags, scope, hostScope, binding) {\n            return;\n        }\n        accept(visitor) {\n            return visitor.visitPrimitiveLiteral(this);\n        }\n    }\n    PrimitiveLiteralExpression.$undefined = new PrimitiveLiteralExpression(void 0);\n    PrimitiveLiteralExpression.$null = new PrimitiveLiteralExpression(null);\n    PrimitiveLiteralExpression.$true = new PrimitiveLiteralExpression(true);\n    PrimitiveLiteralExpression.$false = new PrimitiveLiteralExpression(false);\n    PrimitiveLiteralExpression.$empty = new PrimitiveLiteralExpression('');\n    return PrimitiveLiteralExpression;\n})();\nexport { PrimitiveLiteralExpression };\nexport class HtmlLiteralExpression {\n    constructor(parts) {\n        this.parts = parts;\n    }\n    get $kind() { return 51 /* HtmlLiteral */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const elements = this.parts;\n        let result = '';\n        let value;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            value = elements[i].evaluate(flags, scope, hostScope, locator);\n            if (value == null) {\n                continue;\n            }\n            result += value;\n        }\n        return result;\n    }\n    assign(flags, scope, hostScope, locator, obj, rojection) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        for (let i = 0, ii = this.parts.length; i < ii; ++i) {\n            this.parts[i].connect(flags, scope, hostScope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitHtmlLiteral(this);\n    }\n}\nlet ArrayLiteralExpression = /** @class */ (() => {\n    class ArrayLiteralExpression {\n        constructor(elements) {\n            this.elements = elements;\n        }\n        get $kind() { return 17955 /* ArrayLiteral */; }\n        get hasBind() { return false; }\n        get hasUnbind() { return false; }\n        evaluate(flags, scope, hostScope, locator) {\n            const elements = this.elements;\n            const length = elements.length;\n            const result = Array(length);\n            for (let i = 0; i < length; ++i) {\n                result[i] = elements[i].evaluate(flags, scope, hostScope, locator);\n            }\n            return result;\n        }\n        assign(flags, scope, hostScope, locator, obj) {\n            return void 0;\n        }\n        connect(flags, scope, hostScope, binding) {\n            const elements = this.elements;\n            for (let i = 0, ii = elements.length; i < ii; ++i) {\n                elements[i].connect(flags, scope, hostScope, binding);\n            }\n        }\n        accept(visitor) {\n            return visitor.visitArrayLiteral(this);\n        }\n    }\n    ArrayLiteralExpression.$empty = new ArrayLiteralExpression(PLATFORM.emptyArray);\n    return ArrayLiteralExpression;\n})();\nexport { ArrayLiteralExpression };\nlet ObjectLiteralExpression = /** @class */ (() => {\n    class ObjectLiteralExpression {\n        constructor(keys, values) {\n            this.keys = keys;\n            this.values = values;\n        }\n        get $kind() { return 17956 /* ObjectLiteral */; }\n        get hasBind() { return false; }\n        get hasUnbind() { return false; }\n        evaluate(flags, scope, hostScope, locator) {\n            const instance = {};\n            const keys = this.keys;\n            const values = this.values;\n            for (let i = 0, ii = keys.length; i < ii; ++i) {\n                instance[keys[i]] = values[i].evaluate(flags, scope, hostScope, locator);\n            }\n            return instance;\n        }\n        assign(flags, scope, hostScope, locator, obj) {\n            return void 0;\n        }\n        connect(flags, scope, hostScope, binding) {\n            const keys = this.keys;\n            const values = this.values;\n            for (let i = 0, ii = keys.length; i < ii; ++i) {\n                values[i].connect(flags, scope, hostScope, binding);\n            }\n        }\n        accept(visitor) {\n            return visitor.visitObjectLiteral(this);\n        }\n    }\n    ObjectLiteralExpression.$empty = new ObjectLiteralExpression(PLATFORM.emptyArray, PLATFORM.emptyArray);\n    return ObjectLiteralExpression;\n})();\nexport { ObjectLiteralExpression };\nlet TemplateExpression = /** @class */ (() => {\n    class TemplateExpression {\n        constructor(cooked, expressions = PLATFORM.emptyArray) {\n            this.cooked = cooked;\n            this.expressions = expressions;\n        }\n        get $kind() { return 17958 /* Template */; }\n        get hasBind() { return false; }\n        get hasUnbind() { return false; }\n        evaluate(flags, scope, hostScope, locator) {\n            const expressions = this.expressions;\n            const cooked = this.cooked;\n            let result = cooked[0];\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                result += expressions[i].evaluate(flags, scope, hostScope, locator);\n                result += cooked[i + 1];\n            }\n            return result;\n        }\n        assign(flags, scope, hostScope, locator, obj) {\n            return void 0;\n        }\n        connect(flags, scope, hostScope, binding) {\n            const expressions = this.expressions;\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                expressions[i].connect(flags, scope, hostScope, binding);\n                i++;\n            }\n        }\n        accept(visitor) {\n            return visitor.visitTemplate(this);\n        }\n    }\n    TemplateExpression.$empty = new TemplateExpression(['']);\n    return TemplateExpression;\n})();\nexport { TemplateExpression };\nexport class TaggedTemplateExpression {\n    constructor(cooked, raw, func, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.func = func;\n        this.expressions = expressions;\n        cooked.raw = raw;\n    }\n    get $kind() { return 1197 /* TaggedTemplate */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        const expressions = this.expressions;\n        const len = expressions.length;\n        const results = Array(len);\n        for (let i = 0, ii = len; i < ii; ++i) {\n            results[i] = expressions[i].evaluate(flags, scope, hostScope, locator);\n        }\n        const func = this.func.evaluate(flags, scope, hostScope, locator);\n        if (typeof func !== 'function') {\n            throw Reporter.error(207 /* NotAFunction */, this);\n        }\n        return func(this.cooked, ...results);\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, hostScope, binding);\n        }\n        this.func.connect(flags, scope, hostScope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitTaggedTemplate(this);\n    }\n}\nexport class ArrayBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(elements) {\n        this.elements = elements;\n    }\n    get $kind() { return 65556 /* ArrayBindingPattern */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitArrayBindingPattern(this);\n    }\n}\nexport class ObjectBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n    }\n    get $kind() { return 65557 /* ObjectBindingPattern */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitObjectBindingPattern(this);\n    }\n}\nexport class BindingIdentifier {\n    constructor(name) {\n        this.name = name;\n    }\n    get $kind() { return 65558 /* BindingIdentifier */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        return this.name;\n    }\n    connect(flags, scope, hostScope, binding) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitBindingIdentifier(this);\n    }\n}\nconst toStringTag = Object.prototype.toString;\n// https://tc39.github.io/ecma262/#sec-iteration-statements\n// https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements\nexport class ForOfStatement {\n    constructor(declaration, iterable) {\n        this.declaration = declaration;\n        this.iterable = iterable;\n    }\n    get $kind() { return 6199 /* ForOfStatement */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        return this.iterable.evaluate(flags, scope, hostScope, locator);\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    count(flags, result) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return result.length;\n            case '[object Map]': return result.size;\n            case '[object Set]': return result.size;\n            case '[object Number]': return result;\n            case '[object Null]': return 0;\n            case '[object Undefined]': return 0;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    iterate(flags, result, func) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return $array(flags, result, func);\n            case '[object Map]': return $map(flags, result, func);\n            case '[object Set]': return $set(flags, result, func);\n            case '[object Number]': return $number(flags, result, func);\n            case '[object Null]': return;\n            case '[object Undefined]': return;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    connect(flags, scope, hostScope, binding) {\n        this.declaration.connect(flags, scope, hostScope, binding);\n        this.iterable.connect(flags, scope, hostScope, binding);\n    }\n    bind(flags, scope, hostScope, binding) {\n        if (this.iterable.hasBind) {\n            this.iterable.bind(flags, scope, hostScope, binding);\n        }\n    }\n    unbind(flags, scope, hostScope, binding) {\n        if (this.iterable.hasUnbind) {\n            this.iterable.unbind(flags, scope, hostScope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitForOfStatement(this);\n    }\n}\n/*\n* Note: this implementation is far simpler than the one in vCurrent and might be missing important stuff (not sure yet)\n* so while this implementation is identical to Template and we could reuse that one, we don't want to lock outselves in to potentially the wrong abstraction\n* but this class might be a candidate for removal if it turns out it does provide all we need\n*/\nexport class Interpolation {\n    constructor(parts, expressions = PLATFORM.emptyArray) {\n        this.parts = parts;\n        this.expressions = expressions;\n        this.isMulti = expressions.length > 1;\n        this.firstExpression = expressions[0];\n    }\n    get $kind() { return 24 /* Interpolation */; }\n    get hasBind() { return false; }\n    get hasUnbind() { return false; }\n    evaluate(flags, scope, hostScope, locator) {\n        if (this.isMulti) {\n            const expressions = this.expressions;\n            const parts = this.parts;\n            let result = parts[0];\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                result += expressions[i].evaluate(flags, scope, hostScope, locator);\n                result += parts[i + 1];\n            }\n            return result;\n        }\n        else {\n            const parts = this.parts;\n            return `${parts[0]}${this.firstExpression.evaluate(flags, scope, hostScope, locator)}${parts[1]}`;\n        }\n    }\n    assign(flags, scope, hostScope, locator, obj) {\n        return void 0;\n    }\n    connect(flags, scope, hostScope, binding) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitInterpolation(this);\n    }\n}\n/// Evaluate the [list] in context of the [scope].\nfunction evalList(flags, scope, locator, list, hostScope) {\n    const len = list.length;\n    const result = Array(len);\n    for (let i = 0; i < len; ++i) {\n        result[i] = list[i].evaluate(flags, scope, hostScope, locator);\n    }\n    return result;\n}\nfunction getFunction(flags, obj, name) {\n    const func = obj == null ? null : obj[name];\n    if (typeof func === 'function') {\n        return func;\n    }\n    if (!(flags & 128 /* mustEvaluate */) && func == null) {\n        return null;\n    }\n    throw Reporter.error(207 /* NotAFunction */, obj, name, func);\n}\nconst proxyAndOriginalArray = 2 /* proxyStrategy */;\nfunction $array(flags, result, func) {\n    if ((flags & proxyAndOriginalArray) === proxyAndOriginalArray) {\n        // If we're in proxy mode, and the array is the original \"items\" (and not an array we created here to iterate over e.g. a set)\n        // then replace all items (which are Objects) with proxies so their properties are observed in the source view model even if no\n        // observers are explicitly created\n        const rawArray = ProxyObserver.getRawIfProxy(result);\n        const len = rawArray.length;\n        let item;\n        let i = 0;\n        for (; i < len; ++i) {\n            item = rawArray[i];\n            if (item instanceof Object) {\n                item = rawArray[i] = ProxyObserver.getOrCreate(item).proxy;\n            }\n            func(rawArray, i, item);\n        }\n    }\n    else {\n        for (let i = 0, ii = result.length; i < ii; ++i) {\n            func(result, i, result[i]);\n        }\n    }\n}\nfunction $map(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const entry of result.entries()) {\n        arr[++i] = entry;\n    }\n    $array(flags, arr, func);\n}\nfunction $set(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const key of result.keys()) {\n        arr[++i] = key;\n    }\n    $array(flags, arr, func);\n}\nfunction $number(flags, result, func) {\n    const arr = Array(result);\n    for (let i = 0; i < result; ++i) {\n        arr[i] = i;\n    }\n    $array(flags, arr, func);\n}\n//# sourceMappingURL=ast.js.map","/** @internal */\nexport var SubscriberFlags;\n(function (SubscriberFlags) {\n    SubscriberFlags[SubscriberFlags[\"None\"] = 0] = \"None\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber0\"] = 1] = \"Subscriber0\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber1\"] = 2] = \"Subscriber1\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber2\"] = 4] = \"Subscriber2\";\n    SubscriberFlags[SubscriberFlags[\"SubscribersRest\"] = 8] = \"SubscribersRest\";\n    SubscriberFlags[SubscriberFlags[\"Any\"] = 15] = \"Any\";\n})(SubscriberFlags || (SubscriberFlags = {}));\nexport var DelegationStrategy;\n(function (DelegationStrategy) {\n    DelegationStrategy[DelegationStrategy[\"none\"] = 0] = \"none\";\n    DelegationStrategy[DelegationStrategy[\"capturing\"] = 1] = \"capturing\";\n    DelegationStrategy[DelegationStrategy[\"bubbling\"] = 2] = \"bubbling\";\n})(DelegationStrategy || (DelegationStrategy = {}));\nexport var CollectionKind;\n(function (CollectionKind) {\n    CollectionKind[CollectionKind[\"indexed\"] = 8] = \"indexed\";\n    CollectionKind[CollectionKind[\"keyed\"] = 4] = \"keyed\";\n    CollectionKind[CollectionKind[\"array\"] = 9] = \"array\";\n    CollectionKind[CollectionKind[\"map\"] = 6] = \"map\";\n    CollectionKind[CollectionKind[\"set\"] = 7] = \"set\";\n})(CollectionKind || (CollectionKind = {}));\nexport var AccessorType;\n(function (AccessorType) {\n    AccessorType[AccessorType[\"None\"] = 0] = \"None\";\n    AccessorType[AccessorType[\"Observer\"] = 1] = \"Observer\";\n    AccessorType[AccessorType[\"Node\"] = 2] = \"Node\";\n    AccessorType[AccessorType[\"Obj\"] = 4] = \"Obj\";\n    AccessorType[AccessorType[\"Array\"] = 10] = \"Array\";\n    AccessorType[AccessorType[\"Set\"] = 18] = \"Set\";\n    AccessorType[AccessorType[\"Map\"] = 34] = \"Map\";\n    // misc characteristic of observer when update\n    //\n    // by default, everything is synchronous\n    // except changes that are supposed to cause reflow/heavy computation\n    // an observer can use this flag to signal binding that don't carelessly tell it to update\n    // queue it instead\n    // todo: https://gist.github.com/paulirish/5d52fb081b3570c81e3a\n    // todo: https://csstriggers.com/\n    AccessorType[AccessorType[\"Layout\"] = 64] = \"Layout\";\n    // there needs to be a flag to signal that accessor real value\n    // may get out of sync with binding value\n    // so that binding can ask for a force read instead of cache read\n})(AccessorType || (AccessorType = {}));\nexport function copyIndexMap(existing, deletedItems) {\n    const { length } = existing;\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = existing[i];\n        ++i;\n    }\n    if (deletedItems !== void 0) {\n        arr.deletedItems = deletedItems.slice(0);\n    }\n    else if (existing.deletedItems !== void 0) {\n        arr.deletedItems = existing.deletedItems.slice(0);\n    }\n    else {\n        arr.deletedItems = [];\n    }\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function createIndexMap(length = 0) {\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = i++;\n    }\n    arr.deletedItems = [];\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function cloneIndexMap(indexMap) {\n    const clone = indexMap.slice();\n    clone.deletedItems = indexMap.deletedItems.slice();\n    clone.isIndexMap = true;\n    return clone;\n}\nexport function isIndexMap(value) {\n    return value instanceof Array && value.isIndexMap === true;\n}\n//# sourceMappingURL=observation.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionLengthObserver = /** @class */ (() => {\n    let CollectionLengthObserver = class CollectionLengthObserver {\n        constructor(obj) {\n            this.obj = obj;\n            this.type = 10 /* Array */;\n            this.task = null;\n            this.currentValue = obj.length;\n        }\n        getValue() {\n            return this.obj.length;\n        }\n        setValue(newValue, flags) {\n            const currentValue = this.currentValue;\n            if (newValue !== currentValue) {\n                this.currentValue = newValue;\n                this.callSubscribers(newValue, currentValue, flags | 8 /* updateTargetInstance */);\n            }\n        }\n    };\n    CollectionLengthObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Array])\n    ], CollectionLengthObserver);\n    return CollectionLengthObserver;\n})();\nexport { CollectionLengthObserver };\n//# sourceMappingURL=collection-length-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionLengthObserver } from './collection-length-observer';\nimport { collectionSubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\n// https://tc39.github.io/ecma262/#sec-sortcompare\nfunction sortCompare(x, y) {\n    if (x === y) {\n        return 0;\n    }\n    x = x === null ? 'null' : x.toString();\n    y = y === null ? 'null' : y.toString();\n    return x < y ? -1 : 1;\n}\nfunction preSortCompare(x, y) {\n    if (x === void 0) {\n        if (y === void 0) {\n            return 0;\n        }\n        else {\n            return 1;\n        }\n    }\n    if (y === void 0) {\n        return -1;\n    }\n    return 0;\n}\nfunction insertionSort(arr, indexMap, from, to, compareFn) {\n    let velement, ielement, vtmp, itmp, order;\n    let i, j;\n    for (i = from + 1; i < to; i++) {\n        velement = arr[i];\n        ielement = indexMap[i];\n        for (j = i - 1; j >= from; j--) {\n            vtmp = arr[j];\n            itmp = indexMap[j];\n            order = compareFn(vtmp, velement);\n            if (order > 0) {\n                arr[j + 1] = vtmp;\n                indexMap[j + 1] = itmp;\n            }\n            else {\n                break;\n            }\n        }\n        arr[j + 1] = velement;\n        indexMap[j + 1] = ielement;\n    }\n}\nfunction quickSort(arr, indexMap, from, to, compareFn) {\n    let thirdIndex = 0, i = 0;\n    let v0, v1, v2;\n    let i0, i1, i2;\n    let c01, c02, c12;\n    let vtmp, itmp;\n    let vpivot, ipivot, lowEnd, highStart;\n    let velement, ielement, order, vtopElement;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        if (to - from <= 10) {\n            insertionSort(arr, indexMap, from, to, compareFn);\n            return;\n        }\n        thirdIndex = from + ((to - from) >> 1);\n        v0 = arr[from];\n        i0 = indexMap[from];\n        v1 = arr[to - 1];\n        i1 = indexMap[to - 1];\n        v2 = arr[thirdIndex];\n        i2 = indexMap[thirdIndex];\n        c01 = compareFn(v0, v1);\n        if (c01 > 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v1;\n            i0 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        c02 = compareFn(v0, v2);\n        if (c02 >= 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v2;\n            i0 = i2;\n            v2 = v1;\n            i2 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        else {\n            c12 = compareFn(v1, v2);\n            if (c12 > 0) {\n                vtmp = v1;\n                itmp = i1;\n                v1 = v2;\n                i1 = i2;\n                v2 = vtmp;\n                i2 = itmp;\n            }\n        }\n        arr[from] = v0;\n        indexMap[from] = i0;\n        arr[to - 1] = v2;\n        indexMap[to - 1] = i2;\n        vpivot = v1;\n        ipivot = i1;\n        lowEnd = from + 1;\n        highStart = to - 1;\n        arr[thirdIndex] = arr[lowEnd];\n        indexMap[thirdIndex] = indexMap[lowEnd];\n        arr[lowEnd] = vpivot;\n        indexMap[lowEnd] = ipivot;\n        partition: for (i = lowEnd + 1; i < highStart; i++) {\n            velement = arr[i];\n            ielement = indexMap[i];\n            order = compareFn(velement, vpivot);\n            if (order < 0) {\n                arr[i] = arr[lowEnd];\n                indexMap[i] = indexMap[lowEnd];\n                arr[lowEnd] = velement;\n                indexMap[lowEnd] = ielement;\n                lowEnd++;\n            }\n            else if (order > 0) {\n                do {\n                    highStart--;\n                    // eslint-disable-next-line eqeqeq\n                    if (highStart == i) {\n                        break partition;\n                    }\n                    vtopElement = arr[highStart];\n                    order = compareFn(vtopElement, vpivot);\n                } while (order > 0);\n                arr[i] = arr[highStart];\n                indexMap[i] = indexMap[highStart];\n                arr[highStart] = velement;\n                indexMap[highStart] = ielement;\n                if (order < 0) {\n                    velement = arr[i];\n                    ielement = indexMap[i];\n                    arr[i] = arr[lowEnd];\n                    indexMap[i] = indexMap[lowEnd];\n                    arr[lowEnd] = velement;\n                    indexMap[lowEnd] = ielement;\n                    lowEnd++;\n                }\n            }\n        }\n        if (to - highStart < lowEnd - from) {\n            quickSort(arr, indexMap, highStart, to, compareFn);\n            to = lowEnd;\n        }\n        else {\n            quickSort(arr, indexMap, from, lowEnd, compareFn);\n            from = highStart;\n        }\n    }\n}\nconst proto = Array.prototype;\nconst $push = proto.push;\nconst $unshift = proto.unshift;\nconst $pop = proto.pop;\nconst $shift = proto.shift;\nconst $splice = proto.splice;\nconst $reverse = proto.reverse;\nconst $sort = proto.sort;\nconst native = { push: $push, unshift: $unshift, pop: $pop, shift: $shift, splice: $splice, reverse: $reverse, sort: $sort };\nconst methods = ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'];\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-array.prototype.push\n    push: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $push.apply($this, args);\n        }\n        const len = $this.length;\n        const argCount = args.length;\n        if (argCount === 0) {\n            return len;\n        }\n        $this.length = o.indexMap.length = len + argCount;\n        let i = len;\n        while (i < $this.length) {\n            $this[i] = args[i - len];\n            o.indexMap[i] = -2;\n            i++;\n        }\n        o.notify();\n        return $this.length;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.unshift\n    unshift: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $unshift.apply($this, args);\n        }\n        const argCount = args.length;\n        const inserts = new Array(argCount);\n        let i = 0;\n        while (i < argCount) {\n            inserts[i++] = -2;\n        }\n        $unshift.apply(o.indexMap, inserts);\n        const len = $unshift.apply($this, args);\n        o.notify();\n        return len;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.pop\n    pop: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $pop.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $pop.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        const index = indexMap.length - 1;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        $pop.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.shift\n    shift: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $shift.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $shift.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        if (indexMap[0] > -1) {\n            indexMap.deletedItems.push(indexMap[0]);\n        }\n        $shift.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.splice\n    splice: function (...args) {\n        const start = args[0];\n        const deleteCount = args[1];\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $splice.apply($this, args);\n        }\n        const len = this.length;\n        const relativeStart = start | 0;\n        const actualStart = relativeStart < 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);\n        const indexMap = o.indexMap;\n        const argCount = args.length;\n        const actualDeleteCount = argCount === 0 ? 0 : argCount === 1 ? len - actualStart : deleteCount;\n        if (actualDeleteCount > 0) {\n            let i = actualStart;\n            const to = i + actualDeleteCount;\n            while (i < to) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n        }\n        if (argCount > 2) {\n            const itemCount = argCount - 2;\n            const inserts = new Array(itemCount);\n            let i = 0;\n            while (i < itemCount) {\n                inserts[i++] = -2;\n            }\n            $splice.call(indexMap, start, deleteCount, ...inserts);\n        }\n        else {\n            $splice.apply(indexMap, args);\n        }\n        const deleted = $splice.apply($this, args);\n        o.notify();\n        return deleted;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.reverse\n    reverse: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $reverse.call($this);\n            return this;\n        }\n        const len = $this.length;\n        const middle = (len / 2) | 0;\n        let lower = 0;\n        while (lower !== middle) {\n            const upper = len - lower - 1;\n            const lowerValue = $this[lower];\n            const lowerIndex = o.indexMap[lower];\n            const upperValue = $this[upper];\n            const upperIndex = o.indexMap[upper];\n            $this[lower] = upperValue;\n            o.indexMap[lower] = upperIndex;\n            $this[upper] = lowerValue;\n            o.indexMap[upper] = lowerIndex;\n            lower++;\n        }\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.sort\n    // https://github.com/v8/v8/blob/master/src/js/array.js\n    sort: function (compareFn) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $sort.call($this, compareFn);\n            return this;\n        }\n        const len = $this.length;\n        if (len < 2) {\n            return this;\n        }\n        quickSort($this, o.indexMap, 0, len, preSortCompare);\n        let i = 0;\n        while (i < len) {\n            if ($this[i] === void 0) {\n                break;\n            }\n            i++;\n        }\n        if (compareFn === void 0 || typeof compareFn !== 'function' /* spec says throw a TypeError, should we do that too? */) {\n            compareFn = sortCompare;\n        }\n        quickSort($this, o.indexMap, 0, i, compareFn);\n        o.notify();\n        return this;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableArrayObservationCalled = false;\nexport function enableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nlet ArrayObserver = /** @class */ (() => {\n    let ArrayObserver = class ArrayObserver {\n        constructor(flags, lifecycle, array) {\n            this.type = 10 /* Array */;\n            this.task = null;\n            if (!enableArrayObservationCalled) {\n                enableArrayObservationCalled = true;\n                enableArrayObservation();\n            }\n            this.inBatch = false;\n            this.indexObservers = {};\n            this.collection = array;\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            this.indexMap = createIndexMap(array.length);\n            this.lifecycle = lifecycle;\n            this.lengthObserver = (void 0);\n            observerLookup.set(array, this);\n        }\n        notify() {\n            if (this.lifecycle.batch.depth > 0) {\n                if (!this.inBatch) {\n                    this.inBatch = true;\n                    this.lifecycle.batch.add(this);\n                }\n            }\n            else {\n                this.flushBatch(0 /* none */);\n            }\n        }\n        getLengthObserver() {\n            if (this.lengthObserver === void 0) {\n                this.lengthObserver = new CollectionLengthObserver(this.collection);\n            }\n            return this.lengthObserver;\n        }\n        getIndexObserver(index) {\n            return this.getOrCreateIndexObserver(index);\n        }\n        flushBatch(flags) {\n            const indexMap = this.indexMap;\n            const length = this.collection.length;\n            this.inBatch = false;\n            this.indexMap = createIndexMap(length);\n            this.callCollectionSubscribers(indexMap, 8 /* updateTargetInstance */ | this.persistentFlags);\n            if (this.lengthObserver !== void 0) {\n                this.lengthObserver.setValue(length, 8 /* updateTargetInstance */);\n            }\n        }\n        /**\n         * @internal used by friend class ArrayIndexObserver only\n         */\n        addIndexObserver(indexObserver) {\n            this.addCollectionSubscriber(indexObserver);\n        }\n        /**\n         * @internal used by friend class ArrayIndexObserver only\n         */\n        removeIndexObserver(indexObserver) {\n            this.removeCollectionSubscriber(indexObserver);\n        }\n        /**\n         * @internal\n         */\n        getOrCreateIndexObserver(index) {\n            const indexObservers = this.indexObservers;\n            let observer = indexObservers[index];\n            if (observer === void 0) {\n                observer = indexObservers[index] = new ArrayIndexObserver(this, index);\n            }\n            return observer;\n        }\n    };\n    ArrayObserver = __decorate([\n        collectionSubscriberCollection(),\n        __metadata(\"design:paramtypes\", [Number, Object, Object])\n    ], ArrayObserver);\n    return ArrayObserver;\n})();\nexport { ArrayObserver };\nlet ArrayIndexObserver = /** @class */ (() => {\n    let ArrayIndexObserver = class ArrayIndexObserver {\n        constructor(owner, index) {\n            this.owner = owner;\n            this.index = index;\n            this.subscriberCount = 0;\n            this.currentValue = this.getValue();\n        }\n        getValue() {\n            return this.owner.collection[this.index];\n        }\n        setValue(newValue, flags) {\n            if (newValue === this.getValue()) {\n                return;\n            }\n            const arrayObserver = this.owner;\n            const index = this.index;\n            const indexMap = arrayObserver.indexMap;\n            if (indexMap[index] > -1) {\n                indexMap.deletedItems.push(indexMap[index]);\n            }\n            indexMap[index] = -2;\n            // do not need to update current value here\n            // as it will be updated inside handle collection change\n            arrayObserver.collection[index] = newValue;\n            arrayObserver.notify();\n        }\n        /**\n         * From interface `ICollectionSubscriber`\n         */\n        handleCollectionChange(indexMap, flags) {\n            const index = this.index;\n            const noChange = indexMap[index] === index;\n            if (noChange) {\n                return;\n            }\n            const prevValue = this.currentValue;\n            const currValue = this.currentValue = this.getValue();\n            // hmm\n            if (prevValue !== currValue) {\n                this.callSubscribers(currValue, prevValue, flags);\n            }\n        }\n        subscribe(subscriber) {\n            if (this.addSubscriber(subscriber) && ++this.subscriberCount === 1) {\n                this.owner.addIndexObserver(this);\n            }\n        }\n        unsubscribe(subscriber) {\n            if (this.removeSubscriber(subscriber) && --this.subscriberCount === 0) {\n                this.owner.removeIndexObserver(this);\n            }\n        }\n    };\n    ArrayIndexObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [ArrayObserver, Number])\n    ], ArrayIndexObserver);\n    return ArrayIndexObserver;\n})();\nexport { ArrayIndexObserver };\nexport function getArrayObserver(flags, lifecycle, array) {\n    const observer = observerLookup.get(array);\n    if (observer === void 0) {\n        return new ArrayObserver(flags, lifecycle, array);\n    }\n    return observer;\n}\n/**\n * Applies offsets to the non-negative indices in the IndexMap\n * based on added and deleted items relative to those indices.\n *\n * e.g. turn `[-2, 0, 1]` into `[-2, 1, 2]`, allowing the values at the indices to be\n * used for sorting/reordering items if needed\n */\nexport function applyMutationsToIndices(indexMap) {\n    let offset = 0;\n    let j = 0;\n    const len = indexMap.length;\n    for (let i = 0; i < len; ++i) {\n        while (indexMap.deletedItems[j] <= i - offset) {\n            ++j;\n            --offset;\n        }\n        if (indexMap[i] === -2) {\n            ++offset;\n        }\n        else {\n            indexMap[i] += offset;\n        }\n    }\n}\n/**\n * After `applyMutationsToIndices`, this function can be used to reorder items in a derived\n * array (e.g.  the items in the `views` in the repeater are derived from the `items` property)\n */\nexport function synchronizeIndices(items, indexMap) {\n    const copy = items.slice();\n    const len = indexMap.length;\n    let to = 0;\n    let from = 0;\n    while (to < len) {\n        from = indexMap[to];\n        if (from !== -2) {\n            items[to] = copy[from];\n        }\n        ++to;\n    }\n}\n//# sourceMappingURL=array-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n/* eslint-disable eqeqeq, compat/compat */\nimport { PLATFORM, Reporter, isArrayIndex } from '@aurelia/kernel';\nimport { IObserverLocator } from './observer-locator';\nimport { subscriberCollection } from './subscriber-collection';\nexport function computed(config) {\n    return function (target, key) {\n        /**\n         * The 'computed' property defined on prototype needs to be non-enumerable to prevent getting this in loops,\n         * iterating over object properties, such as for..in.\n         *\n         * The 'value' of the property should not have any prototype. Otherwise if by mistake the target passed\n         * here is `Object`, then we are in soup. Because then every instance of `Object` will have the `computed`\n         * property, including the `value` (in the descriptor of the property), when assigned `{}`. This might\n         * lead to infinite recursion for the cases as mentioned above.\n         */\n        if (target.computed == null) {\n            Reflect.defineProperty(target, 'computed', {\n                writable: true,\n                configurable: true,\n                enumerable: false,\n                value: Object.create(null)\n            });\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        target.computed[key] = config;\n    };\n}\nconst computedOverrideDefaults = { static: false, volatile: false };\n/* @internal */\nexport function createComputedObserver(flags, observerLocator, dirtyChecker, lifecycle, instance, propertyName, descriptor) {\n    if (descriptor.configurable === false) {\n        return dirtyChecker.createProperty(instance, propertyName);\n    }\n    if (descriptor.get != null) {\n        const { constructor: { prototype: { computed: givenOverrides } } } = instance;\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-type-assertion\n        const overrides = givenOverrides && givenOverrides[propertyName] || computedOverrideDefaults;\n        if (descriptor.set != null) {\n            if (overrides.volatile) {\n                return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n            }\n            return new CustomSetterObserver(instance, propertyName, descriptor);\n        }\n        return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n    }\n    throw Reporter.error(18, propertyName);\n}\n// Used when the getter is dependent solely on changes that happen within the setter.\nlet CustomSetterObserver = /** @class */ (() => {\n    let CustomSetterObserver = class CustomSetterObserver {\n        constructor(obj, propertyKey, descriptor) {\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.descriptor = descriptor;\n            this.currentValue = void 0;\n            this.oldValue = void 0;\n            this.observing = false;\n        }\n        setValue(newValue) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion, @typescript-eslint/no-unnecessary-type-assertion\n            this.descriptor.set.call(this.obj, newValue); // Non-null is implied because descriptors without setters won't end up here\n            if (this.currentValue !== newValue) {\n                this.oldValue = this.currentValue;\n                this.currentValue = newValue;\n                this.callSubscribers(newValue, this.oldValue, 8 /* updateTargetInstance */);\n            }\n        }\n        subscribe(subscriber) {\n            if (!this.observing) {\n                this.convertProperty();\n            }\n            this.addSubscriber(subscriber);\n        }\n        unsubscribe(subscriber) {\n            this.removeSubscriber(subscriber);\n        }\n        convertProperty() {\n            this.observing = true;\n            this.currentValue = this.obj[this.propertyKey];\n            const set = (newValue) => { this.setValue(newValue); };\n            Reflect.defineProperty(this.obj, this.propertyKey, { set, get: this.descriptor.get });\n        }\n    };\n    CustomSetterObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, String, Object])\n    ], CustomSetterObserver);\n    return CustomSetterObserver;\n})();\nexport { CustomSetterObserver };\n// Used when there is no setter, and the getter is dependent on other properties of the object;\n// Used when there is a setter but the value of the getter can change based on properties set outside of the setter.\nlet GetterObserver = /** @class */ (() => {\n    let GetterObserver = class GetterObserver {\n        constructor(flags, overrides, obj, propertyKey, descriptor, observerLocator) {\n            this.overrides = overrides;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.descriptor = descriptor;\n            this.currentValue = void 0;\n            this.oldValue = void 0;\n            this.propertyDeps = [];\n            this.collectionDeps = [];\n            this.subscriberCount = 0;\n            this.isCollecting = false;\n            this.proxy = new Proxy(obj, createGetterTraps(flags, observerLocator, this));\n            const get = () => this.getValue();\n            Reflect.defineProperty(obj, propertyKey, { get, set: descriptor.set });\n        }\n        addPropertyDep(subscribable) {\n            if (!this.propertyDeps.includes(subscribable)) {\n                this.propertyDeps.push(subscribable);\n            }\n        }\n        addCollectionDep(subscribable) {\n            if (!this.collectionDeps.includes(subscribable)) {\n                this.collectionDeps.push(subscribable);\n            }\n        }\n        getValue() {\n            if (this.subscriberCount > 0 || this.isCollecting) {\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                this.currentValue = Reflect.apply(this.descriptor.get, this.proxy, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n            }\n            else {\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                this.currentValue = Reflect.apply(this.descriptor.get, this.obj, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n            }\n            return this.currentValue;\n        }\n        subscribe(subscriber) {\n            this.addSubscriber(subscriber);\n            if (++this.subscriberCount === 1) {\n                this.getValueAndCollectDependencies(true);\n            }\n        }\n        unsubscribe(subscriber) {\n            this.removeSubscriber(subscriber);\n            if (--this.subscriberCount === 0) {\n                this.unsubscribeAllDependencies();\n            }\n        }\n        handleChange() {\n            const oldValue = this.currentValue;\n            const newValue = this.getValueAndCollectDependencies(false);\n            if (oldValue !== newValue) {\n                this.callSubscribers(newValue, oldValue, 8 /* updateTargetInstance */);\n            }\n        }\n        handleCollectionChange() {\n            const oldValue = this.currentValue;\n            const newValue = this.getValueAndCollectDependencies(false);\n            if (oldValue !== newValue) {\n                this.callSubscribers(newValue, oldValue, 8 /* updateTargetInstance */);\n            }\n        }\n        getValueAndCollectDependencies(requireCollect) {\n            const dynamicDependencies = !this.overrides.static || requireCollect;\n            if (dynamicDependencies) {\n                this.unsubscribeAllDependencies();\n                this.isCollecting = true;\n            }\n            this.currentValue = this.getValue();\n            if (dynamicDependencies) {\n                this.propertyDeps.forEach(x => { x.subscribe(this); });\n                this.collectionDeps.forEach(x => { x.subscribeToCollection(this); });\n                this.isCollecting = false;\n            }\n            return this.currentValue;\n        }\n        doNotCollect(target, key, receiver) {\n            return !this.isCollecting\n                || key === '$observers'\n                || key === '$synthetic'\n                || key === 'constructor';\n        }\n        unsubscribeAllDependencies() {\n            this.propertyDeps.forEach(x => { x.unsubscribe(this); });\n            this.propertyDeps.length = 0;\n            this.collectionDeps.forEach(x => { x.unsubscribeFromCollection(this); });\n            this.collectionDeps.length = 0;\n        }\n    };\n    GetterObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Number, Object, Object, String, Object, Object])\n    ], GetterObserver);\n    return GetterObserver;\n})();\nexport { GetterObserver };\nconst toStringTag = Object.prototype.toString;\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction createGetterTraps(flags, observerLocator, observer) {\n    return {\n        get: function (target, key, receiver) {\n            if (observer.doNotCollect(target, key, receiver)) {\n                return Reflect.get(target, key, receiver);\n            }\n            // The length and iterator properties need to be invoked on the original object\n            // (for Map and Set at least) or they will throw.\n            switch (toStringTag.call(target)) {\n                case '[object Array]':\n                    if (key === 'length' || isArrayIndex(key)) {\n                        observer.addCollectionDep(observerLocator.getArrayObserver(flags, target));\n                        return proxyOrValue(flags, target, key, observerLocator, observer);\n                    }\n                    break;\n                case '[object Map]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getMapObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n                case '[object Set]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getSetObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n            }\n            observer.addPropertyDep(observerLocator.getObserver(flags, target, key));\n            return proxyOrValue(flags, target, key, observerLocator, observer);\n        }\n    };\n}\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction proxyOrValue(flags, target, key, observerLocator, observer) {\n    const value = Reflect.get(target, key, target);\n    if (typeof value !== 'object' || typeof value === 'function' || value === null) {\n        return value;\n    }\n    return new Proxy(value, createGetterTraps(flags, observerLocator, observer));\n}\n//# sourceMappingURL=computed-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\nimport { IScheduler } from '@aurelia/scheduler';\nexport const IDirtyChecker = DI.createInterface('IDirtyChecker').withDefault(x => x.singleton(DirtyChecker));\nexport const DirtyCheckSettings = {\n    /**\n     * Default: `6`\n     *\n     * Adjust the global dirty check frequency.\n     * Measures in \"frames per check\", such that (given an FPS of 60):\n     * - A value of 1 will result in 60 dirty checks per second\n     * - A value of 6 will result in 10 dirty checks per second\n     */\n    framesPerCheck: 6,\n    /**\n     * Default: `false`\n     *\n     * Disable dirty-checking entirely. Properties that cannot be observed without dirty checking\n     * or an adapter, will simply not be observed.\n     */\n    disabled: false,\n    /**\n     * Default: `true`\n     *\n     * Log a warning message to the console if a property is being dirty-checked.\n     */\n    warn: true,\n    /**\n     * Default: `false`\n     *\n     * Throw an error if a property is being dirty-checked.\n     */\n    throw: false,\n    /**\n     * Resets all dirty checking settings to the framework's defaults.\n     */\n    resetToDefault() {\n        this.framesPerCheck = 6;\n        this.disabled = false;\n        this.warn = true;\n        this.throw = false;\n    }\n};\n/** @internal */\nlet DirtyChecker = /** @class */ (() => {\n    let DirtyChecker = class DirtyChecker {\n        constructor(scheduler) {\n            this.scheduler = scheduler;\n            this.tracked = [];\n            this.task = null;\n            this.elapsedFrames = 0;\n        }\n        createProperty(obj, propertyName) {\n            if (DirtyCheckSettings.throw) {\n                throw Reporter.error(800, propertyName); // TODO: create/organize error code\n            }\n            if (DirtyCheckSettings.warn) {\n                Reporter.write(801, propertyName);\n            }\n            return new DirtyCheckProperty(this, obj, propertyName);\n        }\n        addProperty(property) {\n            this.tracked.push(property);\n            if (this.tracked.length === 1) {\n                this.task = this.scheduler.queueRenderTask(() => this.check(), { persistent: true });\n            }\n        }\n        removeProperty(property) {\n            this.tracked.splice(this.tracked.indexOf(property), 1);\n            if (this.tracked.length === 0) {\n                this.task.cancel();\n                this.task = null;\n            }\n        }\n        check(delta) {\n            if (DirtyCheckSettings.disabled) {\n                return;\n            }\n            if (++this.elapsedFrames < DirtyCheckSettings.framesPerCheck) {\n                return;\n            }\n            this.elapsedFrames = 0;\n            const tracked = this.tracked;\n            const len = tracked.length;\n            let current;\n            let i = 0;\n            for (; i < len; ++i) {\n                current = tracked[i];\n                if (current.isDirty()) {\n                    current.flush(0 /* none */);\n                }\n            }\n        }\n    };\n    DirtyChecker = __decorate([\n        __param(0, IScheduler),\n        __metadata(\"design:paramtypes\", [Object])\n    ], DirtyChecker);\n    return DirtyChecker;\n})();\nexport { DirtyChecker };\nlet DirtyCheckProperty = /** @class */ (() => {\n    let DirtyCheckProperty = class DirtyCheckProperty {\n        constructor(dirtyChecker, obj, propertyKey) {\n            this.dirtyChecker = dirtyChecker;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.type = 4 /* Obj */;\n        }\n        isDirty() {\n            return this.oldValue !== this.obj[this.propertyKey];\n        }\n        flush(flags) {\n            const oldValue = this.oldValue;\n            const newValue = this.obj[this.propertyKey];\n            this.callSubscribers(newValue, oldValue, flags | 8 /* updateTargetInstance */);\n            this.oldValue = newValue;\n        }\n        subscribe(subscriber) {\n            if (!this.hasSubscribers()) {\n                this.oldValue = this.obj[this.propertyKey];\n                this.dirtyChecker.addProperty(this);\n            }\n            this.addSubscriber(subscriber);\n        }\n        unsubscribe(subscriber) {\n            if (this.removeSubscriber(subscriber) && !this.hasSubscribers()) {\n                this.dirtyChecker.removeProperty(this);\n            }\n        }\n    };\n    DirtyCheckProperty = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Object, String])\n    ], DirtyCheckProperty);\n    return DirtyCheckProperty;\n})();\nexport { DirtyCheckProperty };\n//# sourceMappingURL=dirty-checker.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionSizeObserver = /** @class */ (() => {\n    let CollectionSizeObserver = class CollectionSizeObserver {\n        constructor(obj) {\n            this.obj = obj;\n            this.type = 4 /* Obj */;\n            this.task = null;\n            this.currentValue = obj.size;\n        }\n        getValue() {\n            return this.obj.size;\n        }\n        setValue(newValue, flags) {\n            const { currentValue } = this;\n            if (newValue !== currentValue) {\n                this.currentValue = newValue;\n                this.callSubscribers(newValue, currentValue, flags | 8 /* updateTargetInstance */);\n            }\n        }\n    };\n    CollectionSizeObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object])\n    ], CollectionSizeObserver);\n    return CollectionSizeObserver;\n})();\nexport { CollectionSizeObserver };\n//# sourceMappingURL=collection-size-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap, } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Map.prototype;\nconst $set = proto.set;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { set: $set, clear: $clear, delete: $delete };\nconst methods = ['set', 'clear', 'delete'];\n// note: we can't really do much with Map due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, map/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-map.prototype.map\n    set: function (key, value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $set.call($this, key, value);\n            return this;\n        }\n        const oldValue = $this.get(key);\n        const oldSize = $this.size;\n        $set.call($this, key, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            let i = 0;\n            for (const entry of $this.entries()) {\n                if (entry[0] === key) {\n                    if (entry[1] !== oldValue) {\n                        o.indexMap.deletedItems.push(o.indexMap[i]);\n                        o.indexMap[i] = -2;\n                        o.notify();\n                    }\n                    return this;\n                }\n                i++;\n            }\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            ++i;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableMapObservationCalled = false;\nexport function enableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet MapObserver = /** @class */ (() => {\n    let MapObserver = class MapObserver {\n        constructor(flags, lifecycle, map) {\n            this.type = 34 /* Map */;\n            this.task = null;\n            if (!enableMapObservationCalled) {\n                enableMapObservationCalled = true;\n                enableMapObservation();\n            }\n            this.inBatch = false;\n            this.collection = map;\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            this.indexMap = createIndexMap(map.size);\n            this.lifecycle = lifecycle;\n            this.lengthObserver = (void 0);\n            observerLookup.set(map, this);\n        }\n        notify() {\n            if (this.lifecycle.batch.depth > 0) {\n                if (!this.inBatch) {\n                    this.inBatch = true;\n                    this.lifecycle.batch.add(this);\n                }\n            }\n            else {\n                this.flushBatch(0 /* none */);\n            }\n        }\n        getLengthObserver() {\n            if (this.lengthObserver === void 0) {\n                this.lengthObserver = new CollectionSizeObserver(this.collection);\n            }\n            return this.lengthObserver;\n        }\n        getIndexObserver(index) {\n            throw new Error('Map index observation not supported');\n        }\n        flushBatch(flags) {\n            const indexMap = this.indexMap;\n            const size = this.collection.size;\n            this.inBatch = false;\n            this.indexMap = createIndexMap(size);\n            this.callCollectionSubscribers(indexMap, 8 /* updateTargetInstance */ | this.persistentFlags);\n            if (this.lengthObserver !== void 0) {\n                this.lengthObserver.setValue(size, 8 /* updateTargetInstance */);\n            }\n        }\n    };\n    MapObserver = __decorate([\n        collectionSubscriberCollection(),\n        __metadata(\"design:paramtypes\", [Number, Object, Object])\n    ], MapObserver);\n    return MapObserver;\n})();\nexport { MapObserver };\nexport function getMapObserver(flags, lifecycle, map) {\n    const observer = observerLookup.get(map);\n    if (observer === void 0) {\n        return new MapObserver(flags, lifecycle, map);\n    }\n    return observer;\n}\n//# sourceMappingURL=map-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nconst slice = Array.prototype.slice;\nconst noop = PLATFORM.noop;\n// note: string.length is the only property of any primitive that is not a function,\n// so we can hardwire it to that and simply return undefined for anything else\n// note#2: a modified primitive constructor prototype would not work (and really, it shouldn't..)\nexport class PrimitiveObserver {\n    constructor(obj, propertyKey) {\n        this.doNotCache = true;\n        this.type = 0 /* None */;\n        this.task = null;\n        // we don't need to store propertyName because only 'length' can return a useful value\n        if (propertyKey === 'length') {\n            // deliberately not checking for typeof string as users probably still want to know via an error that their string is undefined\n            this.obj = obj;\n            this.getValue = this.getStringLength;\n        }\n        else {\n            this.getValue = this.returnUndefined;\n        }\n    }\n    getStringLength() {\n        return this.obj.length;\n    }\n    returnUndefined() {\n        return undefined;\n    }\n}\nPrimitiveObserver.prototype.setValue = noop;\nPrimitiveObserver.prototype.subscribe = noop;\nPrimitiveObserver.prototype.unsubscribe = noop;\nPrimitiveObserver.prototype.dispose = noop;\n//# sourceMappingURL=primitive-observer.js.map","export class PropertyAccessor {\n    constructor(obj, propertyKey) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        // the only thing can be guaranteed is it's an object\n        // even if this property accessor is used to access an element\n        this.type = 4 /* Obj */;\n        if (obj.$observers !== void 0\n            && obj.$observers[propertyKey] !== void 0\n            && obj.$observers[propertyKey].setValue !== void 0) {\n            this.setValue = this.setValueDirect;\n        }\n    }\n    getValue() {\n        return this.obj[this.propertyKey];\n    }\n    setValue(value, flags) {\n        this.obj[this.propertyKey] = value;\n    }\n    setValueDirect(value, flags) {\n        this.obj.$observers[this.propertyKey].setValue(value, flags);\n    }\n}\n//# sourceMappingURL=property-accessor.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Set.prototype;\nconst $add = proto.add;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { add: $add, clear: $clear, delete: $delete };\nconst methods = ['add', 'clear', 'delete'];\n// note: we can't really do much with Set due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, add/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-set.prototype.add\n    add: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $add.call($this, value);\n            return this;\n        }\n        const oldSize = $this.size;\n        $add.call($this, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            i++;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableSetObservationCalled = false;\nexport function enableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet SetObserver = /** @class */ (() => {\n    let SetObserver = class SetObserver {\n        constructor(flags, lifecycle, observedSet) {\n            this.type = 18 /* Set */;\n            this.task = null;\n            if (!enableSetObservationCalled) {\n                enableSetObservationCalled = true;\n                enableSetObservation();\n            }\n            this.inBatch = false;\n            this.collection = observedSet;\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            this.indexMap = createIndexMap(observedSet.size);\n            this.lifecycle = lifecycle;\n            this.lengthObserver = (void 0);\n            observerLookup.set(observedSet, this);\n        }\n        notify() {\n            if (this.lifecycle.batch.depth > 0) {\n                if (!this.inBatch) {\n                    this.inBatch = true;\n                    this.lifecycle.batch.add(this);\n                }\n            }\n            else {\n                this.flushBatch(0 /* none */);\n            }\n        }\n        getLengthObserver() {\n            if (this.lengthObserver === void 0) {\n                this.lengthObserver = new CollectionSizeObserver(this.collection);\n            }\n            return this.lengthObserver;\n        }\n        getIndexObserver(index) {\n            throw new Error('Set index observation not supported');\n        }\n        flushBatch(flags) {\n            const indexMap = this.indexMap;\n            const size = this.collection.size;\n            this.inBatch = false;\n            this.indexMap = createIndexMap(size);\n            this.callCollectionSubscribers(indexMap, 8 /* updateTargetInstance */ | this.persistentFlags);\n            if (this.lengthObserver !== void 0) {\n                this.lengthObserver.setValue(size, 8 /* updateTargetInstance */);\n            }\n        }\n    };\n    SetObserver = __decorate([\n        collectionSubscriberCollection(),\n        __metadata(\"design:paramtypes\", [Number, Object, Object])\n    ], SetObserver);\n    return SetObserver;\n})();\nexport { SetObserver };\nexport function getSetObserver(flags, lifecycle, observedSet) {\n    const observer = observerLookup.get(observedSet);\n    if (observer === void 0) {\n        return new SetObserver(flags, lifecycle, observedSet);\n    }\n    return observer;\n}\n//# sourceMappingURL=set-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration, Reporter, isArrayIndex, } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { getArrayObserver } from './array-observer';\nimport { createComputedObserver } from './computed-observer';\nimport { IDirtyChecker } from './dirty-checker';\nimport { getMapObserver } from './map-observer';\nimport { PrimitiveObserver } from './primitive-observer';\nimport { PropertyAccessor } from './property-accessor';\nimport { ProxyObserver } from './proxy-observer';\nimport { getSetObserver } from './set-observer';\nimport { SetterObserver } from './setter-observer';\nimport { IScheduler } from '@aurelia/scheduler';\nconst toStringTag = Object.prototype.toString;\nexport const IObserverLocator = DI.createInterface('IObserverLocator').noDefault();\nexport const ITargetObserverLocator = DI.createInterface('ITargetObserverLocator').noDefault();\nexport const ITargetAccessorLocator = DI.createInterface('ITargetAccessorLocator').noDefault();\nfunction getPropertyDescriptor(subject, name) {\n    let pd = Object.getOwnPropertyDescriptor(subject, name);\n    let proto = Object.getPrototypeOf(subject);\n    while (pd == null && proto != null) {\n        pd = Object.getOwnPropertyDescriptor(proto, name);\n        proto = Object.getPrototypeOf(proto);\n    }\n    return pd;\n}\n/** @internal */\nlet ObserverLocator = /** @class */ (() => {\n    let ObserverLocator = class ObserverLocator {\n        constructor(lifecycle, scheduler, dirtyChecker, targetObserverLocator, targetAccessorLocator) {\n            this.lifecycle = lifecycle;\n            this.scheduler = scheduler;\n            this.dirtyChecker = dirtyChecker;\n            this.targetObserverLocator = targetObserverLocator;\n            this.targetAccessorLocator = targetAccessorLocator;\n            this.adapters = [];\n        }\n        static register(container) {\n            return Registration.singleton(IObserverLocator, this).register(container);\n        }\n        getObserver(flags, obj, propertyName) {\n            if (flags & 2 /* proxyStrategy */ && typeof obj === 'object') {\n                return ProxyObserver.getOrCreate(obj, propertyName); // TODO: fix typings (and ensure proper contracts ofc)\n            }\n            if (isBindingContext(obj)) {\n                return obj.getObservers(flags).getOrCreate(this.lifecycle, flags, obj, propertyName);\n            }\n            let observersLookup = obj.$observers;\n            if (observersLookup && propertyName in observersLookup) {\n                return observersLookup[propertyName];\n            }\n            const observer = this.createPropertyObserver(flags, obj, propertyName);\n            if (!observer.doNotCache) {\n                if (observersLookup === void 0) {\n                    observersLookup = this.getOrCreateObserversLookup(obj);\n                }\n                observersLookup[propertyName] = observer;\n            }\n            return observer;\n        }\n        addAdapter(adapter) {\n            this.adapters.push(adapter);\n        }\n        getAccessor(flags, obj, propertyName) {\n            if (this.targetAccessorLocator.handles(flags, obj)) {\n                if (this.targetObserverLocator.overridesAccessor(flags, obj, propertyName)) {\n                    return this.getObserver(flags, obj, propertyName);\n                }\n                return this.targetAccessorLocator.getAccessor(flags, this.scheduler, this.lifecycle, obj, propertyName);\n            }\n            if (flags & 2 /* proxyStrategy */) {\n                return ProxyObserver.getOrCreate(obj, propertyName);\n            }\n            return new PropertyAccessor(obj, propertyName);\n        }\n        getArrayObserver(flags, observedArray) {\n            return getArrayObserver(flags, this.lifecycle, observedArray);\n        }\n        getMapObserver(flags, observedMap) {\n            return getMapObserver(flags, this.lifecycle, observedMap);\n        }\n        getSetObserver(flags, observedSet) {\n            return getSetObserver(flags, this.lifecycle, observedSet);\n        }\n        getOrCreateObserversLookup(obj) {\n            return obj.$observers || this.createObserversLookup(obj);\n        }\n        createObserversLookup(obj) {\n            const value = {};\n            if (!Reflect.defineProperty(obj, '$observers', {\n                enumerable: false,\n                configurable: false,\n                writable: false,\n                value: value\n            })) {\n                Reporter.write(0, obj);\n            }\n            return value;\n        }\n        getAdapterObserver(flags, obj, propertyName, descriptor) {\n            for (let i = 0, ii = this.adapters.length; i < ii; i++) {\n                const adapter = this.adapters[i];\n                const observer = adapter.getObserver(flags, obj, propertyName, descriptor);\n                if (observer != null) {\n                    return observer;\n                }\n            }\n            return null;\n        }\n        createPropertyObserver(flags, obj, propertyName) {\n            if (!(obj instanceof Object)) {\n                return new PrimitiveObserver(obj, propertyName);\n            }\n            let isNode = false;\n            if (this.targetObserverLocator.handles(flags, obj)) {\n                const observer = this.targetObserverLocator.getObserver(flags, this.scheduler, this.lifecycle, this, obj, propertyName);\n                if (observer != null) {\n                    return observer;\n                }\n                isNode = true;\n            }\n            const tag = toStringTag.call(obj);\n            switch (tag) {\n                case '[object Array]':\n                    if (propertyName === 'length') {\n                        return this.getArrayObserver(flags, obj).getLengthObserver();\n                    }\n                    // is numer only returns true for integer\n                    if (isArrayIndex(propertyName)) {\n                        return this.getArrayObserver(flags, obj).getIndexObserver(Number(propertyName));\n                    }\n                    break;\n                case '[object Map]':\n                    if (propertyName === 'size') {\n                        return this.getMapObserver(flags, obj).getLengthObserver();\n                    }\n                    break;\n                case '[object Set]':\n                    if (propertyName === 'size') {\n                        return this.getSetObserver(flags, obj).getLengthObserver();\n                    }\n                    break;\n            }\n            const descriptor = getPropertyDescriptor(obj, propertyName);\n            if (descriptor != null && (descriptor.get != null || descriptor.set != null)) {\n                if (descriptor.get != null && descriptor.get.getObserver != null) {\n                    return descriptor.get.getObserver(obj);\n                }\n                // attempt to use an adapter before resorting to dirty checking.\n                const adapterObserver = this.getAdapterObserver(flags, obj, propertyName, descriptor);\n                if (adapterObserver != null) {\n                    return adapterObserver;\n                }\n                if (isNode) {\n                    // TODO: use MutationObserver\n                    return this.dirtyChecker.createProperty(obj, propertyName);\n                }\n                return createComputedObserver(flags, this, this.dirtyChecker, this.lifecycle, obj, propertyName, descriptor);\n            }\n            return new SetterObserver(this.lifecycle, flags, obj, propertyName);\n        }\n    };\n    ObserverLocator = __decorate([\n        __param(0, ILifecycle),\n        __param(1, IScheduler),\n        __param(2, IDirtyChecker),\n        __param(3, ITargetObserverLocator),\n        __param(4, ITargetAccessorLocator),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, Object, Object])\n    ], ObserverLocator);\n    return ObserverLocator;\n})();\nexport { ObserverLocator };\nexport function getCollectionObserver(flags, lifecycle, collection) {\n    // If the collection is wrapped by a proxy then `$observer` will return the proxy observer instead of the collection observer, which is not what we want\n    // when we ask for getCollectionObserver\n    const rawCollection = collection instanceof Object ? ProxyObserver.getRawIfProxy(collection) : collection;\n    switch (toStringTag.call(collection)) {\n        case '[object Array]':\n            return getArrayObserver(flags, lifecycle, rawCollection);\n        case '[object Map]':\n            return getMapObserver(flags, lifecycle, rawCollection);\n        case '[object Set]':\n            return getSetObserver(flags, lifecycle, rawCollection);\n    }\n    return void 0;\n}\nfunction isBindingContext(obj) {\n    return obj.$synthetic === true;\n}\n//# sourceMappingURL=observer-locator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, } from '@aurelia/kernel';\nimport { IScheduler, } from '@aurelia/scheduler';\nimport { BindingMode, } from '../flags';\nimport { ILifecycle } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nconst updateTaskOpts = {\n    reusable: false,\n    preempt: true,\n};\nlet PropertyBinding = /** @class */ (() => {\n    let PropertyBinding = class PropertyBinding {\n        constructor(sourceExpression, target, targetProperty, mode, observerLocator, locator) {\n            this.sourceExpression = sourceExpression;\n            this.target = target;\n            this.targetProperty = targetProperty;\n            this.mode = mode;\n            this.observerLocator = observerLocator;\n            this.locator = locator;\n            this.interceptor = this;\n            this.isBound = false;\n            this.$scope = void 0;\n            this.$hostScope = null;\n            this.targetObserver = void 0;\n            this.persistentFlags = 0 /* none */;\n            this.task = null;\n            connectable.assignIdTo(this);\n            this.$lifecycle = locator.get(ILifecycle);\n            this.$scheduler = locator.get(IScheduler);\n        }\n        ;\n        updateTarget(value, flags) {\n            flags |= this.persistentFlags;\n            this.targetObserver.setValue(value, flags);\n        }\n        updateSource(value, flags) {\n            flags |= this.persistentFlags;\n            this.sourceExpression.assign(flags, this.$scope, this.$hostScope, this.locator, value);\n        }\n        handleChange(newValue, _previousValue, flags) {\n            var _a, _b;\n            if (!this.isBound) {\n                return;\n            }\n            flags |= this.persistentFlags;\n            const targetObserver = this.targetObserver;\n            const interceptor = this.interceptor;\n            const sourceExpression = this.sourceExpression;\n            const $scope = this.$scope;\n            const locator = this.locator;\n            if ((flags & 8 /* updateTargetInstance */) > 0) {\n                // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n                if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                    newValue = this.sourceExpression.evaluate(flags, $scope, this.$hostScope, locator);\n                }\n                // Alpha: during bind a simple strategy for bind is always flush immediately\n                // todo:\n                //  (1). determine whether this should be the behavior\n                //  (2). if not, then fix tests to reflect the changes/scheduler to properly yield all with aurelia.start().wait()\n                const shouldQueueFlush = (flags & 32 /* fromBind */) === 0 && (targetObserver.type & 64 /* Layout */) > 0;\n                const oldValue = targetObserver.getValue();\n                if (sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                    newValue = sourceExpression.evaluate(flags, $scope, this.$hostScope, locator);\n                }\n                // todo(fred): maybe let the obsrever decides whether it updates\n                if (newValue !== oldValue) {\n                    if (shouldQueueFlush) {\n                        flags |= 4096 /* noTargetObserverQueue */;\n                        (_a = this.task) === null || _a === void 0 ? void 0 : _a.cancel();\n                        (_b = targetObserver.task) === null || _b === void 0 ? void 0 : _b.cancel();\n                        targetObserver.task = this.task = this.$scheduler.queueRenderTask(() => {\n                            var _a, _b;\n                            (_b = (_a = targetObserver).flushChanges) === null || _b === void 0 ? void 0 : _b.call(_a, flags);\n                            this.task = targetObserver.task = null;\n                        }, updateTaskOpts);\n                    }\n                    interceptor.updateTarget(newValue, flags);\n                }\n                // todo: merge this with evaluate above\n                if ((this.mode & oneTime) === 0) {\n                    this.version++;\n                    sourceExpression.connect(flags, $scope, this.$hostScope, this.interceptor);\n                    interceptor.unobserve(false);\n                }\n                return;\n            }\n            if ((flags & 16 /* updateSourceExpression */) > 0) {\n                if (newValue !== sourceExpression.evaluate(flags, $scope, this.$hostScope, locator)) {\n                    interceptor.updateSource(newValue, flags);\n                }\n                return;\n            }\n            throw new Error('Unexpected handleChange context in PropertyBinding');\n        }\n        $bind(flags, scope, hostScope) {\n            if (this.isBound) {\n                if (this.$scope === scope) {\n                    return;\n                }\n                this.interceptor.$unbind(flags | 32 /* fromBind */);\n            }\n            // Force property binding to always be strict\n            flags |= 4 /* isStrictBindingStrategy */;\n            // Store flags which we can only receive during $bind and need to pass on\n            // to the AST during evaluate/connect/assign\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            this.$scope = scope;\n            this.$hostScope = hostScope;\n            let sourceExpression = this.sourceExpression;\n            if (sourceExpression.hasBind) {\n                sourceExpression.bind(flags, scope, hostScope, this.interceptor);\n            }\n            let $mode = this.mode;\n            let targetObserver = this.targetObserver;\n            if (!targetObserver) {\n                const observerLocator = this.observerLocator;\n                if ($mode & fromView) {\n                    targetObserver = observerLocator.getObserver(flags, this.target, this.targetProperty);\n                }\n                else {\n                    targetObserver = observerLocator.getAccessor(flags, this.target, this.targetProperty);\n                }\n                this.targetObserver = targetObserver;\n            }\n            if ($mode !== BindingMode.oneTime && targetObserver.bind) {\n                targetObserver.bind(flags);\n            }\n            // deepscan-disable-next-line\n            $mode = this.mode;\n            // during bind, binding behavior might have changed sourceExpression\n            sourceExpression = this.sourceExpression;\n            const interceptor = this.interceptor;\n            if ($mode & toViewOrOneTime) {\n                interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.$hostScope, this.locator), flags);\n            }\n            if ($mode & toView) {\n                sourceExpression.connect(flags, scope, this.$hostScope, interceptor);\n            }\n            if ($mode & fromView) {\n                targetObserver.subscribe(interceptor);\n                if (($mode & toView) === 0) {\n                    interceptor.updateSource(targetObserver.getValue(), flags);\n                }\n                targetObserver[this.id] |= 16 /* updateSourceExpression */;\n            }\n            // add isBound flag and remove isBinding flag\n            this.isBound = true;\n        }\n        $unbind(flags) {\n            if (!this.isBound) {\n                return;\n            }\n            // clear persistent flags\n            this.persistentFlags = 0 /* none */;\n            if (this.sourceExpression.hasUnbind) {\n                this.sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n            }\n            this.$scope = void 0;\n            const targetObserver = this.targetObserver;\n            const task = this.task;\n            if (targetObserver.unbind) {\n                targetObserver.unbind(flags);\n            }\n            if (targetObserver.unsubscribe) {\n                targetObserver.unsubscribe(this.interceptor);\n                targetObserver[this.id] &= ~16 /* updateSourceExpression */;\n            }\n            if (task != null) {\n                task.cancel();\n                if (task === targetObserver.task) {\n                    targetObserver.task = null;\n                }\n                this.task = null;\n            }\n            this.interceptor.unobserve(true);\n            this.isBound = false;\n        }\n        dispose() {\n            this.interceptor = (void 0);\n            this.sourceExpression = (void 0);\n            this.locator = (void 0);\n            this.targetObserver = (void 0);\n            this.target = (void 0);\n        }\n    };\n    PropertyBinding = __decorate([\n        connectable(),\n        __metadata(\"design:paramtypes\", [Object, Object, String, Number, Object, Object])\n    ], PropertyBinding);\n    return PropertyBinding;\n})();\nexport { PropertyBinding };\n//# sourceMappingURL=property-binding.js.map","export class CallBinding {\n    constructor(sourceExpression, target, targetProperty, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.locator = locator;\n        this.interceptor = this;\n        this.isBound = false;\n        this.$hostScope = null;\n        this.targetObserver = observerLocator.getObserver(0 /* none */, target, targetProperty);\n    }\n    callSource(args) {\n        const overrideContext = this.$scope.overrideContext;\n        Object.assign(overrideContext, args);\n        const result = this.sourceExpression.evaluate(128 /* mustEvaluate */, this.$scope, this.$hostScope, this.locator);\n        for (const prop in args) {\n            Reflect.deleteProperty(overrideContext, prop);\n        }\n        return result;\n    }\n    $bind(flags, scope, hostScope) {\n        if (this.isBound) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 32 /* fromBind */);\n        }\n        this.$scope = scope;\n        this.$hostScope = hostScope;\n        if (this.sourceExpression.hasBind) {\n            this.sourceExpression.bind(flags, scope, hostScope, this.interceptor);\n        }\n        this.targetObserver.setValue(($args) => this.interceptor.callSource($args), flags);\n        // add isBound flag and remove isBinding flag\n        this.isBound = true;\n    }\n    $unbind(flags) {\n        if (!this.isBound) {\n            return;\n        }\n        if (this.sourceExpression.hasUnbind) {\n            this.sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.targetObserver.setValue(null, flags);\n        this.isBound = false;\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n    dispose() {\n        this.interceptor = (void 0);\n        this.sourceExpression = (void 0);\n        this.locator = (void 0);\n        this.targetObserver = (void 0);\n    }\n}\n//# sourceMappingURL=call-binding.js.map","import { DI, Registration, Reporter, } from '@aurelia/kernel';\nimport { AccessKeyedExpression, AccessMemberExpression, AccessScopeExpression, AccessThisExpression, ArrayBindingPattern, ArrayLiteralExpression, AssignExpression, BinaryExpression, BindingBehaviorExpression, BindingIdentifier, CallFunctionExpression, CallMemberExpression, CallScopeExpression, ConditionalExpression, CustomExpression, ForOfStatement, Interpolation, ObjectBindingPattern, ObjectLiteralExpression, PrimitiveLiteralExpression, TaggedTemplateExpression, TemplateExpression, UnaryExpression, ValueConverterExpression, } from './ast';\nexport const IExpressionParser = DI.createInterface('IExpressionParser').withDefault(x => x.singleton(ExpressionParser));\nexport class ExpressionParser {\n    constructor() {\n        this.expressionLookup = Object.create(null);\n        this.forOfLookup = Object.create(null);\n        this.interpolationLookup = Object.create(null);\n    }\n    static register(container) {\n        return Registration.singleton(IExpressionParser, this).register(container);\n    }\n    parse(expression, bindingType) {\n        switch (bindingType) {\n            case 2048 /* Interpolation */: {\n                let found = this.interpolationLookup[expression];\n                if (found === void 0) {\n                    found = this.interpolationLookup[expression] = this.$parse(expression, bindingType);\n                }\n                return found;\n            }\n            case 539 /* ForCommand */: {\n                let found = this.forOfLookup[expression];\n                if (found === void 0) {\n                    found = this.forOfLookup[expression] = this.$parse(expression, bindingType);\n                }\n                return found;\n            }\n            default: {\n                // Allow empty strings for normal bindings and those that are empty by default (such as a custom attribute without an equals sign)\n                // But don't cache it, because empty strings are always invalid for any other type of binding\n                if (expression.length === 0 && (bindingType & (53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */))) {\n                    return PrimitiveLiteralExpression.$empty;\n                }\n                let found = this.expressionLookup[expression];\n                if (found === void 0) {\n                    found = this.expressionLookup[expression] = this.$parse(expression, bindingType);\n                }\n                return found;\n            }\n        }\n    }\n    $parse(expression, bindingType) {\n        $state.input = expression;\n        $state.length = expression.length;\n        $state.index = 0;\n        $state.currentChar = expression.charCodeAt(0);\n        return parse($state, 0 /* Reset */, 61 /* Variadic */, bindingType === void 0 ? 53 /* BindCommand */ : bindingType);\n    }\n}\nexport var Char;\n(function (Char) {\n    Char[Char[\"Null\"] = 0] = \"Null\";\n    Char[Char[\"Backspace\"] = 8] = \"Backspace\";\n    Char[Char[\"Tab\"] = 9] = \"Tab\";\n    Char[Char[\"LineFeed\"] = 10] = \"LineFeed\";\n    Char[Char[\"VerticalTab\"] = 11] = \"VerticalTab\";\n    Char[Char[\"FormFeed\"] = 12] = \"FormFeed\";\n    Char[Char[\"CarriageReturn\"] = 13] = \"CarriageReturn\";\n    Char[Char[\"Space\"] = 32] = \"Space\";\n    Char[Char[\"Exclamation\"] = 33] = \"Exclamation\";\n    Char[Char[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    Char[Char[\"Dollar\"] = 36] = \"Dollar\";\n    Char[Char[\"Percent\"] = 37] = \"Percent\";\n    Char[Char[\"Ampersand\"] = 38] = \"Ampersand\";\n    Char[Char[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    Char[Char[\"OpenParen\"] = 40] = \"OpenParen\";\n    Char[Char[\"CloseParen\"] = 41] = \"CloseParen\";\n    Char[Char[\"Asterisk\"] = 42] = \"Asterisk\";\n    Char[Char[\"Plus\"] = 43] = \"Plus\";\n    Char[Char[\"Comma\"] = 44] = \"Comma\";\n    Char[Char[\"Minus\"] = 45] = \"Minus\";\n    Char[Char[\"Dot\"] = 46] = \"Dot\";\n    Char[Char[\"Slash\"] = 47] = \"Slash\";\n    Char[Char[\"Semicolon\"] = 59] = \"Semicolon\";\n    Char[Char[\"Backtick\"] = 96] = \"Backtick\";\n    Char[Char[\"OpenBracket\"] = 91] = \"OpenBracket\";\n    Char[Char[\"Backslash\"] = 92] = \"Backslash\";\n    Char[Char[\"CloseBracket\"] = 93] = \"CloseBracket\";\n    Char[Char[\"Caret\"] = 94] = \"Caret\";\n    Char[Char[\"Underscore\"] = 95] = \"Underscore\";\n    Char[Char[\"OpenBrace\"] = 123] = \"OpenBrace\";\n    Char[Char[\"Bar\"] = 124] = \"Bar\";\n    Char[Char[\"CloseBrace\"] = 125] = \"CloseBrace\";\n    Char[Char[\"Colon\"] = 58] = \"Colon\";\n    Char[Char[\"LessThan\"] = 60] = \"LessThan\";\n    Char[Char[\"Equals\"] = 61] = \"Equals\";\n    Char[Char[\"GreaterThan\"] = 62] = \"GreaterThan\";\n    Char[Char[\"Question\"] = 63] = \"Question\";\n    Char[Char[\"Zero\"] = 48] = \"Zero\";\n    Char[Char[\"One\"] = 49] = \"One\";\n    Char[Char[\"Two\"] = 50] = \"Two\";\n    Char[Char[\"Three\"] = 51] = \"Three\";\n    Char[Char[\"Four\"] = 52] = \"Four\";\n    Char[Char[\"Five\"] = 53] = \"Five\";\n    Char[Char[\"Six\"] = 54] = \"Six\";\n    Char[Char[\"Seven\"] = 55] = \"Seven\";\n    Char[Char[\"Eight\"] = 56] = \"Eight\";\n    Char[Char[\"Nine\"] = 57] = \"Nine\";\n    Char[Char[\"UpperA\"] = 65] = \"UpperA\";\n    Char[Char[\"UpperB\"] = 66] = \"UpperB\";\n    Char[Char[\"UpperC\"] = 67] = \"UpperC\";\n    Char[Char[\"UpperD\"] = 68] = \"UpperD\";\n    Char[Char[\"UpperE\"] = 69] = \"UpperE\";\n    Char[Char[\"UpperF\"] = 70] = \"UpperF\";\n    Char[Char[\"UpperG\"] = 71] = \"UpperG\";\n    Char[Char[\"UpperH\"] = 72] = \"UpperH\";\n    Char[Char[\"UpperI\"] = 73] = \"UpperI\";\n    Char[Char[\"UpperJ\"] = 74] = \"UpperJ\";\n    Char[Char[\"UpperK\"] = 75] = \"UpperK\";\n    Char[Char[\"UpperL\"] = 76] = \"UpperL\";\n    Char[Char[\"UpperM\"] = 77] = \"UpperM\";\n    Char[Char[\"UpperN\"] = 78] = \"UpperN\";\n    Char[Char[\"UpperO\"] = 79] = \"UpperO\";\n    Char[Char[\"UpperP\"] = 80] = \"UpperP\";\n    Char[Char[\"UpperQ\"] = 81] = \"UpperQ\";\n    Char[Char[\"UpperR\"] = 82] = \"UpperR\";\n    Char[Char[\"UpperS\"] = 83] = \"UpperS\";\n    Char[Char[\"UpperT\"] = 84] = \"UpperT\";\n    Char[Char[\"UpperU\"] = 85] = \"UpperU\";\n    Char[Char[\"UpperV\"] = 86] = \"UpperV\";\n    Char[Char[\"UpperW\"] = 87] = \"UpperW\";\n    Char[Char[\"UpperX\"] = 88] = \"UpperX\";\n    Char[Char[\"UpperY\"] = 89] = \"UpperY\";\n    Char[Char[\"UpperZ\"] = 90] = \"UpperZ\";\n    Char[Char[\"LowerA\"] = 97] = \"LowerA\";\n    Char[Char[\"LowerB\"] = 98] = \"LowerB\";\n    Char[Char[\"LowerC\"] = 99] = \"LowerC\";\n    Char[Char[\"LowerD\"] = 100] = \"LowerD\";\n    Char[Char[\"LowerE\"] = 101] = \"LowerE\";\n    Char[Char[\"LowerF\"] = 102] = \"LowerF\";\n    Char[Char[\"LowerG\"] = 103] = \"LowerG\";\n    Char[Char[\"LowerH\"] = 104] = \"LowerH\";\n    Char[Char[\"LowerI\"] = 105] = \"LowerI\";\n    Char[Char[\"LowerJ\"] = 106] = \"LowerJ\";\n    Char[Char[\"LowerK\"] = 107] = \"LowerK\";\n    Char[Char[\"LowerL\"] = 108] = \"LowerL\";\n    Char[Char[\"LowerM\"] = 109] = \"LowerM\";\n    Char[Char[\"LowerN\"] = 110] = \"LowerN\";\n    Char[Char[\"LowerO\"] = 111] = \"LowerO\";\n    Char[Char[\"LowerP\"] = 112] = \"LowerP\";\n    Char[Char[\"LowerQ\"] = 113] = \"LowerQ\";\n    Char[Char[\"LowerR\"] = 114] = \"LowerR\";\n    Char[Char[\"LowerS\"] = 115] = \"LowerS\";\n    Char[Char[\"LowerT\"] = 116] = \"LowerT\";\n    Char[Char[\"LowerU\"] = 117] = \"LowerU\";\n    Char[Char[\"LowerV\"] = 118] = \"LowerV\";\n    Char[Char[\"LowerW\"] = 119] = \"LowerW\";\n    Char[Char[\"LowerX\"] = 120] = \"LowerX\";\n    Char[Char[\"LowerY\"] = 121] = \"LowerY\";\n    Char[Char[\"LowerZ\"] = 122] = \"LowerZ\";\n})(Char || (Char = {}));\nfunction unescapeCode(code) {\n    switch (code) {\n        case 98 /* LowerB */: return 8 /* Backspace */;\n        case 116 /* LowerT */: return 9 /* Tab */;\n        case 110 /* LowerN */: return 10 /* LineFeed */;\n        case 118 /* LowerV */: return 11 /* VerticalTab */;\n        case 102 /* LowerF */: return 12 /* FormFeed */;\n        case 114 /* LowerR */: return 13 /* CarriageReturn */;\n        case 34 /* DoubleQuote */: return 34 /* DoubleQuote */;\n        case 39 /* SingleQuote */: return 39 /* SingleQuote */;\n        case 92 /* Backslash */: return 92 /* Backslash */;\n        default: return code;\n    }\n}\nexport var Access;\n(function (Access) {\n    Access[Access[\"Reset\"] = 0] = \"Reset\";\n    Access[Access[\"Ancestor\"] = 511] = \"Ancestor\";\n    Access[Access[\"This\"] = 512] = \"This\";\n    Access[Access[\"Scope\"] = 1024] = \"Scope\";\n    Access[Access[\"Member\"] = 2048] = \"Member\";\n    Access[Access[\"Keyed\"] = 4096] = \"Keyed\";\n})(Access || (Access = {}));\nexport var Precedence;\n(function (Precedence) {\n    Precedence[Precedence[\"Variadic\"] = 61] = \"Variadic\";\n    Precedence[Precedence[\"Assign\"] = 62] = \"Assign\";\n    Precedence[Precedence[\"Conditional\"] = 63] = \"Conditional\";\n    Precedence[Precedence[\"LogicalOR\"] = 64] = \"LogicalOR\";\n    Precedence[Precedence[\"LogicalAND\"] = 128] = \"LogicalAND\";\n    Precedence[Precedence[\"Equality\"] = 192] = \"Equality\";\n    Precedence[Precedence[\"Relational\"] = 256] = \"Relational\";\n    Precedence[Precedence[\"Additive\"] = 320] = \"Additive\";\n    Precedence[Precedence[\"Multiplicative\"] = 384] = \"Multiplicative\";\n    Precedence[Precedence[\"Binary\"] = 448] = \"Binary\";\n    Precedence[Precedence[\"LeftHandSide\"] = 449] = \"LeftHandSide\";\n    Precedence[Precedence[\"Primary\"] = 450] = \"Primary\";\n    Precedence[Precedence[\"Unary\"] = 451] = \"Unary\";\n})(Precedence || (Precedence = {}));\nvar Token;\n(function (Token) {\n    Token[Token[\"EOF\"] = 1572864] = \"EOF\";\n    Token[Token[\"ExpressionTerminal\"] = 1048576] = \"ExpressionTerminal\";\n    Token[Token[\"AccessScopeTerminal\"] = 524288] = \"AccessScopeTerminal\";\n    Token[Token[\"ClosingToken\"] = 262144] = \"ClosingToken\";\n    Token[Token[\"OpeningToken\"] = 131072] = \"OpeningToken\";\n    Token[Token[\"BinaryOp\"] = 65536] = \"BinaryOp\";\n    Token[Token[\"UnaryOp\"] = 32768] = \"UnaryOp\";\n    Token[Token[\"LeftHandSide\"] = 16384] = \"LeftHandSide\";\n    Token[Token[\"StringOrNumericLiteral\"] = 12288] = \"StringOrNumericLiteral\";\n    Token[Token[\"NumericLiteral\"] = 8192] = \"NumericLiteral\";\n    Token[Token[\"StringLiteral\"] = 4096] = \"StringLiteral\";\n    Token[Token[\"IdentifierName\"] = 3072] = \"IdentifierName\";\n    Token[Token[\"Keyword\"] = 2048] = \"Keyword\";\n    Token[Token[\"Identifier\"] = 1024] = \"Identifier\";\n    Token[Token[\"Contextual\"] = 512] = \"Contextual\";\n    Token[Token[\"Precedence\"] = 448] = \"Precedence\";\n    Token[Token[\"Type\"] = 63] = \"Type\";\n    Token[Token[\"FalseKeyword\"] = 2048] = \"FalseKeyword\";\n    Token[Token[\"TrueKeyword\"] = 2049] = \"TrueKeyword\";\n    Token[Token[\"NullKeyword\"] = 2050] = \"NullKeyword\";\n    Token[Token[\"UndefinedKeyword\"] = 2051] = \"UndefinedKeyword\";\n    Token[Token[\"ThisScope\"] = 3076] = \"ThisScope\";\n    Token[Token[\"HostScope\"] = 3077] = \"HostScope\";\n    Token[Token[\"ParentScope\"] = 3078] = \"ParentScope\";\n    Token[Token[\"OpenParen\"] = 671751] = \"OpenParen\";\n    Token[Token[\"OpenBrace\"] = 131080] = \"OpenBrace\";\n    Token[Token[\"Dot\"] = 16393] = \"Dot\";\n    Token[Token[\"CloseBrace\"] = 1835018] = \"CloseBrace\";\n    Token[Token[\"CloseParen\"] = 1835019] = \"CloseParen\";\n    Token[Token[\"Comma\"] = 1572876] = \"Comma\";\n    Token[Token[\"OpenBracket\"] = 671757] = \"OpenBracket\";\n    Token[Token[\"CloseBracket\"] = 1835022] = \"CloseBracket\";\n    Token[Token[\"Colon\"] = 1572879] = \"Colon\";\n    Token[Token[\"Question\"] = 1572880] = \"Question\";\n    Token[Token[\"Ampersand\"] = 1572883] = \"Ampersand\";\n    Token[Token[\"Bar\"] = 1572884] = \"Bar\";\n    Token[Token[\"BarBar\"] = 1638549] = \"BarBar\";\n    Token[Token[\"AmpersandAmpersand\"] = 1638614] = \"AmpersandAmpersand\";\n    Token[Token[\"EqualsEquals\"] = 1638679] = \"EqualsEquals\";\n    Token[Token[\"ExclamationEquals\"] = 1638680] = \"ExclamationEquals\";\n    Token[Token[\"EqualsEqualsEquals\"] = 1638681] = \"EqualsEqualsEquals\";\n    Token[Token[\"ExclamationEqualsEquals\"] = 1638682] = \"ExclamationEqualsEquals\";\n    Token[Token[\"LessThan\"] = 1638747] = \"LessThan\";\n    Token[Token[\"GreaterThan\"] = 1638748] = \"GreaterThan\";\n    Token[Token[\"LessThanEquals\"] = 1638749] = \"LessThanEquals\";\n    Token[Token[\"GreaterThanEquals\"] = 1638750] = \"GreaterThanEquals\";\n    Token[Token[\"InKeyword\"] = 1640799] = \"InKeyword\";\n    Token[Token[\"InstanceOfKeyword\"] = 1640800] = \"InstanceOfKeyword\";\n    Token[Token[\"Plus\"] = 623009] = \"Plus\";\n    Token[Token[\"Minus\"] = 623010] = \"Minus\";\n    Token[Token[\"TypeofKeyword\"] = 34851] = \"TypeofKeyword\";\n    Token[Token[\"VoidKeyword\"] = 34852] = \"VoidKeyword\";\n    Token[Token[\"Asterisk\"] = 1638885] = \"Asterisk\";\n    Token[Token[\"Percent\"] = 1638886] = \"Percent\";\n    Token[Token[\"Slash\"] = 1638887] = \"Slash\";\n    Token[Token[\"Equals\"] = 1048616] = \"Equals\";\n    Token[Token[\"Exclamation\"] = 32809] = \"Exclamation\";\n    Token[Token[\"TemplateTail\"] = 540714] = \"TemplateTail\";\n    Token[Token[\"TemplateContinuation\"] = 540715] = \"TemplateContinuation\";\n    Token[Token[\"OfKeyword\"] = 1051180] = \"OfKeyword\";\n})(Token || (Token = {}));\nconst $false = PrimitiveLiteralExpression.$false;\nconst $true = PrimitiveLiteralExpression.$true;\nconst $null = PrimitiveLiteralExpression.$null;\nconst $undefined = PrimitiveLiteralExpression.$undefined;\nconst $this = AccessThisExpression.$this;\nconst $host = AccessThisExpression.$host;\nconst $parent = AccessThisExpression.$parent;\n/* eslint-disable @typescript-eslint/indent */\nexport var BindingType;\n(function (BindingType) {\n    BindingType[BindingType[\"None\"] = 0] = \"None\";\n    BindingType[BindingType[\"IgnoreCustomAttr\"] = 4096] = \"IgnoreCustomAttr\";\n    BindingType[BindingType[\"Interpolation\"] = 2048] = \"Interpolation\";\n    BindingType[BindingType[\"IsRef\"] = 5376] = \"IsRef\";\n    BindingType[BindingType[\"IsIterator\"] = 512] = \"IsIterator\";\n    BindingType[BindingType[\"IsCustom\"] = 256] = \"IsCustom\";\n    BindingType[BindingType[\"IsFunction\"] = 128] = \"IsFunction\";\n    BindingType[BindingType[\"IsEvent\"] = 64] = \"IsEvent\";\n    BindingType[BindingType[\"IsProperty\"] = 32] = \"IsProperty\";\n    BindingType[BindingType[\"IsCommand\"] = 16] = \"IsCommand\";\n    BindingType[BindingType[\"IsPropertyCommand\"] = 48] = \"IsPropertyCommand\";\n    BindingType[BindingType[\"IsEventCommand\"] = 80] = \"IsEventCommand\";\n    BindingType[BindingType[\"DelegationStrategyDelta\"] = 6] = \"DelegationStrategyDelta\";\n    BindingType[BindingType[\"Command\"] = 15] = \"Command\";\n    BindingType[BindingType[\"OneTimeCommand\"] = 49] = \"OneTimeCommand\";\n    BindingType[BindingType[\"ToViewCommand\"] = 50] = \"ToViewCommand\";\n    BindingType[BindingType[\"FromViewCommand\"] = 51] = \"FromViewCommand\";\n    BindingType[BindingType[\"TwoWayCommand\"] = 52] = \"TwoWayCommand\";\n    BindingType[BindingType[\"BindCommand\"] = 53] = \"BindCommand\";\n    BindingType[BindingType[\"TriggerCommand\"] = 4182] = \"TriggerCommand\";\n    BindingType[BindingType[\"CaptureCommand\"] = 4183] = \"CaptureCommand\";\n    BindingType[BindingType[\"DelegateCommand\"] = 4184] = \"DelegateCommand\";\n    BindingType[BindingType[\"CallCommand\"] = 153] = \"CallCommand\";\n    BindingType[BindingType[\"OptionsCommand\"] = 26] = \"OptionsCommand\";\n    BindingType[BindingType[\"ForCommand\"] = 539] = \"ForCommand\";\n    BindingType[BindingType[\"CustomCommand\"] = 284] = \"CustomCommand\";\n})(BindingType || (BindingType = {}));\n/* eslint-enable @typescript-eslint/indent */\n/** @internal */\nexport class ParserState {\n    constructor(input) {\n        this.input = input;\n        this.index = 0;\n        this.startIndex = 0;\n        this.lastIndex = 0;\n        this.currentToken = 1572864 /* EOF */;\n        this.tokenValue = '';\n        this.assignable = true;\n        this.length = input.length;\n        this.currentChar = input.charCodeAt(0);\n    }\n    get tokenRaw() {\n        return this.input.slice(this.startIndex, this.index);\n    }\n}\nconst $state = new ParserState('');\nvar SyntaxError;\n(function (SyntaxError) {\n    SyntaxError[SyntaxError[\"InvalidExpressionStart\"] = 100] = \"InvalidExpressionStart\";\n    SyntaxError[SyntaxError[\"UnconsumedToken\"] = 101] = \"UnconsumedToken\";\n    SyntaxError[SyntaxError[\"DoubleDot\"] = 102] = \"DoubleDot\";\n    SyntaxError[SyntaxError[\"InvalidMemberExpression\"] = 103] = \"InvalidMemberExpression\";\n    SyntaxError[SyntaxError[\"UnexpectedEndOfExpression\"] = 104] = \"UnexpectedEndOfExpression\";\n    SyntaxError[SyntaxError[\"ExpectedIdentifier\"] = 105] = \"ExpectedIdentifier\";\n    SyntaxError[SyntaxError[\"InvalidForDeclaration\"] = 106] = \"InvalidForDeclaration\";\n    SyntaxError[SyntaxError[\"InvalidObjectLiteralPropertyDefinition\"] = 107] = \"InvalidObjectLiteralPropertyDefinition\";\n    SyntaxError[SyntaxError[\"UnterminatedQuote\"] = 108] = \"UnterminatedQuote\";\n    SyntaxError[SyntaxError[\"UnterminatedTemplate\"] = 109] = \"UnterminatedTemplate\";\n    SyntaxError[SyntaxError[\"MissingExpectedToken\"] = 110] = \"MissingExpectedToken\";\n    SyntaxError[SyntaxError[\"UnexpectedCharacter\"] = 111] = \"UnexpectedCharacter\";\n    SyntaxError[SyntaxError[\"MissingValueConverter\"] = 112] = \"MissingValueConverter\";\n    SyntaxError[SyntaxError[\"MissingBindingBehavior\"] = 113] = \"MissingBindingBehavior\";\n})(SyntaxError || (SyntaxError = {}));\nvar SemanticError;\n(function (SemanticError) {\n    SemanticError[SemanticError[\"NotAssignable\"] = 150] = \"NotAssignable\";\n    SemanticError[SemanticError[\"UnexpectedForOf\"] = 151] = \"UnexpectedForOf\";\n})(SemanticError || (SemanticError = {}));\n/** @internal */\nexport function parseExpression(input, bindingType) {\n    $state.input = input;\n    $state.length = input.length;\n    $state.index = 0;\n    $state.currentChar = input.charCodeAt(0);\n    return parse($state, 0 /* Reset */, 61 /* Variadic */, bindingType === void 0 ? 53 /* BindCommand */ : bindingType);\n}\n/** @internal */\n// This is performance-critical code which follows a subset of the well-known ES spec.\n// Knowing the spec, or parsers in general, will help with understanding this code and it is therefore not the\n// single source of information for being able to figure it out.\n// It generally does not need to change unless the spec changes or spec violations are found, or optimization\n// opportunities are found (which would likely not fix these warnings in any case).\n// It's therefore not considered to have any tangible impact on the maintainability of the code base.\n// For reference, most of the parsing logic is based on: https://tc39.github.io/ecma262/#sec-ecmascript-language-expressions\n// eslint-disable-next-line max-lines-per-function\nexport function parse(state, access, minPrecedence, bindingType) {\n    if (bindingType === 284 /* CustomCommand */) {\n        return new CustomExpression(state.input);\n    }\n    if (state.index === 0) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseInterpolation(state);\n        }\n        nextToken(state);\n        if (state.currentToken & 1048576 /* ExpressionTerminal */) {\n            throw Reporter.error(100 /* InvalidExpressionStart */, { state });\n        }\n    }\n    state.assignable = 448 /* Binary */ > minPrecedence;\n    let result = void 0;\n    if (state.currentToken & 32768 /* UnaryOp */) {\n        /** parseUnaryExpression\n         * https://tc39.github.io/ecma262/#sec-unary-operators\n         *\n         * UnaryExpression :\n         * 1. LeftHandSideExpression\n         * 2. void UnaryExpression\n         * 3. typeof UnaryExpression\n         * 4. + UnaryExpression\n         * 5. - UnaryExpression\n         * 6. ! UnaryExpression\n         *\n         * IsValidAssignmentTarget\n         * 2,3,4,5,6 = false\n         * 1 = see parseLeftHandSideExpression\n         *\n         * Note: technically we should throw on ++ / -- / +++ / ---, but there's nothing to gain from that\n         */\n        const op = TokenValues[state.currentToken & 63 /* Type */];\n        nextToken(state);\n        result = new UnaryExpression(op, parse(state, access, 449 /* LeftHandSide */, bindingType));\n        state.assignable = false;\n    }\n    else {\n        /** parsePrimaryExpression\n         * https://tc39.github.io/ecma262/#sec-primary-expression\n         *\n         * PrimaryExpression :\n         * 1. this\n         * 2. IdentifierName\n         * 3. Literal\n         * 4. ArrayLiteralExpression\n         * 5. ObjectLiteralExpression\n         * 6. TemplateLiteral\n         * 7. ParenthesizedExpression\n         *\n         * Literal :\n         * NullLiteral\n         * BooleanLiteral\n         * NumericLiteral\n         * StringLiteral\n         *\n         * ParenthesizedExpression :\n         * ( AssignmentExpression )\n         *\n         * IsValidAssignmentTarget\n         * 1,3,4,5,6,7 = false\n         * 2 = true\n         */\n        primary: switch (state.currentToken) {\n            case 3078 /* ParentScope */: // $parent\n                state.assignable = false;\n                do {\n                    nextToken(state);\n                    access++; // ancestor\n                    if (consumeOpt(state, 16393 /* Dot */)) {\n                        if (state.currentToken === 16393 /* Dot */) {\n                            throw Reporter.error(102 /* DoubleDot */, { state });\n                        }\n                        else if (state.currentToken === 1572864 /* EOF */) {\n                            throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                        }\n                    }\n                    else if (state.currentToken & 524288 /* AccessScopeTerminal */) {\n                        const ancestor = access & 511 /* Ancestor */;\n                        result = ancestor === 0 ? $this : ancestor === 1 ? $parent : new AccessThisExpression(ancestor);\n                        access = 512 /* This */;\n                        break primary;\n                    }\n                    else {\n                        throw Reporter.error(103 /* InvalidMemberExpression */, { state });\n                    }\n                } while (state.currentToken === 3078 /* ParentScope */);\n            // falls through\n            case 1024 /* Identifier */: // identifier\n                if (bindingType & 512 /* IsIterator */) {\n                    result = new BindingIdentifier(state.tokenValue);\n                }\n                else {\n                    result = new AccessScopeExpression(state.tokenValue, access & 511 /* Ancestor */);\n                    access = 1024 /* Scope */;\n                }\n                state.assignable = true;\n                nextToken(state);\n                break;\n            case 3076 /* ThisScope */: // $this\n                state.assignable = false;\n                nextToken(state);\n                result = $this;\n                access = 512 /* This */;\n                break;\n            case 3077 /* HostScope */: // $host\n                state.assignable = false;\n                nextToken(state);\n                result = $host;\n                access = 512 /* This */;\n                break;\n            case 671751 /* OpenParen */: // parenthesized expression\n                nextToken(state);\n                result = parse(state, 0 /* Reset */, 62 /* Assign */, bindingType);\n                consume(state, 1835019 /* CloseParen */);\n                access = 0 /* Reset */;\n                break;\n            case 671757 /* OpenBracket */:\n                result = parseArrayLiteralExpression(state, access, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 131080 /* OpenBrace */:\n                result = parseObjectLiteralExpression(state, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 540714 /* TemplateTail */:\n                result = new TemplateExpression([state.tokenValue]);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 540715 /* TemplateContinuation */:\n                result = parseTemplate(state, access, bindingType, result, false);\n                access = 0 /* Reset */;\n                break;\n            case 4096 /* StringLiteral */:\n            case 8192 /* NumericLiteral */:\n                result = new PrimitiveLiteralExpression(state.tokenValue);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 2050 /* NullKeyword */:\n            case 2051 /* UndefinedKeyword */:\n            case 2049 /* TrueKeyword */:\n            case 2048 /* FalseKeyword */:\n                result = TokenValues[state.currentToken & 63 /* Type */];\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            default:\n                if (state.index >= state.length) {\n                    throw Reporter.error(104 /* UnexpectedEndOfExpression */, { state });\n                }\n                else {\n                    throw Reporter.error(101 /* UnconsumedToken */, { state });\n                }\n        }\n        if (bindingType & 512 /* IsIterator */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseForOfStatement(state, result);\n        }\n        if (449 /* LeftHandSide */ < minPrecedence) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        /** parseMemberExpression (Token.Dot, Token.OpenBracket, Token.TemplateContinuation)\n         * MemberExpression :\n         * 1. PrimaryExpression\n         * 2. MemberExpression [ AssignmentExpression ]\n         * 3. MemberExpression . IdentifierName\n         * 4. MemberExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,4 = false\n         * 2,3 = true\n         *\n         *\n         * parseCallExpression (Token.OpenParen)\n         * CallExpression :\n         * 1. MemberExpression Arguments\n         * 2. CallExpression Arguments\n         * 3. CallExpression [ AssignmentExpression ]\n         * 4. CallExpression . IdentifierName\n         * 5. CallExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,2,5 = false\n         * 3,4 = true\n         */\n        let name = state.tokenValue;\n        while ((state.currentToken & 16384 /* LeftHandSide */) > 0) {\n            const args = [];\n            let strings;\n            switch (state.currentToken) {\n                case 16393 /* Dot */:\n                    state.assignable = true;\n                    nextToken(state);\n                    if ((state.currentToken & 3072 /* IdentifierName */) === 0) {\n                        throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                    }\n                    name = state.tokenValue;\n                    nextToken(state);\n                    // Change $This to $Scope, change $Scope to $Member, keep $Member as-is, change $Keyed to $Member, disregard other flags\n                    access = ((access & (512 /* This */ | 1024 /* Scope */)) << 1) | (access & 2048 /* Member */) | ((access & 4096 /* Keyed */) >> 1);\n                    if (state.currentToken === 671751 /* OpenParen */) {\n                        if (access === 0 /* Reset */) { // if the left hand side is a literal, make sure we parse a CallMemberExpression\n                            access = 2048 /* Member */;\n                        }\n                        continue;\n                    }\n                    if (access & 1024 /* Scope */) {\n                        result = new AccessScopeExpression(name, result.ancestor, result === $host);\n                    }\n                    else { // if it's not $Scope, it's $Member\n                        result = new AccessMemberExpression(result, name);\n                    }\n                    continue;\n                case 671757 /* OpenBracket */:\n                    state.assignable = true;\n                    nextToken(state);\n                    access = 4096 /* Keyed */;\n                    result = new AccessKeyedExpression(result, parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                    consume(state, 1835022 /* CloseBracket */);\n                    break;\n                case 671751 /* OpenParen */:\n                    state.assignable = false;\n                    nextToken(state);\n                    while (state.currentToken !== 1835019 /* CloseParen */) {\n                        args.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                        if (!consumeOpt(state, 1572876 /* Comma */)) {\n                            break;\n                        }\n                    }\n                    consume(state, 1835019 /* CloseParen */);\n                    if (access & 1024 /* Scope */) {\n                        result = new CallScopeExpression(name, args, result.ancestor, result === $host);\n                    }\n                    else if (access & 2048 /* Member */) {\n                        result = new CallMemberExpression(result, name, args);\n                    }\n                    else {\n                        result = new CallFunctionExpression(result, args);\n                    }\n                    access = 0;\n                    break;\n                case 540714 /* TemplateTail */:\n                    state.assignable = false;\n                    strings = [state.tokenValue];\n                    result = new TaggedTemplateExpression(strings, strings, result);\n                    nextToken(state);\n                    break;\n                case 540715 /* TemplateContinuation */:\n                    result = parseTemplate(state, access, bindingType, result, true);\n                default:\n            }\n        }\n    }\n    if (448 /* Binary */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseBinaryExpression\n     * https://tc39.github.io/ecma262/#sec-multiplicative-operators\n     *\n     * MultiplicativeExpression : (local precedence 6)\n     * UnaryExpression\n     * MultiplicativeExpression * / % UnaryExpression\n     *\n     * AdditiveExpression : (local precedence 5)\n     * MultiplicativeExpression\n     * AdditiveExpression + - MultiplicativeExpression\n     *\n     * RelationalExpression : (local precedence 4)\n     * AdditiveExpression\n     * RelationalExpression < > <= >= instanceof in AdditiveExpression\n     *\n     * EqualityExpression : (local precedence 3)\n     * RelationalExpression\n     * EqualityExpression == != === !== RelationalExpression\n     *\n     * LogicalANDExpression : (local precedence 2)\n     * EqualityExpression\n     * LogicalANDExpression && EqualityExpression\n     *\n     * LogicalORExpression : (local precedence 1)\n     * LogicalANDExpression\n     * LogicalORExpression || LogicalANDExpression\n     */\n    while ((state.currentToken & 65536 /* BinaryOp */) > 0) {\n        const opToken = state.currentToken;\n        if ((opToken & 448 /* Precedence */) <= minPrecedence) {\n            break;\n        }\n        nextToken(state);\n        result = new BinaryExpression(TokenValues[opToken & 63 /* Type */], result, parse(state, access, opToken & 448 /* Precedence */, bindingType));\n        state.assignable = false;\n    }\n    if (63 /* Conditional */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /**\n     * parseConditionalExpression\n     * https://tc39.github.io/ecma262/#prod-ConditionalExpression\n     *\n     * ConditionalExpression :\n     * 1. BinaryExpression\n     * 2. BinaryExpression ? AssignmentExpression : AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1572880 /* Question */)) {\n        const yes = parse(state, access, 62 /* Assign */, bindingType);\n        consume(state, 1572879 /* Colon */);\n        result = new ConditionalExpression(result, yes, parse(state, access, 62 /* Assign */, bindingType));\n        state.assignable = false;\n    }\n    if (62 /* Assign */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseAssignmentExpression\n     * https://tc39.github.io/ecma262/#prod-AssignmentExpression\n     * Note: AssignmentExpression here is equivalent to ES Expression because we don't parse the comma operator\n     *\n     * AssignmentExpression :\n     * 1. ConditionalExpression\n     * 2. LeftHandSideExpression = AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1048616 /* Equals */)) {\n        if (!state.assignable) {\n            throw Reporter.error(150 /* NotAssignable */, { state });\n        }\n        result = new AssignExpression(result, parse(state, access, 62 /* Assign */, bindingType));\n    }\n    if (61 /* Variadic */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseValueConverter\n     */\n    while (consumeOpt(state, 1572884 /* Bar */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(112);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572879 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new ValueConverterExpression(result, name, args);\n    }\n    /** parseBindingBehavior\n     */\n    while (consumeOpt(state, 1572883 /* Ampersand */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(113);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572879 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new BindingBehaviorExpression(result, name, args);\n    }\n    if (state.currentToken !== 1572864 /* EOF */) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        if (state.tokenRaw === 'of') {\n            throw Reporter.error(151 /* UnexpectedForOf */, { state });\n        }\n        throw Reporter.error(101 /* UnconsumedToken */, { state });\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return result;\n}\n/**\n * parseArrayLiteralExpression\n * https://tc39.github.io/ecma262/#prod-ArrayLiteralExpression\n *\n * ArrayLiteralExpression :\n * [ Elision(opt) ]\n * [ ElementList ]\n * [ ElementList, Elision(opt) ]\n *\n * ElementList :\n * Elision(opt) AssignmentExpression\n * ElementList, Elision(opt) AssignmentExpression\n *\n * Elision :\n * ,\n * Elision ,\n */\nfunction parseArrayLiteralExpression(state, access, bindingType) {\n    nextToken(state);\n    const elements = new Array();\n    while (state.currentToken !== 1835022 /* CloseBracket */) {\n        if (consumeOpt(state, 1572876 /* Comma */)) {\n            elements.push($undefined);\n            if (state.currentToken === 1835022 /* CloseBracket */) {\n                break;\n            }\n        }\n        else {\n            elements.push(parse(state, access, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            if (consumeOpt(state, 1572876 /* Comma */)) {\n                if (state.currentToken === 1835022 /* CloseBracket */) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n    }\n    consume(state, 1835022 /* CloseBracket */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ArrayBindingPattern(elements);\n    }\n    else {\n        state.assignable = false;\n        return new ArrayLiteralExpression(elements);\n    }\n}\nfunction parseForOfStatement(state, result) {\n    if ((result.$kind & 65536 /* IsForDeclaration */) === 0) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    if (state.currentToken !== 1051180 /* OfKeyword */) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    nextToken(state);\n    const declaration = result;\n    const statement = parse(state, 0 /* Reset */, 61 /* Variadic */, 0 /* None */);\n    return new ForOfStatement(declaration, statement);\n}\n/**\n * parseObjectLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * ObjectLiteralExpression :\n * { }\n * { PropertyDefinitionList }\n *\n * PropertyDefinitionList :\n * PropertyDefinition\n * PropertyDefinitionList, PropertyDefinition\n *\n * PropertyDefinition :\n * IdentifierName\n * PropertyName : AssignmentExpression\n *\n * PropertyName :\n * IdentifierName\n * StringLiteral\n * NumericLiteral\n */\nfunction parseObjectLiteralExpression(state, bindingType) {\n    const keys = new Array();\n    const values = new Array();\n    nextToken(state);\n    while (state.currentToken !== 1835018 /* CloseBrace */) {\n        keys.push(state.tokenValue);\n        // Literal = mandatory colon\n        if (state.currentToken & 12288 /* StringOrNumericLiteral */) {\n            nextToken(state);\n            consume(state, 1572879 /* Colon */);\n            values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n        }\n        else if (state.currentToken & 3072 /* IdentifierName */) {\n            // IdentifierName = optional colon\n            const { currentChar, currentToken, index } = state;\n            nextToken(state);\n            if (consumeOpt(state, 1572879 /* Colon */)) {\n                values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            }\n            else {\n                // Shorthand\n                state.currentChar = currentChar;\n                state.currentToken = currentToken;\n                state.index = index;\n                values.push(parse(state, 0 /* Reset */, 450 /* Primary */, bindingType & ~512 /* IsIterator */));\n            }\n        }\n        else {\n            throw Reporter.error(107 /* InvalidObjectLiteralPropertyDefinition */, { state });\n        }\n        if (state.currentToken !== 1835018 /* CloseBrace */) {\n            consume(state, 1572876 /* Comma */);\n        }\n    }\n    consume(state, 1835018 /* CloseBrace */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ObjectBindingPattern(keys, values);\n    }\n    else {\n        state.assignable = false;\n        return new ObjectLiteralExpression(keys, values);\n    }\n}\nfunction parseInterpolation(state) {\n    const parts = [];\n    const expressions = [];\n    const length = state.length;\n    let result = '';\n    while (state.index < length) {\n        switch (state.currentChar) {\n            case 36 /* Dollar */:\n                if (state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                    parts.push(result);\n                    result = '';\n                    state.index += 2;\n                    state.currentChar = state.input.charCodeAt(state.index);\n                    nextToken(state);\n                    const expression = parse(state, 0 /* Reset */, 61 /* Variadic */, 2048 /* Interpolation */);\n                    expressions.push(expression);\n                    continue;\n                }\n                else {\n                    result += '$';\n                }\n                break;\n            case 92 /* Backslash */:\n                result += String.fromCharCode(unescapeCode(nextChar(state)));\n                break;\n            default:\n                result += String.fromCharCode(state.currentChar);\n        }\n        nextChar(state);\n    }\n    if (expressions.length) {\n        parts.push(result);\n        return new Interpolation(parts, expressions);\n    }\n    return null;\n}\n/**\n * parseTemplateLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * TemplateExpression :\n * NoSubstitutionTemplate\n * TemplateHead\n *\n * NoSubstitutionTemplate :\n * ` TemplateCharacters(opt) `\n *\n * TemplateHead :\n * ` TemplateCharacters(opt) ${\n *\n * TemplateSubstitutionTail :\n * TemplateMiddle\n * TemplateTail\n *\n * TemplateMiddle :\n * } TemplateCharacters(opt) ${\n *\n * TemplateTail :\n * } TemplateCharacters(opt) `\n *\n * TemplateCharacters :\n * TemplateCharacter TemplateCharacters(opt)\n *\n * TemplateCharacter :\n * $ [lookahead  {]\n * \\ EscapeSequence\n * SourceCharacter (but not one of ` or \\ or $)\n */\nfunction parseTemplate(state, access, bindingType, result, tagged) {\n    const cooked = [state.tokenValue];\n    // TODO: properly implement raw parts / decide whether we want this\n    consume(state, 540715 /* TemplateContinuation */);\n    const expressions = [parse(state, access, 62 /* Assign */, bindingType)];\n    while ((state.currentToken = scanTemplateTail(state)) !== 540714 /* TemplateTail */) {\n        cooked.push(state.tokenValue);\n        consume(state, 540715 /* TemplateContinuation */);\n        expressions.push(parse(state, access, 62 /* Assign */, bindingType));\n    }\n    cooked.push(state.tokenValue);\n    state.assignable = false;\n    if (tagged) {\n        nextToken(state);\n        return new TaggedTemplateExpression(cooked, cooked, result, expressions);\n    }\n    else {\n        nextToken(state);\n        return new TemplateExpression(cooked, expressions);\n    }\n}\nfunction nextToken(state) {\n    while (state.index < state.length) {\n        state.startIndex = state.index;\n        if ((state.currentToken = (CharScanners[state.currentChar](state))) != null) { // a null token means the character must be skipped\n            return;\n        }\n    }\n    state.currentToken = 1572864 /* EOF */;\n}\nfunction nextChar(state) {\n    return state.currentChar = state.input.charCodeAt(++state.index);\n}\nfunction scanIdentifier(state) {\n    // run to the next non-idPart\n    while (IdParts[nextChar(state)])\n        ;\n    const token = KeywordLookup[state.tokenValue = state.tokenRaw];\n    return token === undefined ? 1024 /* Identifier */ : token;\n}\nfunction scanNumber(state, isFloat) {\n    let char = state.currentChar;\n    if (isFloat === false) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n        if (char !== 46 /* Dot */) {\n            state.tokenValue = parseInt(state.tokenRaw, 10);\n            return 8192 /* NumericLiteral */;\n        }\n        // past this point it's always a float\n        char = nextChar(state);\n        if (state.index >= state.length) {\n            // unless the number ends with a dot - that behaves a little different in native ES expressions\n            // but in our AST that behavior has no effect because numbers are always stored in variables\n            state.tokenValue = parseInt(state.tokenRaw.slice(0, -1), 10);\n            return 8192 /* NumericLiteral */;\n        }\n    }\n    if (char <= 57 /* Nine */ && char >= 48 /* Zero */) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n    }\n    else {\n        state.currentChar = state.input.charCodeAt(--state.index);\n    }\n    state.tokenValue = parseFloat(state.tokenRaw);\n    return 8192 /* NumericLiteral */;\n}\nfunction scanString(state) {\n    const quote = state.currentChar;\n    nextChar(state); // Skip initial quote.\n    let unescaped = 0;\n    const buffer = new Array();\n    let marker = state.index;\n    while (state.currentChar !== quote) {\n        if (state.currentChar === 92 /* Backslash */) {\n            buffer.push(state.input.slice(marker, state.index));\n            nextChar(state);\n            unescaped = unescapeCode(state.currentChar);\n            nextChar(state);\n            buffer.push(String.fromCharCode(unescaped));\n            marker = state.index;\n        }\n        else if (state.index >= state.length) {\n            throw Reporter.error(108 /* UnterminatedQuote */, { state });\n        }\n        else {\n            nextChar(state);\n        }\n    }\n    const last = state.input.slice(marker, state.index);\n    nextChar(state); // Skip terminating quote.\n    // Compute the unescaped string value.\n    buffer.push(last);\n    const unescapedStr = buffer.join('');\n    state.tokenValue = unescapedStr;\n    return 4096 /* StringLiteral */;\n}\nfunction scanTemplate(state) {\n    let tail = true;\n    let result = '';\n    while (nextChar(state) !== 96 /* Backtick */) {\n        if (state.currentChar === 36 /* Dollar */) {\n            if ((state.index + 1) < state.length && state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                state.index++;\n                tail = false;\n                break;\n            }\n            else {\n                result += '$';\n            }\n        }\n        else if (state.currentChar === 92 /* Backslash */) {\n            result += String.fromCharCode(unescapeCode(nextChar(state)));\n        }\n        else {\n            if (state.index >= state.length) {\n                throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n            }\n            result += String.fromCharCode(state.currentChar);\n        }\n    }\n    nextChar(state);\n    state.tokenValue = result;\n    if (tail) {\n        return 540714 /* TemplateTail */;\n    }\n    return 540715 /* TemplateContinuation */;\n}\nfunction scanTemplateTail(state) {\n    if (state.index >= state.length) {\n        throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n    }\n    state.index--;\n    return scanTemplate(state);\n}\nfunction consumeOpt(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n        return true;\n    }\n    return false;\n}\nfunction consume(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n    }\n    else {\n        throw Reporter.error(110 /* MissingExpectedToken */, { state, expected: token });\n    }\n}\n/**\n * Array for mapping tokens to token values. The indices of the values\n * correspond to the token bits 0-38.\n * For this to work properly, the values in the array must be kept in\n * the same order as the token bits.\n * Usage: TokenValues[token & Token.Type]\n */\nconst TokenValues = [\n    $false, $true, $null, $undefined, '$this', '$host', '$parent',\n    '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"',\n    '&', '|', '||', '&&', '==', '!=', '===', '!==', '<', '>',\n    '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!',\n    540714 /* TemplateTail */, 540715 /* TemplateContinuation */,\n    'of'\n];\nconst KeywordLookup = Object.create(null);\nKeywordLookup.true = 2049 /* TrueKeyword */;\nKeywordLookup.null = 2050 /* NullKeyword */;\nKeywordLookup.false = 2048 /* FalseKeyword */;\nKeywordLookup.undefined = 2051 /* UndefinedKeyword */;\nKeywordLookup.$this = 3076 /* ThisScope */;\nKeywordLookup.$host = 3077 /* HostScope */;\nKeywordLookup.$parent = 3078 /* ParentScope */;\nKeywordLookup.in = 1640799 /* InKeyword */;\nKeywordLookup.instanceof = 1640800 /* InstanceOfKeyword */;\nKeywordLookup.typeof = 34851 /* TypeofKeyword */;\nKeywordLookup.void = 34852 /* VoidKeyword */;\nKeywordLookup.of = 1051180 /* OfKeyword */;\n/**\n * Ranges of code points in pairs of 2 (eg 0x41-0x5B, 0x61-0x7B, ...) where the second value is not inclusive (5-7 means 5 and 6)\n * Single values are denoted by the second value being a 0\n *\n * Copied from output generated with \"node build/generate-unicode.js\"\n *\n * See also: https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF\n */\nconst codes = {\n    /* [$0-9A-Za_a-z] */\n    AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n    IdStart: /* IdentifierStart */ [0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n    Digit: /* DecimalNumber */ [0x30, 0x3A],\n    Skip: /* Skippable */ [0, 0x21, 0x7F, 0xA1]\n};\n/**\n * Decompress the ranges into an array of numbers so that the char code\n * can be used as an index to the lookup\n */\nfunction decompress(lookup, $set, compressed, value) {\n    const rangeCount = compressed.length;\n    for (let i = 0; i < rangeCount; i += 2) {\n        const start = compressed[i];\n        let end = compressed[i + 1];\n        end = end > 0 ? end : start + 1;\n        if (lookup) {\n            lookup.fill(value, start, end);\n        }\n        if ($set) {\n            for (let ch = start; ch < end; ch++) {\n                $set.add(ch);\n            }\n        }\n    }\n}\n// CharFuncLookup functions\nfunction returnToken(token) {\n    return s => {\n        nextChar(s);\n        return token;\n    };\n}\nconst unexpectedCharacter = s => {\n    throw Reporter.error(111 /* UnexpectedCharacter */, { state: s });\n};\nunexpectedCharacter.notMapped = true;\n// ASCII IdentifierPart lookup\nconst AsciiIdParts = new Set();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n// IdentifierPart lookup\nconst IdParts = new Uint8Array(0xFFFF);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.IdStart, 1);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.Digit, 1);\n// Character scanning function lookup\nconst CharScanners = new Array(0xFFFF);\nCharScanners.fill(unexpectedCharacter, 0, 0xFFFF);\ndecompress(CharScanners, null, codes.Skip, s => {\n    nextChar(s);\n    return null;\n});\ndecompress(CharScanners, null, codes.IdStart, scanIdentifier);\ndecompress(CharScanners, null, codes.Digit, s => scanNumber(s, false));\nCharScanners[34 /* DoubleQuote */] =\n    CharScanners[39 /* SingleQuote */] = s => {\n        return scanString(s);\n    };\nCharScanners[96 /* Backtick */] = s => {\n    return scanTemplate(s);\n};\n// !, !=, !==\nCharScanners[33 /* Exclamation */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 32809 /* Exclamation */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638680 /* ExclamationEquals */;\n    }\n    nextChar(s);\n    return 1638682 /* ExclamationEqualsEquals */;\n};\n// =, ==, ===\nCharScanners[61 /* Equals */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1048616 /* Equals */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638679 /* EqualsEquals */;\n    }\n    nextChar(s);\n    return 1638681 /* EqualsEqualsEquals */;\n};\n// &, &&\nCharScanners[38 /* Ampersand */] = s => {\n    if (nextChar(s) !== 38 /* Ampersand */) {\n        return 1572883 /* Ampersand */;\n    }\n    nextChar(s);\n    return 1638614 /* AmpersandAmpersand */;\n};\n// |, ||\nCharScanners[124 /* Bar */] = s => {\n    if (nextChar(s) !== 124 /* Bar */) {\n        return 1572884 /* Bar */;\n    }\n    nextChar(s);\n    return 1638549 /* BarBar */;\n};\n// .\nCharScanners[46 /* Dot */] = s => {\n    if (nextChar(s) <= 57 /* Nine */ && s.currentChar >= 48 /* Zero */) {\n        return scanNumber(s, true);\n    }\n    return 16393 /* Dot */;\n};\n// <, <=\nCharScanners[60 /* LessThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638747 /* LessThan */;\n    }\n    nextChar(s);\n    return 1638749 /* LessThanEquals */;\n};\n// >, >=\nCharScanners[62 /* GreaterThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638748 /* GreaterThan */;\n    }\n    nextChar(s);\n    return 1638750 /* GreaterThanEquals */;\n};\nCharScanners[37 /* Percent */] = returnToken(1638886 /* Percent */);\nCharScanners[40 /* OpenParen */] = returnToken(671751 /* OpenParen */);\nCharScanners[41 /* CloseParen */] = returnToken(1835019 /* CloseParen */);\nCharScanners[42 /* Asterisk */] = returnToken(1638885 /* Asterisk */);\nCharScanners[43 /* Plus */] = returnToken(623009 /* Plus */);\nCharScanners[44 /* Comma */] = returnToken(1572876 /* Comma */);\nCharScanners[45 /* Minus */] = returnToken(623010 /* Minus */);\nCharScanners[47 /* Slash */] = returnToken(1638887 /* Slash */);\nCharScanners[58 /* Colon */] = returnToken(1572879 /* Colon */);\nCharScanners[63 /* Question */] = returnToken(1572880 /* Question */);\nCharScanners[91 /* OpenBracket */] = returnToken(671757 /* OpenBracket */);\nCharScanners[93 /* CloseBracket */] = returnToken(1835022 /* CloseBracket */);\nCharScanners[123 /* OpenBrace */] = returnToken(131080 /* OpenBrace */);\nCharScanners[125 /* CloseBrace */] = returnToken(1835018 /* CloseBrace */);\n//# sourceMappingURL=expression-parser.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator } from '@aurelia/kernel';\nimport { IScheduler, } from '@aurelia/scheduler';\nimport { BindingMode, } from '../flags';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { Interpolation } from './ast';\nimport { connectable, } from './connectable';\nconst { toView, oneTime } = BindingMode;\nconst queueTaskOptions = {\n    reusable: false,\n    preempt: true,\n};\nexport class MultiInterpolationBinding {\n    constructor(observerLocator, interpolation, target, targetProperty, mode, locator) {\n        this.observerLocator = observerLocator;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.locator = locator;\n        this.interceptor = this;\n        this.isBound = false;\n        this.$scope = void 0;\n        // Note: the child expressions of an Interpolation expression are full Aurelia expressions, meaning they may include\n        // value converters and binding behaviors.\n        // Each expression represents one ${interpolation}, and for each we create a child TextBinding unless there is only one,\n        // in which case the renderer will create the TextBinding directly\n        const expressions = interpolation.expressions;\n        const parts = this.parts = Array(expressions.length);\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            parts[i] = new InterpolationBinding(expressions[i], interpolation, target, targetProperty, mode, observerLocator, locator, i === 0);\n        }\n    }\n    $bind(flags, scope, hostScope) {\n        if (this.isBound) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.isBound = true;\n        this.$scope = scope;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$bind(flags, scope, hostScope);\n        }\n    }\n    $unbind(flags) {\n        if (!this.isBound) {\n            return;\n        }\n        this.isBound = false;\n        this.$scope = void 0;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$unbind(flags);\n        }\n    }\n    dispose() {\n        this.interceptor = (void 0);\n        this.interpolation = (void 0);\n        this.locator = (void 0);\n        this.target = (void 0);\n    }\n}\nlet InterpolationBinding = /** @class */ (() => {\n    let InterpolationBinding = class InterpolationBinding {\n        constructor(sourceExpression, interpolation, target, targetProperty, mode, observerLocator, locator, isFirst) {\n            this.sourceExpression = sourceExpression;\n            this.interpolation = interpolation;\n            this.target = target;\n            this.targetProperty = targetProperty;\n            this.mode = mode;\n            this.observerLocator = observerLocator;\n            this.locator = locator;\n            this.isFirst = isFirst;\n            this.interceptor = this;\n            this.$hostScope = null;\n            this.task = null;\n            this.isBound = false;\n            connectable.assignIdTo(this);\n            this.$scheduler = locator.get(IScheduler);\n            this.targetObserver = observerLocator.getAccessor(0 /* none */, target, targetProperty);\n        }\n        updateTarget(value, flags) {\n            this.targetObserver.setValue(value, flags | 8 /* updateTargetInstance */);\n        }\n        handleChange(_newValue, _previousValue, flags) {\n            var _a, _b;\n            if (!this.isBound) {\n                return;\n            }\n            const targetObserver = this.targetObserver;\n            // Alpha: during bind a simple strategy for bind is always flush immediately\n            // todo:\n            //  (1). determine whether this should be the behavior\n            //  (2). if not, then fix tests to reflect the changes/scheduler to properly yield all with aurelia.start().wait()\n            const shouldQueueFlush = (flags & 32 /* fromBind */) === 0 && (targetObserver.type & 64 /* Layout */) > 0;\n            const newValue = this.interpolation.evaluate(flags, this.$scope, this.$hostScope, this.locator);\n            const oldValue = targetObserver.getValue();\n            const interceptor = this.interceptor;\n            // todo(fred): maybe let the observer decides whether it updates\n            if (newValue !== oldValue) {\n                if (shouldQueueFlush) {\n                    flags |= 4096 /* noTargetObserverQueue */;\n                    (_a = this.task) === null || _a === void 0 ? void 0 : _a.cancel();\n                    (_b = targetObserver.task) === null || _b === void 0 ? void 0 : _b.cancel();\n                    targetObserver.task = this.task = this.$scheduler.queueRenderTask(() => {\n                        var _a, _b;\n                        (_b = (_a = targetObserver).flushChanges) === null || _b === void 0 ? void 0 : _b.call(_a, flags);\n                        this.task = targetObserver.task = null;\n                    }, queueTaskOptions);\n                }\n                interceptor.updateTarget(newValue, flags);\n            }\n            // todo: merge this with evaluate above\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.$hostScope, interceptor);\n                interceptor.unobserve(false);\n            }\n        }\n        $bind(flags, scope, hostScope) {\n            if (this.isBound) {\n                if (this.$scope === scope) {\n                    return;\n                }\n                this.interceptor.$unbind(flags);\n            }\n            this.isBound = true;\n            this.$scope = scope;\n            this.$hostScope = hostScope;\n            const sourceExpression = this.sourceExpression;\n            if (sourceExpression.hasBind) {\n                sourceExpression.bind(flags, scope, hostScope, this.interceptor);\n            }\n            const targetObserver = this.targetObserver;\n            const mode = this.mode;\n            if (mode !== BindingMode.oneTime && targetObserver.bind) {\n                targetObserver.bind(flags);\n            }\n            // since the interpolation already gets the whole value, we only need to let the first\n            // text binding do the update if there are multiple\n            if (this.isFirst) {\n                this.interceptor.updateTarget(this.interpolation.evaluate(flags, scope, hostScope, this.locator), flags);\n            }\n            if ((mode & toView) > 0) {\n                sourceExpression.connect(flags, scope, hostScope, this.interceptor);\n            }\n        }\n        $unbind(flags) {\n            if (!this.isBound) {\n                return;\n            }\n            this.isBound = false;\n            const sourceExpression = this.sourceExpression;\n            if (sourceExpression.hasUnbind) {\n                sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n            }\n            const targetObserver = this.targetObserver;\n            const task = this.task;\n            if (targetObserver.unbind) {\n                targetObserver.unbind(flags);\n            }\n            if (task != null) {\n                task.cancel();\n                if (task === targetObserver.task) {\n                    targetObserver.task = null;\n                }\n                this.task = null;\n            }\n            this.$scope = void 0;\n            this.interceptor.unobserve(true);\n        }\n        dispose() {\n            this.interceptor = (void 0);\n            this.sourceExpression = (void 0);\n            this.locator = (void 0);\n            this.targetObserver = (void 0);\n        }\n    };\n    InterpolationBinding = __decorate([\n        connectable(),\n        __metadata(\"design:paramtypes\", [Object, Interpolation, Object, String, Number, Object, Object, Boolean])\n    ], InterpolationBinding);\n    return InterpolationBinding;\n})();\nexport { InterpolationBinding };\n//# sourceMappingURL=interpolation-binding.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, } from '@aurelia/kernel';\nimport { ILifecycle, } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nlet LetBinding = /** @class */ (() => {\n    let LetBinding = class LetBinding {\n        constructor(sourceExpression, targetProperty, observerLocator, locator, toBindingContext = false) {\n            this.sourceExpression = sourceExpression;\n            this.targetProperty = targetProperty;\n            this.observerLocator = observerLocator;\n            this.locator = locator;\n            this.toBindingContext = toBindingContext;\n            this.interceptor = this;\n            this.isBound = false;\n            this.$scope = void 0;\n            this.$hostScope = null;\n            this.task = null;\n            this.target = null;\n            connectable.assignIdTo(this);\n            this.$lifecycle = locator.get(ILifecycle);\n        }\n        handleChange(_newValue, _previousValue, flags) {\n            if (!this.isBound) {\n                return;\n            }\n            if (flags & 8 /* updateTargetInstance */) {\n                const target = this.target;\n                const targetProperty = this.targetProperty;\n                const previousValue = target[targetProperty];\n                const newValue = this.sourceExpression.evaluate(flags, this.$scope, this.$hostScope, this.locator);\n                if (newValue !== previousValue) {\n                    target[targetProperty] = newValue;\n                }\n                return;\n            }\n            throw new Error('Unexpected handleChange context in LetBinding');\n        }\n        $bind(flags, scope, hostScope) {\n            if (this.isBound) {\n                if (this.$scope === scope) {\n                    return;\n                }\n                this.interceptor.$unbind(flags | 32 /* fromBind */);\n            }\n            this.$scope = scope;\n            this.$hostScope = hostScope;\n            this.target = (this.toBindingContext ? (hostScope !== null && hostScope !== void 0 ? hostScope : scope).bindingContext : (hostScope !== null && hostScope !== void 0 ? hostScope : scope).overrideContext);\n            const sourceExpression = this.sourceExpression;\n            if (sourceExpression.hasBind) {\n                sourceExpression.bind(flags, scope, hostScope, this.interceptor);\n            }\n            // sourceExpression might have been changed during bind\n            this.target[this.targetProperty] = this.sourceExpression.evaluate(flags | 32 /* fromBind */, scope, hostScope, this.locator);\n            this.sourceExpression.connect(flags, scope, hostScope, this.interceptor);\n            // add isBound flag and remove isBinding flag\n            this.isBound = true;\n        }\n        $unbind(flags) {\n            if (!this.isBound) {\n                return;\n            }\n            const sourceExpression = this.sourceExpression;\n            if (sourceExpression.hasUnbind) {\n                sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n            }\n            this.$scope = void 0;\n            this.interceptor.unobserve(true);\n            // remove isBound and isUnbinding flags\n            this.isBound = false;\n        }\n        dispose() {\n            this.interceptor = (void 0);\n            this.sourceExpression = (void 0);\n            this.locator = (void 0);\n            this.target = (void 0);\n        }\n    };\n    LetBinding = __decorate([\n        connectable(),\n        __metadata(\"design:paramtypes\", [Object, String, Object, Object, Boolean])\n    ], LetBinding);\n    return LetBinding;\n})();\nexport { LetBinding };\n//# sourceMappingURL=let-binding.js.map","export class RefBinding {\n    constructor(sourceExpression, target, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.locator = locator;\n        this.interceptor = this;\n        this.isBound = false;\n        this.$scope = void 0;\n        this.$hostScope = null;\n    }\n    $bind(flags, scope, hostScope) {\n        if (this.isBound) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 32 /* fromBind */);\n        }\n        this.$scope = scope;\n        this.$hostScope = hostScope;\n        if (this.sourceExpression.hasBind) {\n            this.sourceExpression.bind(flags, scope, hostScope, this);\n        }\n        this.sourceExpression.assign(flags | 16 /* updateSourceExpression */, this.$scope, hostScope, this.locator, this.target);\n        // add isBound flag and remove isBinding flag\n        this.isBound = true;\n    }\n    $unbind(flags) {\n        if (!this.isBound) {\n            return;\n        }\n        let sourceExpression = this.sourceExpression;\n        if (sourceExpression.evaluate(flags, this.$scope, this.$hostScope, this.locator) === this.target) {\n            sourceExpression.assign(flags, this.$scope, this.$hostScope, this.locator, null);\n        }\n        // source expression might have been modified durring assign, via a BB\n        sourceExpression = this.sourceExpression;\n        if (sourceExpression.hasUnbind) {\n            sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.isBound = false;\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n    dispose() {\n        this.interceptor = (void 0);\n        this.sourceExpression = (void 0);\n        this.locator = (void 0);\n        this.target = (void 0);\n    }\n}\n//# sourceMappingURL=ref-binding.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Reporter, PLATFORM } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { ProxyObserver } from './proxy-observer';\nimport { subscriberCollection } from './subscriber-collection';\nlet BindableObserver = /** @class */ (() => {\n    var BindableObserver_1;\n    let BindableObserver = BindableObserver_1 = class BindableObserver {\n        constructor(lifecycle, flags, obj, propertyKey, cbName, $set) {\n            this.lifecycle = lifecycle;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.$set = $set;\n            this.currentValue = void 0;\n            this.oldValue = void 0;\n            this.inBatch = false;\n            this.type = 4 /* Obj */;\n            let isProxy = false;\n            if (ProxyObserver.isProxy(obj)) {\n                isProxy = true;\n                obj.$observer.subscribe(this, propertyKey);\n                this.obj = obj.$raw;\n            }\n            this.callback = this.obj[cbName];\n            const propertyChangedCallback = this.propertyChangedCallback = this.obj.propertyChanged;\n            const hasPropertyChangedCallback = this.hasPropertyChangedCallback = typeof propertyChangedCallback === 'function';\n            const shouldInterceptSet = this.shouldInterceptSet = $set !== PLATFORM.noop;\n            // when user declare @bindable({ set })\n            // it's expected to work from the start,\n            // regardless where the assignment comes from: either direct view model assignment or from binding during render\n            // so if either getter/setter config is present, alter the accessor straight await\n            if (this.callback === void 0 && !hasPropertyChangedCallback && !shouldInterceptSet) {\n                this.observing = false;\n            }\n            else {\n                this.observing = true;\n                const currentValue = obj[propertyKey];\n                this.currentValue = shouldInterceptSet && currentValue !== void 0\n                    ? $set(currentValue)\n                    : currentValue;\n                if (!isProxy) {\n                    this.createGetterSetter();\n                }\n            }\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n        }\n        handleChange(newValue, oldValue, flags) {\n            this.setValue(newValue, flags);\n        }\n        getValue() {\n            return this.currentValue;\n        }\n        setValue(newValue, flags) {\n            if (this.shouldInterceptSet) {\n                newValue = this.$set(newValue);\n            }\n            if (this.observing) {\n                const currentValue = this.currentValue;\n                // eslint-disable-next-line compat/compat\n                if (Object.is(newValue, currentValue)) {\n                    return;\n                }\n                this.currentValue = newValue;\n                if (this.lifecycle.batch.depth === 0) {\n                    this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n                    if ((flags & 32 /* fromBind */) === 0 || (flags & 16 /* updateSourceExpression */) > 0) {\n                        const callback = this.callback;\n                        if (callback !== void 0) {\n                            callback.call(this.obj, newValue, currentValue, this.persistentFlags | flags);\n                        }\n                        if (this.hasPropertyChangedCallback) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            this.propertyChangedCallback.call(this.obj, this.propertyKey, newValue, currentValue, this.persistentFlags | flags);\n                        }\n                    }\n                }\n                else if (!this.inBatch) {\n                    this.inBatch = true;\n                    this.oldValue = currentValue;\n                    this.lifecycle.batch.add(this);\n                }\n            }\n            else {\n                // See SetterObserver.setValue for explanation\n                this.obj[this.propertyKey] = newValue;\n            }\n        }\n        subscribe(subscriber) {\n            if (this.observing === false) {\n                this.observing = true;\n                const currentValue = this.obj[this.propertyKey];\n                this.currentValue = this.shouldInterceptSet\n                    ? this.$set(currentValue)\n                    : currentValue;\n                this.createGetterSetter();\n            }\n            this.addSubscriber(subscriber);\n        }\n        createGetterSetter() {\n            if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                enumerable: true,\n                configurable: true,\n                get: () => this.currentValue,\n                set: (value) => {\n                    this.setValue(value, 0 /* none */);\n                }\n            })) {\n                Reporter.write(1, this.propertyKey, this.obj);\n            }\n        }\n    };\n    BindableObserver = BindableObserver_1 = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Number, Object, String, String, Function])\n    ], BindableObserver);\n    return BindableObserver;\n})();\nexport { BindableObserver };\n//# sourceMappingURL=bindable-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { BindingMode } from '../../flags';\nimport { bindingBehavior } from '../binding-behavior';\nexport class BindingModeBehavior {\n    constructor(mode) {\n        this.mode = mode;\n        this.originalModes = new WeakMap();\n    }\n    bind(flags, scope, binding) {\n        this.originalModes.set(binding, binding.mode);\n        binding.mode = this.mode;\n    }\n    unbind(flags, scope, binding) {\n        binding.mode = this.originalModes.get(binding);\n    }\n}\nlet OneTimeBindingBehavior = /** @class */ (() => {\n    let OneTimeBindingBehavior = class OneTimeBindingBehavior extends BindingModeBehavior {\n        constructor() {\n            super(BindingMode.oneTime);\n        }\n    };\n    OneTimeBindingBehavior = __decorate([\n        bindingBehavior('oneTime'),\n        __metadata(\"design:paramtypes\", [])\n    ], OneTimeBindingBehavior);\n    return OneTimeBindingBehavior;\n})();\nexport { OneTimeBindingBehavior };\nlet ToViewBindingBehavior = /** @class */ (() => {\n    let ToViewBindingBehavior = class ToViewBindingBehavior extends BindingModeBehavior {\n        constructor() {\n            super(BindingMode.toView);\n        }\n    };\n    ToViewBindingBehavior = __decorate([\n        bindingBehavior('toView'),\n        __metadata(\"design:paramtypes\", [])\n    ], ToViewBindingBehavior);\n    return ToViewBindingBehavior;\n})();\nexport { ToViewBindingBehavior };\nlet FromViewBindingBehavior = /** @class */ (() => {\n    let FromViewBindingBehavior = class FromViewBindingBehavior extends BindingModeBehavior {\n        constructor() {\n            super(BindingMode.fromView);\n        }\n    };\n    FromViewBindingBehavior = __decorate([\n        bindingBehavior('fromView'),\n        __metadata(\"design:paramtypes\", [])\n    ], FromViewBindingBehavior);\n    return FromViewBindingBehavior;\n})();\nexport { FromViewBindingBehavior };\nlet TwoWayBindingBehavior = /** @class */ (() => {\n    let TwoWayBindingBehavior = class TwoWayBindingBehavior extends BindingModeBehavior {\n        constructor() {\n            super(BindingMode.twoWay);\n        }\n    };\n    TwoWayBindingBehavior = __decorate([\n        bindingBehavior('twoWay'),\n        __metadata(\"design:paramtypes\", [])\n    ], TwoWayBindingBehavior);\n    return TwoWayBindingBehavior;\n})();\nexport { TwoWayBindingBehavior };\n//# sourceMappingURL=binding-mode.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler } from '@aurelia/scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet DebounceBindingBehavior = /** @class */ (() => {\n    let DebounceBindingBehavior = class DebounceBindingBehavior extends BindingInterceptor {\n        constructor(binding, expr) {\n            super(binding, expr);\n            this.opts = { delay: 0 };\n            this.firstArg = null;\n            this.task = null;\n            this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n            if (expr.args.length > 0) {\n                this.firstArg = expr.args[0];\n            }\n        }\n        callSource(args) {\n            this.queueTask(() => this.binding.callSource(args));\n            return void 0;\n        }\n        handleChange(newValue, previousValue, flags) {\n            this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n        }\n        queueTask(callback) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.taskQueue.queueTask(callback, this.opts);\n        }\n        $bind(flags, scope, hostScope) {\n            if (this.firstArg !== null) {\n                const delay = Number(this.firstArg.evaluate(flags, scope, hostScope, this.locator));\n                if (!isNaN(delay)) {\n                    this.opts.delay = delay;\n                }\n            }\n            this.binding.$bind(flags, scope, hostScope);\n        }\n    };\n    DebounceBindingBehavior = __decorate([\n        bindingBehavior('debounce'),\n        __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n    ], DebounceBindingBehavior);\n    return DebounceBindingBehavior;\n})();\nexport { DebounceBindingBehavior };\n//# sourceMappingURL=debounce.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { ISignaler } from '../../observation/signaler';\nimport { bindingBehavior } from '../binding-behavior';\nlet SignalBindingBehavior = /** @class */ (() => {\n    let SignalBindingBehavior = class SignalBindingBehavior {\n        constructor(signaler) {\n            this.signaler = signaler;\n        }\n        bind(flags, scope, binding, ...args) {\n            if (!binding.updateTarget) {\n                throw Reporter.error(11);\n            }\n            if (arguments.length === 4) {\n                const name = args[0];\n                this.signaler.addSignalListener(name, binding);\n                binding.signal = name;\n            }\n            else if (arguments.length > 4) {\n                const names = Array.prototype.slice.call(args.length + 3, 3);\n                let i = names.length;\n                while (i--) {\n                    const name = names[i];\n                    this.signaler.addSignalListener(name, binding);\n                }\n                binding.signal = names;\n            }\n            else {\n                throw Reporter.error(12);\n            }\n        }\n        unbind(flags, scope, binding) {\n            const name = binding.signal;\n            binding.signal = null;\n            if (Array.isArray(name)) {\n                const names = name;\n                let i = names.length;\n                while (i--) {\n                    this.signaler.removeSignalListener(names[i], binding);\n                }\n            }\n            else {\n                this.signaler.removeSignalListener(name, binding);\n            }\n        }\n    };\n    SignalBindingBehavior = __decorate([\n        bindingBehavior('signal'),\n        __param(0, ISignaler),\n        __metadata(\"design:paramtypes\", [Object])\n    ], SignalBindingBehavior);\n    return SignalBindingBehavior;\n})();\nexport { SignalBindingBehavior };\n//# sourceMappingURL=signals.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler, Now } from '@aurelia/scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet ThrottleBindingBehavior = /** @class */ (() => {\n    let ThrottleBindingBehavior = class ThrottleBindingBehavior extends BindingInterceptor {\n        constructor(binding, expr) {\n            super(binding, expr);\n            this.opts = { delay: 0 };\n            this.firstArg = null;\n            this.task = null;\n            this.lastCall = 0;\n            this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n            this.now = binding.locator.get(Now);\n            if (expr.args.length > 0) {\n                this.firstArg = expr.args[0];\n            }\n        }\n        callSource(args) {\n            this.queueTask(() => this.binding.callSource(args));\n            return void 0;\n        }\n        handleChange(newValue, previousValue, flags) {\n            this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n        }\n        queueTask(callback) {\n            const opts = this.opts;\n            const now = this.now;\n            const nextDelay = this.lastCall + opts.delay - now();\n            if (nextDelay > 0) {\n                if (this.task !== null) {\n                    this.task.cancel();\n                }\n                opts.delay = nextDelay;\n                this.task = this.taskQueue.queueTask(() => {\n                    this.lastCall = now();\n                    callback();\n                }, opts);\n            }\n            else {\n                this.lastCall = now();\n                callback();\n            }\n        }\n        $bind(flags, scope, hostScope) {\n            if (this.firstArg !== null) {\n                const delay = Number(this.firstArg.evaluate(flags, scope, hostScope, this.locator));\n                if (!isNaN(delay)) {\n                    this.opts.delay = delay;\n                }\n            }\n            this.binding.$bind(flags, scope, hostScope);\n        }\n    };\n    ThrottleBindingBehavior = __decorate([\n        bindingBehavior('throttle'),\n        __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n    ], ThrottleBindingBehavior);\n    return ThrottleBindingBehavior;\n})();\nexport { ThrottleBindingBehavior };\n//# sourceMappingURL=throttle.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { kebabCase, Metadata, Protocol, firstDefined, getPrototypeChain, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nexport function bindable(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @bindable\n            // Invocation with or w/o opts:\n            // - @bindable()\n            // - @bindable({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Bindable.name, BindableDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Bindable.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @bindable\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @bindable('bar')\n        // Direct call:\n        // - @bindable('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @bindable()\n    // - @bindable({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isBindableAnnotation(key) {\n    return key.startsWith(Bindable.name);\n}\nexport const Bindable = {\n    name: Protocol.annotation.keyFor('bindable'),\n    keyFrom(name) {\n        return `${Bindable.name}:${name}`;\n    },\n    from(...bindableLists) {\n        const bindables = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            bindables[name] = BindableDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            bindables[name] = def instanceof BindableDefinition ? def : BindableDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof BindableDefinition) {\n                bindables[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList[name]));\n            }\n        }\n        bindableLists.forEach(addList);\n        return bindables;\n    },\n    for(Type) {\n        let def;\n        const builder = {\n            add(configOrProp) {\n                let prop;\n                let config;\n                if (typeof configOrProp === 'string') {\n                    prop = configOrProp;\n                    config = { property: prop };\n                }\n                else {\n                    prop = configOrProp.property;\n                    config = configOrProp;\n                }\n                def = BindableDefinition.create(prop, config);\n                if (!Metadata.hasOwn(Bindable.name, Type, prop)) {\n                    Protocol.annotation.appendTo(Type, Bindable.keyFrom(prop));\n                }\n                Metadata.define(Bindable.name, def, Type, prop);\n                return builder;\n            },\n            mode(mode) {\n                def.mode = mode;\n                return builder;\n            },\n            callback(callback) {\n                def.callback = callback;\n                return builder;\n            },\n            attribute(attribute) {\n                def.attribute = attribute;\n                return builder;\n            },\n            primary() {\n                def.primary = true;\n                return builder;\n            },\n            set(setInterpreter) {\n                def.set = setInterpreter;\n                return builder;\n            }\n        };\n        return builder;\n    },\n    getAll(Type) {\n        const propStart = Bindable.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isBindableAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Bindable.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class BindableDefinition {\n    constructor(attribute, callback, mode, primary, property, set) {\n        this.attribute = attribute;\n        this.callback = callback;\n        this.mode = mode;\n        this.primary = primary;\n        this.property = property;\n        this.set = set;\n    }\n    static create(prop, def = {}) {\n        return new BindableDefinition(firstDefined(def.attribute, kebabCase(prop)), firstDefined(def.callback, `${prop}Changed`), firstDefined(def.mode, BindingMode.toView), firstDefined(def.primary, false), firstDefined(def.property, prop), firstDefined(def.set, PLATFORM.noop));\n    }\n}\n/* eslint-disable @typescript-eslint/no-unused-vars,spaced-comment */\n/**\n * This function serves two purposes:\n * - A playground for contributors to try their changes to the APIs.\n * - Cause the API surface to be properly type-checked and protected against accidental type regressions.\n *\n * It will be automatically removed by dead code elimination.\n */\nfunction apiTypeCheck() {\n    let Foo = /** @class */ (() => {\n        let Foo = \n        // > expected error - class decorator only accepts a string\n        //@bindable({})\n        class Foo {\n        };\n        __decorate([\n            bindable,\n            bindable(),\n            bindable({})\n            // > expected error - 'property' does not exist on decorator input object\n            //@bindable({ property: 'prop' })\n            ,\n            bindable({ mode: BindingMode.twoWay }),\n            bindable({ callback: 'propChanged' }),\n            bindable({ attribute: 'prop' }),\n            bindable({ primary: true }),\n            bindable({ set: value => String(value) }),\n            bindable({ set: value => Number(value) }),\n            bindable({\n                mode: BindingMode.twoWay,\n                callback: 'propChanged',\n                attribute: 'prop',\n                primary: true,\n                set: value => String(value)\n            }),\n            __metadata(\"design:type\", Object)\n        ], Foo.prototype, \"prop\", void 0);\n        Foo = __decorate([\n            bindable('prop')\n            // > expected error - class decorator only accepts a string\n            //@bindable({})\n        ], Foo);\n        return Foo;\n    })();\n    Bindable.for(Foo)\n        // > expected error - there is no add() function with only optional params on the fluent api\n        //.add()\n        // > expected error - 'property' is a required property on the fluent api\n        //.add({})\n        .add({ property: 'prop' })\n        .add({ property: 'prop', mode: BindingMode.twoWay })\n        .add({ property: 'prop', callback: 'propChanged' })\n        .add({ property: 'prop', attribute: 'prop' })\n        .add({ property: 'prop', primary: true })\n        .add({ property: 'prop', mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n        .add('prop')\n        // > expected error - the add() method that accepts an object literal does not return a fluent api\n        //.add({ property: 'prop' }).mode(BindingMode.twoWay)\n        //.add({ property: 'prop' }).callback('propChanged')\n        //.add({ property: 'prop' }).attribute('prop')\n        //.add({ property: 'prop' }).primary()\n        // > expected error - fluent api methods can only be invoked once per bindable\n        //.add('prop').mode(BindingMode.twoWay).mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').callback('propChanged') // etc\n        // > expected error - wrong invocation order\n        //.add('prop').callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').primary().mode(BindingMode.twoWay)  // etc\n        .add('prop').mode(BindingMode.twoWay)\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop').primary()\n        .add('prop').mode(BindingMode.twoWay).set((value) => Number(value))\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').set(value => Number(value))\n        .add('prop').callback('propChanged')\n        .add('prop').callback('propChanged').attribute('prop')\n        .add('prop').callback('propChanged').attribute('prop').primary()\n        .add('prop').attribute('prop')\n        .add('prop').attribute('prop').primary()\n        .add('prop').primary();\n}\n/* eslint-enable @typescript-eslint/no-unused-vars,spaced-comment */\n//# sourceMappingURL=bindable.js.map","import { Registration, Protocol, Metadata, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { HooksDefinition, registerAliases, } from '../definitions';\nimport { BindingMode, } from '../flags';\nimport { Bindable } from '../templating/bindable';\nexport function customAttribute(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(nameOrDef, target);\n    };\n}\nexport function templateController(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(typeof nameOrDef === 'string'\n            ? { isTemplateController: true, name: nameOrDef }\n            : { isTemplateController: true, ...nameOrDef }, target);\n    };\n}\nexport class CustomAttributeDefinition {\n    constructor(Type, name, aliases, key, defaultBindingMode, isTemplateController, bindables, strategy, hooks, noMultiBindings) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.defaultBindingMode = defaultBindingMode;\n        this.isTemplateController = isTemplateController;\n        this.bindables = bindables;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.noMultiBindings = noMultiBindings;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new CustomAttributeDefinition(Type, firstDefined(CustomAttribute.getAnnotation(Type, 'name'), name), mergeArrays(CustomAttribute.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), CustomAttribute.keyFrom(name), firstDefined(CustomAttribute.getAnnotation(Type, 'defaultBindingMode'), def.defaultBindingMode, Type.defaultBindingMode, BindingMode.toView), firstDefined(CustomAttribute.getAnnotation(Type, 'isTemplateController'), def.isTemplateController, Type.isTemplateController, false), Bindable.from(...Bindable.getAll(Type), CustomAttribute.getAnnotation(Type, 'bindables'), Type.bindables, def.bindables), firstDefined(CustomAttribute.getAnnotation(Type, 'strategy'), def.strategy, Type.strategy, 1 /* getterSetter */), firstDefined(CustomAttribute.getAnnotation(Type, 'hooks'), def.hooks, Type.hooks, new HooksDefinition(Type.prototype)), firstDefined(CustomAttribute.getAnnotation(Type, 'noMultiBindings'), def.noMultiBindings, Type.noMultiBindings, false));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, CustomAttribute, key, container);\n    }\n}\nexport const CustomAttribute = {\n    name: Protocol.resource.keyFor('custom-attribute'),\n    keyFrom(name) {\n        return `${CustomAttribute.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomAttribute.name, value);\n    },\n    for(node, name) {\n        return Metadata.getOwn(CustomAttribute.keyFrom(name), node);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomAttributeDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomAttribute.name, definition, definition.Type);\n        Metadata.define(CustomAttribute.name, definition, definition);\n        Protocol.resource.appendTo(Type, CustomAttribute.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomAttribute.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=custom-attribute.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nexport const INode = DI.createInterface('INode').noDefault();\nexport const IRenderLocation = DI.createInterface('IRenderLocation').noDefault();\nexport const IDOM = DI.createInterface('IDOM').noDefault();\nconst ni = function (...args) {\n    throw Reporter.error(1000); // TODO: create error code (not implemented exception)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n}; // this function doesn't need typing because it is never directly called\nconst niDOM = {\n    addEventListener: ni,\n    appendChild: ni,\n    cloneNode: ni,\n    convertToRenderLocation: ni,\n    createDocumentFragment: ni,\n    createNodeSequence: ni,\n    createElement: ni,\n    createCustomEvent: ni,\n    dispatchEvent: ni,\n    createNodeObserver: ni,\n    createTemplate: ni,\n    createTextNode: ni,\n    getEffectiveParentNode: ni,\n    setEffectiveParentNode: ni,\n    insertBefore: ni,\n    isMarker: ni,\n    isNodeInstance: ni,\n    isRenderLocation: ni,\n    makeTarget: ni,\n    registerElementResolver: ni,\n    remove: ni,\n    removeEventListener: ni,\n    setAttribute: ni\n};\nexport const DOM = {\n    ...niDOM,\n    scheduler: (void 0),\n    get isInitialized() {\n        return Reflect.get(this, '$initialized') === true;\n    },\n    initialize(dom) {\n        if (this.isInitialized) {\n            throw Reporter.error(1001); // TODO: create error code (already initialized, check isInitialized property and call destroy() if you want to assign a different dom)\n        }\n        const descriptors = {};\n        const protos = [dom];\n        let proto = Object.getPrototypeOf(dom);\n        while (proto && proto !== Object.prototype) {\n            protos.unshift(proto);\n            proto = Object.getPrototypeOf(proto);\n        }\n        for (proto of protos) {\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(proto));\n        }\n        const keys = [];\n        let key;\n        let descriptor;\n        for (key in descriptors) {\n            descriptor = descriptors[key];\n            if (descriptor.configurable && descriptor.writable) {\n                Reflect.defineProperty(this, key, descriptor);\n                keys.push(key);\n            }\n        }\n        Reflect.set(this, '$domKeys', keys);\n        Reflect.set(this, '$initialized', true);\n    },\n    destroy() {\n        if (!this.isInitialized) {\n            throw Reporter.error(1002); // TODO: create error code (already destroyed)\n        }\n        const keys = Reflect.get(this, '$domKeys');\n        keys.forEach(key => {\n            Reflect.deleteProperty(this, key);\n        });\n        Object.assign(this, niDOM);\n        Reflect.set(this, '$domKeys', PLATFORM.emptyArray);\n        Reflect.set(this, '$initialized', false);\n    }\n};\n// This is an implementation of INodeSequence that represents \"no DOM\" to render.\n// It's used in various places to avoid null and to encode\n// the explicit idea of \"no view\".\nconst emptySequence = {\n    isMounted: false,\n    isLinked: false,\n    next: void 0,\n    childNodes: PLATFORM.emptyArray,\n    firstChild: null,\n    lastChild: null,\n    findTargets() { return PLATFORM.emptyArray; },\n    insertBefore(refNode) { },\n    appendTo(parent) { },\n    remove() { },\n    addToLinked() { },\n    unlink() { },\n    link(next) { },\n};\nexport const NodeSequence = {\n    empty: emptySequence\n};\n//# sourceMappingURL=dom.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nclass FlagsTemplateController {\n    constructor(factory, location, flags) {\n        this.factory = factory;\n        this.flags = flags;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.setLocation(location, 1 /* insertBefore */);\n    }\n    afterAttach(initiator, parent, flags) {\n        const { $controller } = this;\n        return this.view.activate(initiator, $controller, flags | this.flags, $controller.scope, $controller.hostScope);\n    }\n    afterUnbind(initiator, parent, flags) {\n        return this.view.deactivate(initiator, this.$controller, flags);\n    }\n    onCancel(initiator, parent, flags) {\n        var _a;\n        (_a = this.view) === null || _a === void 0 ? void 0 : _a.cancel(initiator, this.$controller, flags);\n    }\n    dispose() {\n        this.view.dispose();\n        this.view = (void 0);\n    }\n    accept(visitor) {\n        var _a;\n        if (((_a = this.view) === null || _a === void 0 ? void 0 : _a.accept(visitor)) === true) {\n            return true;\n        }\n    }\n}\nlet InfrequentMutations = /** @class */ (() => {\n    let InfrequentMutations = class InfrequentMutations extends FlagsTemplateController {\n        constructor(factory, location) {\n            super(factory, location, 4096 /* noTargetObserverQueue */);\n        }\n    };\n    InfrequentMutations = __decorate([\n        templateController('infrequent-mutations'),\n        __param(0, IViewFactory), __param(1, IRenderLocation),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], InfrequentMutations);\n    return InfrequentMutations;\n})();\nexport { InfrequentMutations };\nlet FrequentMutations = /** @class */ (() => {\n    let FrequentMutations = class FrequentMutations extends FlagsTemplateController {\n        constructor(factory, location) {\n            super(factory, location, 8192 /* persistentTargetObserverQueue */);\n        }\n    };\n    FrequentMutations = __decorate([\n        templateController('frequent-mutations'),\n        __param(0, IViewFactory), __param(1, IRenderLocation),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], FrequentMutations);\n    return FrequentMutations;\n})();\nexport { FrequentMutations };\nlet ObserveShallow = /** @class */ (() => {\n    let ObserveShallow = class ObserveShallow extends FlagsTemplateController {\n        constructor(factory, location) {\n            super(factory, location, 2048 /* observeLeafPropertiesOnly */);\n        }\n    };\n    ObserveShallow = __decorate([\n        templateController('observe-shallow'),\n        __param(0, IViewFactory), __param(1, IRenderLocation),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], ObserveShallow);\n    return ObserveShallow;\n})();\nexport { ObserveShallow };\n//# sourceMappingURL=flags.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, onResolve } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet If = /** @class */ (() => {\n    let If = class If {\n        constructor(ifFactory, location) {\n            this.ifFactory = ifFactory;\n            this.location = location;\n            this.id = nextId('au$component');\n            this.elseFactory = void 0;\n            this.elseView = void 0;\n            this.ifView = void 0;\n            this.view = void 0;\n            this.value = false;\n        }\n        afterAttach(initiator, parent, flags) {\n            const view = this.view = this.updateView(this.value, flags);\n            if (view !== void 0) {\n                const { $controller } = this;\n                return view.activate(initiator, $controller, flags, $controller.scope, $controller.hostScope);\n            }\n        }\n        afterUnbind(initiator, parent, flags) {\n            if (this.view !== void 0) {\n                return this.view.deactivate(initiator, this.$controller, flags);\n            }\n        }\n        valueChanged(newValue, oldValue, flags) {\n            var _a;\n            const { $controller } = this;\n            if (!$controller.isActive) {\n                return;\n            }\n            const ret = onResolve((_a = this.view) === null || _a === void 0 ? void 0 : _a.deactivate(this.view, $controller, flags), () => {\n                const view = this.view = this.updateView(this.value, flags);\n                if (view !== void 0) {\n                    // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n                    return view.activate(view, $controller, flags, $controller.scope, $controller.hostScope);\n                }\n            });\n            if (ret instanceof Promise) {\n                ret.catch(err => { throw err; });\n            }\n        }\n        /** @internal */\n        updateView(value, flags) {\n            if (value) {\n                return this.ifView = this.ensureView(this.ifView, this.ifFactory, flags);\n            }\n            if (this.elseFactory != void 0) {\n                return this.elseView = this.ensureView(this.elseView, this.elseFactory, flags);\n            }\n            return void 0;\n        }\n        /** @internal */\n        ensureView(view, factory, flags) {\n            if (view === void 0) {\n                view = factory.create(flags);\n            }\n            view.setLocation(this.location, 1 /* insertBefore */);\n            return view;\n        }\n        onCancel(initiator, parent, flags) {\n            var _a;\n            (_a = this.view) === null || _a === void 0 ? void 0 : _a.cancel(initiator, this.$controller, flags);\n        }\n        dispose() {\n            if (this.ifView !== void 0) {\n                this.ifView.dispose();\n                this.ifView = void 0;\n            }\n            if (this.elseView !== void 0) {\n                this.elseView.dispose();\n                this.elseView = void 0;\n            }\n            this.view = void 0;\n        }\n        accept(visitor) {\n            var _a;\n            if (((_a = this.view) === null || _a === void 0 ? void 0 : _a.accept(visitor)) === true) {\n                return true;\n            }\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], If.prototype, \"value\", void 0);\n    If = __decorate([\n        templateController('if'),\n        __param(0, IViewFactory),\n        __param(1, IRenderLocation),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], If);\n    return If;\n})();\nexport { If };\nlet Else = /** @class */ (() => {\n    let Else = class Else {\n        constructor(factory) {\n            this.factory = factory;\n            this.id = nextId('au$component');\n        }\n        link(ifBehavior) {\n            if (ifBehavior instanceof If) {\n                ifBehavior.elseFactory = this.factory;\n            }\n            else if (ifBehavior.viewModel instanceof If) {\n                ifBehavior.viewModel.elseFactory = this.factory;\n            }\n            else {\n                throw new Error(`Unsupported IfBehavior`); // TODO: create error code\n            }\n        }\n    };\n    Else = __decorate([\n        templateController('else'),\n        __param(0, IViewFactory),\n        __metadata(\"design:paramtypes\", [Object])\n    ], Else);\n    return Else;\n})();\nexport { Else };\n//# sourceMappingURL=if.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { compareNumber, nextId, onResolve } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory, IController, } from '../../lifecycle';\nimport { applyMutationsToIndices, synchronizeIndices } from '../../observation/array-observer';\nimport { BindingContext, Scope } from '../../observation/binding-context';\nimport { getCollectionObserver } from '../../observation/observer-locator';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nfunction dispose(disposable) {\n    disposable.dispose();\n}\nlet Repeat = /** @class */ (() => {\n    let Repeat = class Repeat {\n        constructor(location, renderable, factory) {\n            this.location = location;\n            this.renderable = renderable;\n            this.factory = factory;\n            this.id = nextId('au$component');\n            this.hasPendingInstanceMutation = false;\n            this.observer = void 0;\n            this.views = [];\n            this.key = void 0;\n            this.normalizedItems = void 0;\n        }\n        beforeBind(initiator, parent, flags) {\n            this.checkCollectionObserver(flags);\n            const bindings = this.renderable.bindings;\n            let binding = (void 0);\n            for (let i = 0, ii = bindings.length; i < ii; ++i) {\n                binding = bindings[i];\n                if (binding.target.id === this.id && binding.targetProperty === 'items') {\n                    this.forOf = binding.sourceExpression;\n                    break;\n                }\n            }\n            this.local = this.forOf.declaration.evaluate(flags, this.$controller.scope, null, binding.locator);\n        }\n        afterAttach(initiator, parent, flags) {\n            this.normalizeToArray(flags);\n            return this.activateAllViews(initiator, flags);\n        }\n        afterUnbind(initiator, parent, flags) {\n            this.checkCollectionObserver(flags);\n            return this.deactivateAllViews(initiator, flags);\n        }\n        // called by SetterObserver\n        itemsChanged(flags) {\n            const { $controller } = this;\n            if (!$controller.isActive) {\n                return;\n            }\n            flags |= $controller.flags;\n            this.checkCollectionObserver(flags);\n            flags |= 8 /* updateTargetInstance */;\n            this.normalizeToArray(flags);\n            const ret = onResolve(this.deactivateAllViews(null, flags), () => {\n                // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n                return this.activateAllViews(null, flags);\n            });\n            if (ret instanceof Promise) {\n                ret.catch(err => { throw err; });\n            }\n        }\n        // called by a CollectionObserver\n        handleCollectionChange(indexMap, flags) {\n            const { $controller } = this;\n            if (!$controller.isActive) {\n                return;\n            }\n            flags |= $controller.flags;\n            flags |= 8 /* updateTargetInstance */;\n            this.normalizeToArray(flags);\n            if (indexMap === void 0) {\n                const ret = onResolve(this.deactivateAllViews(null, flags), () => {\n                    // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n                    return this.activateAllViews(null, flags);\n                });\n                if (ret instanceof Promise) {\n                    ret.catch(err => { throw err; });\n                }\n            }\n            else {\n                const oldLength = this.views.length;\n                applyMutationsToIndices(indexMap);\n                // first detach+unbind+(remove from array) the deleted view indices\n                if (indexMap.deletedItems.length > 0) {\n                    indexMap.deletedItems.sort(compareNumber);\n                    const ret = onResolve(this.deactivateAndRemoveViewsByKey(indexMap, flags), () => {\n                        // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add a variety of `if` integration tests\n                        return this.createAndActivateAndSortViewsByKey(oldLength, indexMap, flags);\n                    });\n                    if (ret instanceof Promise) {\n                        ret.catch(err => { throw err; });\n                    }\n                }\n                else {\n                    // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add integration tests\n                    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                    this.createAndActivateAndSortViewsByKey(oldLength, indexMap, flags);\n                }\n            }\n        }\n        // todo: subscribe to collection from inner expression\n        checkCollectionObserver(flags) {\n            const oldObserver = this.observer;\n            if ((flags & 64 /* fromUnbind */)) {\n                if (oldObserver !== void 0) {\n                    oldObserver.unsubscribeFromCollection(this);\n                }\n            }\n            else if (this.$controller.isActive) {\n                const newObserver = this.observer = getCollectionObserver(flags, this.$controller.lifecycle, this.items);\n                if (oldObserver !== newObserver && oldObserver) {\n                    oldObserver.unsubscribeFromCollection(this);\n                }\n                if (newObserver) {\n                    newObserver.subscribeToCollection(this);\n                }\n            }\n        }\n        normalizeToArray(flags) {\n            const items = this.items;\n            if (items instanceof Array) {\n                this.normalizedItems = items;\n                return;\n            }\n            const forOf = this.forOf;\n            if (forOf === void 0) {\n                return;\n            }\n            const normalizedItems = [];\n            this.forOf.iterate(flags, items, (arr, index, item) => {\n                normalizedItems[index] = item;\n            });\n            this.normalizedItems = normalizedItems;\n        }\n        activateAllViews(initiator, flags) {\n            let promises = void 0;\n            let ret;\n            let view;\n            let viewScope;\n            const { $controller, factory, local, location, items } = this;\n            const parentScope = $controller.scope;\n            const hostScope = $controller.hostScope;\n            const newLen = this.forOf.count(flags, items);\n            const views = this.views = Array(newLen);\n            this.forOf.iterate(flags, items, (arr, i, item) => {\n                view = views[i] = factory.create(flags);\n                view.setLocation(location, 1 /* insertBefore */);\n                view.nodes.unlink();\n                viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, item));\n                setContextualProperties(viewScope.overrideContext, i, newLen);\n                ret = view.activate(initiator !== null && initiator !== void 0 ? initiator : view, $controller, flags, viewScope, hostScope);\n                if (ret instanceof Promise) {\n                    (promises !== null && promises !== void 0 ? promises : (promises = [])).push(ret);\n                }\n            });\n            if (promises !== void 0) {\n                return promises.length === 1\n                    ? promises[0]\n                    : Promise.all(promises);\n            }\n        }\n        deactivateAllViews(initiator, flags) {\n            let promises = void 0;\n            let ret;\n            let view;\n            const { views, $controller } = this;\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                view = views[i];\n                view.release();\n                ret = view.deactivate(initiator !== null && initiator !== void 0 ? initiator : view, $controller, flags);\n                if (ret instanceof Promise) {\n                    (promises !== null && promises !== void 0 ? promises : (promises = [])).push(ret);\n                }\n            }\n            if (promises !== void 0) {\n                return promises.length === 1\n                    ? promises[0]\n                    : Promise.all(promises);\n            }\n        }\n        deactivateAndRemoveViewsByKey(indexMap, flags) {\n            let promises = void 0;\n            let ret;\n            let view;\n            const { $controller, views } = this;\n            const deleted = indexMap.deletedItems;\n            const deletedLen = deleted.length;\n            let i = 0;\n            for (; i < deletedLen; ++i) {\n                view = views[deleted[i]];\n                view.release();\n                ret = view.deactivate(view, $controller, flags);\n                if (ret instanceof Promise) {\n                    (promises !== null && promises !== void 0 ? promises : (promises = [])).push(ret);\n                }\n            }\n            i = 0;\n            let j = 0;\n            for (; i < deletedLen; ++i) {\n                j = deleted[i] - i;\n                views.splice(j, 1);\n            }\n            if (promises !== void 0) {\n                return promises.length === 1\n                    ? promises[0]\n                    : Promise.all(promises);\n            }\n        }\n        createAndActivateAndSortViewsByKey(oldLength, indexMap, flags) {\n            var _a;\n            let promises = void 0;\n            let ret;\n            let view;\n            let viewScope;\n            const { $controller, factory, local, normalizedItems, location, views } = this;\n            const mapLen = indexMap.length;\n            for (let i = 0; i < mapLen; ++i) {\n                if (indexMap[i] === -2) {\n                    view = factory.create(flags);\n                    views.splice(i, 0, view);\n                }\n            }\n            if (views.length !== mapLen) {\n                // TODO: create error code and use reporter with more informative message\n                throw new Error(`viewsLen=${views.length}, mapLen=${mapLen}`);\n            }\n            const parentScope = $controller.scope;\n            const hostScope = $controller.hostScope;\n            const newLen = indexMap.length;\n            synchronizeIndices(views, indexMap);\n            // this algorithm retrieves the indices of the longest increasing subsequence of items in the repeater\n            // the items on those indices are not moved; this minimizes the number of DOM operations that need to be performed\n            const seq = longestIncreasingSubsequence(indexMap);\n            const seqLen = seq.length;\n            let next;\n            let j = seqLen - 1;\n            let i = newLen - 1;\n            for (; i >= 0; --i) {\n                view = views[i];\n                next = views[i + 1];\n                view.nodes.link((_a = next === null || next === void 0 ? void 0 : next.nodes) !== null && _a !== void 0 ? _a : location);\n                if (indexMap[i] === -2) {\n                    viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, normalizedItems[i]));\n                    setContextualProperties(viewScope.overrideContext, i, newLen);\n                    view.setLocation(location, 1 /* insertBefore */);\n                    ret = view.activate(view, $controller, flags, viewScope, hostScope);\n                    if (ret instanceof Promise) {\n                        (promises !== null && promises !== void 0 ? promises : (promises = [])).push(ret);\n                    }\n                }\n                else if (j < 0 || seqLen === 1 || i !== seq[j]) {\n                    setContextualProperties(view.scope.overrideContext, i, newLen);\n                    view.nodes.insertBefore(view.location);\n                }\n                else {\n                    if (oldLength !== newLen) {\n                        setContextualProperties(view.scope.overrideContext, i, newLen);\n                    }\n                    --j;\n                }\n            }\n            if (promises !== void 0) {\n                return promises.length === 1\n                    ? promises[0]\n                    : Promise.all(promises);\n            }\n        }\n        onCancel(initiator, parent, flags) {\n            this.views.forEach(view => {\n                view.cancel(initiator, this.$controller, flags);\n            });\n        }\n        dispose() {\n            this.views.forEach(dispose);\n            this.views = (void 0);\n        }\n        accept(visitor) {\n            const { views } = this;\n            if (views !== void 0) {\n                for (let i = 0, ii = views.length; i < ii; ++i) {\n                    if (views[i].accept(visitor) === true) {\n                        return true;\n                    }\n                }\n            }\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], Repeat.prototype, \"items\", void 0);\n    Repeat = __decorate([\n        templateController('repeat'),\n        __param(0, IRenderLocation),\n        __param(1, IController),\n        __param(2, IViewFactory),\n        __metadata(\"design:paramtypes\", [Object, Object, Object])\n    ], Repeat);\n    return Repeat;\n})();\nexport { Repeat };\nlet maxLen = 16;\nlet prevIndices = new Int32Array(maxLen);\nlet tailIndices = new Int32Array(maxLen);\n// Based on inferno's lis_algorithm @ https://github.com/infernojs/inferno/blob/master/packages/inferno/src/DOM/patching.ts#L732\n// with some tweaks to make it just a bit faster + account for IndexMap (and some names changes for readability)\n/** @internal */\nexport function longestIncreasingSubsequence(indexMap) {\n    const len = indexMap.length;\n    if (len > maxLen) {\n        maxLen = len;\n        prevIndices = new Int32Array(len);\n        tailIndices = new Int32Array(len);\n    }\n    let cursor = 0;\n    let cur = 0;\n    let prev = 0;\n    let i = 0;\n    let j = 0;\n    let low = 0;\n    let high = 0;\n    let mid = 0;\n    for (; i < len; i++) {\n        cur = indexMap[i];\n        if (cur !== -2) {\n            j = prevIndices[cursor];\n            prev = indexMap[j];\n            if (prev !== -2 && prev < cur) {\n                tailIndices[i] = j;\n                prevIndices[++cursor] = i;\n                continue;\n            }\n            low = 0;\n            high = cursor;\n            while (low < high) {\n                mid = (low + high) >> 1;\n                prev = indexMap[prevIndices[mid]];\n                if (prev !== -2 && prev < cur) {\n                    low = mid + 1;\n                }\n                else {\n                    high = mid;\n                }\n            }\n            prev = indexMap[prevIndices[low]];\n            if (cur < prev || prev === -2) {\n                if (low > 0) {\n                    tailIndices[i] = prevIndices[low - 1];\n                }\n                prevIndices[low] = i;\n            }\n        }\n    }\n    i = ++cursor;\n    const result = new Int32Array(i);\n    cur = prevIndices[cursor - 1];\n    while (cursor-- > 0) {\n        result[cursor] = cur;\n        cur = tailIndices[cur];\n    }\n    while (i-- > 0)\n        prevIndices[i] = 0;\n    return result;\n}\nfunction setContextualProperties(oc, index, length) {\n    const isFirst = index === 0;\n    const isLast = index === length - 1;\n    const isEven = index % 2 === 0;\n    oc.$index = index;\n    oc.$first = isFirst;\n    oc.$last = isLast;\n    oc.$middle = !isFirst && !isLast;\n    oc.$even = isEven;\n    oc.$odd = !isEven;\n    oc.$length = length;\n}\n//# sourceMappingURL=repeat.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nimport { bindable } from '../../templating/bindable';\nimport { Scope } from '../../observation/binding-context';\nlet With = /** @class */ (() => {\n    let With = class With {\n        constructor(factory, location) {\n            this.factory = factory;\n            this.location = location;\n            this.id = nextId('au$component');\n            this.id = nextId('au$component');\n            this.view = this.factory.create();\n            this.view.setLocation(location, 1 /* insertBefore */);\n        }\n        valueChanged(newValue, oldValue, flags) {\n            if (this.$controller.isActive) {\n                // TODO(fkleuver): add logic to the controller that ensures correct handling of race conditions and add integration tests\n                // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                this.activateView(this.view, 32 /* fromBind */);\n            }\n        }\n        afterAttach(initiator, parent, flags) {\n            return this.activateView(initiator, flags);\n        }\n        afterUnbind(initiator, parent, flags) {\n            return this.view.deactivate(initiator, this.$controller, flags);\n        }\n        activateView(initiator, flags) {\n            const { $controller, value } = this;\n            const scope = Scope.fromParent(flags, $controller.scope, value === void 0 ? {} : value);\n            return this.view.activate(initiator, $controller, flags, scope, $controller.hostScope);\n        }\n        onCancel(initiator, parent, flags) {\n            var _a;\n            (_a = this.view) === null || _a === void 0 ? void 0 : _a.cancel(initiator, this.$controller, flags);\n        }\n        dispose() {\n            this.view.dispose();\n            this.view = (void 0);\n        }\n        accept(visitor) {\n            var _a;\n            if (((_a = this.view) === null || _a === void 0 ? void 0 : _a.accept(visitor)) === true) {\n                return true;\n            }\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], With.prototype, \"value\", void 0);\n    With = __decorate([\n        templateController('with'),\n        __param(0, IViewFactory),\n        __param(1, IRenderLocation),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], With);\n    return With;\n})();\nexport { With };\n//# sourceMappingURL=with.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n/* eslint-disable @typescript-eslint/no-use-before-define */\nimport { Protocol, Metadata, firstDefined, getPrototypeChain, Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '../resources/custom-element';\nimport { subscriberCollection } from '../observation/subscriber-collection';\nexport function children(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @children\n            // Invocation with or w/o opts:\n            // - @children()\n            // - @children({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Children.name, ChildrenDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Children.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @children\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @children('bar')\n        // Direct call:\n        // - @children('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @children()\n    // - @children({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isChildrenObserverAnnotation(key) {\n    return key.startsWith(Children.name);\n}\nexport const Children = {\n    name: Protocol.annotation.keyFor('children-observer'),\n    keyFrom(name) {\n        return `${Children.name}:${name}`;\n    },\n    from(...childrenObserverLists) {\n        const childrenObservers = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            childrenObservers[name] = ChildrenDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            childrenObservers[name] = ChildrenDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof ChildrenDefinition) {\n                childrenObservers[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList));\n            }\n        }\n        childrenObserverLists.forEach(addList);\n        return childrenObservers;\n    },\n    getAll(Type) {\n        const propStart = Children.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isChildrenObserverAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Children.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class ChildrenDefinition {\n    constructor(callback, property, options, query, filter, map) {\n        this.callback = callback;\n        this.property = property;\n        this.options = options;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n    }\n    static create(prop, def = {}) {\n        return new ChildrenDefinition(firstDefined(def.callback, `${prop}Changed`), firstDefined(def.property, prop), def.options, def.query, def.filter, def.map);\n    }\n}\n/** @internal */\nlet ChildrenObserver = /** @class */ (() => {\n    var ChildrenObserver_1;\n    let ChildrenObserver = ChildrenObserver_1 = class ChildrenObserver {\n        constructor(controller, obj, flags, propertyKey, cbName, query = defaultChildQuery, filter = defaultChildFilter, map = defaultChildMap, options) {\n            this.controller = controller;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.query = query;\n            this.filter = filter;\n            this.map = map;\n            this.options = options;\n            this.observing = false;\n            this.children = (void 0);\n            this.callback = obj[cbName];\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            this.createGetterSetter();\n        }\n        getValue() {\n            this.tryStartObserving();\n            return this.children;\n        }\n        setValue(newValue) { }\n        subscribe(subscriber) {\n            this.tryStartObserving();\n            this.addSubscriber(subscriber);\n        }\n        tryStartObserving() {\n            if (!this.observing) {\n                this.observing = true;\n                const projector = this.controller.projector;\n                this.children = filterChildren(projector, this.query, this.filter, this.map);\n                projector.subscribeToChildrenChange(() => { this.onChildrenChanged(); }, this.options);\n            }\n        }\n        onChildrenChanged() {\n            this.children = filterChildren(this.controller.projector, this.query, this.filter, this.map);\n            if (this.callback !== void 0) {\n                this.callback.call(this.obj);\n            }\n            this.callSubscribers(this.children, undefined, this.persistentFlags | 8 /* updateTargetInstance */);\n        }\n        createGetterSetter() {\n            if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                enumerable: true,\n                configurable: true,\n                get: () => this.getValue(),\n                set: () => { return; },\n            })) {\n                Reporter.write(1, this.propertyKey, this.obj);\n            }\n        }\n    };\n    ChildrenObserver = ChildrenObserver_1 = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Object, Number, String, String, Object, Object, Object, Object])\n    ], ChildrenObserver);\n    return ChildrenObserver;\n})();\nexport { ChildrenObserver };\nfunction defaultChildQuery(projector) {\n    return projector.children;\n}\nfunction defaultChildFilter(node, controller, viewModel) {\n    return !!viewModel;\n}\nfunction defaultChildMap(node, controller, viewModel) {\n    return viewModel;\n}\nconst forOpts = { optional: true };\n/** @internal */\nexport function filterChildren(projector, query, filter, map) {\n    var _a;\n    const nodes = query(projector);\n    const children = [];\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n        const node = nodes[i];\n        const controller = CustomElement.for(node, forOpts);\n        const viewModel = (_a = controller === null || controller === void 0 ? void 0 : controller.viewModel) !== null && _a !== void 0 ? _a : null;\n        if (filter(node, controller, viewModel)) {\n            children.push(map(node, controller, viewModel));\n        }\n    }\n    return children;\n}\n//# sourceMappingURL=children.js.map","import { DI, Registration, Protocol, Metadata, mergeArrays, fromDefinitionOrDefault, pascalCase, fromAnnotationOrTypeOrDefault, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases, HooksDefinition, } from '../definitions';\nimport { DOM } from '../dom';\nimport { Bindable } from '../templating/bindable';\nimport { Children } from '../templating/children';\nexport function customElement(nameOrDef) {\n    return function (target) {\n        return CustomElement.define(nameOrDef, target);\n    };\n}\nexport function useShadowDOM(targetOrOptions) {\n    if (targetOrOptions === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', { mode: 'open' });\n        };\n    }\n    if (typeof targetOrOptions !== 'function') {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', targetOrOptions);\n        };\n    }\n    CustomElement.annotate(targetOrOptions, 'shadowOptions', { mode: 'open' });\n}\nexport function containerless(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'containerless', true);\n        };\n    }\n    CustomElement.annotate(target, 'containerless', true);\n}\nexport function strict(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'isStrictBinding', true);\n        };\n    }\n    CustomElement.annotate(target, 'isStrictBinding', true);\n}\nconst definitionLookup = new WeakMap();\nexport class CustomElementDefinition {\n    constructor(Type, name, aliases, key, cache, template, instructions, dependencies, injectable, needsCompile, surrogates, bindables, childrenObservers, containerless, isStrictBinding, shadowOptions, hasSlots, strategy, hooks, enhance, projectionsMap) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.cache = cache;\n        this.template = template;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.injectable = injectable;\n        this.needsCompile = needsCompile;\n        this.surrogates = surrogates;\n        this.bindables = bindables;\n        this.childrenObservers = childrenObservers;\n        this.containerless = containerless;\n        this.isStrictBinding = isStrictBinding;\n        this.shadowOptions = shadowOptions;\n        this.hasSlots = hasSlots;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.enhance = enhance;\n        this.projectionsMap = projectionsMap;\n    }\n    static create(nameOrDef, Type = null) {\n        if (Type === null) {\n            const def = nameOrDef;\n            if (typeof def === 'string') {\n                throw new Error(`Cannot create a custom element definition with only a name and no type: ${nameOrDef}`);\n            }\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const name = fromDefinitionOrDefault('name', def, CustomElement.generateName);\n            if (typeof def.Type === 'function') {\n                // This needs to be a clone (it will usually be the compiler calling this signature)\n                // TODO: we need to make sure it's documented that passing in the type via the definition (while passing in null\n                // as the \"Type\" parameter) effectively skips type analysis, so it should only be used this way for cloning purposes.\n                Type = def.Type;\n            }\n            else {\n                Type = CustomElement.generateType(pascalCase(name));\n            }\n            return new CustomElementDefinition(Type, name, mergeArrays(def.aliases), fromDefinitionOrDefault('key', def, () => CustomElement.keyFrom(name)), fromDefinitionOrDefault('cache', def, () => 0), fromDefinitionOrDefault('template', def, () => null), mergeArrays(def.instructions), mergeArrays(def.dependencies), fromDefinitionOrDefault('injectable', def, () => null), fromDefinitionOrDefault('needsCompile', def, () => true), mergeArrays(def.surrogates), Bindable.from(def.bindables), Children.from(def.childrenObservers), fromDefinitionOrDefault('containerless', def, () => false), fromDefinitionOrDefault('isStrictBinding', def, () => false), fromDefinitionOrDefault('shadowOptions', def, () => null), fromDefinitionOrDefault('hasSlots', def, () => false), fromDefinitionOrDefault('strategy', def, () => 1 /* getterSetter */), fromDefinitionOrDefault('hooks', def, () => HooksDefinition.none), fromDefinitionOrDefault('enhance', def, () => false), fromDefinitionOrDefault('projectionsMap', def, () => new Map()));\n        }\n        // If a type is passed in, we ignore the Type property on the definition if it exists.\n        // TODO: document this behavior\n        if (typeof nameOrDef === 'string') {\n            return new CustomElementDefinition(Type, nameOrDef, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), Type.aliases), CustomElement.keyFrom(nameOrDef), fromAnnotationOrTypeOrDefault('cache', Type, () => 0), fromAnnotationOrTypeOrDefault('template', Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), Type.dependencies), fromAnnotationOrTypeOrDefault('injectable', Type, () => null), fromAnnotationOrTypeOrDefault('needsCompile', Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers), fromAnnotationOrTypeOrDefault('containerless', Type, () => false), fromAnnotationOrTypeOrDefault('isStrictBinding', Type, () => false), fromAnnotationOrTypeOrDefault('shadowOptions', Type, () => null), fromAnnotationOrTypeOrDefault('hasSlots', Type, () => false), fromAnnotationOrTypeOrDefault('strategy', Type, () => 1 /* getterSetter */), \n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), fromAnnotationOrTypeOrDefault('enhance', Type, () => false), fromAnnotationOrTypeOrDefault('projectionsMap', Type, () => new Map()));\n        }\n        // This is the typical default behavior, e.g. from regular CustomElement.define invocations or from @customElement deco\n        // The ViewValueConverter also uses this signature and passes in a definition where everything except for the 'hooks'\n        // property needs to be copied. So we have that exception for 'hooks', but we may need to revisit that default behavior\n        // if this turns out to be too opinionated.\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const name = fromDefinitionOrDefault('name', nameOrDef, CustomElement.generateName);\n        return new CustomElementDefinition(Type, name, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), nameOrDef.aliases, Type.aliases), CustomElement.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('cache', nameOrDef, Type, () => 0), fromAnnotationOrDefinitionOrTypeOrDefault('template', nameOrDef, Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), nameOrDef.instructions, Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), nameOrDef.dependencies, Type.dependencies), fromAnnotationOrDefinitionOrTypeOrDefault('injectable', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('needsCompile', nameOrDef, Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), nameOrDef.surrogates, Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables, nameOrDef.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers, nameOrDef.childrenObservers), fromAnnotationOrDefinitionOrTypeOrDefault('containerless', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('isStrictBinding', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('shadowOptions', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('hasSlots', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', nameOrDef, Type, () => 1 /* getterSetter */), \n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), fromAnnotationOrDefinitionOrTypeOrDefault('enhance', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('projectionsMap', nameOrDef, Type, () => new Map()));\n    }\n    static getOrCreate(partialDefinition) {\n        if (partialDefinition instanceof CustomElementDefinition) {\n            return partialDefinition;\n        }\n        if (definitionLookup.has(partialDefinition)) {\n            return definitionLookup.get(partialDefinition);\n        }\n        const definition = CustomElementDefinition.create(partialDefinition);\n        definitionLookup.set(partialDefinition, definition);\n        // Make sure the full definition can be retrieved from dynamically created classes as well\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        return definition;\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, CustomElement, key, container);\n    }\n}\nconst defaultForOpts = {\n    name: undefined,\n    searchParents: false,\n    optional: false,\n};\nexport const CustomElement = {\n    name: Protocol.resource.keyFor('custom-element'),\n    keyFrom(name) {\n        return `${CustomElement.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomElement.name, value);\n    },\n    for(node, opts = defaultForOpts) {\n        if (opts.name === void 0 && opts.searchParents !== true) {\n            const controller = Metadata.getOwn(CustomElement.name, node);\n            if (controller === void 0) {\n                if (opts.optional === true) {\n                    return null;\n                }\n                throw new Error(`The provided node is not a custom element or containerless host.`);\n            }\n            return controller;\n        }\n        if (opts.name !== void 0) {\n            if (opts.searchParents !== true) {\n                const controller = Metadata.getOwn(CustomElement.name, node);\n                if (controller === void 0) {\n                    throw new Error(`The provided node is not a custom element or containerless host.`);\n                }\n                if (controller.is(opts.name)) {\n                    return controller;\n                }\n                return (void 0);\n            }\n            let cur = node;\n            let foundAController = false;\n            while (cur !== null) {\n                const controller = Metadata.getOwn(CustomElement.name, cur);\n                if (controller !== void 0) {\n                    foundAController = true;\n                    if (controller.is(opts.name)) {\n                        return controller;\n                    }\n                }\n                cur = DOM.getEffectiveParentNode(cur);\n            }\n            if (foundAController) {\n                return (void 0);\n            }\n            throw new Error(`The provided node does does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.`);\n        }\n        let cur = node;\n        while (cur !== null) {\n            const controller = Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        throw new Error(`The provided node does does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.`);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomElementDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        Metadata.define(CustomElement.name, definition, definition);\n        Protocol.resource.appendTo(definition.Type, CustomElement.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomElement.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n    generateName: (function () {\n        let id = 0;\n        return function () {\n            return `unnamed-${++id}`;\n        };\n    })(),\n    createInjectable() {\n        const $injectable = function (target, property, index) {\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = $injectable;\n            return target;\n        };\n        $injectable.register = function (container) {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            return {\n                resolve(container, requestor) {\n                    if (requestor.has($injectable, true)) {\n                        return requestor.get($injectable);\n                    }\n                    else {\n                        return null;\n                    }\n                },\n            };\n        };\n        return $injectable;\n    },\n    generateType: (function () {\n        const nameDescriptor = {\n            value: '',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const defaultProto = {};\n        return function (name, proto = defaultProto) {\n            // Anonymous class ensures that minification cannot cause unintended side-effects, and keeps the class\n            // looking similarly from the outside (when inspected via debugger, etc).\n            const Type = class {\n            };\n            // Define the name property so that Type.name can be used by end users / plugin authors if they really need to,\n            // even when minified.\n            nameDescriptor.value = name;\n            Reflect.defineProperty(Type, 'name', nameDescriptor);\n            // Assign anything from the prototype that was passed in\n            if (proto !== defaultProto) {\n                Object.assign(Type.prototype, proto);\n            }\n            return Type;\n        };\n    })(),\n};\nexport const IProjectorLocator = DI.createInterface('IProjectorLocator').noDefault();\n//# sourceMappingURL=custom-element.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration } from '@aurelia/kernel';\nimport { IRenderLocation, } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { customElement } from '../custom-element';\nexport const IProjections = DI.createInterface(\"IProjections\").noDefault();\nexport var AuSlotContentType;\n(function (AuSlotContentType) {\n    AuSlotContentType[AuSlotContentType[\"Projection\"] = 0] = \"Projection\";\n    AuSlotContentType[AuSlotContentType[\"Fallback\"] = 1] = \"Fallback\";\n})(AuSlotContentType || (AuSlotContentType = {}));\nexport class SlotInfo {\n    constructor(name, type, projectionContext) {\n        this.name = name;\n        this.type = type;\n        this.projectionContext = projectionContext;\n    }\n}\nexport class ProjectionContext {\n    constructor(content, scope = null) {\n        this.content = content;\n        this.scope = scope;\n    }\n}\nexport class RegisteredProjections {\n    constructor(scope, projections) {\n        this.scope = scope;\n        this.projections = projections;\n    }\n}\nexport const IProjectionProvider = DI.createInterface('IProjectionProvider').noDefault();\nconst projectionMap = new WeakMap();\nexport class ProjectionProvider {\n    static register(container) {\n        return container.register(Registration.singleton(IProjectionProvider, ProjectionProvider));\n    }\n    registerProjections(projections, scope) {\n        for (const [instruction, $projections] of projections) {\n            projectionMap.set(instruction, new RegisteredProjections(scope, $projections));\n        }\n    }\n    getProjectionFor(instruction) {\n        var _a;\n        return (_a = projectionMap.get(instruction)) !== null && _a !== void 0 ? _a : null;\n    }\n}\nlet AuSlot = /** @class */ (() => {\n    let AuSlot = class AuSlot {\n        constructor(factory, location) {\n            this.factory = factory;\n            this.hostScope = null;\n            this.view = factory.create();\n            this.view.setLocation(location, 1 /* insertBefore */);\n            this.isProjection = factory.contentType === AuSlotContentType.Projection;\n            this.outerScope = factory.projectionScope;\n        }\n        beforeBind(initiator, parent, flags) {\n            this.hostScope = this.$controller.scope.parentScope;\n        }\n        afterAttach(initiator, parent, flags) {\n            var _a;\n            const { $controller } = this;\n            return this.view.activate(initiator, $controller, flags, (_a = this.outerScope) !== null && _a !== void 0 ? _a : this.hostScope, this.hostScope);\n        }\n        afterUnbind(initiator, parent, flags) {\n            return this.view.deactivate(initiator, this.$controller, flags);\n        }\n        onCancel(initiator, parent, flags) {\n            this.view.cancel(initiator, this.$controller, flags);\n        }\n        dispose() {\n            this.view.dispose();\n            this.view = (void 0);\n        }\n        accept(visitor) {\n            var _a;\n            if (((_a = this.view) === null || _a === void 0 ? void 0 : _a.accept(visitor)) === true) {\n                return true;\n            }\n        }\n    };\n    AuSlot = __decorate([\n        customElement({ name: 'au-slot', template: null, containerless: true }),\n        __param(0, IViewFactory),\n        __param(1, IRenderLocation),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], AuSlot);\n    return AuSlot;\n})();\nexport { AuSlot };\n//# sourceMappingURL=au-slot.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI } from '@aurelia/kernel';\nimport { valueConverter } from '../value-converter';\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\nexport const ISanitizer = DI.createInterface('ISanitizer').withDefault(x => x.singleton(class {\n    sanitize(input) {\n        return input.replace(SCRIPT_REGEX, '');\n    }\n}));\n/**\n * Simple html sanitization converter to preserve whitelisted elements and attributes on a bound property containing html.\n */\nlet SanitizeValueConverter = /** @class */ (() => {\n    let SanitizeValueConverter = class SanitizeValueConverter {\n        constructor(sanitizer) {\n            this.sanitizer = sanitizer;\n        }\n        /**\n         * Process the provided markup that flows to the view.\n         *\n         * @param untrustedMarkup - The untrusted markup to be sanitized.\n         */\n        toView(untrustedMarkup) {\n            if (untrustedMarkup == null) {\n                return null;\n            }\n            return this.sanitizer.sanitize(untrustedMarkup);\n        }\n    };\n    SanitizeValueConverter = __decorate([\n        valueConverter('sanitize'),\n        __param(0, ISanitizer),\n        __metadata(\"design:paramtypes\", [Object])\n    ], SanitizeValueConverter);\n    return SanitizeValueConverter;\n})();\nexport { SanitizeValueConverter };\n//# sourceMappingURL=sanitize.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, Registration, Metadata, DI, } from '@aurelia/kernel';\nimport { CallBinding } from './binding/call-binding';\nimport { IExpressionParser } from './binding/expression-parser';\nimport { InterpolationBinding, MultiInterpolationBinding } from './binding/interpolation-binding';\nimport { LetBinding } from './binding/let-binding';\nimport { PropertyBinding } from './binding/property-binding';\nimport { RefBinding } from './binding/ref-binding';\nimport { BindingMode } from './flags';\nimport { ILifecycle, } from './lifecycle';\nimport { IObserverLocator } from './observation/observer-locator';\nimport { CustomAttribute, } from './resources/custom-attribute';\nimport { CustomElement, } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nimport { getRenderContext } from './templating/render-context';\nimport { BindingBehaviorExpression } from './binding/ast';\nimport { BindingBehaviorFactory } from './resources/binding-behavior';\nexport const ITemplateCompiler = DI.createInterface('ITemplateCompiler').noDefault();\nexport const IInstructionRenderer = DI.createInterface('IInstructionRenderer').noDefault();\nexport const IRenderer = DI.createInterface('IRenderer').noDefault();\nexport function instructionRenderer(instructionType) {\n    return function decorator(target) {\n        // wrap the constructor to set the instructionType to the instance (for better performance than when set on the prototype)\n        const decoratedTarget = function (...args) {\n            const instance = new target(...args);\n            instance.instructionType = instructionType;\n            return instance;\n        };\n        // make sure we register the decorated constructor with DI\n        decoratedTarget.register = function register(container) {\n            Registration.singleton(IInstructionRenderer, decoratedTarget).register(container);\n        };\n        // copy over any metadata such as annotations (set by preceding decorators) as well as static properties set by the user\n        // also copy the name, to be less confusing to users (so they can still use constructor.name for whatever reason)\n        // the length (number of ctor arguments) is copied for the same reason\n        const metadataKeys = Metadata.getOwnKeys(target);\n        for (const key of metadataKeys) {\n            Metadata.define(key, Metadata.getOwn(key, target), decoratedTarget);\n        }\n        const ownProperties = Object.getOwnPropertyDescriptors(target);\n        Object.keys(ownProperties).filter(prop => prop !== 'prototype').forEach(prop => {\n            Reflect.defineProperty(decoratedTarget, prop, ownProperties[prop]);\n        });\n        return decoratedTarget;\n    };\n}\n/* @internal */\nlet Renderer = /** @class */ (() => {\n    let Renderer = class Renderer {\n        constructor(instructionRenderers) {\n            const record = this.instructionRenderers = {};\n            instructionRenderers.forEach(item => {\n                // Binding the functions to the renderer instances and calling the functions directly,\n                // prevents the `render` call sites from going megamorphic.\n                // Consumes slightly more memory but significantly less CPU.\n                record[item.instructionType] = item.render.bind(item);\n            });\n        }\n        static register(container) {\n            return Registration.singleton(IRenderer, this).register(container);\n        }\n        render(flags, context, controller, targets, definition, host) {\n            const targetInstructions = definition.instructions;\n            if (targets.length !== targetInstructions.length) {\n                throw new Error(`The compiled template is not aligned with the render instructions. There are ${targets.length} targets and ${targetInstructions.length} instructions.`);\n            }\n            for (let i = 0, ii = targets.length; i < ii; ++i) {\n                this.renderInstructions(\n                /* flags        */ flags, \n                /* context      */ context, \n                /* instructions */ targetInstructions[i], \n                /* controller   */ controller, \n                /* target       */ targets[i]);\n            }\n            if (host !== void 0 && host !== null) {\n                this.renderInstructions(\n                /* flags        */ flags, \n                /* context      */ context, \n                /* instructions */ definition.surrogates, \n                /* controller   */ controller, \n                /* target       */ host);\n            }\n        }\n        renderInstructions(flags, context, instructions, controller, target) {\n            const instructionRenderers = this.instructionRenderers;\n            let current;\n            for (let i = 0, ii = instructions.length; i < ii; ++i) {\n                current = instructions[i];\n                instructionRenderers[current.type](flags, context, controller, target, current);\n            }\n        }\n    };\n    Renderer = __decorate([\n        __param(0, all(IInstructionRenderer)),\n        __metadata(\"design:paramtypes\", [Array])\n    ], Renderer);\n    return Renderer;\n})();\nexport { Renderer };\nexport function ensureExpression(parser, srcOrExpr, bindingType) {\n    if (typeof srcOrExpr === 'string') {\n        return parser.parse(srcOrExpr, bindingType);\n    }\n    return srcOrExpr;\n}\nexport function getTarget(potentialTarget) {\n    if (potentialTarget.bindingContext !== void 0) {\n        return potentialTarget.bindingContext;\n    }\n    return potentialTarget;\n}\nexport function getRefTarget(refHost, refTargetName) {\n    if (refTargetName === 'element') {\n        return refHost;\n    }\n    switch (refTargetName) {\n        case 'controller':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost);\n        case 'view':\n            // todo: returns node sequences for fun?\n            throw new Error('Not supported API');\n        case 'view-model':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost).viewModel;\n        default: {\n            const caController = CustomAttribute.for(refHost, refTargetName);\n            if (caController !== void 0) {\n                return caController.viewModel;\n            }\n            const ceController = CustomElement.for(refHost, { name: refTargetName });\n            if (ceController === void 0) {\n                throw new Error(`Attempted to reference \"${refTargetName}\", but it was not found amongst the target's API.`);\n            }\n            return ceController.viewModel;\n        }\n    }\n}\nlet SetPropertyRenderer = /** @class */ (() => {\n    let SetPropertyRenderer = \n    /** @internal */\n    class SetPropertyRenderer {\n        render(flags, context, controller, target, instruction) {\n            const obj = getTarget(target);\n            if (obj.$observers !== void 0 && obj.$observers[instruction.to] !== void 0) {\n                obj.$observers[instruction.to].setValue(instruction.value, 32 /* fromBind */);\n            }\n            else {\n                obj[instruction.to] = instruction.value;\n            }\n        }\n    };\n    SetPropertyRenderer = __decorate([\n        instructionRenderer(\"re\" /* setProperty */)\n        /** @internal */\n    ], SetPropertyRenderer);\n    return SetPropertyRenderer;\n})();\nexport { SetPropertyRenderer };\nlet CustomElementRenderer = /** @class */ (() => {\n    let CustomElementRenderer = \n    /** @internal */\n    class CustomElementRenderer {\n        render(flags, context, controller, target, instruction) {\n            let viewFactory;\n            const slotInfo = instruction.slotInfo;\n            if (slotInfo !== null) {\n                const projectionCtx = slotInfo.projectionContext;\n                viewFactory = getRenderContext(projectionCtx.content, context).getViewFactory(void 0, slotInfo.type, projectionCtx.scope);\n            }\n            const factory = context.getComponentFactory(\n            /* parentController */ controller, \n            /* host             */ target, \n            /* instruction      */ instruction, \n            /* viewFactory      */ viewFactory, \n            /* location         */ target);\n            const key = CustomElement.keyFrom(instruction.res);\n            const component = factory.createComponent(key);\n            const lifecycle = context.get(ILifecycle);\n            const childController = Controller.forCustomElement(\n            /* viewModel           */ component, \n            /* lifecycle           */ lifecycle, \n            /* host                */ target, \n            /* parentContainer     */ context, \n            /* targetedProjections */ context.getProjectionFor(instruction), \n            /* flags               */ flags);\n            flags = childController.flags;\n            Metadata.define(key, childController, target);\n            context.renderInstructions(\n            /* flags        */ flags, \n            /* instructions */ instruction.instructions, \n            /* controller   */ controller, \n            /* target       */ childController);\n            controller.addController(childController);\n            factory.dispose();\n        }\n    };\n    CustomElementRenderer = __decorate([\n        instructionRenderer(\"ra\" /* hydrateElement */)\n        /** @internal */\n    ], CustomElementRenderer);\n    return CustomElementRenderer;\n})();\nexport { CustomElementRenderer };\nlet CustomAttributeRenderer = /** @class */ (() => {\n    let CustomAttributeRenderer = \n    /** @internal */\n    class CustomAttributeRenderer {\n        render(flags, context, controller, target, instruction) {\n            const factory = context.getComponentFactory(\n            /* parentController */ controller, \n            /* host             */ target, \n            /* instruction      */ instruction, \n            /* viewFactory      */ void 0, \n            /* location         */ void 0);\n            const key = CustomAttribute.keyFrom(instruction.res);\n            const component = factory.createComponent(key);\n            const lifecycle = context.get(ILifecycle);\n            const childController = Controller.forCustomAttribute(\n            /* viewModel */ component, \n            /* lifecycle */ lifecycle, \n            /* host      */ target, \n            /* flags     */ flags);\n            Metadata.define(key, childController, target);\n            context.renderInstructions(\n            /* flags        */ flags, \n            /* instructions */ instruction.instructions, \n            /* controller   */ controller, \n            /* target       */ childController);\n            controller.addController(childController);\n            factory.dispose();\n        }\n    };\n    CustomAttributeRenderer = __decorate([\n        instructionRenderer(\"rb\" /* hydrateAttribute */)\n        /** @internal */\n    ], CustomAttributeRenderer);\n    return CustomAttributeRenderer;\n})();\nexport { CustomAttributeRenderer };\nlet TemplateControllerRenderer = /** @class */ (() => {\n    let TemplateControllerRenderer = \n    /** @internal */\n    class TemplateControllerRenderer {\n        render(flags, parentContext, controller, target, instruction) {\n            const viewFactory = getRenderContext(instruction.def, parentContext).getViewFactory();\n            const renderLocation = parentContext.dom.convertToRenderLocation(target);\n            const componentFactory = parentContext.getComponentFactory(\n            /* parentController */ controller, \n            /* host             */ target, \n            /* instruction      */ instruction, \n            /* viewFactory      */ viewFactory, \n            /* location         */ renderLocation);\n            const key = CustomAttribute.keyFrom(instruction.res);\n            const component = componentFactory.createComponent(key);\n            const lifecycle = parentContext.get(ILifecycle);\n            const childController = Controller.forCustomAttribute(\n            /* viewModel */ component, \n            /* lifecycle */ lifecycle, \n            /* host      */ target, \n            /* flags     */ flags);\n            Metadata.define(key, childController, renderLocation);\n            if (instruction.link) {\n                const children = controller.children;\n                component.link(children[children.length - 1]);\n            }\n            parentContext.renderInstructions(\n            /* flags        */ flags, \n            /* instructions */ instruction.instructions, \n            /* controller   */ controller, \n            /* target       */ childController);\n            controller.addController(childController);\n            componentFactory.dispose();\n        }\n    };\n    TemplateControllerRenderer = __decorate([\n        instructionRenderer(\"rc\" /* hydrateTemplateController */)\n        /** @internal */\n    ], TemplateControllerRenderer);\n    return TemplateControllerRenderer;\n})();\nexport { TemplateControllerRenderer };\nlet LetElementRenderer = /** @class */ (() => {\n    let LetElementRenderer = \n    /** @internal */\n    class LetElementRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            context.dom.remove(target);\n            const childInstructions = instruction.instructions;\n            const toBindingContext = instruction.toBindingContext;\n            let childInstruction;\n            let expr;\n            let binding;\n            for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n                childInstruction = childInstructions[i];\n                expr = ensureExpression(this.parser, childInstruction.from, 48 /* IsPropertyCommand */);\n                binding = applyBindingBehavior(new LetBinding(expr, childInstruction.to, this.observerLocator, context, toBindingContext), expr, context);\n                controller.addBinding(binding);\n            }\n        }\n    };\n    LetElementRenderer = __decorate([\n        instructionRenderer(\"rd\" /* hydrateLetElement */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], LetElementRenderer);\n    return LetElementRenderer;\n})();\nexport { LetElementRenderer };\nlet CallBindingRenderer = /** @class */ (() => {\n    let CallBindingRenderer = \n    /** @internal */\n    class CallBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            const expr = ensureExpression(this.parser, instruction.from, 153 /* CallCommand */);\n            const binding = applyBindingBehavior(new CallBinding(expr, getTarget(target), instruction.to, this.observerLocator, context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    CallBindingRenderer = __decorate([\n        instructionRenderer(\"rh\" /* callBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], CallBindingRenderer);\n    return CallBindingRenderer;\n})();\nexport { CallBindingRenderer };\nlet RefBindingRenderer = /** @class */ (() => {\n    let RefBindingRenderer = \n    /** @internal */\n    class RefBindingRenderer {\n        constructor(parser) {\n            this.parser = parser;\n        }\n        render(flags, context, controller, target, instruction) {\n            const expr = ensureExpression(this.parser, instruction.from, 5376 /* IsRef */);\n            const binding = applyBindingBehavior(new RefBinding(expr, getRefTarget(target, instruction.to), context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    RefBindingRenderer = __decorate([\n        instructionRenderer(\"rj\" /* refBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __metadata(\"design:paramtypes\", [Object])\n    ], RefBindingRenderer);\n    return RefBindingRenderer;\n})();\nexport { RefBindingRenderer };\nlet InterpolationBindingRenderer = /** @class */ (() => {\n    let InterpolationBindingRenderer = \n    /** @internal */\n    class InterpolationBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            let binding;\n            const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n            if (expr.isMulti) {\n                binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, getTarget(target), instruction.to, BindingMode.toView, context), expr, context);\n            }\n            else {\n                binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context, true), expr, context);\n            }\n            controller.addBinding(binding);\n        }\n    };\n    InterpolationBindingRenderer = __decorate([\n        instructionRenderer(\"rf\" /* interpolation */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], InterpolationBindingRenderer);\n    return InterpolationBindingRenderer;\n})();\nexport { InterpolationBindingRenderer };\nlet PropertyBindingRenderer = /** @class */ (() => {\n    let PropertyBindingRenderer = \n    /** @internal */\n    class PropertyBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | instruction.mode);\n            const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, instruction.mode, this.observerLocator, context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    PropertyBindingRenderer = __decorate([\n        instructionRenderer(\"rg\" /* propertyBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], PropertyBindingRenderer);\n    return PropertyBindingRenderer;\n})();\nexport { PropertyBindingRenderer };\nlet IteratorBindingRenderer = /** @class */ (() => {\n    let IteratorBindingRenderer = \n    /** @internal */\n    class IteratorBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            const expr = ensureExpression(this.parser, instruction.from, 539 /* ForCommand */);\n            const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    IteratorBindingRenderer = __decorate([\n        instructionRenderer(\"rk\" /* iteratorBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], IteratorBindingRenderer);\n    return IteratorBindingRenderer;\n})();\nexport { IteratorBindingRenderer };\nlet behaviorExpressionIndex = 0;\nconst behaviorExpressions = [];\nexport function applyBindingBehavior(binding, expression, locator) {\n    while (expression instanceof BindingBehaviorExpression) {\n        behaviorExpressions[behaviorExpressionIndex++] = expression;\n        expression = expression.expression;\n    }\n    while (behaviorExpressionIndex > 0) {\n        const behaviorExpression = behaviorExpressions[--behaviorExpressionIndex];\n        const behaviorOrFactory = locator.get(behaviorExpression.behaviorKey);\n        if (behaviorOrFactory instanceof BindingBehaviorFactory) {\n            binding = behaviorOrFactory.construct(binding, behaviorExpression);\n        }\n    }\n    behaviorExpressions.length = 0;\n    return binding;\n}\n//# sourceMappingURL=renderer.js.map","import { InstanceProvider, Reporter, } from '@aurelia/kernel';\nimport { ITargetedInstruction, } from '../definitions';\nimport { IDOM, IRenderLocation } from '../dom';\nimport { IController, ILifecycle, IViewFactory, } from '../lifecycle';\nimport { IRenderer, ITemplateCompiler } from '../renderer';\nimport { CustomElementDefinition } from '../resources/custom-element';\nimport { ViewFactory } from './view';\nimport { IProjectionProvider } from '../resources/custom-elements/au-slot';\nconst definitionContainerLookup = new WeakMap();\nconst definitionContainerProjectionsLookup = new WeakMap();\nconst fragmentCache = new WeakMap();\nexport function isRenderContext(value) {\n    return value instanceof RenderContext;\n}\nexport function getRenderContext(partialDefinition, parentContainer, projections) {\n    const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n    // injectable completely prevents caching, ensuring that each instance gets a new render context\n    if (definition.injectable !== null) {\n        return new RenderContext(definition, parentContainer);\n    }\n    if (projections == null) {\n        let containerLookup = definitionContainerLookup.get(definition);\n        if (containerLookup === void 0) {\n            definitionContainerLookup.set(definition, containerLookup = new WeakMap());\n        }\n        let context = containerLookup.get(parentContainer);\n        if (context === void 0) {\n            containerLookup.set(parentContainer, context = new RenderContext(definition, parentContainer));\n        }\n        return context;\n    }\n    let containerProjectionsLookup = definitionContainerProjectionsLookup.get(definition);\n    if (containerProjectionsLookup === void 0) {\n        definitionContainerProjectionsLookup.set(definition, containerProjectionsLookup = new WeakMap());\n    }\n    let projectionsLookup = containerProjectionsLookup.get(parentContainer);\n    if (projectionsLookup === void 0) {\n        containerProjectionsLookup.set(parentContainer, projectionsLookup = new WeakMap());\n    }\n    let context = projectionsLookup.get(projections);\n    if (context === void 0) {\n        projectionsLookup.set(projections, context = new RenderContext(definition, parentContainer));\n    }\n    return context;\n}\nexport class RenderContext {\n    constructor(definition, parentContainer) {\n        this.definition = definition;\n        this.parentContainer = parentContainer;\n        this.viewModelProvider = void 0;\n        this.fragment = null;\n        this.factory = void 0;\n        this.isCompiled = false;\n        this.compiledDefinition = (void 0);\n        const container = this.container = parentContainer.createChild();\n        this.renderer = container.get(IRenderer);\n        this.projectionProvider = container.get(IProjectionProvider);\n        container.registerResolver(IViewFactory, this.factoryProvider = new ViewFactoryProvider(), true);\n        container.registerResolver(IController, this.parentControllerProvider = new InstanceProvider(), true);\n        container.registerResolver(ITargetedInstruction, this.instructionProvider = new InstanceProvider(), true);\n        container.registerResolver(IRenderLocation, this.renderLocationProvider = new InstanceProvider(), true);\n        (this.dom = container.get(IDOM)).registerElementResolver(container, this.elementProvider = new InstanceProvider());\n        container.register(...definition.dependencies);\n    }\n    // #region IServiceLocator api\n    has(key, searchAncestors) {\n        return this.container.has(key, searchAncestors);\n    }\n    get(key) {\n        return this.container.get(key);\n    }\n    getAll(key) {\n        return this.container.getAll(key);\n    }\n    // #endregion\n    // #region IContainer api\n    register(...params) {\n        return this.container.register(...params);\n    }\n    registerResolver(key, resolver) {\n        return this.container.registerResolver(key, resolver);\n    }\n    // public deregisterResolverFor<K extends Key, T = K>(key: K): void {\n    //   this.container.deregisterResolverFor(key);\n    // }\n    registerTransformer(key, transformer) {\n        return this.container.registerTransformer(key, transformer);\n    }\n    getResolver(key, autoRegister) {\n        return this.container.getResolver(key, autoRegister);\n    }\n    getFactory(key) {\n        return this.container.getFactory(key);\n    }\n    registerFactory(key, factory) {\n        this.container.registerFactory(key, factory);\n    }\n    createChild() {\n        return this.container.createChild();\n    }\n    disposeResolvers() {\n        this.container.disposeResolvers();\n    }\n    // #endregion\n    // #region IRenderContext api\n    compile(targetedProjections) {\n        let compiledDefinition;\n        if (this.isCompiled) {\n            return this;\n        }\n        this.isCompiled = true;\n        const definition = this.definition;\n        if (definition.needsCompile) {\n            const container = this.container;\n            const compiler = container.get(ITemplateCompiler);\n            compiledDefinition = this.compiledDefinition = compiler.compile(definition, container, targetedProjections);\n        }\n        else {\n            compiledDefinition = this.compiledDefinition = definition;\n        }\n        // Support Recursive Components by adding self to own context\n        compiledDefinition.register(this);\n        if (fragmentCache.has(compiledDefinition)) {\n            this.fragment = fragmentCache.get(compiledDefinition);\n        }\n        else {\n            const template = compiledDefinition.template;\n            if (template === null) {\n                fragmentCache.set(compiledDefinition, null);\n            }\n            else {\n                fragmentCache.set(compiledDefinition, this.fragment = this.definition.enhance ? template : this.dom.createDocumentFragment(template));\n            }\n        }\n        return this;\n    }\n    getViewFactory(name, contentType, projectionScope) {\n        let factory = this.factory;\n        if (factory === void 0) {\n            if (name === void 0) {\n                name = this.definition.name;\n            }\n            const lifecycle = this.parentContainer.get(ILifecycle);\n            factory = this.factory = new ViewFactory(name, this, lifecycle, contentType, projectionScope);\n        }\n        return factory;\n    }\n    beginChildComponentOperation(instance) {\n        const definition = this.definition;\n        if (definition.injectable !== null) {\n            if (this.viewModelProvider === void 0) {\n                this.container.registerResolver(definition.injectable, this.viewModelProvider = new InstanceProvider());\n            }\n            this.viewModelProvider.prepare(instance);\n        }\n        return this;\n    }\n    // #endregion\n    // #region ICompiledRenderContext api\n    createNodes() {\n        return this.dom.createNodeSequence(this.fragment, !this.definition.enhance);\n    }\n    // TODO: split up into 2 methods? getComponentFactory + getSyntheticFactory or something\n    getComponentFactory(parentController, host, instruction, viewFactory, location) {\n        if (parentController !== void 0) {\n            this.parentControllerProvider.prepare(parentController);\n        }\n        if (host !== void 0) {\n            // TODO: fix provider input type, Key is probably not a good constraint\n            this.elementProvider.prepare(host);\n        }\n        if (instruction !== void 0) {\n            this.instructionProvider.prepare(instruction);\n        }\n        if (location !== void 0) {\n            this.renderLocationProvider.prepare(location);\n        }\n        if (viewFactory !== void 0) {\n            this.factoryProvider.prepare(viewFactory);\n        }\n        return this;\n    }\n    // #endregion\n    // #region IComponentFactory api\n    createComponent(resourceKey) {\n        return this.container.get(resourceKey);\n    }\n    render(flags, controller, targets, templateDefinition, host) {\n        this.renderer.render(flags, this, controller, targets, templateDefinition, host);\n    }\n    renderInstructions(flags, instructions, controller, target) {\n        this.renderer.renderInstructions(flags, this, instructions, controller, target);\n    }\n    dispose() {\n        this.elementProvider.dispose();\n        this.container.disposeResolvers();\n    }\n    // #endregion\n    // #region IProjectionProvider api\n    registerProjections(projections, scope) {\n        this.projectionProvider.registerProjections(projections, scope);\n    }\n    getProjectionFor(instruction) {\n        return this.projectionProvider.getProjectionFor(instruction);\n    }\n}\n/** @internal */\nexport class ViewFactoryProvider {\n    constructor() {\n        this.factory = null;\n    }\n    prepare(factory) {\n        this.factory = factory;\n    }\n    get $isResolver() { return true; }\n    resolve(_handler, _requestor) {\n        const factory = this.factory;\n        if (factory === null) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        if (typeof factory.name !== 'string' || factory.name.length === 0) { // unmet invariant: factory must have a name\n            throw Reporter.error(51); // TODO: organize error codes\n        }\n        return factory;\n    }\n    dispose() {\n        this.factory = null;\n    }\n}\n//# sourceMappingURL=render-context.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/* eslint-disable @typescript-eslint/promise-function-async */\nimport { DI, IServiceLocator, Registration, } from '@aurelia/kernel';\nexport const LifecycleTask = {\n    done: {\n        done: true,\n        wait() { return Promise.resolve(); }\n    }\n};\nexport var TaskSlot;\n(function (TaskSlot) {\n    TaskSlot[TaskSlot[\"beforeCreate\"] = 0] = \"beforeCreate\";\n    TaskSlot[TaskSlot[\"beforeRender\"] = 1] = \"beforeRender\";\n    TaskSlot[TaskSlot[\"beforeCompileChildren\"] = 2] = \"beforeCompileChildren\";\n    TaskSlot[TaskSlot[\"beforeBind\"] = 3] = \"beforeBind\";\n    TaskSlot[TaskSlot[\"afterAttach\"] = 4] = \"afterAttach\";\n})(TaskSlot || (TaskSlot = {}));\nexport const IStartTask = DI.createInterface('IStartTask').noDefault();\nvar TaskType;\n(function (TaskType) {\n    TaskType[TaskType[\"with\"] = 0] = \"with\";\n    TaskType[TaskType[\"from\"] = 1] = \"from\";\n})(TaskType || (TaskType = {}));\nexport const StartTask = class $StartTask {\n    constructor(type) {\n        this.type = type;\n        this._slot = void 0;\n        this._promiseOrTask = void 0;\n        this._container = void 0;\n        this._key = void 0;\n        this._callback = void 0;\n        this._task = void 0;\n    }\n    get slot() {\n        if (this._slot === void 0) {\n            throw new Error('StartTask.slot is not set');\n        }\n        return this._slot;\n    }\n    get promiseOrTask() {\n        if (this._promiseOrTask === void 0) {\n            throw new Error('StartTask.promiseOrTask is not set');\n        }\n        return this._promiseOrTask;\n    }\n    get container() {\n        if (this._container === void 0) {\n            throw new Error('StartTask.container is not set');\n        }\n        return this._container;\n    }\n    get key() {\n        if (this._key === void 0) {\n            throw new Error('StartTask.key is not set');\n        }\n        return this._key;\n    }\n    get callback() {\n        if (this._callback === void 0) {\n            throw new Error('StartTask.callback is not set');\n        }\n        return this._callback;\n    }\n    get task() {\n        if (this._task === void 0) {\n            throw new Error('StartTask.task is not set');\n        }\n        return this._task;\n    }\n    static with(key) {\n        const task = new $StartTask(0 /* with */);\n        task._key = key;\n        return task;\n    }\n    static from(promiseOrTask) {\n        const task = new $StartTask(1 /* from */);\n        task._promiseOrTask = promiseOrTask;\n        return task;\n    }\n    beforeCreate() {\n        return this.at(0 /* beforeCreate */);\n    }\n    beforeRender() {\n        return this.at(1 /* beforeRender */);\n    }\n    beforeCompileChildren() {\n        return this.at(2 /* beforeCompileChildren */);\n    }\n    beforeBind() {\n        return this.at(3 /* beforeBind */);\n    }\n    afterAttach() {\n        return this.at(4 /* afterAttach */);\n    }\n    at(slot) {\n        this._slot = slot;\n        return this;\n    }\n    call(fn) {\n        this._callback = fn;\n        return this;\n    }\n    register(container) {\n        return this._container = container.register(Registration.instance(IStartTask, this));\n    }\n    resolveTask() {\n        if (this._task === void 0) {\n            switch (this.type) {\n                case 0 /* with */:\n                    this._task = new ProviderTask(this.container, this.key, this.callback);\n                    break;\n                case 1 /* from */:\n                    this._task = new TerminalTask(this.promiseOrTask);\n                    break;\n            }\n        }\n        return this.task;\n    }\n};\nexport const IStartTaskManager = DI.createInterface('IStartTaskManager').noDefault();\nlet StartTaskManager = /** @class */ (() => {\n    let StartTaskManager = class StartTaskManager {\n        constructor(locator) {\n            this.locator = locator;\n            this.beforeCompileChildrenQueued = false;\n        }\n        static register(container) {\n            return Registration.singleton(IStartTaskManager, this).register(container);\n        }\n        enqueueBeforeCompileChildren() {\n            if (this.beforeCompileChildrenQueued) {\n                throw new Error(`BeforeCompileChildren already queued`);\n            }\n            this.beforeCompileChildrenQueued = true;\n        }\n        runBeforeCreate(locator = this.locator) {\n            return this.run(0 /* beforeCreate */, locator);\n        }\n        runBeforeRender(locator = this.locator) {\n            return this.run(1 /* beforeRender */, locator);\n        }\n        runBeforeCompileChildren(locator = this.locator) {\n            if (this.beforeCompileChildrenQueued) {\n                this.beforeCompileChildrenQueued = false;\n                return this.run(2 /* beforeCompileChildren */, locator);\n            }\n            return LifecycleTask.done;\n        }\n        runBeforeBind(locator = this.locator) {\n            return this.run(3 /* beforeBind */, locator);\n        }\n        runAfterAttach(locator = this.locator) {\n            return this.run(4 /* afterAttach */, locator);\n        }\n        run(slot, locator = this.locator) {\n            const tasks = locator.getAll(IStartTask)\n                .filter(startTask => startTask.slot === slot)\n                .map(startTask => startTask.resolveTask())\n                .filter(task => !task.done);\n            if (tasks.length === 0) {\n                return LifecycleTask.done;\n            }\n            return new AggregateTerminalTask(tasks);\n        }\n    };\n    StartTaskManager = __decorate([\n        __param(0, IServiceLocator),\n        __metadata(\"design:paramtypes\", [Object])\n    ], StartTaskManager);\n    return StartTaskManager;\n})();\nexport { StartTaskManager };\nexport class PromiseTask {\n    constructor(promise, next, context, ...args) {\n        this.done = false;\n        this.promise = promise.then(value => {\n            if (next !== null) {\n                const nextResult = next.call(context, value, ...args);\n                if (nextResult === void 0) {\n                    this.done = true;\n                }\n                else {\n                    const nextPromise = nextResult.then instanceof Function\n                        ? nextResult\n                        : nextResult.wait();\n                    return nextPromise.then(() => {\n                        this.done = true;\n                    });\n                }\n            }\n        });\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class ProviderTask {\n    constructor(container, key, callback) {\n        this.container = container;\n        this.key = key;\n        this.callback = callback;\n        this.done = false;\n    }\n    wait() {\n        if (this.promise === void 0) {\n            const instance = this.container.get(this.key);\n            const maybePromiseOrTask = this.callback.call(void 0, instance);\n            this.promise = maybePromiseOrTask === void 0\n                ? Promise.resolve()\n                : maybePromiseOrTask.then instanceof Function\n                    ? maybePromiseOrTask\n                    : maybePromiseOrTask.wait();\n            this.promise = this.promise.then(() => {\n                this.done = true;\n                this.container = (void 0);\n                this.key = (void 0);\n                this.callback = (void 0);\n            }).catch(e => { throw e; });\n        }\n        return this.promise;\n    }\n}\nexport class ContinuationTask {\n    constructor(antecedent, next, context, ...args) {\n        this.done = false;\n        const promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise = promise.then(() => {\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                const nextPromise = nextResult.then instanceof Function\n                    ? nextResult\n                    : nextResult.wait();\n                return nextPromise.then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class TerminalTask {\n    constructor(antecedent) {\n        this.done = false;\n        this.promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise.then(() => {\n            this.done = true;\n        }).catch(e => { throw e; });\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateContinuationTask {\n    constructor(antecedents, next, context, ...args) {\n        this.done = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                return nextResult.wait().then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateTerminalTask {\n    constructor(antecedents) {\n        this.done = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            this.done = true;\n        });\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport function hasAsyncWork(value) {\n    return !(value === void 0 || value.done === true);\n}\n//# sourceMappingURL=lifecycle-task.js.map","/* eslint-disable @typescript-eslint/no-unnecessary-type-assertion */\nimport { nextId, isObject, ILogger, resolveAll, } from '@aurelia/kernel';\nimport { HooksDefinition, } from '../definitions';\nimport { stringifyState, } from '../lifecycle';\nimport { Scope, } from '../observation/binding-context';\nimport { ProxyObserver, } from '../observation/proxy-observer';\nimport { BindableObserver, } from '../observation/bindable-observer';\nimport { IProjectorLocator, CustomElementDefinition, CustomElement, } from '../resources/custom-element';\nimport { CustomAttribute, } from '../resources/custom-attribute';\nimport { getRenderContext, } from './render-context';\nimport { ChildrenObserver } from './children';\nimport { IStartTaskManager } from '../lifecycle-task';\nfunction callDispose(disposable) {\n    disposable.dispose();\n}\nconst controllerLookup = new WeakMap();\nexport class Controller {\n    constructor(vmKind, flags, lifecycle, definition, hooks, \n    /**\n     * The viewFactory. Only present for synthetic views.\n     */\n    viewFactory, \n    /**\n     * The backing viewModel. This is never a proxy. Only present for custom attributes and elements.\n     */\n    viewModel, \n    /**\n     * The binding context. This may be a proxy. If it is not, then it is the same instance as the viewModel. Only present for custom attributes and elements.\n     */\n    bindingContext, \n    /**\n     * The physical host dom node. Only present for custom elements.\n     */\n    host) {\n        this.vmKind = vmKind;\n        this.flags = flags;\n        this.lifecycle = lifecycle;\n        this.definition = definition;\n        this.hooks = hooks;\n        this.viewFactory = viewFactory;\n        this.viewModel = viewModel;\n        this.bindingContext = bindingContext;\n        this.host = host;\n        this.id = nextId('au$component');\n        this.head = null;\n        this.tail = null;\n        this.next = null;\n        this.parent = null;\n        this.bindings = void 0;\n        this.children = void 0;\n        this.hasLockedScope = false;\n        this.isStrictBinding = false;\n        this.scope = void 0;\n        this.hostScope = null;\n        this.projector = void 0;\n        this.nodes = void 0;\n        this.context = void 0;\n        this.location = void 0;\n        this.mountStrategy = 1 /* insertBefore */;\n        this.state = 0 /* none */;\n        this.promise = void 0;\n        this.resolve = void 0;\n        this.reject = void 0;\n        this.logger = null;\n        this.debug = false;\n        this.fullyNamed = false;\n        this.canceling = false;\n    }\n    get isActive() {\n        return (this.state & (1 /* activating */ | 14 /* activated */)) > 0 && (this.state & 16 /* deactivating */) === 0;\n    }\n    get name() {\n        var _a, _b, _c, _d, _e;\n        let parentName = (_b = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.name) !== null && _b !== void 0 ? _b : '';\n        parentName = parentName.length > 0 ? `${parentName} -> ` : '';\n        switch (this.vmKind) {\n            case 1 /* customAttribute */:\n                return `${parentName}Attribute<${(_c = this.viewModel) === null || _c === void 0 ? void 0 : _c.constructor.name}>`;\n            case 0 /* customElement */:\n                return `${parentName}Element<${(_d = this.viewModel) === null || _d === void 0 ? void 0 : _d.constructor.name}>`;\n            case 2 /* synthetic */:\n                return `${parentName}View<${(_e = this.viewFactory) === null || _e === void 0 ? void 0 : _e.name}>`;\n        }\n    }\n    static getCached(viewModel) {\n        return controllerLookup.get(viewModel);\n    }\n    static getCachedOrThrow(viewModel) {\n        const controller = Controller.getCached(viewModel);\n        if (controller === void 0) {\n            throw new Error(`There is no cached controller for the provided ViewModel: ${String(viewModel)}`);\n        }\n        return controller;\n    }\n    static forCustomElement(viewModel, lifecycle, host, parentContainer, \n    // projections *targeted* for this custom element. these are not the projections *provided* by this custom element.\n    targetedProjections, flags = 0 /* none */, hydrate = true, \n    // Use this when `instance.constructor` is not a custom element type to pass on the CustomElement definition\n    definition = void 0) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        definition = definition !== null && definition !== void 0 ? definition : CustomElement.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(0 /* customElement */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* definition     */ definition, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        if (hydrate) {\n            controller.hydrateCustomElement(parentContainer, targetedProjections);\n        }\n        return controller;\n    }\n    static forCustomAttribute(viewModel, lifecycle, host, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomAttribute.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(1 /* customAttribute */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* definition     */ definition, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomAttribute();\n        return controller;\n    }\n    static forSyntheticView(viewFactory, lifecycle, context, flags = 0 /* none */) {\n        const controller = new Controller(2 /* synthetic */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* definition     */ void 0, \n        /* hooks          */ HooksDefinition.none, \n        /* viewFactory    */ viewFactory, \n        /* viewModel      */ void 0, \n        /* bindingContext */ void 0, \n        /* host           */ void 0);\n        controller.hydrateSynthetic(context);\n        return controller;\n    }\n    hydrateCustomElement(parentContainer, targetedProjections) {\n        this.logger = parentContainer.get(ILogger).root;\n        this.debug = this.logger.config.level <= 1 /* debug */;\n        if (this.debug) {\n            this.logger = this.logger.scopeTo(this.name);\n        }\n        let definition = this.definition;\n        const flags = this.flags |= definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        createChildrenObservers(this, definition, flags, instance);\n        const scope = this.scope = Scope.create(flags, this.bindingContext, null);\n        const hooks = this.hooks;\n        if (hooks.hasCreate) {\n            if (this.debug) {\n                this.logger.trace(`invoking create() hook`);\n            }\n            const result = instance.create(\n            /* controller      */ this, \n            /* parentContainer */ parentContainer, \n            /* definition      */ definition);\n            if (result !== void 0 && result !== definition) {\n                definition = CustomElementDefinition.getOrCreate(result);\n            }\n        }\n        const context = this.context = getRenderContext(definition, parentContainer, targetedProjections === null || targetedProjections === void 0 ? void 0 : targetedProjections.projections);\n        // Support Recursive Components by adding self to own context\n        definition.register(context);\n        if (definition.injectable !== null) {\n            // If the element is registered as injectable, support injecting the instance into children\n            context.beginChildComponentOperation(instance);\n        }\n        if (hooks.hasBeforeCompile) {\n            if (this.debug) {\n                this.logger.trace(`invoking hasBeforeCompile() hook`);\n            }\n            instance.beforeCompile(this);\n        }\n        const compiledContext = context.compile(targetedProjections);\n        const compiledDefinition = compiledContext.compiledDefinition;\n        compiledContext.registerProjections(compiledDefinition.projectionsMap, scope);\n        // once the projections are registered, we can cleanup the projection map to prevent memory leaks.\n        compiledDefinition.projectionsMap.clear();\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const projectorLocator = parentContainer.get(IProjectorLocator);\n        this.projector = projectorLocator.getElementProjector(context.dom, this, this.host, compiledDefinition);\n        instance.$controller = this;\n        const nodes = this.nodes = compiledContext.createNodes();\n        if (hooks.hasAfterCompile) {\n            if (this.debug) {\n                this.logger.trace(`invoking hasAfterCompile() hook`);\n            }\n            instance.afterCompile(this);\n        }\n        const taskmgr = parentContainer.get(IStartTaskManager);\n        taskmgr.runBeforeCompileChildren(parentContainer);\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ this.host);\n        if (hooks.hasAfterCompileChildren) {\n            if (this.debug) {\n                this.logger.trace(`invoking afterCompileChildren() hook`);\n            }\n            instance.afterCompileChildren(this);\n        }\n    }\n    hydrateCustomAttribute() {\n        const definition = this.definition;\n        const flags = this.flags | definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        instance.$controller = this;\n    }\n    hydrateSynthetic(context) {\n        this.context = context;\n        const compiledContext = context.compile(null);\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const nodes = this.nodes = compiledContext.createNodes();\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ void 0);\n    }\n    cancel(initiator, parent, flags) {\n        var _a, _b, _c, _d;\n        if (this.canceling) {\n            return;\n        }\n        this.canceling = true;\n        if ((this.state & 1 /* activating */) === 1 /* activating */) {\n            this.state = (this.state ^ 1 /* activating */) | 16 /* deactivating */;\n            (_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.onCancel) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags);\n            if ((this.state & 4 /* activateChildrenCalled */) === 4 /* activateChildrenCalled */ &&\n                this.children !== void 0) {\n                for (const child of this.children) {\n                    child.cancel(initiator, parent, flags);\n                }\n            }\n        }\n        else if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n            this.state = (this.state ^ 16 /* deactivating */) | 1 /* activating */;\n            (_d = (_c = this.bindingContext) === null || _c === void 0 ? void 0 : _c.onCancel) === null || _d === void 0 ? void 0 : _d.call(_c, initiator, parent, flags);\n            if ((this.state & 64 /* deactivateChildrenCalled */) === 64 /* deactivateChildrenCalled */ &&\n                this.children !== void 0) {\n                for (const child of this.children) {\n                    child.cancel(initiator, parent, flags);\n                }\n            }\n        }\n    }\n    activate(initiator, parent, flags, scope, hostScope) {\n        this.canceling = false;\n        switch (this.state) {\n            case 0 /* none */:\n            case 224 /* deactivated */:\n                if (!(parent === null || parent.isActive)) {\n                    // If this is not the root, and the parent is either:\n                    // 1. Not activated, or activating children OR\n                    // 2. Deactivating itself\n                    // abort.\n                    return;\n                }\n                // Otherwise, proceed normally.\n                // 'deactivated' and 'none' are treated the same because, from an activation perspective, they mean the same thing.\n                this.state = 1 /* activating */;\n                break;\n            case 14 /* activated */:\n                // If we're already activated, no need to do anything.\n                return;\n            case 512 /* disposed */:\n                throw new Error(`${this.name} trying to activate a controller that is disposed.`);\n            default:\n                if ((this.state & 1 /* activating */) === 1 /* activating */) {\n                    // We're already activating, so no need to do anything.\n                    return this.promise;\n                }\n                if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n                    // We're in an incomplete deactivation, so we can still abort some of it.\n                    // Simply add the 'activating' bit (and remove 'deactivating' so we know what was the last request) and return.\n                    this.state = (this.state ^ 16 /* deactivating */) | 1 /* activating */;\n                    if ((this.state & 64 /* deactivateChildrenCalled */) === 64 /* deactivateChildrenCalled */ &&\n                        this.children !== void 0) {\n                        return resolveAll(this.onResolve(this.$activateChildren(initiator, parent, flags)), this.promise);\n                    }\n                    return this.promise;\n                }\n                else {\n                    throw new Error(`${this.name} unexpected state: ${stringifyState(this.state)}.`);\n                }\n        }\n        this.parent = parent;\n        if (this.debug && !this.fullyNamed) {\n            this.fullyNamed = true;\n            this.logger = this.context.get(ILogger).root.scopeTo(this.name);\n            this.logger.trace(`activate()`);\n        }\n        this.hostScope = hostScope !== null && hostScope !== void 0 ? hostScope : null;\n        flags |= 32 /* fromBind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                // Custom element scope is created and assigned during hydration\n                this.scope.parentScope = scope === void 0 ? null : scope;\n                break;\n            case 1 /* customAttribute */:\n                this.scope = scope;\n                break;\n            case 2 /* synthetic */:\n                if (scope === void 0 || scope === null) {\n                    throw new Error(`Scope is null or undefined`);\n                }\n                if (!this.hasLockedScope) {\n                    this.scope = scope;\n                }\n                break;\n        }\n        if (this.isStrictBinding) {\n            flags |= 4 /* isStrictBindingStrategy */;\n        }\n        return this.beforeBind(initiator, parent, flags);\n    }\n    beforeBind(initiator, parent, flags) {\n        var _a, _b;\n        if (this.debug) {\n            this.logger.trace(`beforeBind()`);\n        }\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.beforeBind) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags), () => {\n            return this.bind(initiator, parent, flags);\n        });\n    }\n    bind(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`bind()`);\n        }\n        this.state |= 2 /* beforeBindCalled */;\n        if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n            return this.afterUnbind(initiator, parent, flags);\n        }\n        if (this.bindings !== void 0) {\n            const { scope, hostScope, bindings } = this;\n            for (let i = 0, ii = bindings.length; i < ii; ++i) {\n                bindings[i].$bind(flags, scope, hostScope);\n            }\n        }\n        return this.afterBind(initiator, parent, flags);\n    }\n    afterBind(initiator, parent, flags) {\n        var _a, _b;\n        if (this.debug) {\n            this.logger.trace(`afterBind()`);\n        }\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.afterBind) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags), () => {\n            return this.attach(initiator, parent, flags);\n        });\n    }\n    attach(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`attach()`);\n        }\n        if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n            return this.beforeUnbind(initiator, parent, flags);\n        }\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.projector.project(this.nodes);\n                break;\n            case 2 /* synthetic */:\n                switch (this.mountStrategy) {\n                    case 2 /* append */:\n                        this.nodes.appendTo(this.location);\n                        break;\n                    case 1 /* insertBefore */:\n                        this.nodes.insertBefore(this.location);\n                        break;\n                }\n                break;\n        }\n        return this.afterAttach(initiator, parent, flags);\n    }\n    afterAttach(initiator, parent, flags) {\n        var _a, _b;\n        if (this.debug) {\n            this.logger.trace(`afterAttach()`);\n        }\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.afterAttach) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags), () => {\n            return this.activateChildren(initiator, parent, flags);\n        });\n    }\n    activateChildren(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`activateChildren()`);\n        }\n        this.state |= 4 /* activateChildrenCalled */;\n        return this.onResolve(this.$activateChildren(initiator, parent, flags), () => {\n            return this.endActivate(initiator, parent, flags);\n        });\n    }\n    $activateChildren(initiator, parent, flags) {\n        if (this.children !== void 0) {\n            const { children, scope, hostScope } = this;\n            return resolveAll(...children.map(child => {\n                return child.activate(initiator, this, flags, scope, hostScope);\n            }));\n        }\n    }\n    endActivate(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`afterAttachChildren()`);\n        }\n        this.state ^= 4 /* activateChildrenCalled */;\n        if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n            clearLinks(initiator);\n            return this.beforeDetach(initiator, parent, flags);\n        }\n        else if ((this.state & 32 /* beforeDetachCalled */) === 32 /* beforeDetachCalled */) {\n            this.state ^= 32 /* beforeDetachCalled */;\n            this.resolvePromise();\n            return;\n        }\n        let promises = void 0;\n        let ret;\n        if (initiator.head === null) {\n            initiator.head = this;\n        }\n        else {\n            initiator.tail.next = this;\n        }\n        initiator.tail = this;\n        if (initiator === this) {\n            if (initiator.head !== null) {\n                let cur = initiator.head;\n                initiator.head = initiator.tail = null;\n                let next;\n                do {\n                    ret = cur.afterAttachChildren(initiator, parent, flags);\n                    if (ret instanceof Promise) {\n                        (promises !== null && promises !== void 0 ? promises : (promises = [])).push(ret);\n                    }\n                    next = cur.next;\n                    cur.next = null;\n                    cur = next;\n                } while (cur !== null);\n                if (promises !== void 0) {\n                    const promise = promises.length === 1\n                        ? promises[0]\n                        : Promise.all(promises);\n                    return promise.then(() => {\n                        this.resolvePromise();\n                    });\n                }\n            }\n            this.resolvePromise();\n        }\n    }\n    afterAttachChildren(initiator, parent, flags) {\n        var _a, _b;\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.afterAttachChildren) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, flags), () => {\n            if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n                this.state = 14 /* activated */;\n                // If the cancellation of activation was requested once the children were already activating,\n                // then there were no more sensible cancellation points and we had to wait out the remainder of the operation.\n                // Now, after activation finally finished, we can proceed to deactivate.\n                return this.deactivate(this, parent, flags);\n            }\n            this.state = 14 /* activated */;\n            if (initiator !== this) {\n                // For the initiator, the promise is resolved at the end of endAactivate because that promise resolution\n                // has to come after all descendant postEndActivate calls resolved. Otherwise, the initiator might resolve\n                // while some of its descendants are still busy.\n                this.resolvePromise();\n            }\n        });\n    }\n    deactivate(initiator, parent, flags) {\n        this.canceling = false;\n        switch ((this.state & ~256 /* released */)) {\n            case 14 /* activated */:\n                // We're fully activated, so proceed with normal deactivation.\n                this.state = 16 /* deactivating */;\n                break;\n            case 0 /* none */:\n            case 224 /* deactivated */:\n            case 512 /* disposed */:\n            case 224 /* deactivated */ | 512 /* disposed */:\n                // If we're already deactivated (or even disposed), or never activated in the first place, no need to do anything.\n                return;\n            default:\n                if ((this.state & 16 /* deactivating */) === 16 /* deactivating */) {\n                    // We're already deactivating, so no need to do anything.\n                    return this.promise;\n                }\n                if ((this.state & 1 /* activating */) === 1 /* activating */) {\n                    // We're in an incomplete activation, so we can still abort some of it.\n                    // Simply add the 'deactivating' bit (and remove 'activating' so we know what was the last request) and return.\n                    this.state = (this.state ^ 1 /* activating */) | 16 /* deactivating */;\n                    if ((this.state & 4 /* activateChildrenCalled */) === 4 /* activateChildrenCalled */ &&\n                        this.children !== void 0) {\n                        return resolveAll(this.onResolve(this.$deactivateChildren(initiator, parent, flags)), this.promise);\n                    }\n                    return this.promise;\n                }\n                else {\n                    throw new Error(`${this.name} unexpected state: ${stringifyState(this.state)}.`);\n                }\n        }\n        if (this.debug) {\n            this.logger.trace(`deactivate()`);\n        }\n        return this.beforeDetach(initiator, parent, flags);\n    }\n    beforeDetach(initiator, parent, flags) {\n        var _a, _b;\n        if (this.debug) {\n            this.logger.trace(`beforeDetach()`);\n        }\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.beforeDetach) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags), () => {\n            return this.detach(initiator, parent, flags);\n        });\n    }\n    detach(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`detach()`);\n        }\n        this.state |= 32 /* beforeDetachCalled */;\n        if ((this.state & 1 /* activating */) === 1 /* activating */) {\n            return this.afterAttach(initiator, parent, flags);\n        }\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.projector.take(this.nodes);\n                break;\n            case 2 /* synthetic */:\n                this.nodes.remove();\n                this.nodes.unlink();\n                break;\n        }\n        return this.beforeUnbind(initiator, parent, flags);\n    }\n    beforeUnbind(initiator, parent, flags) {\n        var _a, _b;\n        if (this.debug) {\n            this.logger.trace(`beforeUnbind()`);\n        }\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.beforeUnbind) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags), () => {\n            return this.unbind(initiator, parent, flags);\n        });\n    }\n    unbind(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`unbind()`);\n        }\n        if ((this.state & 1 /* activating */) === 1 /* activating */) {\n            return this.afterBind(initiator, parent, flags);\n        }\n        flags |= 64 /* fromUnbind */;\n        if (this.bindings !== void 0) {\n            const { bindings } = this;\n            for (let i = 0, ii = bindings.length; i < ii; ++i) {\n                bindings[i].$unbind(flags);\n            }\n        }\n        return this.afterUnbind(initiator, parent, flags);\n    }\n    afterUnbind(initiator, parent, flags) {\n        var _a, _b;\n        if (this.debug) {\n            this.logger.trace(`afterUnbind()`);\n        }\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.afterUnbind) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, parent, flags), () => {\n            return this.deactivateChildren(initiator, parent, flags);\n        });\n    }\n    deactivateChildren(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`deactivateChildren()`);\n        }\n        this.state |= 64 /* deactivateChildrenCalled */;\n        return this.onResolve(this.$deactivateChildren(initiator, parent, flags), () => {\n            return this.endDeactivate(initiator, parent, flags);\n        });\n    }\n    $deactivateChildren(initiator, parent, flags) {\n        if (this.children !== void 0) {\n            const { children } = this;\n            return resolveAll(...children.map(child => {\n                return child.deactivate(initiator, this, flags);\n            }));\n        }\n    }\n    endDeactivate(initiator, parent, flags) {\n        if (this.debug) {\n            this.logger.trace(`afterUnbindChildren()`);\n        }\n        this.state ^= 64 /* deactivateChildrenCalled */;\n        if ((this.state & 1 /* activating */) === 1 /* activating */) {\n            // In a short-circuit it's possible that descendants have already started building the links for afterUnbindChildren hooks.\n            // Those hooks are never invoked (because only the initiator can do that), but we still need to clear the list so as to avoid corrupting the next lifecycle.\n            clearLinks(initiator);\n            return this.beforeBind(initiator, parent, flags);\n        }\n        else if ((this.state & 2 /* beforeBindCalled */) === 2 /* beforeBindCalled */) {\n            this.state ^= 2 /* beforeBindCalled */;\n            this.resolvePromise();\n            return;\n        }\n        let promises = void 0;\n        let ret;\n        if (initiator.head === null) {\n            initiator.head = this;\n        }\n        else {\n            initiator.tail.next = this;\n        }\n        initiator.tail = this;\n        if (initiator === this) {\n            if (initiator.head !== null) {\n                let cur = initiator.head;\n                initiator.head = initiator.tail = null;\n                let next;\n                do {\n                    ret = cur.afterUnbindChildren(initiator, parent, flags);\n                    if (ret instanceof Promise) {\n                        (promises !== null && promises !== void 0 ? promises : (promises = [])).push(ret);\n                    }\n                    next = cur.next;\n                    cur.next = null;\n                    cur = next;\n                } while (cur !== null);\n                if (promises !== void 0) {\n                    const promise = promises.length === 1\n                        ? promises[0]\n                        : Promise.all(promises);\n                    return promise.then(() => {\n                        this.resolvePromise();\n                    });\n                }\n            }\n            this.resolvePromise();\n        }\n    }\n    afterUnbindChildren(initiator, parent, flags) {\n        var _a, _b;\n        return this.onResolve((_b = (_a = this.bindingContext) === null || _a === void 0 ? void 0 : _a.afterUnbindChildren) === null || _b === void 0 ? void 0 : _b.call(_a, initiator, flags), () => {\n            this.parent = null;\n            switch (this.vmKind) {\n                case 1 /* customAttribute */:\n                    this.scope = void 0;\n                    break;\n                case 2 /* synthetic */:\n                    if (!this.hasLockedScope) {\n                        this.scope = void 0;\n                    }\n                    if ((this.state & 256 /* released */) === 256 /* released */ &&\n                        !this.viewFactory.tryReturnToCache(this)) {\n                        this.dispose();\n                    }\n                    break;\n                case 0 /* customElement */:\n                    this.scope.parentScope = null;\n                    break;\n            }\n            if ((this.state & 1 /* activating */) === 1 /* activating */) {\n                this.state = (this.state & 512 /* disposed */) | 224 /* deactivated */;\n                return this.activate(this, parent, flags);\n            }\n            if ((flags & 512 /* dispose */) === 512 /* dispose */) {\n                this.dispose();\n            }\n            this.state = (this.state & 512 /* disposed */) | 224 /* deactivated */;\n            if (initiator !== this) {\n                // For the initiator, the promise is resolved at the end of endDeactivate because that promise resolution\n                // has to come after all descendant postEndDeactivate calls resolved. Otherwise, the initiator might resolve\n                // while some of its descendants are still busy.\n                this.resolvePromise();\n            }\n        });\n    }\n    onResolve(maybePromise, resolveCallback) {\n        if (maybePromise instanceof Promise) {\n            if (this.promise === void 0) {\n                this.promise = new Promise((resolve, reject) => {\n                    this.resolve = resolve;\n                    this.reject = reject;\n                });\n            }\n            maybePromise = maybePromise.catch(err => {\n                var _a;\n                (_a = this.logger) === null || _a === void 0 ? void 0 : _a.error(err);\n                const reject = this.reject;\n                this.promise = this.resolve = this.reject = void 0;\n                reject(err);\n                throw err;\n            });\n            return resolveCallback === void 0\n                ? maybePromise\n                : maybePromise.then(resolveCallback);\n        }\n        if (resolveCallback !== void 0) {\n            return resolveCallback();\n        }\n    }\n    addBinding(binding) {\n        if (this.bindings === void 0) {\n            this.bindings = [binding];\n        }\n        else {\n            this.bindings[this.bindings.length] = binding;\n        }\n    }\n    addController(controller) {\n        if (this.children === void 0) {\n            this.children = [controller];\n        }\n        else {\n            this.children[this.children.length] = controller;\n        }\n    }\n    is(name) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */: {\n                const def = CustomAttribute.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 0 /* customElement */: {\n                const def = CustomElement.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 2 /* synthetic */:\n                return this.viewFactory.name === name;\n        }\n    }\n    lockScope(scope) {\n        this.scope = scope;\n        this.hasLockedScope = true;\n    }\n    setLocation(location, mountStrategy) {\n        this.location = location;\n        this.mountStrategy = mountStrategy;\n    }\n    release() {\n        this.state |= 256 /* released */;\n    }\n    dispose() {\n        if (this.debug) {\n            this.logger.trace(`dispose()`);\n        }\n        if ((this.state & 512 /* disposed */) === 512 /* disposed */) {\n            return;\n        }\n        this.state |= 512 /* disposed */;\n        if (this.hooks.hasDispose) {\n            this.bindingContext.dispose();\n        }\n        if (this.children !== void 0) {\n            this.children.forEach(callDispose);\n            this.children = void 0;\n        }\n        if (this.bindings !== void 0) {\n            this.bindings.forEach(callDispose);\n            this.bindings = void 0;\n        }\n        this.scope = void 0;\n        this.projector = void 0;\n        this.nodes = void 0;\n        this.context = void 0;\n        this.location = void 0;\n        this.viewFactory = void 0;\n        if (this.viewModel !== void 0) {\n            controllerLookup.delete(this.viewModel);\n            this.viewModel = void 0;\n        }\n        this.bindingContext = void 0;\n        this.host = void 0;\n    }\n    accept(visitor) {\n        if (visitor(this) === true) {\n            return true;\n        }\n        if (this.hooks.hasAccept && this.bindingContext.accept(visitor) === true) {\n            return true;\n        }\n        if (this.children !== void 0) {\n            const { children } = this;\n            for (let i = 0, ii = children.length; i < ii; ++i) {\n                if (children[i].accept(visitor) === true) {\n                    return true;\n                }\n            }\n        }\n    }\n    getTargetAccessor(propertyName) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const binding = bindings.find(b => b.targetProperty === propertyName);\n            if (binding !== void 0) {\n                return binding.targetObserver;\n            }\n        }\n        return void 0;\n    }\n    resolvePromise() {\n        const resolve = this.resolve;\n        if (resolve !== void 0) {\n            this.promise = this.resolve = this.reject = void 0;\n            resolve();\n        }\n    }\n}\nfunction getBindingContext(flags, instance) {\n    if (instance.noProxy === true || (flags & 2 /* proxyStrategy */) === 0) {\n        return instance;\n    }\n    return ProxyObserver.getOrCreate(instance).proxy;\n}\nfunction getLookup(instance) {\n    let lookup = instance.$observers;\n    if (lookup === void 0) {\n        Reflect.defineProperty(instance, '$observers', {\n            enumerable: false,\n            value: lookup = {},\n        });\n    }\n    return lookup;\n}\nfunction createObservers(lifecycle, definition, flags, instance) {\n    const bindables = definition.bindables;\n    const observableNames = Object.getOwnPropertyNames(bindables);\n    const length = observableNames.length;\n    if (length > 0) {\n        let name;\n        let bindable;\n        if ((flags & 2 /* proxyStrategy */) > 0) {\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                bindable = bindables[name];\n                new BindableObserver(lifecycle, flags, ProxyObserver.getOrCreate(instance).proxy, name, bindable.callback, bindable.set);\n            }\n        }\n        else {\n            const observers = getLookup(instance);\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                if (observers[name] === void 0) {\n                    bindable = bindables[name];\n                    observers[name] = new BindableObserver(lifecycle, flags, instance, name, bindable.callback, bindable.set);\n                }\n            }\n        }\n    }\n}\nfunction createChildrenObservers(controller, definition, flags, instance) {\n    const childrenObservers = definition.childrenObservers;\n    const childObserverNames = Object.getOwnPropertyNames(childrenObservers);\n    const length = childObserverNames.length;\n    if (length > 0) {\n        const observers = getLookup(instance);\n        let name;\n        for (let i = 0; i < length; ++i) {\n            name = childObserverNames[i];\n            if (observers[name] == void 0) {\n                const childrenDescription = childrenObservers[name];\n                observers[name] = new ChildrenObserver(controller, instance, flags, name, childrenDescription.callback, childrenDescription.query, childrenDescription.filter, childrenDescription.map, childrenDescription.options);\n            }\n        }\n    }\n}\nfunction clearLinks(initiator) {\n    let cur = initiator.head;\n    initiator.head = initiator.tail = null;\n    let next;\n    while (cur !== null) {\n        next = cur.next;\n        cur.next = null;\n        cur = next;\n    }\n}\nexport function isCustomElementController(value) {\n    return value instanceof Controller && value.vmKind === 0 /* customElement */;\n}\nexport function isCustomElementViewModel(value) {\n    return isObject(value) && CustomElement.isType(value.constructor);\n}\n//# sourceMappingURL=controller.js.map","import { DI, Registration, Metadata, Protocol } from '@aurelia/kernel';\nimport { Scope } from '../observation/binding-context';\nimport { CustomElement, CustomElementDefinition } from '../resources/custom-element';\nimport { Controller } from './controller';\nlet ViewFactory = /** @class */ (() => {\n    class ViewFactory {\n        constructor(name, context, lifecycle, contentType, projectionScope = null) {\n            this.name = name;\n            this.context = context;\n            this.lifecycle = lifecycle;\n            this.contentType = contentType;\n            this.projectionScope = projectionScope;\n            this.isCaching = false;\n            this.cache = null;\n            this.cacheSize = -1;\n        }\n        setCacheSize(size, doNotOverrideIfAlreadySet) {\n            if (size) {\n                if (size === '*') {\n                    size = ViewFactory.maxCacheSize;\n                }\n                else if (typeof size === 'string') {\n                    size = parseInt(size, 10);\n                }\n                if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n                    this.cacheSize = size;\n                }\n            }\n            if (this.cacheSize > 0) {\n                this.cache = [];\n            }\n            else {\n                this.cache = null;\n            }\n            this.isCaching = this.cacheSize > 0;\n        }\n        canReturnToCache(controller) {\n            return this.cache != null && this.cache.length < this.cacheSize;\n        }\n        tryReturnToCache(controller) {\n            if (this.canReturnToCache(controller)) {\n                this.cache.push(controller);\n                return true;\n            }\n            return false;\n        }\n        create(flags) {\n            const cache = this.cache;\n            let controller;\n            if (cache != null && cache.length > 0) {\n                controller = cache.pop();\n                return controller;\n            }\n            controller = Controller.forSyntheticView(this, this.lifecycle, this.context, flags);\n            return controller;\n        }\n    }\n    ViewFactory.maxCacheSize = 0xFFFF;\n    return ViewFactory;\n})();\nexport { ViewFactory };\nconst seenViews = new WeakSet();\nfunction notYetSeen($view) {\n    return !seenViews.has($view);\n}\nfunction toCustomElementDefinition($view) {\n    seenViews.add($view);\n    return CustomElementDefinition.create($view);\n}\nexport const Views = {\n    name: Protocol.resource.keyFor('views'),\n    has(value) {\n        return typeof value === 'function' && (Metadata.hasOwn(Views.name, value) || '$views' in value);\n    },\n    get(value) {\n        if (typeof value === 'function' && '$views' in value) {\n            // TODO: a `get` operation with side effects is not a good thing. Should refactor this to a proper resource kind.\n            const $views = value.$views;\n            const definitions = $views.filter(notYetSeen).map(toCustomElementDefinition);\n            for (const def of definitions) {\n                Views.add(value, def);\n            }\n        }\n        let views = Metadata.getOwn(Views.name, value);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [], value);\n        }\n        return views;\n    },\n    add(Type, partialDefinition) {\n        const definition = CustomElementDefinition.create(partialDefinition);\n        let views = Metadata.getOwn(Views.name, Type);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [definition], Type);\n        }\n        else {\n            views.push(definition);\n        }\n        return views;\n    },\n};\nexport function view(v) {\n    return function (target) {\n        Views.add(target, v);\n    };\n}\nexport const IViewLocator = DI.createInterface('IViewLocator')\n    .noDefault();\nexport class ViewLocator {\n    constructor() {\n        this.modelInstanceToBoundComponent = new WeakMap();\n        this.modelTypeToUnboundComponent = new Map();\n    }\n    static register(container) {\n        return Registration.singleton(IViewLocator, this).register(container);\n    }\n    getViewComponentForObject(object, viewNameOrSelector) {\n        if (object) {\n            const availableViews = Views.has(object.constructor) ? Views.get(object.constructor) : [];\n            const resolvedViewName = typeof viewNameOrSelector === 'function'\n                ? viewNameOrSelector(object, availableViews)\n                : this.getViewName(availableViews, viewNameOrSelector);\n            return this.getOrCreateBoundComponent(object, availableViews, resolvedViewName);\n        }\n        return null;\n    }\n    getOrCreateBoundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelInstanceToBoundComponent.get(object);\n        let BoundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelInstanceToBoundComponent.set(object, lookup);\n        }\n        else {\n            BoundComponent = lookup[resolvedViewName];\n        }\n        if (BoundComponent === void 0) {\n            const UnboundComponent = this.getOrCreateUnboundComponent(object, availableViews, resolvedViewName);\n            BoundComponent = CustomElement.define(CustomElement.getDefinition(UnboundComponent), class extends UnboundComponent {\n                constructor() {\n                    super(object);\n                }\n            });\n            lookup[resolvedViewName] = BoundComponent;\n        }\n        return BoundComponent;\n    }\n    getOrCreateUnboundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelTypeToUnboundComponent.get(object.constructor);\n        let UnboundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelTypeToUnboundComponent.set(object.constructor, lookup);\n        }\n        else {\n            UnboundComponent = lookup[resolvedViewName];\n        }\n        if (UnboundComponent === void 0) {\n            UnboundComponent = CustomElement.define(this.getView(availableViews, resolvedViewName), class {\n                constructor(viewModel) {\n                    this.viewModel = viewModel;\n                }\n                create(controller, parentContainer, definition) {\n                    const vm = this.viewModel;\n                    controller.scope = Scope.fromParent(controller.flags, controller.scope, vm);\n                    if (vm.create !== void 0) {\n                        return vm.create(controller, parentContainer, definition);\n                    }\n                }\n            });\n            const proto = UnboundComponent.prototype;\n            if ('beforeCompile' in object) {\n                proto.beforeCompile = function beforeCompile(controller) {\n                    this.viewModel.beforeCompile(controller);\n                };\n            }\n            if ('afterCompile' in object) {\n                proto.afterCompile = function afterCompile(controller) {\n                    this.viewModel.afterCompile(controller);\n                };\n            }\n            if ('afterCompileChildren' in object) {\n                proto.afterCompileChildren = function afterCompileChildren(controller) {\n                    this.viewModel.afterCompileChildren(controller);\n                };\n            }\n            if ('beforeBind' in object) {\n                proto.beforeBind = function beforeBind(initiator, parent, flags) {\n                    return this.viewModel.beforeBind(initiator, parent, flags);\n                };\n            }\n            if ('afterBind' in object) {\n                proto.afterBind = function afterBind(initiator, parent, flags) {\n                    return this.viewModel.afterBind(initiator, parent, flags);\n                };\n            }\n            if ('afterAttach' in object) {\n                proto.afterAttach = function afterAttach(initiator, parent, flags) {\n                    return this.viewModel.afterAttach(initiator, parent, flags);\n                };\n            }\n            if ('afterAttachChildren' in object) {\n                proto.afterAttachChildren = function afterAttachChildren(initiator, flags) {\n                    return this.viewModel.afterAttachChildren(initiator, flags);\n                };\n            }\n            if ('beforeDetach' in object) {\n                proto.beforeDetach = function beforeDetach(initiator, parent, flags) {\n                    return this.viewModel.beforeDetach(initiator, parent, flags);\n                };\n            }\n            if ('beforeUnbind' in object) {\n                proto.beforeUnbind = function beforeUnbind(initiator, parent, flags) {\n                    return this.viewModel.beforeUnbind(initiator, parent, flags);\n                };\n            }\n            if ('afterUnbind' in object) {\n                proto.afterUnbind = function afterUnbind(initiator, parent, flags) {\n                    return this.viewModel.afterUnbind(initiator, parent, flags);\n                };\n            }\n            if ('afterUnbindChildren' in object) {\n                proto.afterUnbindChildren = function afterUnbindChildren(initiator, flags) {\n                    return this.viewModel.afterUnbindChildren(initiator, flags);\n                };\n            }\n            if ('dispose' in object) {\n                proto.dispose = function dispose() {\n                    this.viewModel.dispose();\n                };\n            }\n            lookup[resolvedViewName] = UnboundComponent;\n        }\n        return UnboundComponent;\n    }\n    getViewName(views, requestedName) {\n        if (requestedName) {\n            return requestedName;\n        }\n        if (views.length === 1) {\n            return views[0].name;\n        }\n        return 'default-view';\n    }\n    getView(views, name) {\n        const v = views.find(x => x.name === name);\n        if (v === void 0) {\n            // TODO: Use Reporter\n            throw new Error(`Could not find view: ${name}`);\n        }\n        return v;\n    }\n}\n//# sourceMappingURL=view.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IViewLocator } from '../../templating/view';\nimport { valueConverter } from '../value-converter';\nlet ViewValueConverter = /** @class */ (() => {\n    let ViewValueConverter = class ViewValueConverter {\n        constructor(viewLocator) {\n            this.viewLocator = viewLocator;\n        }\n        toView(object, viewNameOrSelector) {\n            return this.viewLocator.getViewComponentForObject(object, viewNameOrSelector);\n        }\n    };\n    ViewValueConverter = __decorate([\n        valueConverter('view'),\n        __param(0, IViewLocator),\n        __metadata(\"design:paramtypes\", [Object])\n    ], ViewValueConverter);\n    return ViewValueConverter;\n})();\nexport { ViewValueConverter };\n//# sourceMappingURL=view.js.map","import { DI, Registration, } from '@aurelia/kernel';\nimport { ILifecycle } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, hasAsyncWork, TerminalTask, LifecycleTask, } from './lifecycle-task';\nimport { Controller } from './templating/controller';\nexport const IActivator = DI.createInterface('IActivator').withDefault(x => x.singleton(Activator));\n/** @internal */\nlet Activator = /** @class */ (() => {\n    class Activator {\n        constructor(taskManager) {\n            this.taskManager = taskManager;\n        }\n        static register(container) {\n            return Registration.singleton(IActivator, this).register(container);\n        }\n        activate(host, component, container, flags = 0 /* none */, parentScope) {\n            flags = flags === void 0 ? 0 /* none */ : flags;\n            const mgr = this.taskManager;\n            let task = mgr.runBeforeRender();\n            if (task.done) {\n                this.render(host, component, container, flags);\n            }\n            else {\n                task = new ContinuationTask(task, this.render, this, host, component, container, flags);\n            }\n            if (task.done) {\n                task = mgr.runBeforeBind();\n            }\n            else {\n                task = new ContinuationTask(task, mgr.runBeforeBind, mgr);\n            }\n            if (task.done) {\n                task = this.activateController(component, flags, parentScope);\n            }\n            else {\n                task = new ContinuationTask(task, this.activateController, this, component, flags, parentScope);\n            }\n            if (task.done) {\n                task = mgr.runAfterAttach();\n            }\n            else {\n                task = new ContinuationTask(task, mgr.runAfterAttach, mgr);\n            }\n            return task;\n        }\n        deactivate(component, flags = 0 /* none */) {\n            const controller = Controller.getCachedOrThrow(component);\n            const ret = controller.deactivate(controller, null, flags);\n            if (hasAsyncWork(ret)) {\n                return new TerminalTask(ret);\n            }\n            return LifecycleTask.done;\n        }\n        render(host, component, container, flags) {\n            const lifecycle = container.get(ILifecycle);\n            Controller.forCustomElement(component, lifecycle, host, container, null, flags);\n        }\n        activateController(component, flags, parentScope) {\n            const controller = Controller.getCachedOrThrow(component);\n            const ret = controller.activate(controller, null, flags | 32 /* fromBind */, parentScope);\n            if (hasAsyncWork(ret)) {\n                return new TerminalTask(ret);\n            }\n            return LifecycleTask.done;\n        }\n    }\n    Activator.inject = [IStartTaskManager];\n    return Activator;\n})();\nexport { Activator };\n//# sourceMappingURL=activator.js.map","import { DI, PLATFORM, Registration, InstanceProvider } from '@aurelia/kernel';\nimport { IActivator } from './activator';\nimport { INode } from './dom';\nimport { ILifecycle, } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, LifecycleTask, } from './lifecycle-task';\nimport { CustomElement } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nimport { HooksDefinition } from './definitions';\nexport class CompositionRoot {\n    constructor(config, container, rootProvider, enhance = false) {\n        this.config = config;\n        rootProvider.prepare(this);\n        if (config.host != void 0) {\n            if (container.has(INode, false)) {\n                this.container = container.createChild();\n            }\n            else {\n                this.container = container;\n            }\n            Registration.instance(INode, config.host).register(this.container);\n            this.host = config.host;\n        }\n        else if (container.has(INode, true)) {\n            this.container = container;\n            this.host = container.get(INode);\n        }\n        else {\n            throw new Error(`No host element found.`);\n        }\n        this.strategy = config.strategy != void 0 ? config.strategy : 1 /* getterSetter */;\n        const initializer = this.container.get(IDOMInitializer);\n        this.dom = initializer.initialize(config);\n        this.lifecycle = this.container.get(ILifecycle);\n        this.activator = this.container.get(IActivator);\n        const taskManager = this.container.get(IStartTaskManager);\n        const beforeCreateTask = taskManager.runBeforeCreate();\n        if (enhance) {\n            const component = config.component;\n            this.enhanceDefinition = CustomElement.getDefinition(CustomElement.isType(component)\n                ? CustomElement.define({ ...CustomElement.getDefinition(component), template: this.host, enhance: true }, component)\n                : CustomElement.define({ name: (void 0), template: this.host, enhance: true, hooks: new HooksDefinition(component) }));\n        }\n        if (beforeCreateTask.done) {\n            this.task = LifecycleTask.done;\n            this.create();\n        }\n        else {\n            this.task = new ContinuationTask(beforeCreateTask, this.create, this);\n        }\n    }\n    activate(antecedent) {\n        const { task, host, viewModel, container, activator, strategy } = this;\n        const flags = strategy;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.activate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.activate(host, viewModel, container, flags, void 0);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        return this.task;\n    }\n    deactivate(antecedent) {\n        const { task, viewModel, activator, strategy } = this;\n        const flags = strategy;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.deactivate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.deactivate(viewModel, flags);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.deactivate, activator, viewModel, flags);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        return this.task;\n    }\n    dispose() {\n        var _a;\n        (_a = this.controller) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    create() {\n        const config = this.config;\n        const instance = this.viewModel = CustomElement.isType(config.component)\n            ? this.container.get(config.component)\n            : config.component;\n        const container = this.container;\n        const lifecycle = container.get(ILifecycle);\n        const taskManager = container.get(IStartTaskManager);\n        taskManager.enqueueBeforeCompileChildren();\n        // This hack with delayed hydration is to make the controller instance accessible to the `beforeCompileChildren` hook via the composition root.\n        this.controller = Controller.forCustomElement(instance, lifecycle, this.host, container, null, this.strategy, false, this.enhanceDefinition);\n        this.controller['hydrateCustomElement'](container, null);\n    }\n}\nexport class Aurelia {\n    constructor(container = DI.createContainer()) {\n        if (container.has(Aurelia, true)) {\n            throw new Error('An instance of Aurelia is already registered with the container or an ancestor of it.');\n        }\n        this.container = container;\n        this.task = LifecycleTask.done;\n        this._isRunning = false;\n        this._isStarting = false;\n        this._isStopping = false;\n        this._root = void 0;\n        this.next = (void 0);\n        Registration.instance(Aurelia, this).register(container);\n        container.registerResolver(CompositionRoot, this.rootProvider = new InstanceProvider());\n    }\n    get isRunning() {\n        return this._isRunning;\n    }\n    get isStarting() {\n        return this._isStarting;\n    }\n    get isStopping() {\n        return this._isStopping;\n    }\n    get root() {\n        if (this._root == void 0) {\n            if (this.next == void 0) {\n                throw new Error(`root is not defined`); // TODO: create error code\n            }\n            return this.next;\n        }\n        return this._root;\n    }\n    register(...params) {\n        this.container.register(...params);\n        return this;\n    }\n    app(config) {\n        return this.configureRoot(config);\n    }\n    enhance(config) {\n        return this.configureRoot(config, true);\n    }\n    start(root = this.next) {\n        if (root == void 0) {\n            throw new Error(`There is no composition root`); // TODO: create error code\n        }\n        this.stop(root);\n        if (this.task.done) {\n            this.onBeforeStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onBeforeStart, this, root);\n        }\n        this.task = this.root.activate(this.task);\n        if (this.task.done) {\n            this.task = this.onAfterStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onAfterStart, this, root);\n        }\n        return this.task;\n    }\n    stop(root = this._root) {\n        if (this._isRunning && root != void 0) {\n            if (this.task.done) {\n                this.onBeforeStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onBeforeStop, this, root);\n            }\n            this.task = root.deactivate(this.task);\n            if (this.task.done) {\n                this.task = this.onAfterStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onAfterStop, this, root);\n            }\n        }\n        return this.task;\n    }\n    wait() {\n        return this.task.wait();\n    }\n    dispose() {\n        var _a;\n        if (this._isRunning || this._isStopping) {\n            throw new Error(`The aurelia instance must be fully stopped before it can be disposed`);\n        }\n        (_a = this._root) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._root = void 0;\n        this.container.dispose();\n    }\n    configureRoot(config, enhance) {\n        this.next = new CompositionRoot(config, this.container, this.rootProvider, enhance);\n        if (this.isRunning) {\n            this.start();\n        }\n        return this;\n    }\n    onBeforeStart(root) {\n        Reflect.set(root.host, '$aurelia', this);\n        this.rootProvider.prepare(this._root = root);\n        this._isStarting = true;\n    }\n    onAfterStart(root) {\n        this._isRunning = true;\n        this._isStarting = false;\n        this.dispatchEvent(root, 'aurelia-composed', root.dom);\n        this.dispatchEvent(root, 'au-started', root.host);\n        return LifecycleTask.done;\n    }\n    onBeforeStop(root) {\n        this._isRunning = false;\n        this._isStopping = true;\n    }\n    onAfterStop(root) {\n        Reflect.deleteProperty(root.host, '$aurelia');\n        this._root = void 0;\n        this.rootProvider.dispose();\n        this._isStopping = false;\n        this.dispatchEvent(root, 'au-stopped', root.host);\n        return LifecycleTask.done;\n    }\n    dispatchEvent(root, name, target) {\n        target = 'dispatchEvent' in target ? target : root.dom;\n        target.dispatchEvent(root.dom.createCustomEvent(name, { detail: this, bubbles: true, cancelable: true }));\n    }\n}\nPLATFORM.global.Aurelia = Aurelia;\nexport const IDOMInitializer = DI.createInterface('IDOMInitializer').noDefault();\n//# sourceMappingURL=aurelia.js.map","import { DI } from '@aurelia/kernel';\nimport { Lifecycle } from './lifecycle';\nimport { StartTaskManager } from './lifecycle-task';\nimport { ObserverLocator } from './observation/observer-locator';\nimport { CallBindingRenderer, CustomAttributeRenderer, CustomElementRenderer, InterpolationBindingRenderer, IteratorBindingRenderer, LetElementRenderer, PropertyBindingRenderer, RefBindingRenderer, Renderer, SetPropertyRenderer, TemplateControllerRenderer } from './renderer';\nimport { FromViewBindingBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nimport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern } from './attribute-patterns';\nimport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nimport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nimport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nimport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nimport { FrequentMutations, InfrequentMutations, ObserveShallow } from './resources/custom-attributes/flags';\nimport { Else, If } from './resources/custom-attributes/if';\nimport { Repeat } from './resources/custom-attributes/repeat';\nimport { With } from './resources/custom-attributes/with';\nimport { SanitizeValueConverter } from './resources/value-converters/sanitize';\nimport { ViewValueConverter } from './resources/value-converters/view';\nimport { ViewLocator } from './templating/view';\nimport { Now } from '@aurelia/scheduler';\nimport { AuSlot, ProjectionProvider } from './resources/custom-elements/au-slot';\nimport { ExpressionParser } from './binding/expression-parser';\nexport const AtPrefixedTriggerAttributePatternRegistration = AtPrefixedTriggerAttributePattern;\nexport const ColonPrefixedBindAttributePatternRegistration = ColonPrefixedBindAttributePattern;\nexport const RefAttributePatternRegistration = RefAttributePattern;\nexport const DotSeparatedAttributePatternRegistration = DotSeparatedAttributePattern;\nexport const IExpressionParserRegistration = ExpressionParser;\nexport const IObserverLocatorRegistration = ObserverLocator;\nexport const ILifecycleRegistration = Lifecycle;\nexport const IRendererRegistration = Renderer;\nexport const IStartTaskManagerRegistration = StartTaskManager;\nexport const IViewLocatorRegistration = ViewLocator;\n/**\n * Default binding syntax for the following attribute name patterns:\n * - `ref`\n * - `target.command` (dot-separated)\n */\nexport const DefaultBindingSyntax = [\n    RefAttributePatternRegistration,\n    DotSeparatedAttributePatternRegistration\n];\n/**\n * Binding syntax for short-hand attribute name patterns:\n * - `@target` (short-hand for `target.trigger`)\n * - `:target` (short-hand for `target.bind`)\n */\nexport const ShortHandBindingSyntax = [\n    AtPrefixedTriggerAttributePatternRegistration,\n    ColonPrefixedBindAttributePatternRegistration\n];\nexport const CallBindingCommandRegistration = CallBindingCommand;\nexport const DefaultBindingCommandRegistration = DefaultBindingCommand;\nexport const ForBindingCommandRegistration = ForBindingCommand;\nexport const FromViewBindingCommandRegistration = FromViewBindingCommand;\nexport const OneTimeBindingCommandRegistration = OneTimeBindingCommand;\nexport const ToViewBindingCommandRegistration = ToViewBindingCommand;\nexport const TwoWayBindingCommandRegistration = TwoWayBindingCommand;\n/**\n * Default runtime/environment-agnostic binding commands:\n * - Property observation: `.bind`, `.one-time`, `.from-view`, `.to-view`, `.two-way`\n * - Function call: `.call`\n * - Collection observation: `.for`\n */\nexport const DefaultBindingLanguage = [\n    DefaultBindingCommandRegistration,\n    OneTimeBindingCommandRegistration,\n    FromViewBindingCommandRegistration,\n    ToViewBindingCommandRegistration,\n    TwoWayBindingCommandRegistration,\n    CallBindingCommandRegistration,\n    ForBindingCommandRegistration\n];\n/**\n * Default implementations for the following interfaces:\n * - `IExpressionParserRegistration`\n * - `IObserverLocator`\n * - `ILifecycle`\n * - `IRenderer`\n * - `IStartTaskManager`\n * - `IViewLocator`\n * - `IClockRegistration`\n * - `ISchedulerRegistration`\n */\nexport const DefaultComponents = [\n    IExpressionParserRegistration,\n    IObserverLocatorRegistration,\n    ILifecycleRegistration,\n    IRendererRegistration,\n    IStartTaskManagerRegistration,\n    IViewLocatorRegistration,\n    Now,\n    ProjectionProvider,\n];\nexport const FrequentMutationsRegistration = FrequentMutations;\nexport const InfrequentMutationsRegistration = InfrequentMutations;\nexport const ObserveShallowRegistration = ObserveShallow;\nexport const IfRegistration = If;\nexport const ElseRegistration = Else;\nexport const RepeatRegistration = Repeat;\nexport const WithRegistration = With;\nexport const SanitizeValueConverterRegistration = SanitizeValueConverter;\nexport const ViewValueConverterRegistration = ViewValueConverter;\nexport const DebounceBindingBehaviorRegistration = DebounceBindingBehavior;\nexport const OneTimeBindingBehaviorRegistration = OneTimeBindingBehavior;\nexport const ToViewBindingBehaviorRegistration = ToViewBindingBehavior;\nexport const FromViewBindingBehaviorRegistration = FromViewBindingBehavior;\nexport const SignalBindingBehaviorRegistration = SignalBindingBehavior;\nexport const ThrottleBindingBehaviorRegistration = ThrottleBindingBehavior;\nexport const TwoWayBindingBehaviorRegistration = TwoWayBindingBehavior;\n/**\n * Default resources:\n * - Template controllers (`if`/`else`, `repeat`, `with`)\n * - Value Converters (`sanitize`)\n * - Binding Behaviors (`oneTime`, `toView`, `fromView`, `twoWay`, `signal`, `debounce`, `throttle`)\n * - Custom element: au-slot\n */\nexport const DefaultResources = [\n    FrequentMutationsRegistration,\n    InfrequentMutationsRegistration,\n    ObserveShallowRegistration,\n    IfRegistration,\n    ElseRegistration,\n    RepeatRegistration,\n    WithRegistration,\n    SanitizeValueConverterRegistration,\n    ViewValueConverterRegistration,\n    DebounceBindingBehaviorRegistration,\n    OneTimeBindingBehaviorRegistration,\n    ToViewBindingBehaviorRegistration,\n    FromViewBindingBehaviorRegistration,\n    SignalBindingBehaviorRegistration,\n    ThrottleBindingBehaviorRegistration,\n    TwoWayBindingBehaviorRegistration,\n    AuSlot,\n];\nexport const CallBindingRendererRegistration = CallBindingRenderer;\nexport const CustomAttributeRendererRegistration = CustomAttributeRenderer;\nexport const CustomElementRendererRegistration = CustomElementRenderer;\nexport const InterpolationBindingRendererRegistration = InterpolationBindingRenderer;\nexport const IteratorBindingRendererRegistration = IteratorBindingRenderer;\nexport const LetElementRendererRegistration = LetElementRenderer;\nexport const PropertyBindingRendererRegistration = PropertyBindingRenderer;\nexport const RefBindingRendererRegistration = RefBindingRenderer;\nexport const SetPropertyRendererRegistration = SetPropertyRenderer;\nexport const TemplateControllerRendererRegistration = TemplateControllerRenderer;\n/**\n * Default renderers for:\n * - PropertyBinding: `bind`, `one-time`, `to-view`, `from-view`, `two-way`\n * - IteratorBinding: `for`\n * - CallBinding: `call`\n * - RefBinding: `ref`\n * - InterpolationBinding: `${}`\n * - SetProperty\n * - `customElement` hydration\n * - `customAttribute` hydration\n * - `templateController` hydration\n * - `let` element hydration\n */\nexport const DefaultRenderers = [\n    PropertyBindingRendererRegistration,\n    IteratorBindingRendererRegistration,\n    CallBindingRendererRegistration,\n    RefBindingRendererRegistration,\n    InterpolationBindingRendererRegistration,\n    SetPropertyRendererRegistration,\n    CustomElementRendererRegistration,\n    CustomAttributeRendererRegistration,\n    TemplateControllerRendererRegistration,\n    LetElementRendererRegistration\n];\n/**\n * A DI configuration object containing environment/runtime-agnostic registrations:\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers, ...DefaultBindingSyntax, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { kebabCase, Metadata, } from '@aurelia/kernel';\nimport { BindingCommand } from './binding-command';\nimport { BindingMode } from './flags';\nimport { CustomAttribute } from './resources/custom-attribute';\nimport { CustomElement } from './resources/custom-element';\n/**\n * A pre-processed piece of information about a defined bindable property on a custom\n * element or attribute, optimized for consumption by the template compiler.\n */\nexport class BindableInfo {\n    constructor(\n    /**\n     * The pre-processed *property* (not attribute) name of the bindable, which is\n     * (in order of priority):\n     *\n     * 1. The `property` from the description (if defined)\n     * 2. The name of the property of the bindable itself\n     */\n    propName, \n    /**\n     * The pre-processed (default) bindingMode of the bindable, which is (in order of priority):\n     *\n     * 1. The `mode` from the bindable (if defined and not bindingMode.default)\n     * 2. The `defaultBindingMode` (if it's an attribute, defined, and not bindingMode.default)\n     * 3. `bindingMode.toView`\n     */\n    mode) {\n        this.propName = propName;\n        this.mode = mode;\n    }\n}\n/**\n * Pre-processed information about a custom element resource, optimized\n * for consumption by the template compiler.\n */\nexport class ElementInfo {\n    constructor(name, containerless) {\n        this.name = name;\n        this.containerless = containerless;\n        /**\n         * A lookup of the bindables of this element, indexed by the (pre-processed)\n         * attribute names as they would be found in parsed markup.\n         */\n        this.bindables = Object.create(null);\n    }\n    static from(def) {\n        const info = new ElementInfo(def.name, def.containerless);\n        const bindables = def.bindables;\n        const defaultBindingMode = BindingMode.toView;\n        let bindable;\n        let prop;\n        let attr;\n        let mode;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            // explicitly provided attribute name has priority over the derived implicit attribute name\n            if (bindable.attribute !== void 0) {\n                attr = bindable.attribute;\n            }\n            else {\n                // derive the attribute name from the resolved property name\n                attr = kebabCase(prop);\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            info.bindables[attr] = new BindableInfo(prop, mode);\n        }\n        return info;\n    }\n}\n/**\n * Pre-processed information about a custom attribute resource, optimized\n * for consumption by the template compiler.\n */\nexport class AttrInfo {\n    constructor(name, isTemplateController, noMultiBindings) {\n        this.name = name;\n        this.isTemplateController = isTemplateController;\n        this.noMultiBindings = noMultiBindings;\n        /**\n         * A lookup of the bindables of this attribute, indexed by the (pre-processed)\n         * bindable names as they would be found in the attribute value.\n         *\n         * Only applicable to multi attribute bindings (semicolon-separated).\n         */\n        this.bindables = Object.create(null);\n        /**\n         * The single or first bindable of this attribute, or a default 'value'\n         * bindable if no bindables were defined on the attribute.\n         *\n         * Only applicable to single attribute bindings (where the attribute value\n         * contains no semicolons)\n         */\n        this.bindable = null;\n    }\n    static from(def) {\n        const info = new AttrInfo(def.name, def.isTemplateController, def.noMultiBindings);\n        const bindables = def.bindables;\n        const defaultBindingMode = def.defaultBindingMode !== void 0 && def.defaultBindingMode !== BindingMode.default\n            ? def.defaultBindingMode\n            : BindingMode.toView;\n        let bindable;\n        let prop;\n        let mode;\n        let hasPrimary = false;\n        let isPrimary = false;\n        let bindableInfo;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            isPrimary = bindable.primary === true;\n            bindableInfo = info.bindables[prop] = new BindableInfo(prop, mode);\n            if (isPrimary) {\n                if (hasPrimary) {\n                    throw new Error('primary already exists');\n                }\n                hasPrimary = true;\n                info.bindable = bindableInfo;\n            }\n            // set to first bindable by convention\n            if (info.bindable === null) {\n                info.bindable = bindableInfo;\n            }\n        }\n        // if no bindables are present, default to \"value\"\n        if (info.bindable === null) {\n            info.bindable = new BindableInfo('value', defaultBindingMode);\n        }\n        return info;\n    }\n}\nconst contextLookup = new WeakMap();\n/**\n * A pre-processed piece of information about declared custom elements, attributes and\n * binding commands, optimized for consumption by the template compiler.\n */\nexport class ResourceModel {\n    constructor(container) {\n        this.elementLookup = Object.create(null);\n        this.attributeLookup = Object.create(null);\n        this.commandLookup = Object.create(null);\n        // Note: don't do this sort of thing elsewhere, this is purely for perf reasons\n        this.container = container;\n        const rootContainer = container.root;\n        this.resourceResolvers = container.resourceResolvers;\n        this.rootResourceResolvers = rootContainer.resourceResolvers;\n    }\n    static getOrCreate(context) {\n        let model = contextLookup.get(context);\n        if (model === void 0) {\n            contextLookup.set(context, model = new ResourceModel(context));\n        }\n        return model;\n    }\n    /**\n     * Retrieve information about a custom element resource.\n     *\n     * @param element - The original DOM element.\n     *\n     * @returns The resource information if the element exists, or `null` if it does not exist.\n     */\n    getElementInfo(name) {\n        let result = this.elementLookup[name];\n        if (result === void 0) {\n            const def = this.find(CustomElement, name);\n            this.elementLookup[name] = result = def === null ? null : ElementInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve information about a custom attribute resource.\n     *\n     * @param syntax - The parsed `AttrSyntax`\n     *\n     * @returns The resource information if the attribute exists, or `null` if it does not exist.\n     */\n    getAttributeInfo(syntax) {\n        let result = this.attributeLookup[syntax.target];\n        if (result === void 0) {\n            const def = this.find(CustomAttribute, syntax.target);\n            this.attributeLookup[syntax.target] = result = def === null ? null : AttrInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve a binding command resource.\n     *\n     * @param name - The parsed `AttrSyntax`\n     *\n     * @returns An instance of the command if it exists, or `null` if it does not exist.\n     */\n    getBindingCommand(syntax, optional) {\n        const name = syntax.command;\n        if (name === null) {\n            return null;\n        }\n        let result = this.commandLookup[name];\n        if (result === void 0) {\n            result = this.create(BindingCommand, name);\n            if (result === null) {\n                if (optional) {\n                    return null;\n                }\n                throw new Error(`Unknown binding command: ${name}`);\n            }\n            this.commandLookup[name] = result;\n        }\n        return result;\n    }\n    find(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        if (typeof resolver.getFactory === 'function') {\n            const factory = resolver.getFactory(this.container);\n            if (factory === null || factory === void 0) {\n                return null;\n            }\n            const definition = Metadata.getOwn(kind.name, factory.Type);\n            if (definition === void 0) {\n                // TODO: we may want to log a warning here, or even throw. This would happen if a dependency is registered with a resource-like key\n                // but does not actually have a definition associated via the type's metadata. That *should* generally not happen.\n                return null;\n            }\n            return definition;\n        }\n        return null;\n    }\n    create(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        const instance = resolver.resolve(this.container, this.container);\n        if (instance === void 0) {\n            return null;\n        }\n        return instance;\n    }\n}\n//# sourceMappingURL=resource-model.js.map","import { DI } from '@aurelia/kernel';\nexport const IAttrSyntaxTransformer = DI.createInterface('IAttrSyntaxTransformer').noDefault();\n//# sourceMappingURL=attribute-syntax-transformer.js.map","import { DelegationStrategy } from '@aurelia/runtime';\nexport class TextBindingInstruction {\n    constructor(from) {\n        this.from = from;\n        this.type = \"ha\" /* textBinding */;\n    }\n}\nexport class TriggerBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = true;\n        this.strategy = DelegationStrategy.none;\n    }\n}\nexport class DelegateBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.bubbling;\n    }\n}\nexport class CaptureBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.capturing;\n    }\n}\nexport class StylePropertyBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hd\" /* stylePropertyBinding */;\n    }\n}\nexport class SetAttributeInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"he\" /* setAttribute */;\n    }\n}\nexport class SetClassAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hf\" /* setClassAttribute */;\n    }\n}\nexport class SetStyleAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hg\" /* setStyleAttribute */;\n    }\n}\nexport class AttributeBindingInstruction {\n    constructor(\n    /**\n     * `attr` and `to` have the same value on a normal attribute\n     * Will be different on `class` and `style`\n     * on `class`: attr = `class` (from binding command), to = attribute name\n     * on `style`: attr = `style` (from binding command), to = attribute name\n     */\n    attr, from, to) {\n        this.attr = attr;\n        this.from = from;\n        this.to = to;\n        this.type = \"hc\" /* attributeBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { RefBindingInstruction, bindingCommand, getTarget, } from '@aurelia/runtime';\nimport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, TriggerBindingInstruction, } from './instructions';\n/**\n * Trigger binding command. Compile attr with binding symbol with command `trigger` to `TriggerBindingInstruction`\n */\nlet TriggerBindingCommand = /** @class */ (() => {\n    let TriggerBindingCommand = class TriggerBindingCommand {\n        constructor() {\n            this.bindingType = 4182 /* TriggerCommand */;\n        }\n        compile(binding) {\n            return new TriggerBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    TriggerBindingCommand = __decorate([\n        bindingCommand('trigger')\n    ], TriggerBindingCommand);\n    return TriggerBindingCommand;\n})();\nexport { TriggerBindingCommand };\n/**\n * Delegate binding command. Compile attr with binding symbol with command `delegate` to `DelegateBindingInstruction`\n */\nlet DelegateBindingCommand = /** @class */ (() => {\n    let DelegateBindingCommand = class DelegateBindingCommand {\n        constructor() {\n            this.bindingType = 4184 /* DelegateCommand */;\n        }\n        compile(binding) {\n            return new DelegateBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    DelegateBindingCommand = __decorate([\n        bindingCommand('delegate')\n    ], DelegateBindingCommand);\n    return DelegateBindingCommand;\n})();\nexport { DelegateBindingCommand };\n/**\n * Capture binding command. Compile attr with binding symbol with command `capture` to `CaptureBindingInstruction`\n */\nlet CaptureBindingCommand = /** @class */ (() => {\n    let CaptureBindingCommand = class CaptureBindingCommand {\n        constructor() {\n            this.bindingType = 4183 /* CaptureCommand */;\n        }\n        compile(binding) {\n            return new CaptureBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    CaptureBindingCommand = __decorate([\n        bindingCommand('capture')\n    ], CaptureBindingCommand);\n    return CaptureBindingCommand;\n})();\nexport { CaptureBindingCommand };\n/**\n * Attr binding command. Compile attr with binding symbol with command `attr` to `AttributeBindingInstruction`\n */\nlet AttrBindingCommand = /** @class */ (() => {\n    let AttrBindingCommand = class AttrBindingCommand {\n        constructor() {\n            this.bindingType = 32 /* IsProperty */;\n        }\n        compile(binding) {\n            const target = getTarget(binding, false);\n            return new AttributeBindingInstruction(target, binding.expression, target);\n        }\n    };\n    AttrBindingCommand = __decorate([\n        bindingCommand('attr')\n    ], AttrBindingCommand);\n    return AttrBindingCommand;\n})();\nexport { AttrBindingCommand };\n/**\n * Style binding command. Compile attr with binding symbol with command `style` to `AttributeBindingInstruction`\n */\nlet StyleBindingCommand = /** @class */ (() => {\n    let StyleBindingCommand = class StyleBindingCommand {\n        constructor() {\n            this.bindingType = 32 /* IsProperty */;\n        }\n        compile(binding) {\n            return new AttributeBindingInstruction('style', binding.expression, getTarget(binding, false));\n        }\n    };\n    StyleBindingCommand = __decorate([\n        bindingCommand('style')\n    ], StyleBindingCommand);\n    return StyleBindingCommand;\n})();\nexport { StyleBindingCommand };\n/**\n * Class binding command. Compile attr with binding symbol with command `class` to `AttributeBindingInstruction`\n */\nlet ClassBindingCommand = /** @class */ (() => {\n    let ClassBindingCommand = class ClassBindingCommand {\n        constructor() {\n            this.bindingType = 32 /* IsProperty */;\n        }\n        compile(binding) {\n            return new AttributeBindingInstruction('class', binding.expression, getTarget(binding, false));\n        }\n    };\n    ClassBindingCommand = __decorate([\n        bindingCommand('class')\n    ], ClassBindingCommand);\n    return ClassBindingCommand;\n})();\nexport { ClassBindingCommand };\n/**\n * Binding command to refer different targets (element, custom element/attribute view models, controller) afterAttachChildren to an element\n */\nlet RefBindingCommand = /** @class */ (() => {\n    let RefBindingCommand = class RefBindingCommand {\n        constructor() {\n            this.bindingType = 32 /* IsProperty */ | 4096 /* IgnoreCustomAttr */;\n        }\n        compile(binding) {\n            return new RefBindingInstruction(binding.expression, getTarget(binding, false));\n        }\n    };\n    RefBindingCommand = __decorate([\n        bindingCommand('ref')\n    ], RefBindingCommand);\n    return RefBindingCommand;\n})();\nexport { RefBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","/**\n * Listener binding. Handle event binding between view and view model\n */\nexport class Listener {\n    constructor(dom, targetEvent, delegationStrategy, sourceExpression, target, preventDefault, eventManager, locator) {\n        this.dom = dom;\n        this.targetEvent = targetEvent;\n        this.delegationStrategy = delegationStrategy;\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.preventDefault = preventDefault;\n        this.eventManager = eventManager;\n        this.locator = locator;\n        this.interceptor = this;\n        this.isBound = false;\n        this.$hostScope = null;\n    }\n    callSource(event) {\n        const overrideContext = this.$scope.overrideContext;\n        overrideContext.$event = event;\n        const result = this.sourceExpression.evaluate(128 /* mustEvaluate */, this.$scope, this.$hostScope, this.locator);\n        Reflect.deleteProperty(overrideContext, '$event');\n        if (result !== true && this.preventDefault) {\n            event.preventDefault();\n        }\n        return result;\n    }\n    handleEvent(event) {\n        this.interceptor.callSource(event);\n    }\n    $bind(flags, scope, hostScope) {\n        if (this.isBound) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 32 /* fromBind */);\n        }\n        this.$scope = scope;\n        this.$hostScope = hostScope;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.hasBind) {\n            sourceExpression.bind(flags, scope, hostScope, this.interceptor);\n        }\n        this.handler = this.eventManager.addEventListener(this.dom, this.target, this.targetEvent, this, this.delegationStrategy);\n        // add isBound flag and remove isBinding flag\n        this.isBound = true;\n    }\n    $unbind(flags) {\n        if (!this.isBound) {\n            return;\n        }\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.hasUnbind) {\n            sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n        }\n        this.$scope = null;\n        this.handler.dispose();\n        this.handler = null;\n        // remove isBound and isUnbinding flags\n        this.isBound = false;\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n    dispose() {\n        this.interceptor = (void 0);\n        this.sourceExpression = (void 0);\n        this.locator = (void 0);\n        this.target = (void 0);\n    }\n}\n//# sourceMappingURL=listener.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { DOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\n/**\n * Observer for handling two-way binding with attributes\n * Has different strategy for class/style and normal attributes\n * TODO: handle SVG/attributes with namespace\n */\nlet AttributeObserver = /** @class */ (() => {\n    let AttributeObserver = class AttributeObserver {\n        constructor(scheduler, flags, observerLocator, obj, propertyKey, targetAttribute) {\n            this.scheduler = scheduler;\n            this.observerLocator = observerLocator;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.targetAttribute = targetAttribute;\n            this.currentValue = null;\n            this.oldValue = null;\n            this.hasChanges = false;\n            this.task = null;\n            // layout is not certain, depends on the attribute being flushed to owner element\n            // but for simple start, always treat as such\n            this.type = 2 /* Node */ | 1 /* Observer */ | 64 /* Layout */;\n            this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n        }\n        getValue() {\n            // is it safe to assume the observer has the latest value?\n            // todo: ability to turn on/off cache based on type\n            return this.currentValue;\n        }\n        setValue(newValue, flags) {\n            this.currentValue = newValue;\n            this.hasChanges = newValue !== this.oldValue;\n            if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n                this.flushChanges(flags);\n            }\n        }\n        flushChanges(flags) {\n            if (this.hasChanges) {\n                this.hasChanges = false;\n                const currentValue = this.currentValue;\n                this.oldValue = currentValue;\n                switch (this.targetAttribute) {\n                    case 'class': {\n                        // Why is class attribute observer setValue look different with class attribute accessor?\n                        // ==============\n                        // For class list\n                        // newValue is simply checked if truthy or falsy\n                        // and toggle the class accordingly\n                        // -- the rule of this is quite different to normal attribute\n                        //\n                        // for class attribute, observer is different in a way that it only observe a particular class at a time\n                        // this also comes from syntax, where it would typically be my-class.class=\"someProperty\"\n                        //\n                        // so there is no need for separating class by space and add all of them like class accessor\n                        if (!!currentValue) {\n                            this.obj.classList.add(this.propertyKey);\n                        }\n                        else {\n                            this.obj.classList.remove(this.propertyKey);\n                        }\n                        break;\n                    }\n                    case 'style': {\n                        let priority = '';\n                        let newValue = currentValue;\n                        if (typeof newValue === 'string' && newValue.includes('!important')) {\n                            priority = 'important';\n                            newValue = newValue.replace('!important', '');\n                        }\n                        this.obj.style.setProperty(this.propertyKey, newValue, priority);\n                    }\n                }\n            }\n        }\n        handleMutation(mutationRecords) {\n            let shouldProcess = false;\n            for (let i = 0, ii = mutationRecords.length; ii > i; ++i) {\n                const record = mutationRecords[i];\n                if (record.type === 'attributes' && record.attributeName === this.propertyKey) {\n                    shouldProcess = true;\n                    break;\n                }\n            }\n            if (shouldProcess) {\n                let newValue;\n                switch (this.targetAttribute) {\n                    case 'class':\n                        newValue = this.obj.classList.contains(this.propertyKey);\n                        break;\n                    case 'style':\n                        newValue = this.obj.style.getPropertyValue(this.propertyKey);\n                        break;\n                    default:\n                        throw new Error(`Unsupported targetAttribute: ${this.targetAttribute}`);\n                }\n                if (newValue !== this.currentValue) {\n                    const { currentValue } = this;\n                    this.currentValue = this.oldValue = newValue;\n                    this.hasChanges = false;\n                    this.callSubscribers(newValue, currentValue, 0 /* none */);\n                }\n            }\n        }\n        subscribe(subscriber) {\n            if (!this.hasSubscribers()) {\n                this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n                startObservation(this.obj, this);\n            }\n            this.addSubscriber(subscriber);\n        }\n        unsubscribe(subscriber) {\n            this.removeSubscriber(subscriber);\n            if (!this.hasSubscribers()) {\n                stopObservation(this.obj, this);\n            }\n        }\n    };\n    AttributeObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String, String])\n    ], AttributeObserver);\n    return AttributeObserver;\n})();\nexport { AttributeObserver };\nconst startObservation = (element, subscription) => {\n    if (element.$eMObservers === undefined) {\n        element.$eMObservers = new Set();\n    }\n    if (element.$mObserver === undefined) {\n        element.$mObserver = DOM.createNodeObserver(element, handleMutation, { attributes: true });\n    }\n    element.$eMObservers.add(subscription);\n};\nconst stopObservation = (element, subscription) => {\n    const $eMObservers = element.$eMObservers;\n    if ($eMObservers && $eMObservers.delete(subscription)) {\n        if ($eMObservers.size === 0) {\n            element.$mObserver.disconnect();\n            element.$mObserver = undefined;\n        }\n        return true;\n    }\n    return false;\n};\nconst handleMutation = (mutationRecords) => {\n    mutationRecords[0].target.$eMObservers.forEach(invokeHandleMutation, mutationRecords);\n};\nfunction invokeHandleMutation(s) {\n    s.handleMutation(this);\n}\n//# sourceMappingURL=element-attribute-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, } from '@aurelia/kernel';\nimport { BindingMode, connectable, IObserverLocator, IScheduler, INode, } from '@aurelia/runtime';\nimport { AttributeObserver, } from '../observation/element-attribute-observer';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nconst taskOptions = {\n    reusable: false,\n    preempt: true,\n};\n/**\n * Attribute binding. Handle attribute binding betwen view/view model. Understand Html special attributes\n */\nlet AttributeBinding = /** @class */ (() => {\n    let AttributeBinding = class AttributeBinding {\n        constructor(sourceExpression, target, \n        // some attributes may have inner structure\n        // such as class -> collection of class names\n        // such as style -> collection of style rules\n        //\n        // for normal attributes, targetAttribute and targetProperty are the same and can be ignore\n        targetAttribute, targetProperty, mode, observerLocator, locator) {\n            this.sourceExpression = sourceExpression;\n            this.targetAttribute = targetAttribute;\n            this.targetProperty = targetProperty;\n            this.mode = mode;\n            this.observerLocator = observerLocator;\n            this.locator = locator;\n            this.interceptor = this;\n            this.isBound = false;\n            this.$scope = null;\n            this.$hostScope = null;\n            this.task = null;\n            this.persistentFlags = 0 /* none */;\n            this.target = target;\n            connectable.assignIdTo(this);\n            this.$scheduler = locator.get(IScheduler);\n        }\n        updateTarget(value, flags) {\n            flags |= this.persistentFlags;\n            this.targetObserver.setValue(value, flags | 8 /* updateTargetInstance */);\n        }\n        updateSource(value, flags) {\n            flags |= this.persistentFlags;\n            this.sourceExpression.assign(flags | 16 /* updateSourceExpression */, this.$scope, this.$hostScope, this.locator, value);\n        }\n        handleChange(newValue, _previousValue, flags) {\n            var _a, _b;\n            if (!this.isBound) {\n                return;\n            }\n            flags |= this.persistentFlags;\n            const mode = this.mode;\n            const interceptor = this.interceptor;\n            const sourceExpression = this.sourceExpression;\n            const $scope = this.$scope;\n            const locator = this.locator;\n            if (mode === BindingMode.fromView) {\n                flags &= ~8 /* updateTargetInstance */;\n                flags |= 16 /* updateSourceExpression */;\n            }\n            if (flags & 8 /* updateTargetInstance */) {\n                const targetObserver = this.targetObserver;\n                // Alpha: during bind a simple strategy for bind is always flush immediately\n                // todo:\n                //  (1). determine whether this should be the behavior\n                //  (2). if not, then fix tests to reflect the changes/scheduler to properly yield all with aurelia.start().wait()\n                const shouldQueueFlush = (flags & 32 /* fromBind */) === 0 && (targetObserver.type & 64 /* Layout */) > 0;\n                const oldValue = targetObserver.getValue();\n                if (sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                    newValue = sourceExpression.evaluate(flags, $scope, this.$hostScope, locator);\n                }\n                if (newValue !== oldValue) {\n                    if (shouldQueueFlush) {\n                        flags |= 4096 /* noTargetObserverQueue */;\n                        (_a = this.task) === null || _a === void 0 ? void 0 : _a.cancel();\n                        (_b = targetObserver.task) === null || _b === void 0 ? void 0 : _b.cancel();\n                        targetObserver.task = this.task = this.$scheduler.queueRenderTask(() => {\n                            var _a, _b;\n                            (_b = (_a = targetObserver).flushChanges) === null || _b === void 0 ? void 0 : _b.call(_a, flags);\n                            this.task = targetObserver.task = null;\n                        }, taskOptions);\n                    }\n                    interceptor.updateTarget(newValue, flags);\n                }\n                if ((mode & oneTime) === 0) {\n                    this.version++;\n                    sourceExpression.connect(flags, $scope, this.$hostScope, interceptor);\n                    interceptor.unobserve(false);\n                }\n                return;\n            }\n            if (flags & 16 /* updateSourceExpression */) {\n                if (newValue !== this.sourceExpression.evaluate(flags, $scope, this.$hostScope, locator)) {\n                    interceptor.updateSource(newValue, flags);\n                }\n                return;\n            }\n            throw new Error('Unexpected handleChange context in AttributeBinding');\n        }\n        $bind(flags, scope, hostScope, projection) {\n            if (this.isBound) {\n                if (this.$scope === scope) {\n                    return;\n                }\n                this.interceptor.$unbind(flags | 32 /* fromBind */);\n            }\n            // Store flags which we can only receive during $bind and need to pass on\n            // to the AST during evaluate/connect/assign\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            this.$scope = scope;\n            this.$hostScope = hostScope;\n            this.projection = projection;\n            let sourceExpression = this.sourceExpression;\n            if (sourceExpression.hasBind) {\n                sourceExpression.bind(flags, scope, hostScope, this.interceptor);\n            }\n            let targetObserver = this.targetObserver;\n            if (!targetObserver) {\n                targetObserver = this.targetObserver = new AttributeObserver(this.$scheduler, flags, this.observerLocator, this.target, this.targetProperty, this.targetAttribute);\n            }\n            if (targetObserver.bind) {\n                targetObserver.bind(flags);\n            }\n            // during bind, binding behavior might have changed sourceExpression\n            sourceExpression = this.sourceExpression;\n            const $mode = this.mode;\n            const interceptor = this.interceptor;\n            if ($mode & toViewOrOneTime) {\n                interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.$hostScope, this.locator), flags);\n            }\n            if ($mode & toView) {\n                sourceExpression.connect(flags, scope, this.$hostScope, this);\n            }\n            if ($mode & fromView) {\n                targetObserver[this.id] |= 16 /* updateSourceExpression */;\n                targetObserver.subscribe(interceptor);\n            }\n            // add isBound flag and remove isBinding flag\n            this.isBound = true;\n        }\n        $unbind(flags) {\n            if (!this.isBound) {\n                return;\n            }\n            // clear persistent flags\n            this.persistentFlags = 0 /* none */;\n            if (this.sourceExpression.hasUnbind) {\n                this.sourceExpression.unbind(flags, this.$scope, this.$hostScope, this.interceptor);\n            }\n            this.$scope = null;\n            const targetObserver = this.targetObserver;\n            const task = this.task;\n            if (targetObserver.unbind) {\n                targetObserver.unbind(flags);\n            }\n            if (targetObserver.unsubscribe) {\n                targetObserver.unsubscribe(this.interceptor);\n                targetObserver[this.id] &= ~16 /* updateSourceExpression */;\n            }\n            if (task != null) {\n                task.cancel();\n                if (task === targetObserver.task) {\n                    targetObserver.task = null;\n                }\n                this.task = null;\n            }\n            this.interceptor.unobserve(true);\n            // remove isBound and isUnbinding flags\n            this.isBound = false;\n        }\n        connect(flags) {\n            if (this.isBound) {\n                flags |= this.persistentFlags;\n                this.sourceExpression.connect(flags | 128 /* mustEvaluate */, this.$scope, this.$hostScope, this.interceptor); // why do we have a connect method here in the first place? will this be called after bind?\n            }\n        }\n        dispose() {\n            this.interceptor = (void 0);\n            this.sourceExpression = (void 0);\n            this.locator = (void 0);\n            this.targetObserver = (void 0);\n            this.target = (void 0);\n        }\n    };\n    AttributeBinding = __decorate([\n        connectable(),\n        __metadata(\"design:paramtypes\", [Object, Object, String, String, Number, Object, Object])\n    ], AttributeBinding);\n    return AttributeBinding;\n})();\nexport { AttributeBinding };\n//# sourceMappingURL=attribute.js.map","/**\n * Attribute accessor in a XML document/element that can be accessed via a namespace.\n * Wraps [`getAttributeNS`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS).\n */\nexport class AttributeNSAccessor {\n    constructor(scheduler, flags, obj, propertyKey, namespace) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.namespace = namespace;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        // ObserverType.Layout is not always true, it depends on the property\n        // but for simplicity, always treat as such\n        this.type = 2 /* Node */ | 64 /* Layout */;\n        this.obj = obj;\n        this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n    }\n    getValue() {\n        // is it safe to assume the observer has the latest value?\n        // todo: ability to turn on/off cache based on type\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n            this.flushChanges(flags);\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.currentValue;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttributeNS(this.namespace, this.propertyKey);\n            }\n            else {\n                this.obj.setAttributeNS(this.namespace, this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        this.currentValue = this.oldValue = this.obj.getAttributeNS(this.namespace, this.propertyKey);\n    }\n}\n//# sourceMappingURL=attribute-ns-accessor.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection, IScheduler, getCollectionObserver, ILifecycle, } from '@aurelia/runtime';\nconst toStringTag = Object.prototype.toString;\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet CheckedObserver = /** @class */ (() => {\n    let CheckedObserver = class CheckedObserver {\n        constructor(scheduler, flags, lifecycle, handler, obj) {\n            this.scheduler = scheduler;\n            this.lifecycle = lifecycle;\n            this.handler = handler;\n            this.obj = obj;\n            this.currentValue = void 0;\n            this.oldValue = void 0;\n            this.hasChanges = false;\n            this.task = null;\n            // ObserverType.Layout is not always true, it depends on the property\n            // but for simplicity, always treat as such\n            this.type = 2 /* Node */ | 1 /* Observer */ | 64 /* Layout */;\n            this.collectionObserver = void 0;\n            this.valueObserver = void 0;\n            this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n        }\n        getValue() {\n            // is it safe to assume the observer has the latest value?\n            // todo: ability to turn on/off cache based on type\n            return this.currentValue;\n        }\n        setValue(newValue, flags) {\n            this.currentValue = newValue;\n            this.hasChanges = newValue !== this.oldValue;\n            if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n                this.flushChanges(flags);\n            }\n        }\n        flushChanges(flags) {\n            if (this.hasChanges) {\n                this.hasChanges = false;\n                const currentValue = this.oldValue = this.currentValue;\n                if (this.valueObserver === void 0) {\n                    if (this.obj.$observers !== void 0) {\n                        if (this.obj.$observers.model !== void 0) {\n                            this.valueObserver = this.obj.$observers.model;\n                        }\n                        else if (this.obj.$observers.value !== void 0) {\n                            this.valueObserver = this.obj.$observers.value;\n                        }\n                    }\n                    if (this.valueObserver !== void 0) {\n                        this.valueObserver.subscribe(this);\n                    }\n                }\n                if (this.collectionObserver !== void 0) {\n                    this.collectionObserver.unsubscribeFromCollection(this);\n                    this.collectionObserver = void 0;\n                }\n                if (this.obj.type === 'checkbox') {\n                    this.collectionObserver = getCollectionObserver(flags, this.lifecycle, currentValue);\n                    if (this.collectionObserver !== void 0) {\n                        this.collectionObserver.subscribeToCollection(this);\n                    }\n                }\n                this.synchronizeElement();\n            }\n        }\n        handleCollectionChange(indexMap, flags) {\n            const currentValue = this.currentValue;\n            const oldValue = this.oldValue;\n            this.oldValue = currentValue;\n            this.synchronizeElement();\n            // if ((flags & LifecycleFlags.fromBind) > 0 || this.persistentFlags === LifecycleFlags.noTargetObserverQueue) {\n            // } else {\n            //   this.hasChanges = true;\n            // }\n            // if (this.persistentFlags !== LifecycleFlags.persistentTargetObserverQueue && this.task === null) {\n            //   this.task = this.scheduler.queueRenderTask(() => {\n            //     this.flushChanges(flags);\n            //     this.task = null;\n            //   });\n            // }\n            this.callSubscribers(currentValue, oldValue, flags);\n        }\n        handleChange(newValue, previousValue, flags) {\n            // if ((flags & LifecycleFlags.fromBind) > 0 || this.persistentFlags === LifecycleFlags.noTargetObserverQueue) {\n            //   this.synchronizeElement();\n            // } else {\n            //   this.hasChanges = true;\n            // }\n            // if (this.persistentFlags !== LifecycleFlags.persistentTargetObserverQueue && this.task === null) {\n            //   this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags));\n            // }\n            this.synchronizeElement();\n            this.callSubscribers(newValue, previousValue, flags);\n            this.flushChanges(flags);\n        }\n        synchronizeElement() {\n            const currentValue = this.currentValue;\n            const obj = this.obj;\n            const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n            const isRadio = obj.type === 'radio';\n            const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n            if (isRadio) {\n                obj.checked = !!matcher(currentValue, elementValue);\n            }\n            else if (currentValue === true) {\n                obj.checked = true;\n            }\n            else {\n                let hasMatch = false;\n                switch (toStringTag.call(currentValue)) {\n                    case '[object Array]':\n                        hasMatch = currentValue.findIndex(item => !!matcher(item, elementValue)) !== -1;\n                        break;\n                    case '[object Set]':\n                        for (const v of currentValue) {\n                            if (matcher(v, elementValue)) {\n                                hasMatch = true;\n                                break;\n                            }\n                        }\n                        break;\n                    case '[object Map]':\n                        for (const pair of currentValue) {\n                            const existingItem = pair[0];\n                            const $isChecked = pair[1];\n                            // a potential complain, when only `true` is supported\n                            // but it's consistent with array\n                            if (matcher(existingItem, elementValue) && $isChecked === true) {\n                                hasMatch = true;\n                                break;\n                            }\n                        }\n                }\n                obj.checked = hasMatch;\n            }\n        }\n        handleEvent() {\n            let currentValue = this.oldValue = this.currentValue;\n            const obj = this.obj;\n            const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n            const isChecked = obj.checked;\n            const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n            if (obj.type === 'checkbox') {\n                const toStringRet = toStringTag.call(currentValue);\n                if (toStringRet === '[object Array]') {\n                    // Array binding steps on a change event:\n                    // 1. find corresponding item INDEX in the Set based on current model/value and matcher\n                    // 2. is the checkbox checked?\n                    //    2.1. Yes: is the corresponding item in the Array (index === -1)?\n                    //        2.1.1 No: push the current model/value to the Array\n                    //    2.2. No: is the corresponding item in the Array (index !== -1)?\n                    //        2.2.1: Yes: remove the corresponding item\n                    // =================================================\n                    const index = currentValue.findIndex(item => !!matcher(item, elementValue));\n                    // if the checkbox is checkde, and there's no matching value in the existing array\n                    // add the checkbox model/value to the array\n                    if (isChecked && index === -1) {\n                        currentValue.push(elementValue);\n                    }\n                    else if (!isChecked && index !== -1) {\n                        // if the checkbox is not checked, and found a matching item in the array\n                        // based on the checkbox model/value\n                        // remove the existing item\n                        currentValue.splice(index, 1);\n                    }\n                    // when existing currentValue is an array,\n                    // do not invoke callback as only the array obj has changed\n                    return;\n                }\n                else if (toStringRet === '[object Set]') {\n                    // Set binding steps on a change event:\n                    // 1. find corresponding item in the Set based on current model/value and matcher\n                    // 2. is the checkbox checked?\n                    //    2.1. Yes: is the corresponding item in the Set?\n                    //        2.1.1 No: add the current model/value to the Set\n                    //    2.2. No: is the corresponding item in the Set?\n                    //        2.2.1: Yes: remove the corresponding item\n                    // =================================================\n                    // 1. find corresponding item\n                    const unset = {};\n                    let existingItem = unset;\n                    for (const value of currentValue) {\n                        if (matcher(value, elementValue) === true) {\n                            existingItem = value;\n                            break;\n                        }\n                    }\n                    // 2.1. Checkbox is checked, is the corresponding item in the Set?\n                    //\n                    // if checkbox is checked and there's no value in the existing Set\n                    // add the checkbox model/value to the Set\n                    if (isChecked && existingItem === unset) {\n                        // 2.1.1. add the current model/value to the Set\n                        currentValue.add(elementValue);\n                    }\n                    else if (!isChecked && existingItem !== unset) {\n                        // 2.2.1 Checkbox is unchecked, corresponding is in the Set\n                        //\n                        // if checkbox is not checked, and found a matching item in the Set\n                        // based on the checkbox model/value\n                        // remove the existing item\n                        currentValue.delete(existingItem);\n                    }\n                    // when existing value is a Set,\n                    // do not invoke callback as only the Set has been mutated\n                    return;\n                }\n                else if (toStringRet === '[object Map]') {\n                    // Map binding steps on a change event\n                    // 1. find corresponding item in the Map based on current model/value and matcher\n                    // 2. Set the value of the corresponding item in the Map based on checked state of the checkbox\n                    // =================================================\n                    // 1. find the corresponding item\n                    let existingItem;\n                    for (const pair of currentValue) {\n                        const currItem = pair[0];\n                        if (matcher(currItem, elementValue) === true) {\n                            existingItem = currItem;\n                            break;\n                        }\n                    }\n                    // 2. set the value of the corresponding item in the map\n                    // if checkbox is checked and there's no value in the existing Map\n                    // add the checkbox model/value to the Map as key,\n                    // and value will be checked state of the checkbox\n                    currentValue.set(existingItem, isChecked);\n                    // when existing value is a Map,\n                    // do not invoke callback as only the Map has been mutated\n                    return;\n                }\n                currentValue = isChecked;\n            }\n            else if (isChecked) {\n                currentValue = elementValue;\n            }\n            else {\n                // if it's a radio and it has been unchecked\n                // do nothing, as the radio that was checked will fire change event and it will be handle there\n                // a radio cannot be unchecked by user\n                return;\n            }\n            this.currentValue = currentValue;\n            this.callSubscribers(this.currentValue, this.oldValue, 0 /* none */);\n        }\n        bind(flags) {\n            this.currentValue = this.obj.checked;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        unbind(flags) {\n            if (this.collectionObserver !== void 0) {\n                this.collectionObserver.unsubscribeFromCollection(this);\n                this.collectionObserver = void 0;\n            }\n            if (this.valueObserver !== void 0) {\n                this.valueObserver.unsubscribe(this);\n            }\n        }\n        subscribe(subscriber) {\n            if (!this.hasSubscribers()) {\n                this.handler.subscribe(this.obj, this);\n            }\n            this.addSubscriber(subscriber);\n        }\n        unsubscribe(subscriber) {\n            this.removeSubscriber(subscriber);\n            if (!this.hasSubscribers()) {\n                this.handler.dispose();\n            }\n        }\n    };\n    CheckedObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object])\n    ], CheckedObserver);\n    return CheckedObserver;\n})();\nexport { CheckedObserver };\n//# sourceMappingURL=checked-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nexport class ClassAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.doNotCache = true;\n        this.nameIndex = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.isActive = false;\n        this.task = null;\n        this.type = 2 /* Node */ | 64 /* Layout */;\n        this.obj = obj;\n        this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n    }\n    getValue() {\n        // is it safe to assume the observer has the latest value?\n        // todo: ability to turn on/off cache based on type\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n            this.flushChanges(flags);\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.currentValue;\n            const nameIndex = this.nameIndex;\n            let version = this.version;\n            this.oldValue = currentValue;\n            const classesToAdd = getClassesToAdd(currentValue);\n            // Get strings split on a space not including empties\n            if (classesToAdd.length > 0) {\n                this.addClassesAndUpdateIndex(classesToAdd);\n            }\n            this.version += 1;\n            // First call to setValue?  We're done.\n            if (version === 0) {\n                return;\n            }\n            // Remove classes from previous version.\n            version -= 1;\n            for (const name in nameIndex) {\n                if (!Object.prototype.hasOwnProperty.call(nameIndex, name) || nameIndex[name] !== version) {\n                    continue;\n                }\n                // TODO: this has the side-effect that classes already present which are added again,\n                // will be removed if they're not present in the next update.\n                // Better would be do have some configurability for this behavior, allowing the user to\n                // decide whether initial classes always need to be kept, always removed, or something in between\n                this.obj.classList.remove(name);\n            }\n        }\n    }\n    addClassesAndUpdateIndex(classes) {\n        const node = this.obj;\n        for (let i = 0, ii = classes.length; i < ii; i++) {\n            const className = classes[i];\n            if (className.length === 0) {\n                continue;\n            }\n            this.nameIndex[className] = this.version;\n            node.classList.add(className);\n        }\n    }\n}\nexport function getClassesToAdd(object) {\n    function splitClassString(classString) {\n        const matches = classString.match(/\\S+/g);\n        if (matches === null) {\n            return PLATFORM.emptyArray;\n        }\n        return matches;\n    }\n    if (typeof object === 'string') {\n        return splitClassString(object);\n    }\n    if (object instanceof Array) {\n        const len = object.length;\n        if (len > 0) {\n            const classes = [];\n            for (let i = 0; i < len; ++i) {\n                classes.push(...getClassesToAdd(object[i]));\n            }\n            return classes;\n        }\n        else {\n            return PLATFORM.emptyArray;\n        }\n    }\n    else if (object instanceof Object) {\n        const classes = [];\n        for (const property in object) {\n            // Let non typical values also evaluate true so disable bool check\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, no-extra-boolean-cast\n            if (Boolean(object[property])) {\n                // We must do this in case object property has a space in the name which results in two classes\n                if (property.includes(' ')) {\n                    classes.push(...splitClassString(property));\n                }\n                else {\n                    classes.push(property);\n                }\n            }\n        }\n        return classes;\n    }\n    return PLATFORM.emptyArray;\n}\n//# sourceMappingURL=class-attribute-accessor.js.map","/**\n * Attribute accessor for HTML elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see ElementPropertyAccessor\n */\nexport class DataAttributeAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        // ObserverType.Layout is not always true, it depends on the property\n        // but for simplicity, always treat as such\n        this.type = 2 /* Node */ | 64 /* Layout */;\n        this.obj = obj;\n        this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n    }\n    getValue() {\n        // is it safe to assume the observer has the latest value?\n        // todo: ability to turn on/off cache based on type\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n            this.flushChanges(flags);\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.currentValue;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttribute(this.propertyKey);\n            }\n            else {\n                this.obj.setAttribute(this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n    }\n}\n//# sourceMappingURL=data-attribute-accessor.js.map","/**\n * Property accessor for HTML Elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see DataAttributeAccessor\n */\nexport class ElementPropertyAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        // ObserverType.Layout is not always true, it depends on the property\n        // but for simplicity, always treat as such\n        this.type = 2 /* Node */ | 64 /* Layout */;\n        this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n    }\n    getValue() {\n        // is it safe to assume the observer has the latest value?\n        // todo: ability to turn on/off cache based on type\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n            this.flushChanges(flags);\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.currentValue;\n            this.oldValue = currentValue;\n            this.obj[this.propertyKey] = currentValue;\n        }\n    }\n    bind(flags) {\n        this.currentValue = this.oldValue = this.obj[this.propertyKey];\n    }\n}\n//# sourceMappingURL=element-property-accessor.js.map","import { DI } from '@aurelia/kernel';\nimport { DelegationStrategy } from '@aurelia/runtime';\n// Note: path and deepPath are designed to handle v0 and v1 shadow dom specs respectively\n/** @internal */\nexport function findOriginalEventTarget(event) {\n    return (event.composedPath && event.composedPath()[0]) || (event.deepPath && event.deepPath()[0]) || (event.path && event.path[0]) || event.target;\n}\nfunction stopPropagation() {\n    this.standardStopPropagation();\n    this.propagationStopped = true;\n}\nfunction handleCapturedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    const orderedCallbacks = [];\n    /**\n     * During capturing phase, event 'bubbles' down from parent. Needs to reorder callback from root down to target\n     */\n    while (target) {\n        if (target.capturedCallbacks) {\n            const callback = target.capturedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                orderedCallbacks.push(callback);\n            }\n        }\n        target = target.parentNode;\n    }\n    for (let i = orderedCallbacks.length - 1; i >= 0 && !event.propagationStopped; i--) {\n        const orderedCallback = orderedCallbacks[i];\n        if ('handleEvent' in orderedCallback) {\n            orderedCallback.handleEvent(event);\n        }\n        else {\n            orderedCallback(event);\n        }\n    }\n}\nfunction handleDelegatedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    while (target && !event.propagationStopped) {\n        if (target.delegatedCallbacks) {\n            const callback = target.delegatedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                if ('handleEvent' in callback) {\n                    callback.handleEvent(event);\n                }\n                else {\n                    callback(event);\n                }\n            }\n        }\n        target = target.parentNode;\n    }\n}\nexport class ListenerTracker {\n    constructor(dom, eventName, listener, capture) {\n        this.dom = dom;\n        this.eventName = eventName;\n        this.listener = listener;\n        this.capture = capture;\n        this.count = 0;\n    }\n    increment() {\n        this.count++;\n        if (this.count === 1) {\n            this.dom.addEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    decrement() {\n        this.count--;\n        if (this.count === 0) {\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    /* @internal */\n    dispose() {\n        if (this.count > 0) {\n            this.count = 0;\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n}\n/**\n * Enable dispose() pattern for `delegate` & `capture` commands\n */\nexport class DelegateOrCaptureSubscription {\n    constructor(entry, lookup, targetEvent, callback) {\n        this.entry = entry;\n        this.lookup = lookup;\n        this.targetEvent = targetEvent;\n        lookup[targetEvent] = callback;\n    }\n    dispose() {\n        this.entry.decrement();\n        this.lookup[this.targetEvent] = null;\n    }\n}\n/**\n * Enable dispose() pattern for addEventListener for `trigger`\n */\nexport class TriggerSubscription {\n    constructor(dom, target, targetEvent, callback) {\n        this.dom = dom;\n        this.target = target;\n        this.targetEvent = targetEvent;\n        this.callback = callback;\n        dom.addEventListener(targetEvent, callback, target);\n    }\n    dispose() {\n        this.dom.removeEventListener(this.targetEvent, this.callback, this.target);\n    }\n}\nexport class EventSubscriber {\n    constructor(dom, events) {\n        this.dom = dom;\n        this.events = events;\n        this.target = null;\n        this.handler = null;\n    }\n    subscribe(node, callbackOrListener) {\n        this.target = node;\n        this.handler = callbackOrListener;\n        const add = this.dom.addEventListener;\n        const events = this.events;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            add(events[i], callbackOrListener, node);\n        }\n    }\n    dispose() {\n        const node = this.target;\n        const callbackOrListener = this.handler;\n        const events = this.events;\n        const dom = this.dom;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            dom.removeEventListener(events[i], callbackOrListener, node);\n        }\n        this.target = this.handler = null;\n    }\n}\nexport const IEventManager = DI.createInterface('IEventManager').withDefault(x => x.singleton(EventManager));\n/** @internal */\nexport class EventManager {\n    constructor() {\n        this.delegatedHandlers = {};\n        this.capturedHandlers = {};\n    }\n    addEventListener(dom, target, targetEvent, callbackOrListener, strategy) {\n        let delegatedHandlers;\n        let capturedHandlers;\n        let handlerEntry;\n        if (strategy === DelegationStrategy.bubbling) {\n            delegatedHandlers = this.delegatedHandlers;\n            handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleDelegatedEvent, false));\n            handlerEntry.increment();\n            const delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, delegatedCallbacks, targetEvent, callbackOrListener);\n        }\n        if (strategy === DelegationStrategy.capturing) {\n            capturedHandlers = this.capturedHandlers;\n            handlerEntry = capturedHandlers[targetEvent] || (capturedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleCapturedEvent, true));\n            handlerEntry.increment();\n            const capturedCallbacks = target.capturedCallbacks || (target.capturedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, capturedCallbacks, targetEvent, callbackOrListener);\n        }\n        return new TriggerSubscription(dom, target, targetEvent, callbackOrListener);\n    }\n    dispose() {\n        let key;\n        const { delegatedHandlers, capturedHandlers } = this;\n        for (key in delegatedHandlers) {\n            delegatedHandlers[key].dispose();\n        }\n        for (key in capturedHandlers) {\n            capturedHandlers[key].dispose();\n        }\n    }\n}\n//# sourceMappingURL=event-manager.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IDOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\nimport { bound } from '@aurelia/kernel';\nconst childObserverOptions = {\n    childList: true,\n    subtree: true,\n    characterData: true\n};\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet SelectValueObserver = /** @class */ (() => {\n    let SelectValueObserver = class SelectValueObserver {\n        constructor(scheduler, flags, observerLocator, dom, handler, obj) {\n            this.scheduler = scheduler;\n            this.observerLocator = observerLocator;\n            this.dom = dom;\n            this.handler = handler;\n            this.obj = obj;\n            this.currentValue = void 0;\n            this.oldValue = void 0;\n            this.hasChanges = false;\n            this.task = null;\n            // ObserverType.Layout is not always true\n            // but for simplicity, always treat as such\n            this.type = 2 /* Node */ | 1 /* Observer */ | 64 /* Layout */;\n            this.arrayObserver = void 0;\n            this.nodeObserver = void 0;\n            this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n        }\n        getValue() {\n            // is it safe to assume the observer has the latest value?\n            // todo: ability to turn on/off cache based on type\n            return this.currentValue;\n        }\n        setValue(newValue, flags) {\n            this.currentValue = newValue;\n            this.hasChanges = newValue !== this.oldValue;\n            if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n                this.flushChanges(flags);\n            }\n        }\n        flushChanges(flags) {\n            if (this.hasChanges) {\n                this.hasChanges = false;\n                const currentValue = this.currentValue;\n                const isArray = Array.isArray(currentValue);\n                this.oldValue = currentValue;\n                if (!isArray && currentValue != void 0 && this.obj.multiple) {\n                    throw new Error('Only null or Array instances can be bound to a multi-select.');\n                }\n                if (this.arrayObserver) {\n                    this.arrayObserver.unsubscribeFromCollection(this);\n                    this.arrayObserver = void 0;\n                }\n                if (isArray) {\n                    this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                    this.arrayObserver.subscribeToCollection(this);\n                }\n                this.synchronizeOptions();\n                this.notify(flags);\n            }\n        }\n        handleCollectionChange(indexMap, flags) {\n            if ((flags & 32 /* fromBind */) > 0 || this.persistentFlags === 4096 /* noTargetObserverQueue */) {\n                this.synchronizeOptions();\n            }\n            else {\n                this.hasChanges = true;\n            }\n            if (this.persistentFlags !== 8192 /* persistentTargetObserverQueue */ && this.task === null) {\n                this.task = this.scheduler.queueRenderTask(() => {\n                    this.flushChanges(flags);\n                    this.task = null;\n                });\n            }\n            this.callSubscribers(this.currentValue, this.oldValue, flags);\n        }\n        handleChange(newValue, previousValue, flags) {\n            if ((flags & 32 /* fromBind */) > 0 || this.persistentFlags === 4096 /* noTargetObserverQueue */) {\n                this.synchronizeOptions();\n            }\n            else {\n                this.hasChanges = true;\n            }\n            if (this.persistentFlags !== 8192 /* persistentTargetObserverQueue */ && this.task === null) {\n                this.task = this.scheduler.queueRenderTask(() => {\n                    this.flushChanges(flags);\n                    this.task = null;\n                });\n            }\n            this.callSubscribers(newValue, previousValue, flags);\n        }\n        notify(flags) {\n            if ((flags & 32 /* fromBind */) > 0 || this.persistentFlags === 4096 /* noTargetObserverQueue */) {\n                return;\n            }\n            const oldValue = this.oldValue;\n            const newValue = this.currentValue;\n            if (newValue === oldValue) {\n                return;\n            }\n            this.callSubscribers(newValue, oldValue, flags);\n        }\n        handleEvent() {\n            // \"from-view\" changes are always synchronous now, so immediately sync the value and notify subscribers\n            const shouldNotify = this.synchronizeValue();\n            if (shouldNotify) {\n                this.callSubscribers(this.currentValue, this.oldValue, 0 /* none */);\n            }\n        }\n        synchronizeOptions(indexMap) {\n            const { currentValue, obj } = this;\n            const isArray = Array.isArray(currentValue);\n            const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n            const options = obj.options;\n            let i = options.length;\n            while (i-- > 0) {\n                const option = options[i];\n                const optionValue = Object.prototype.hasOwnProperty.call(option, 'model') ? option.model : option.value;\n                if (isArray) {\n                    option.selected = currentValue.findIndex(item => !!matcher(optionValue, item)) !== -1;\n                    continue;\n                }\n                option.selected = !!matcher(optionValue, currentValue);\n            }\n        }\n        synchronizeValue() {\n            // Spec for synchronizing value from `SelectObserver` to `<select/>`\n            // When synchronizing value to observed <select/> element, do the following steps:\n            // A. If `<select/>` is multiple\n            //    1. Check if current value, called `currentValue` is an array\n            //      a. If not an array, return true to signal value has changed\n            //      b. If is an array:\n            //        i. gather all current selected <option/>, in to array called `values`\n            //        ii. loop through the `currentValue` array and remove items that are nolonger selected based on matcher\n            //        iii. loop through the `values` array and add items that are selected based on matcher\n            //        iv. Return false to signal value hasn't changed\n            // B. If the select is single\n            //    1. Let `value` equal the first selected option, if no option selected, then `value` is `null`\n            //    2. assign `this.currentValue` to `this.oldValue`\n            //    3. assign `value` to `this.currentValue`\n            //    4. return `true` to signal value has changed\n            const obj = this.obj;\n            const options = obj.options;\n            const len = options.length;\n            const currentValue = this.currentValue;\n            let i = 0;\n            if (obj.multiple) {\n                // A.\n                if (!Array.isArray(currentValue)) {\n                    // A.1.a\n                    return true;\n                }\n                // A.1.b\n                // multi select\n                let option;\n                const matcher = obj.matcher || defaultMatcher;\n                // A.1.b.i\n                const values = [];\n                while (i < len) {\n                    option = options[i];\n                    if (option.selected) {\n                        values.push(Object.prototype.hasOwnProperty.call(option, 'model')\n                            ? option.model\n                            : option.value);\n                    }\n                    ++i;\n                }\n                // A.1.b.ii\n                i = 0;\n                while (i < currentValue.length) {\n                    const a = currentValue[i];\n                    // Todo: remove arrow fn\n                    if (values.findIndex(b => !!matcher(a, b)) === -1) {\n                        currentValue.splice(i, 1);\n                    }\n                    else {\n                        ++i;\n                    }\n                }\n                // A.1.b.iii\n                i = 0;\n                while (i < values.length) {\n                    const a = values[i];\n                    // Todo: remove arrow fn\n                    if (currentValue.findIndex(b => !!matcher(a, b)) === -1) {\n                        currentValue.push(a);\n                    }\n                    ++i;\n                }\n                // A.1.b.iv\n                return false;\n            }\n            // B. single select\n            // B.1\n            let value = null;\n            while (i < len) {\n                const option = options[i];\n                if (option.selected) {\n                    value = Object.prototype.hasOwnProperty.call(option, 'model')\n                        ? option.model\n                        : option.value;\n                    break;\n                }\n                ++i;\n            }\n            // B.2\n            this.oldValue = this.currentValue;\n            // B.3\n            this.currentValue = value;\n            // B.4\n            return true;\n        }\n        bind(flags) {\n            this.nodeObserver = this.dom.createNodeObserver(this.obj, this.handleNodeChange, childObserverOptions);\n        }\n        unbind(flags) {\n            this.nodeObserver.disconnect();\n            this.nodeObserver = null;\n            if (this.arrayObserver) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = null;\n            }\n        }\n        handleNodeChange() {\n            this.synchronizeOptions();\n            const shouldNotify = this.synchronizeValue();\n            if (shouldNotify) {\n                this.notify(0 /* none */);\n            }\n        }\n        subscribe(subscriber) {\n            if (!this.hasSubscribers()) {\n                this.handler.subscribe(this.obj, this);\n            }\n            this.addSubscriber(subscriber);\n        }\n        unsubscribe(subscriber) {\n            this.removeSubscriber(subscriber);\n            if (!this.hasSubscribers()) {\n                this.handler.dispose();\n            }\n        }\n    };\n    __decorate([\n        bound,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", []),\n        __metadata(\"design:returntype\", void 0)\n    ], SelectValueObserver.prototype, \"handleNodeChange\", null);\n    SelectValueObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object, Object])\n    ], SelectValueObserver);\n    return SelectValueObserver;\n})();\nexport { SelectValueObserver };\n//# sourceMappingURL=select-value-observer.js.map","import { PLATFORM, kebabCase } from '@aurelia/kernel';\nexport class StyleAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.styles = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.type = 2 /* Node */ | 64 /* Layout */;\n        this.obj = obj;\n        this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.obj.style.cssText;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n            this.flushChanges(flags);\n        }\n    }\n    getStyleTuplesFromString(currentValue) {\n        const styleTuples = [];\n        const rx = /\\s*([\\w-]+)\\s*:\\s*((?:(?:[\\w-]+\\(\\s*(?:\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[\\w-]+\\(\\s*(?:[^\"](?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^)]*)\\),?|[^)]*)\\),?|\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^;]*),?\\s*)+);?/g;\n        let pair;\n        let name;\n        while ((pair = rx.exec(currentValue)) !== null) {\n            name = pair[1];\n            if (name.length === 0) {\n                continue;\n            }\n            styleTuples.push([name, pair[2]]);\n        }\n        return styleTuples;\n    }\n    getStyleTuplesFromObject(currentValue) {\n        let value;\n        const styles = [];\n        for (const property in currentValue) {\n            value = currentValue[property];\n            if (value == null) {\n                continue;\n            }\n            if (typeof value === 'string') {\n                styles.push([kebabCase(property), value]);\n                continue;\n            }\n            styles.push(...this.getStyleTuples(value));\n        }\n        return styles;\n    }\n    getStyleTuplesFromArray(currentValue) {\n        const len = currentValue.length;\n        if (len > 0) {\n            const styles = [];\n            for (let i = 0; i < len; ++i) {\n                styles.push(...this.getStyleTuples(currentValue[i]));\n            }\n            return styles;\n        }\n        return PLATFORM.emptyArray;\n    }\n    getStyleTuples(currentValue) {\n        if (typeof currentValue === 'string') {\n            return this.getStyleTuplesFromString(currentValue);\n        }\n        if (currentValue instanceof Array) {\n            return this.getStyleTuplesFromArray(currentValue);\n        }\n        if (currentValue instanceof Object) {\n            return this.getStyleTuplesFromObject(currentValue);\n        }\n        return PLATFORM.emptyArray;\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.currentValue;\n            const styles = this.styles;\n            const styleTuples = this.getStyleTuples(currentValue);\n            let style;\n            let version = this.version;\n            this.oldValue = currentValue;\n            let tuple;\n            let name;\n            let value;\n            const len = styleTuples.length;\n            for (let i = 0; i < len; ++i) {\n                tuple = styleTuples[i];\n                name = tuple[0];\n                value = tuple[1];\n                this.setProperty(name, value);\n                styles[name] = version;\n            }\n            this.styles = styles;\n            this.version += 1;\n            if (version === 0) {\n                return;\n            }\n            version -= 1;\n            for (style in styles) {\n                if (!Object.prototype.hasOwnProperty.call(styles, style) || styles[style] !== version) {\n                    continue;\n                }\n                this.obj.style.removeProperty(style);\n            }\n        }\n    }\n    setProperty(style, value) {\n        let priority = '';\n        if (value != null && typeof value.indexOf === 'function' && value.includes('!important')) {\n            priority = 'important';\n            value = value.replace('!important', '');\n        }\n        this.obj.style.setProperty(style, value, priority);\n    }\n    bind(flags) {\n        this.currentValue = this.oldValue = this.obj.style.cssText;\n    }\n}\n//# sourceMappingURL=style-attribute-accessor.js.map","import { DI } from '@aurelia/kernel';\nexport const ISVGAnalyzer = DI.createInterface('ISVGAnalyzer').withDefault(x => x.singleton(class {\n    isStandardSvgAttribute(node, attributeName) {\n        return false;\n    }\n}));\n//# sourceMappingURL=svg-analyzer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection, IScheduler, } from '@aurelia/runtime';\n// TODO: handle file attribute properly again, etc\n/**\n * Observer for non-radio, non-checkbox input.\n */\nlet ValueAttributeObserver = /** @class */ (() => {\n    let ValueAttributeObserver = class ValueAttributeObserver {\n        constructor(scheduler, flags, handler, obj, propertyKey) {\n            this.scheduler = scheduler;\n            this.handler = handler;\n            this.obj = obj;\n            this.propertyKey = propertyKey;\n            this.currentValue = '';\n            this.oldValue = '';\n            this.hasChanges = false;\n            this.task = null;\n            // ObserverType.Layout is not always true, it depends on the element & property combo\n            // but for simplicity, always treat as such\n            this.type = 2 /* Node */ | 1 /* Observer */ | 64 /* Layout */;\n            this.persistentFlags = flags & 12295 /* targetObserverFlags */;\n        }\n        getValue() {\n            // is it safe to assume the observer has the latest value?\n            // todo: ability to turn on/off cache based on type\n            return this.currentValue;\n        }\n        setValue(newValue, flags) {\n            this.currentValue = newValue;\n            this.hasChanges = newValue !== this.oldValue;\n            if ((flags & 4096 /* noTargetObserverQueue */) === 0) {\n                this.flushChanges(flags);\n            }\n        }\n        flushChanges(flags) {\n            if (this.hasChanges) {\n                this.hasChanges = false;\n                const currentValue = this.currentValue;\n                const oldValue = this.oldValue;\n                this.oldValue = currentValue;\n                if (currentValue == void 0) {\n                    this.obj[this.propertyKey] = '';\n                }\n                else {\n                    this.obj[this.propertyKey] = currentValue;\n                }\n                if ((flags & 32 /* fromBind */) === 0) {\n                    this.callSubscribers(currentValue, oldValue, flags);\n                }\n            }\n        }\n        handleEvent() {\n            const oldValue = this.oldValue = this.currentValue;\n            const currentValue = this.currentValue = this.obj[this.propertyKey];\n            if (oldValue !== currentValue) {\n                this.oldValue = currentValue;\n                this.callSubscribers(currentValue, oldValue, 0 /* none */);\n            }\n        }\n        subscribe(subscriber) {\n            if (!this.hasSubscribers()) {\n                this.handler.subscribe(this.obj, this);\n                this.currentValue = this.oldValue = this.obj[this.propertyKey];\n            }\n            this.addSubscriber(subscriber);\n        }\n        unsubscribe(subscriber) {\n            this.removeSubscriber(subscriber);\n            if (!this.hasSubscribers()) {\n                this.handler.dispose();\n            }\n        }\n    };\n    ValueAttributeObserver = __decorate([\n        subscriberCollection(),\n        __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String])\n    ], ValueAttributeObserver);\n    return ValueAttributeObserver;\n})();\nexport { ValueAttributeObserver };\n//# sourceMappingURL=value-attribute-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registration } from '@aurelia/kernel';\nimport { IDOM, ITargetAccessorLocator, ITargetObserverLocator, SetterObserver } from '@aurelia/runtime';\nimport { AttributeNSAccessor } from './attribute-ns-accessor';\nimport { CheckedObserver } from './checked-observer';\nimport { ClassAttributeAccessor } from './class-attribute-accessor';\nimport { DataAttributeAccessor } from './data-attribute-accessor';\nimport { ElementPropertyAccessor } from './element-property-accessor';\nimport { EventSubscriber } from './event-manager';\nimport { SelectValueObserver } from './select-value-observer';\nimport { StyleAttributeAccessor } from './style-attribute-accessor';\nimport { ISVGAnalyzer } from './svg-analyzer';\nimport { ValueAttributeObserver } from './value-attribute-observer';\n// https://infra.spec.whatwg.org/#namespaces\nconst htmlNS = 'http://www.w3.org/1999/xhtml';\nconst mathmlNS = 'http://www.w3.org/1998/Math/MathML';\nconst svgNS = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink';\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace';\nconst xmlnsNS = 'http://www.w3.org/2000/xmlns/';\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\nconst nsAttributes = Object.assign(Object.create(null), {\n    'xlink:actuate': ['actuate', xlinkNS],\n    'xlink:arcrole': ['arcrole', xlinkNS],\n    'xlink:href': ['href', xlinkNS],\n    'xlink:role': ['role', xlinkNS],\n    'xlink:show': ['show', xlinkNS],\n    'xlink:title': ['title', xlinkNS],\n    'xlink:type': ['type', xlinkNS],\n    'xml:lang': ['lang', xmlNS],\n    'xml:space': ['space', xmlNS],\n    'xmlns': ['xmlns', xmlnsNS],\n    'xmlns:xlink': ['xlink', xmlnsNS],\n});\nconst inputEvents = ['change', 'input'];\nconst selectEvents = ['change'];\nconst contentEvents = ['change', 'input', 'blur', 'keyup', 'paste'];\nconst scrollEvents = ['scroll'];\nconst overrideProps = Object.assign(Object.create(null), {\n    'class': true,\n    'style': true,\n    'css': true,\n    'checked': true,\n    'value': true,\n    'model': true,\n    'xlink:actuate': true,\n    'xlink:arcrole': true,\n    'xlink:href': true,\n    'xlink:role': true,\n    'xlink:show': true,\n    'xlink:title': true,\n    'xlink:type': true,\n    'xml:lang': true,\n    'xml:space': true,\n    'xmlns': true,\n    'xmlns:xlink': true,\n});\nlet TargetObserverLocator = /** @class */ (() => {\n    let TargetObserverLocator = class TargetObserverLocator {\n        constructor(dom, svgAnalyzer) {\n            this.dom = dom;\n            this.svgAnalyzer = svgAnalyzer;\n        }\n        static register(container) {\n            return Registration.singleton(ITargetObserverLocator, this).register(container);\n        }\n        getObserver(flags, scheduler, lifecycle, observerLocator, obj, propertyName) {\n            switch (propertyName) {\n                case 'checked':\n                    return new CheckedObserver(scheduler, flags, lifecycle, new EventSubscriber(this.dom, inputEvents), obj);\n                case 'value':\n                    if (obj.tagName === 'SELECT') {\n                        return new SelectValueObserver(scheduler, flags, observerLocator, this.dom, new EventSubscriber(this.dom, selectEvents), obj);\n                    }\n                    return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n                case 'files':\n                    return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n                case 'textContent':\n                case 'innerHTML':\n                    return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, contentEvents), obj, propertyName);\n                case 'scrollTop':\n                case 'scrollLeft':\n                    return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, scrollEvents), obj, propertyName);\n                case 'class':\n                    return new ClassAttributeAccessor(scheduler, flags, obj);\n                case 'style':\n                case 'css':\n                    return new StyleAttributeAccessor(scheduler, flags, obj);\n                case 'model':\n                    return new SetterObserver(lifecycle, flags, obj, propertyName);\n                case 'role':\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                default:\n                    if (nsAttributes[propertyName] !== undefined) {\n                        const nsProps = nsAttributes[propertyName];\n                        return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                    }\n                    if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                        return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                    }\n            }\n            return null;\n        }\n        overridesAccessor(flags, obj, propertyName) {\n            return overrideProps[propertyName] === true;\n        }\n        // consider a scenario where user would want to provide a Date object observation via patching a few mutation method on it\n        // then this extension point of this default implementaion cannot be used,\n        // and a new implementation of ITargetObserverLocator should be used instead\n        // This default implementation only accounts for the most common target scenarios\n        handles(flags, obj) {\n            return this.dom.isNodeInstance(obj);\n        }\n    };\n    TargetObserverLocator = __decorate([\n        __param(0, IDOM),\n        __param(1, ISVGAnalyzer),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], TargetObserverLocator);\n    return TargetObserverLocator;\n})();\nexport { TargetObserverLocator };\nlet TargetAccessorLocator = /** @class */ (() => {\n    let TargetAccessorLocator = class TargetAccessorLocator {\n        constructor(dom, svgAnalyzer) {\n            this.dom = dom;\n            this.svgAnalyzer = svgAnalyzer;\n        }\n        static register(container) {\n            return Registration.singleton(ITargetAccessorLocator, this).register(container);\n        }\n        getAccessor(flags, scheduler, lifecycle, obj, propertyName) {\n            switch (propertyName) {\n                case 'textContent':\n                    // note: this case is just an optimization (textContent is the most often used property)\n                    return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n                case 'class':\n                    return new ClassAttributeAccessor(scheduler, flags, obj);\n                case 'style':\n                case 'css':\n                    return new StyleAttributeAccessor(scheduler, flags, obj);\n                // TODO: there are (many) more situation where we want to default to DataAttributeAccessor,\n                // but for now stick to what vCurrent does\n                case 'src':\n                case 'href':\n                // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n                case 'role':\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                default:\n                    if (nsAttributes[propertyName] !== undefined) {\n                        const nsProps = nsAttributes[propertyName];\n                        return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                    }\n                    if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                        return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                    }\n                    return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n            }\n        }\n        handles(flags, obj) {\n            return this.dom.isNodeInstance(obj);\n        }\n    };\n    TargetAccessorLocator = __decorate([\n        __param(0, IDOM),\n        __param(1, ISVGAnalyzer),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], TargetAccessorLocator);\n    return TargetAccessorLocator;\n})();\nexport { TargetAccessorLocator };\nconst IsDataAttribute = {};\nfunction isDataAttribute(obj, propertyName, svgAnalyzer) {\n    if (IsDataAttribute[propertyName] === true) {\n        return true;\n    }\n    const prefix = propertyName.slice(0, 5);\n    // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n    // https://html.spec.whatwg.org/multipage/dom.html#custom-data-attribute\n    return IsDataAttribute[propertyName] =\n        prefix === 'aria-' ||\n            prefix === 'data-' ||\n            svgAnalyzer.isStandardSvgAttribute(obj, propertyName);\n}\n//# sourceMappingURL=observer-locator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { bindingBehavior, IScheduler } from '@aurelia/runtime';\nimport { DataAttributeAccessor } from '../../observation/data-attribute-accessor';\nlet AttrBindingBehavior = /** @class */ (() => {\n    let AttrBindingBehavior = class AttrBindingBehavior {\n        bind(flags, _scope, _hostScope, binding) {\n            binding.targetObserver = new DataAttributeAccessor(binding.locator.get(IScheduler), flags, binding.target, binding.targetProperty);\n        }\n        unbind(flags, _scope, _hostScope, binding) {\n            return;\n        }\n    };\n    AttrBindingBehavior = __decorate([\n        bindingBehavior('attr')\n    ], AttrBindingBehavior);\n    return AttrBindingBehavior;\n})();\nexport { AttrBindingBehavior };\n//# sourceMappingURL=attr.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { bindingBehavior } from '@aurelia/runtime';\nimport { findOriginalEventTarget } from '../../observation/event-manager';\n/** @internal */\nexport function handleSelfEvent(event) {\n    const target = findOriginalEventTarget(event);\n    if (this.target !== target) {\n        return;\n    }\n    return this.selfEventCallSource(event);\n}\nlet SelfBindingBehavior = /** @class */ (() => {\n    let SelfBindingBehavior = class SelfBindingBehavior {\n        bind(flags, _scope, _hostScope, binding) {\n            if (!binding.callSource || !binding.targetEvent) {\n                throw Reporter.error(8);\n            }\n            binding.selfEventCallSource = binding.callSource;\n            binding.callSource = handleSelfEvent;\n        }\n        unbind(flags, _scope, _hostScope, binding) {\n            binding.callSource = binding.selfEventCallSource;\n            binding.selfEventCallSource = null;\n        }\n    };\n    SelfBindingBehavior = __decorate([\n        bindingBehavior('self')\n    ], SelfBindingBehavior);\n    return SelfBindingBehavior;\n})();\nexport { SelfBindingBehavior };\n//# sourceMappingURL=self.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { BindingMode, IDOM, IObserverLocator, bindingBehavior } from '@aurelia/runtime';\nimport { EventSubscriber } from '../../observation/event-manager';\nlet UpdateTriggerBindingBehavior = /** @class */ (() => {\n    let UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\n        constructor(observerLocator) {\n            this.observerLocator = observerLocator;\n        }\n        bind(flags, _scope, _hostScope, binding, ...events) {\n            if (events.length === 0) {\n                throw Reporter.error(9);\n            }\n            if (binding.mode !== BindingMode.twoWay && binding.mode !== BindingMode.fromView) {\n                throw Reporter.error(10);\n            }\n            this.persistentFlags = flags & 31751 /* persistentBindingFlags */;\n            // ensure the binding's target observer has been set.\n            const targetObserver = this.observerLocator.getObserver(this.persistentFlags | flags, binding.target, binding.targetProperty);\n            if (!targetObserver.handler) {\n                throw Reporter.error(10);\n            }\n            binding.targetObserver = targetObserver;\n            // stash the original element subscribe function.\n            targetObserver.originalHandler = binding.targetObserver.handler;\n            // replace the element subscribe function with one that uses the correct events.\n            targetObserver.handler = new EventSubscriber(binding.locator.get(IDOM), events);\n        }\n        unbind(flags, _scope, _hostScope, binding) {\n            // restore the state of the binding.\n            binding.targetObserver.handler.dispose();\n            binding.targetObserver.handler = binding.targetObserver.originalHandler;\n            binding.targetObserver.originalHandler = null;\n        }\n    };\n    UpdateTriggerBindingBehavior = __decorate([\n        bindingBehavior('updateTrigger'),\n        __param(0, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object])\n    ], UpdateTriggerBindingBehavior);\n    return UpdateTriggerBindingBehavior;\n})();\nexport { UpdateTriggerBindingBehavior };\n//# sourceMappingURL=update-trigger.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nexport const noopShadowDOMStyles = Object.freeze({\n    applyTo: PLATFORM.noop\n});\nexport const IShadowDOMStyles = DI.createInterface('IShadowDOMStyles').noDefault();\nexport const IShadowDOMGlobalStyles = DI.createInterface('IShadowDOMGlobalStyles')\n    .withDefault(x => x.instance(noopShadowDOMStyles));\nexport class AdoptedStyleSheetsStyles {\n    constructor(dom, localStyles, styleSheetCache, sharedStyles = null) {\n        this.sharedStyles = sharedStyles;\n        this.styleSheets = localStyles.map(x => {\n            let sheet;\n            if (x instanceof dom.CSSStyleSheet) {\n                sheet = x;\n            }\n            else {\n                sheet = styleSheetCache.get(x);\n                if (!sheet) {\n                    sheet = new dom.CSSStyleSheet();\n                    sheet.replaceSync(x);\n                    styleSheetCache.set(x, sheet);\n                }\n            }\n            return sheet;\n        });\n    }\n    static supported(dom) {\n        return 'adoptedStyleSheets' in dom.ShadowRoot.prototype;\n    }\n    applyTo(shadowRoot) {\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n        // https://wicg.github.io/construct-stylesheets/\n        // https://developers.google.com/web/updates/2019/02/constructable-stylesheets\n        shadowRoot.adoptedStyleSheets = [\n            ...shadowRoot.adoptedStyleSheets,\n            ...this.styleSheets\n        ];\n    }\n}\nexport class StyleElementStyles {\n    constructor(dom, localStyles, sharedStyles = null) {\n        this.dom = dom;\n        this.localStyles = localStyles;\n        this.sharedStyles = sharedStyles;\n    }\n    applyTo(shadowRoot) {\n        const styles = this.localStyles;\n        const dom = this.dom;\n        for (let i = styles.length - 1; i > -1; --i) {\n            const element = dom.createElement('style');\n            element.innerHTML = styles[i];\n            shadowRoot.prepend(element);\n        }\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n    }\n}\n//# sourceMappingURL=shadow-dom-styles.js.map","import { PLATFORM, Registration, Reporter, toArray, Metadata } from '@aurelia/kernel';\nimport { IProjectorLocator, CustomElement, } from '@aurelia/runtime';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\nconst defaultShadowOptions = {\n    mode: 'open'\n};\nexport class HTMLProjectorLocator {\n    static register(container) {\n        return Registration.singleton(IProjectorLocator, this).register(container);\n    }\n    getElementProjector(dom, $component, host, def) {\n        if (def.shadowOptions || def.hasSlots) {\n            if (def.containerless) {\n                throw Reporter.error(21);\n            }\n            return new ShadowDOMProjector(dom, $component, host, def);\n        }\n        if (def.containerless) {\n            return new ContainerlessProjector(dom, $component, host);\n        }\n        return new HostProjector($component, host, def.enhance);\n    }\n}\nconst childObserverOptions = { childList: true };\n/** @internal */\nexport class ShadowDOMProjector {\n    constructor(dom, \n    // eslint-disable-next-line @typescript-eslint/prefer-readonly\n    $controller, host, definition) {\n        this.dom = dom;\n        this.$controller = $controller;\n        this.host = host;\n        let shadowOptions;\n        if (definition.shadowOptions instanceof Object &&\n            'mode' in definition.shadowOptions) {\n            shadowOptions = definition.shadowOptions;\n        }\n        else {\n            shadowOptions = defaultShadowOptions;\n        }\n        this.shadowRoot = host.attachShadow(shadowOptions);\n        Metadata.define(CustomElement.name, $controller, this.host);\n        Metadata.define(CustomElement.name, $controller, this.shadowRoot);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback, options = childObserverOptions) {\n        // TODO: add a way to dispose/disconnect\n        this.dom.createNodeObserver(this.host, callback, options);\n    }\n    provideEncapsulationSource() {\n        return this.shadowRoot;\n    }\n    project(nodes) {\n        const context = this.$controller.context;\n        const styles = context.has(IShadowDOMStyles, false)\n            ? context.get(IShadowDOMStyles)\n            : context.get(IShadowDOMGlobalStyles);\n        styles.applyTo(this.shadowRoot);\n        nodes.appendTo(this.shadowRoot);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class ContainerlessProjector {\n    constructor(dom, $controller, host) {\n        if (host.childNodes.length) {\n            this.childNodes = toArray(host.childNodes);\n        }\n        else {\n            this.childNodes = PLATFORM.emptyArray;\n        }\n        this.host = dom.convertToRenderLocation(host);\n        Metadata.define(CustomElement.name, $controller, this.host);\n    }\n    get children() {\n        return this.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // TODO: turn this into an error\n        // Containerless does not have a container node to observe children on.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.insertBefore(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class HostProjector {\n    constructor($controller, host, enhance) {\n        this.host = host;\n        this.enhance = enhance;\n        Metadata.define(CustomElement.name, $controller, host);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // Do nothing since this scenario will never have children.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.appendTo(this.host, this.enhance);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n//# sourceMappingURL=projectors.js.map","import { DI, PLATFORM, Registration, Reporter } from '@aurelia/kernel';\nimport { DOM, IDOM, INode, CustomElement } from '@aurelia/runtime';\nimport { ShadowDOMProjector } from './projectors';\nexport var NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Element\"] = 1] = \"Element\";\n    NodeType[NodeType[\"Attr\"] = 2] = \"Attr\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATASection\"] = 4] = \"CDATASection\";\n    NodeType[NodeType[\"EntityReference\"] = 5] = \"EntityReference\";\n    NodeType[NodeType[\"Entity\"] = 6] = \"Entity\";\n    NodeType[NodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    NodeType[NodeType[\"Comment\"] = 8] = \"Comment\";\n    NodeType[NodeType[\"Document\"] = 9] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    NodeType[NodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n    NodeType[NodeType[\"Notation\"] = 12] = \"Notation\";\n})(NodeType || (NodeType = {}));\nconst effectiveParentNodeOverrides = new WeakMap();\n/**\n * IDOM implementation for Html.\n */\nexport class HTMLDOM {\n    constructor(window, document, TNode, TElement, THTMLElement, TCustomEvent, TCSSStyleSheet, TShadowRoot) {\n        this.window = window;\n        this.document = document;\n        this.Node = TNode;\n        this.Element = TElement;\n        this.HTMLElement = THTMLElement;\n        this.CustomEvent = TCustomEvent;\n        this.CSSStyleSheet = TCSSStyleSheet;\n        this.ShadowRoot = TShadowRoot;\n        if (DOM.isInitialized) {\n            Reporter.write(1001); // TODO: create reporters code // DOM already initialized (just info)\n            DOM.destroy();\n        }\n        DOM.initialize(this);\n        this.emptyNodes = new FragmentNodeSequence(this, document.createDocumentFragment());\n    }\n    static register(container) {\n        return Registration.aliasTo(IDOM, this).register(container);\n    }\n    addEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).addEventListener(eventName, subscriber, options);\n    }\n    appendChild(parent, child) {\n        parent.appendChild(child);\n    }\n    cloneNode(node, deep) {\n        return node.cloneNode(deep !== false);\n    }\n    convertToRenderLocation(node) {\n        if (this.isRenderLocation(node)) {\n            return node; // it's already a IRenderLocation (converted by FragmentNodeSequence)\n        }\n        if (node.parentNode == null) {\n            throw Reporter.error(52);\n        }\n        const locationEnd = this.document.createComment('au-end');\n        const locationStart = this.document.createComment('au-start');\n        node.parentNode.replaceChild(locationEnd, node);\n        locationEnd.parentNode.insertBefore(locationStart, locationEnd);\n        locationEnd.$start = locationStart;\n        locationStart.$nodes = null;\n        return locationEnd;\n    }\n    createDocumentFragment(markupOrNode) {\n        if (markupOrNode == null) {\n            return this.document.createDocumentFragment();\n        }\n        if (this.isNodeInstance(markupOrNode)) {\n            if (markupOrNode.content !== undefined) {\n                return markupOrNode.content;\n            }\n            const fragment = this.document.createDocumentFragment();\n            fragment.appendChild(markupOrNode);\n            return fragment;\n        }\n        return this.createTemplate(markupOrNode).content;\n    }\n    createNodeSequence(fragment, cloneNode = true) {\n        if (fragment === null) {\n            return this.emptyNodes;\n        }\n        return new FragmentNodeSequence(this, cloneNode ? fragment.cloneNode(true) : fragment);\n    }\n    createElement(name) {\n        return this.document.createElement(name);\n    }\n    fetch(input, init) {\n        return this.window.fetch(input, init);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    createCustomEvent(eventType, options) {\n        return new this.CustomEvent(eventType, options);\n    }\n    dispatchEvent(evt) {\n        this.document.dispatchEvent(evt);\n    }\n    createNodeObserver(node, cb, init) {\n        if (typeof MutationObserver === 'undefined') {\n            // TODO: find a proper response for this scenario\n            return {\n                disconnect() { },\n                observe() { },\n                takeRecords() { return PLATFORM.emptyArray; }\n            };\n        }\n        const observer = new MutationObserver(cb);\n        observer.observe(node, init);\n        return observer;\n    }\n    createTemplate(markup) {\n        if (markup == null) {\n            return this.document.createElement('template');\n        }\n        const template = this.document.createElement('template');\n        template.innerHTML = markup.toString();\n        return template;\n    }\n    createTextNode(text) {\n        return this.document.createTextNode(text);\n    }\n    /**\n     * Returns the effective parentNode according to Aurelia's component hierarchy.\n     *\n     * Used by Aurelia to find the closest parent controller relative to a node.\n     *\n     * This method supports 3 additional scenarios that `node.parentNode` does not support:\n     * - Containerless elements. The parentNode in this case is a comment precending the element under specific conditions, rather than a node wrapping the element.\n     * - ShadowDOM. If a `ShadowRoot` is encountered, this method retrieves the associated controller via the metadata api to locate the original host.\n     * - Portals. If the provided node was moved to a different location in the DOM by a `portal` attribute, then the original parent of the node will be returned.\n     *\n     * @param node - The node to get the parent for.\n     * @returns Either the closest parent node, the closest `IRenderLocation` (comment node that is the containerless host), original portal host, or `null` if this is either the absolute document root or a disconnected node.\n     */\n    getEffectiveParentNode(node) {\n        // TODO: this method needs more tests!\n        // First look for any overrides\n        if (effectiveParentNodeOverrides.has(node)) {\n            return effectiveParentNodeOverrides.get(node);\n        }\n        // Then try to get the nearest au-start render location, which would be the containerless parent,\n        // again looking for any overrides along the way.\n        // otherwise return the normal parent node\n        let containerlessOffset = 0;\n        let next = node.nextSibling;\n        while (next !== null) {\n            if (next.nodeType === 8 /* Comment */) {\n                switch (next.textContent) {\n                    case 'au-start':\n                        // If we see an au-start before we see au-end, it will precede the host of a sibling containerless element rather than a parent.\n                        // So we use the offset to ignore the next au-end\n                        ++containerlessOffset;\n                        break;\n                    case 'au-end':\n                        if (containerlessOffset-- === 0) {\n                            return next;\n                        }\n                }\n            }\n            next = next.nextSibling;\n        }\n        if (node.parentNode === null && node.nodeType === 11 /* DocumentFragment */) {\n            // Could be a shadow root; see if there's a controller and if so, get the original host via the projector\n            const controller = CustomElement.for(node);\n            if (controller === void 0) {\n                // Not a shadow root (or at least, not one created by Aurelia)\n                // Nothing more we can try, just return null\n                return null;\n            }\n            const projector = controller.projector;\n            if (projector instanceof ShadowDOMProjector) {\n                // Now we can use the original host to traverse further up\n                return this.getEffectiveParentNode(projector.host);\n            }\n        }\n        return node.parentNode;\n    }\n    setEffectiveParentNode(childNodeOrNodeSequence, parentNode) {\n        if (this.isNodeInstance(childNodeOrNodeSequence)) {\n            effectiveParentNodeOverrides.set(childNodeOrNodeSequence, parentNode);\n        }\n        else {\n            const nodes = childNodeOrNodeSequence.childNodes;\n            for (let i = 0, ii = nodes.length; i < ii; ++i) {\n                effectiveParentNodeOverrides.set(nodes[i], parentNode);\n            }\n        }\n    }\n    insertBefore(nodeToInsert, referenceNode) {\n        referenceNode.parentNode.insertBefore(nodeToInsert, referenceNode);\n    }\n    isMarker(node) {\n        return node.nodeName === 'AU-M';\n    }\n    isNodeInstance(potentialNode) {\n        return potentialNode != null && potentialNode.nodeType > 0;\n    }\n    isRenderLocation(node) {\n        return node.textContent === 'au-end';\n    }\n    makeTarget(node) {\n        node.className = 'au';\n    }\n    registerElementResolver(container, resolver) {\n        container.registerResolver(INode, resolver);\n        container.registerResolver(this.Node, resolver);\n        container.registerResolver(this.Element, resolver);\n        container.registerResolver(this.HTMLElement, resolver);\n    }\n    remove(node) {\n        if (node.remove) {\n            node.remove();\n        }\n        else {\n            node.parentNode.removeChild(node);\n        }\n    }\n    removeEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).removeEventListener(eventName, subscriber, options);\n    }\n    setAttribute(node, name, value) {\n        node.setAttribute(name, value);\n    }\n}\nconst $DOM = DOM;\nexport { $DOM as DOM };\n/* eslint-enable @typescript-eslint/no-explicit-any */\n// This is the most common form of INodeSequence.\n// Every custom element or template controller whose node sequence is based on an HTML template\n// has an instance of this under the hood. Anyone who wants to create a node sequence from\n// a string of markup would also receive an instance of this.\n// CompiledTemplates create instances of FragmentNodeSequence.\n/**\n * This is the most common form of INodeSequence.\n *\n * @internal\n */\nexport class FragmentNodeSequence {\n    constructor(dom, fragment) {\n        this.dom = dom;\n        this.fragment = fragment;\n        this.isMounted = false;\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n        const targetNodeList = fragment.querySelectorAll('.au');\n        let i = 0;\n        let ii = targetNodeList.length;\n        const targets = this.targets = Array(ii);\n        while (i < ii) {\n            // eagerly convert all markers to RenderLocations (otherwise the renderer\n            // will do it anyway) and store them in the target list (since the comments\n            // can't be queried)\n            const target = targetNodeList[i];\n            if (target.nodeName === 'AU-M') {\n                // note the renderer will still call this method, but it will just return the\n                // location if it sees it's already a location\n                targets[i] = this.dom.convertToRenderLocation(target);\n            }\n            else {\n                // also store non-markers for consistent ordering\n                targets[i] = target;\n            }\n            ++i;\n        }\n        const childNodeList = fragment.childNodes;\n        i = 0;\n        ii = childNodeList.length;\n        const childNodes = this.childNodes = Array(ii);\n        while (i < ii) {\n            childNodes[i] = childNodeList[i];\n            ++i;\n        }\n        this.firstChild = fragment.firstChild;\n        this.lastChild = fragment.lastChild;\n    }\n    findTargets() {\n        return this.targets;\n    }\n    insertBefore(refNode) {\n        if (this.isLinked && !!this.refNode) {\n            this.addToLinked();\n        }\n        else {\n            const parent = refNode.parentNode;\n            if (this.isMounted) {\n                let current = this.firstChild;\n                const end = this.lastChild;\n                let next;\n                while (current != null) {\n                    next = current.nextSibling;\n                    parent.insertBefore(current, refNode);\n                    if (current === end) {\n                        break;\n                    }\n                    current = next;\n                }\n            }\n            else {\n                this.isMounted = true;\n                refNode.parentNode.insertBefore(this.fragment, refNode);\n            }\n        }\n    }\n    appendTo(parent, enhance = false) {\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            if (!enhance) {\n                parent.appendChild(this.fragment);\n            }\n        }\n    }\n    remove() {\n        if (this.isMounted) {\n            this.isMounted = false;\n            const fragment = this.fragment;\n            const end = this.lastChild;\n            let next;\n            let current = this.firstChild;\n            while (current !== null) {\n                next = current.nextSibling;\n                fragment.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n    }\n    addToLinked() {\n        const refNode = this.refNode;\n        const parent = refNode.parentNode;\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.insertBefore(current, refNode);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.insertBefore(this.fragment, refNode);\n        }\n    }\n    unlink() {\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n    }\n    link(next) {\n        this.isLinked = true;\n        if (this.dom.isRenderLocation(next)) {\n            this.refNode = next;\n        }\n        else {\n            this.next = next;\n            this.obtainRefNode();\n        }\n    }\n    obtainRefNode() {\n        if (this.next !== void 0) {\n            this.refNode = this.next.firstChild;\n        }\n        else {\n            this.refNode = void 0;\n        }\n    }\n}\n/** @internal */\nexport class AuMarker {\n    constructor(nextSibling) {\n        this.nextSibling = nextSibling;\n        this.textContent = '';\n    }\n    get parentNode() {\n        return this.nextSibling.parentNode;\n    }\n    remove() { }\n}\n(proto => {\n    proto.previousSibling = null;\n    proto.childNodes = PLATFORM.emptyArray;\n    proto.nodeName = 'AU-M';\n    proto.nodeType = 1 /* Element */;\n})(AuMarker.prototype);\nexport const IWindow = DI.createInterface('IWindow').withDefault(x => x.callback(handler => handler.get(HTMLDOM).window));\nexport const ILocation = DI.createInterface('ILocation').withDefault(x => x.callback(handler => handler.get(IWindow).location));\nexport const IHistory = DI.createInterface('IHistory').withDefault(x => x.callback(handler => handler.get(IWindow).history));\n//# sourceMappingURL=dom.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { PLATFORM } from '@aurelia/kernel';\nimport { bindable, customAttribute, IDOM, INode, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\nconst unset = Symbol();\n// Using passive to help with performance\nconst defaultCaptureEventInit = {\n    passive: true,\n    capture: true\n};\n// Using passive to help with performance\nconst defaultBubbleEventInit = {\n    passive: true\n};\n// weakly connect a document to a blur manager\n// to avoid polluting the document properties\nconst blurDocMap = new WeakMap();\nexport class BlurManager {\n    constructor(dom, scheduler) {\n        this.dom = dom;\n        this.scheduler = scheduler;\n        this.blurs = [];\n        blurDocMap.set(dom.document, this);\n        this.handler = createHandler(this, this.blurs);\n    }\n    static createFor(dom, scheduler) {\n        return blurDocMap.get(dom.document) || new BlurManager(dom, scheduler);\n    }\n    register(blur) {\n        const blurs = this.blurs;\n        if (!blurs.includes(blur) && blurs.push(blur) === 1) {\n            this.addListeners();\n        }\n    }\n    unregister(blur) {\n        const blurs = this.blurs;\n        const index = blurs.indexOf(blur);\n        if (index > -1) {\n            blurs.splice(index, 1);\n        }\n        if (blurs.length === 0) {\n            this.removeListeners();\n        }\n    }\n    addListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.addEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.addEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.addEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.addEventListener('focus', handler, defaultCaptureEventInit);\n        win.addEventListener('blur', handler, defaultBubbleEventInit);\n    }\n    removeListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.removeEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.removeEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.removeEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.removeEventListener('focus', handler, defaultCaptureEventInit);\n        win.removeEventListener('blur', handler, defaultBubbleEventInit);\n    }\n}\nlet Blur = /** @class */ (() => {\n    let Blur = class Blur {\n        constructor(element, dom, scheduler) {\n            this.dom = dom;\n            this.element = element;\n            /**\n             * By default, the behavior should be least surprise possible, that:\n             *\n             * it searches for anything from root context,\n             * and root context is document body\n             */\n            this.linkedMultiple = true;\n            this.searchSubTree = true;\n            this.linkingContext = null;\n            this.value = unset;\n            this.manager = BlurManager.createFor(dom, scheduler);\n        }\n        afterAttachChildren() {\n            this.manager.register(this);\n        }\n        beforeDetach() {\n            this.manager.unregister(this);\n        }\n        handleEventTarget(target) {\n            if (this.value === false) {\n                return;\n            }\n            const dom = this.dom;\n            if (target === dom.window || target === dom.document || !this.contains(target)) {\n                this.triggerBlur();\n            }\n        }\n        contains(target) {\n            if (!this.value) {\n                return false;\n            }\n            let els;\n            let i;\n            let j, jj;\n            let link;\n            const element = this.element;\n            if (containsElementOrShadowRoot(element, target)) {\n                return true;\n            }\n            if (!this.linkedWith) {\n                return false;\n            }\n            const doc = this.dom.document;\n            const linkedWith = this.linkedWith;\n            const linkingContext = this.linkingContext;\n            const searchSubTree = this.searchSubTree;\n            const linkedMultiple = this.linkedMultiple;\n            const links = Array.isArray(linkedWith) ? linkedWith : [linkedWith];\n            const contextNode = (typeof linkingContext === 'string'\n                ? doc.querySelector(linkingContext)\n                : linkingContext)\n                || doc.body;\n            const ii = links.length;\n            for (i = 0; ii > i; ++i) {\n                link = links[i];\n                // When user specify to link with something by a string, it acts as a CSS selector\n                // We need to do some querying stuff to determine if target above is contained.\n                if (typeof link === 'string') {\n                    // Default behavior, search the whole tree, from context that user specified, which default to document body\n                    if (searchSubTree) {\n                        // todo: are there too many knobs?? Consider remove \"linkedMultiple\"??\n                        if (!linkedMultiple) {\n                            const el = contextNode.querySelector(link);\n                            els = el !== null ? [el] : PLATFORM.emptyArray;\n                        }\n                        else {\n                            els = contextNode.querySelectorAll(link);\n                        }\n                        jj = els.length;\n                        for (j = 0; jj > j; ++j) {\n                            if (els[j].contains(target)) {\n                                return true;\n                            }\n                        }\n                    }\n                    else {\n                        // default to document body, if user didn't define a linking context, and wanted to ignore subtree.\n                        // This is specifically performant and useful for dialogs, plugins\n                        // that usually generate contents to document body\n                        els = contextNode.children;\n                        jj = els.length;\n                        for (j = 0; jj > j; ++j) {\n                            if (els[j].matches(link)) {\n                                return true;\n                            }\n                        }\n                    }\n                }\n                else {\n                    // When user passed in something that is not a string,\n                    // simply check if has method `contains` (allow duck typing)\n                    // and call it against target.\n                    // This enables flexible usages\n                    if (link && link.contains(target)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        }\n        triggerBlur() {\n            this.value = false;\n            if (typeof this.onBlur === 'function') {\n                this.onBlur.call(null);\n            }\n        }\n    };\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Object)\n    ], Blur.prototype, \"value\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Function)\n    ], Blur.prototype, \"onBlur\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Object)\n    ], Blur.prototype, \"linkedWith\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Boolean)\n    ], Blur.prototype, \"linkedMultiple\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Boolean)\n    ], Blur.prototype, \"searchSubTree\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Object)\n    ], Blur.prototype, \"linkingContext\", void 0);\n    Blur = __decorate([\n        customAttribute('blur'),\n        __param(0, INode), __param(1, IDOM), __param(2, IScheduler),\n        __metadata(\"design:paramtypes\", [Object, HTMLDOM, Object])\n    ], Blur);\n    return Blur;\n})();\nexport { Blur };\nconst containsElementOrShadowRoot = (container, target) => {\n    if (container.contains(target)) {\n        return true;\n    }\n    let parentNode = null;\n    while (target != null) {\n        if (target === container) {\n            return true;\n        }\n        parentNode = target.parentNode;\n        if (parentNode === null && target.nodeType === 11 /* DocumentFragment */) {\n            target = target.host;\n            continue;\n        }\n        target = parentNode;\n    }\n    return false;\n};\nconst createHandler = (manager, checkTargets) => {\n    // *******************************\n    // EVENTS ORDER\n    // -----------------------------\n    // pointerdown\n    // touchstart\n    // pointerup\n    // touchend\n    // mousedown\n    // --------------\n    // BLUR\n    // FOCUS\n    // --------------\n    // mouseup\n    // click\n    //\n    // ******************************\n    //\n    // There are cases focus happens without mouse interaction (keyboard)\n    // So it needs to capture both mouse / focus movement\n    //\n    // ******************************\n    let hasChecked = false;\n    const revertCheckage = () => {\n        hasChecked = false;\n    };\n    const markChecked = () => {\n        hasChecked = true;\n        manager.scheduler.queueRenderTask(revertCheckage, { preempt: true });\n    };\n    const handleMousedown = (e) => {\n        if (!hasChecked) {\n            handleEvent(e);\n            markChecked();\n        }\n    };\n    /**\n     * Handle globally captured focus event\n     * This can happen via a few way:\n     * User clicks on a focusable element\n     * User uses keyboard to navigate to a focusable element\n     * User goes back to the window from another browser tab\n     * User clicks on a non-focusable element\n     * User clicks on the window, outside of the document\n     */\n    const handleFocus = (e) => {\n        if (hasChecked) {\n            return;\n        }\n        // there are two way a focus gets captured on window\n        // when the windows itself got focus\n        // and when an element in the document gets focus\n        // when the window itself got focus, reacting to it is quite unnecessary\n        // as it doesn't really affect element inside the document\n        // Do a simple check and bail immediately\n        const isWindow = e.target === manager.dom.window;\n        if (isWindow) {\n            for (let i = 0, ii = checkTargets.length; ii > i; ++i) {\n                checkTargets[i].triggerBlur();\n            }\n        }\n        else {\n            handleEvent(e);\n        }\n        markChecked();\n    };\n    const handleWindowBlur = () => {\n        hasChecked = false;\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].triggerBlur();\n        }\n    };\n    const handleEvent = (e) => {\n        const target = e.composed ? e.composedPath()[0] : e.target;\n        if (target === null) {\n            return;\n        }\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].handleEventTarget(target);\n        }\n    };\n    return {\n        onpointerdown: handleMousedown,\n        ontouchstart: handleMousedown,\n        onmousedown: handleMousedown,\n        onfocus: handleFocus,\n        onblur: handleWindowBlur,\n        handleEvent(e) {\n            this[`on${e.type}`](e);\n        }\n    };\n};\n//# sourceMappingURL=blur.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, BindingMode, customAttribute, IDOM, INode } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\n/**\n * Focus attribute for element focus binding\n */\nlet Focus = /** @class */ (() => {\n    let Focus = class Focus {\n        constructor(element, dom) {\n            this.dom = dom;\n            /**\n             * Indicates whether `apply` should be called when `afterAttachChildren` callback is invoked\n             */\n            this.needsApply = false;\n            this.element = element;\n        }\n        beforeBind() {\n            this.valueChanged();\n        }\n        /**\n         * Invoked everytime the bound value changes.\n         *\n         * @param newValue - The new value.\n         */\n        valueChanged() {\n            // In theory, we could/should react immediately\n            // but focus state of an element cannot be achieved\n            // while it's disconnected from the document\n            // thus, there neesd to be a check if it's currently connected or not\n            // before applying the value to the element\n            if (this.$controller.isActive) {\n                this.apply();\n            }\n            else {\n                // If the element is not currently connect\n                // toggle the flag to add pending work for later\n                // in afterAttachChildren lifecycle\n                this.needsApply = true;\n            }\n        }\n        /**\n         * Invoked when the attribute is afterAttachChildren to the DOM.\n         */\n        afterAttachChildren() {\n            if (this.needsApply) {\n                this.needsApply = false;\n                this.apply();\n            }\n            const el = this.element;\n            el.addEventListener('focus', this);\n            el.addEventListener('blur', this);\n        }\n        /**\n         * Invoked when the attribute is afterDetachChildren from the DOM.\n         */\n        afterDetachChildren() {\n            const el = this.element;\n            el.removeEventListener('focus', this);\n            el.removeEventListener('blur', this);\n        }\n        /**\n         * EventTarget interface handler for better memory usage\n         */\n        handleEvent(e) {\n            // there are only two event listened to\n            // if the even is focus, it menans the element is focused\n            // only need to switch the value to true\n            if (e.type === 'focus') {\n                this.value = true;\n            }\n            else if (this.dom.document.activeElement !== this.element) {\n                // else, it's blur event\n                // when a blur event happens, there are two situations\n                // 1. the element itself lost the focus\n                // 2. window lost the focus\n                // To handle both (1) and (2), only need to check if\n                // current active element is still the same element of this focus custom attribute\n                // If it's not, it's a blur event happened on Window because the browser tab lost focus\n                this.value = false;\n            }\n        }\n        /**\n         * Focus/blur based on current value\n         */\n        apply() {\n            const el = this.element;\n            if (this.value) {\n                el.focus();\n            }\n            else {\n                el.blur();\n            }\n        }\n    };\n    __decorate([\n        bindable({ mode: BindingMode.twoWay }),\n        __metadata(\"design:type\", Object)\n    ], Focus.prototype, \"value\", void 0);\n    Focus = __decorate([\n        customAttribute('focus'),\n        __param(0, INode), __param(1, IDOM),\n        __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n    ], Focus);\n    return Focus;\n})();\nexport { Focus };\n//# sourceMappingURL=focus.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, onResolve, } from '@aurelia/kernel';\nimport { bindable, IDOM, IRenderLocation, IViewFactory, templateController, } from '@aurelia/runtime';\nimport { HTMLDOM, } from '../../dom';\nlet Portal = /** @class */ (() => {\n    let Portal = class Portal {\n        constructor(factory, originalLoc, dom) {\n            this.factory = factory;\n            this.originalLoc = originalLoc;\n            this.dom = dom;\n            this.id = nextId('au$component');\n            this.strict = false;\n            // to make the shape of this object consistent.\n            // todo: is this necessary\n            this.currentTarget = dom.createElement('div');\n            this.view = this.factory.create();\n            dom.setEffectiveParentNode(this.view.nodes, originalLoc);\n        }\n        afterAttach(initiator, parent, flags) {\n            if (this.callbackContext == null) {\n                this.callbackContext = this.$controller.scope.bindingContext;\n            }\n            const newTarget = this.currentTarget = this.resolveTarget();\n            this.view.setLocation(newTarget, 2 /* append */);\n            return this.$activating(initiator, newTarget, flags);\n        }\n        afterUnbind(initiator, parent, flags) {\n            return this.$deactivating(initiator, this.currentTarget, flags);\n        }\n        targetChanged() {\n            const { $controller } = this;\n            if (!$controller.isActive) {\n                return;\n            }\n            const oldTarget = this.currentTarget;\n            const newTarget = this.currentTarget = this.resolveTarget();\n            if (oldTarget === newTarget) {\n                return;\n            }\n            this.view.setLocation(newTarget, 2 /* append */);\n            // TODO(fkleuver): fix and test possible race condition\n            const ret = onResolve(this.$deactivating(null, newTarget, $controller.flags), () => {\n                return this.$activating(null, newTarget, $controller.flags);\n            });\n            if (ret instanceof Promise) {\n                ret.catch(err => { throw err; });\n            }\n        }\n        $activating(initiator, target, flags) {\n            const { activating, callbackContext, view } = this;\n            view.setLocation(target, 2 /* append */);\n            return onResolve(activating === null || activating === void 0 ? void 0 : activating.call(callbackContext, target, view), () => {\n                return this.activate(initiator, target, flags);\n            });\n        }\n        activate(initiator, target, flags) {\n            const { $controller, view } = this;\n            if (initiator === null) {\n                view.nodes.appendTo(target);\n            }\n            else {\n                // TODO(fkleuver): fix and test possible race condition\n                return onResolve(view.activate(initiator !== null && initiator !== void 0 ? initiator : view, $controller, flags, $controller.scope), () => {\n                    return this.$activated(target);\n                });\n            }\n            return this.$activated(target);\n        }\n        $activated(target) {\n            const { activated, callbackContext, view } = this;\n            return activated === null || activated === void 0 ? void 0 : activated.call(callbackContext, target, view);\n        }\n        $deactivating(initiator, target, flags) {\n            const { deactivating, callbackContext, view } = this;\n            return onResolve(deactivating === null || deactivating === void 0 ? void 0 : deactivating.call(callbackContext, target, view), () => {\n                return this.deactivate(initiator, target, flags);\n            });\n        }\n        deactivate(initiator, target, flags) {\n            const { $controller, view } = this;\n            if (initiator === null) {\n                view.nodes.remove();\n            }\n            else {\n                return onResolve(view.deactivate(initiator, $controller, flags), () => {\n                    return this.$deactivated(target);\n                });\n            }\n            return this.$deactivated(target);\n        }\n        $deactivated(target) {\n            const { deactivated, callbackContext, view } = this;\n            return deactivated === null || deactivated === void 0 ? void 0 : deactivated.call(callbackContext, target, view);\n        }\n        resolveTarget() {\n            const dom = this.dom;\n            // with a $ in front to make it less confusing/error prone\n            const $document = dom.document;\n            let target = this.target;\n            let context = this.renderContext;\n            if (typeof target === 'string') {\n                let queryContext = $document;\n                if (typeof context === 'string') {\n                    context = $document.querySelector(context);\n                }\n                if (dom.isNodeInstance(context)) {\n                    queryContext = context;\n                }\n                target = queryContext.querySelector(target);\n            }\n            if (dom.isNodeInstance(target)) {\n                return target;\n            }\n            if (target == null) {\n                if (this.strict) {\n                    throw new Error('Render target not found');\n                }\n                else {\n                    target = $document.body;\n                }\n            }\n            return target;\n        }\n        onCancel(initiator, parent, flags) {\n            var _a;\n            (_a = this.view) === null || _a === void 0 ? void 0 : _a.cancel(initiator, this.$controller, flags);\n        }\n        dispose() {\n            this.view.dispose();\n            this.view = (void 0);\n            this.callbackContext = null;\n        }\n        accept(visitor) {\n            var _a;\n            if (((_a = this.view) === null || _a === void 0 ? void 0 : _a.accept(visitor)) === true) {\n                return true;\n            }\n        }\n    };\n    __decorate([\n        bindable({ primary: true }),\n        __metadata(\"design:type\", Object)\n    ], Portal.prototype, \"target\", void 0);\n    __decorate([\n        bindable({ callback: 'targetChanged' }),\n        __metadata(\"design:type\", Object)\n    ], Portal.prototype, \"renderContext\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Boolean)\n    ], Portal.prototype, \"strict\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Function)\n    ], Portal.prototype, \"deactivating\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Function)\n    ], Portal.prototype, \"activating\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Function)\n    ], Portal.prototype, \"deactivated\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Function)\n    ], Portal.prototype, \"activated\", void 0);\n    __decorate([\n        bindable(),\n        __metadata(\"design:type\", Object)\n    ], Portal.prototype, \"callbackContext\", void 0);\n    Portal = __decorate([\n        templateController('portal'),\n        __param(0, IViewFactory),\n        __param(1, IRenderLocation),\n        __param(2, IDOM),\n        __metadata(\"design:paramtypes\", [Object, Object, HTMLDOM])\n    ], Portal);\n    return Portal;\n})();\nexport { Portal };\n//# sourceMappingURL=portal.js.map","export var HTMLTargetedInstructionType;\n(function (HTMLTargetedInstructionType) {\n    HTMLTargetedInstructionType[\"textBinding\"] = \"ha\";\n    HTMLTargetedInstructionType[\"listenerBinding\"] = \"hb\";\n    HTMLTargetedInstructionType[\"attributeBinding\"] = \"hc\";\n    HTMLTargetedInstructionType[\"stylePropertyBinding\"] = \"hd\";\n    HTMLTargetedInstructionType[\"setAttribute\"] = \"he\";\n    HTMLTargetedInstructionType[\"setClassAttribute\"] = \"hf\";\n    HTMLTargetedInstructionType[\"setStyleAttribute\"] = \"hg\";\n})(HTMLTargetedInstructionType || (HTMLTargetedInstructionType = {}));\nexport function isHTMLTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\n//# sourceMappingURL=definitions.js.map","import { CustomElement, HydrateElementInstruction, CustomElementDefinition, getRenderContext, } from '@aurelia/runtime';\nimport { isHTMLTargetedInstruction } from './definitions';\nimport { SetAttributeInstruction } from './instructions';\nexport function createElement(dom, tagOrType, props, children) {\n    if (typeof tagOrType === 'string') {\n        return createElementForTag(dom, tagOrType, props, children);\n    }\n    else if (CustomElement.isType(tagOrType)) {\n        return createElementForType(dom, tagOrType, props, children);\n    }\n    else {\n        throw new Error(`Invalid tagOrType.`);\n    }\n}\n/**\n * RenderPlan. Todo: describe goal of this class\n */\nexport class RenderPlan {\n    constructor(dom, node, instructions, dependencies) {\n        this.dom = dom;\n        this.node = node;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.lazyDefinition = void 0;\n    }\n    get definition() {\n        if (this.lazyDefinition === void 0) {\n            this.lazyDefinition = CustomElementDefinition.create({\n                name: CustomElement.generateName(),\n                template: this.node,\n                needsCompile: typeof this.node === 'string',\n                instructions: this.instructions,\n                dependencies: this.dependencies,\n            });\n        }\n        return this.lazyDefinition;\n    }\n    getContext(parentContainer) {\n        return getRenderContext(this.definition, parentContainer);\n    }\n    createView(parentContainer) {\n        return this.getViewFactory(parentContainer).create();\n    }\n    getViewFactory(parentContainer) {\n        return this.getContext(parentContainer).getViewFactory();\n    }\n    /** @internal */\n    mergeInto(parent, instructions, dependencies) {\n        this.dom.appendChild(parent, this.node);\n        instructions.push(...this.instructions);\n        dependencies.push(...this.dependencies);\n    }\n}\nfunction createElementForTag(dom, tagName, props, children) {\n    const instructions = [];\n    const allInstructions = [];\n    const dependencies = [];\n    const element = dom.createElement(tagName);\n    let hasInstructions = false;\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                hasInstructions = true;\n                instructions.push(value);\n            }\n            else {\n                dom.setAttribute(element, to, value);\n            }\n        });\n    }\n    if (hasInstructions) {\n        dom.makeTarget(element);\n        allInstructions.push(instructions);\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction createElementForType(dom, Type, props, children) {\n    const definition = CustomElement.getDefinition(Type);\n    const tagName = definition.name;\n    const instructions = [];\n    const allInstructions = [instructions];\n    const dependencies = [];\n    const childInstructions = [];\n    const bindables = definition.bindables;\n    const element = dom.createElement(tagName);\n    dom.makeTarget(element);\n    if (!dependencies.includes(Type)) {\n        dependencies.push(Type);\n    }\n    instructions.push(new HydrateElementInstruction(tagName, childInstructions, null));\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                childInstructions.push(value);\n            }\n            else {\n                const bindable = bindables[to];\n                if (bindable !== void 0) {\n                    childInstructions.push({\n                        type: \"re\" /* setProperty */,\n                        to,\n                        value\n                    });\n                }\n                else {\n                    childInstructions.push(new SetAttributeInstruction(value, to));\n                }\n            }\n        });\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction addChildren(dom, parent, children, allInstructions, dependencies) {\n    for (let i = 0, ii = children.length; i < ii; ++i) {\n        const current = children[i];\n        switch (typeof current) {\n            case 'string':\n                dom.appendChild(parent, dom.createTextNode(current));\n                break;\n            case 'object':\n                if (dom.isNodeInstance(current)) {\n                    dom.appendChild(parent, current);\n                }\n                else if ('mergeInto' in current) {\n                    current.mergeInto(parent, allInstructions, dependencies);\n                }\n        }\n    }\n}\n//# sourceMappingURL=create-element.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, PLATFORM, onResolve, } from '@aurelia/kernel';\nimport { BindingMode, IDOM, ITargetedInstruction, CustomElementDefinition, bindable, customElement, getRenderContext, } from '@aurelia/runtime';\nimport { createElement, } from '../../create-element';\nfunction toLookup(acc, item) {\n    const to = item.to;\n    if (to !== void 0 && to !== 'subject' && to !== 'composing') {\n        acc[to] = item;\n    }\n    return acc;\n}\nlet Compose = /** @class */ (() => {\n    let Compose = class Compose {\n        constructor(dom, instruction) {\n            this.dom = dom;\n            this.id = nextId('au$component');\n            this.subject = void 0;\n            this.composing = false;\n            this.view = void 0;\n            this.lastSubject = void 0;\n            this.properties = instruction.instructions.reduce(toLookup, {});\n        }\n        afterAttach(initiator, parent, flags) {\n            const { subject, view } = this;\n            if (view === void 0 || this.lastSubject !== subject) {\n                this.lastSubject = subject;\n                this.composing = true;\n                return this.compose(void 0, subject, initiator, flags);\n            }\n            return this.compose(view, subject, initiator, flags);\n        }\n        afterUnbind(initiator, parent, flags) {\n            return this.deactivate(this.view, initiator, flags);\n        }\n        subjectChanged(newValue, previousValue, flags) {\n            const { $controller } = this;\n            if (!$controller.isActive) {\n                return;\n            }\n            if (this.lastSubject === newValue) {\n                return;\n            }\n            this.lastSubject = newValue;\n            this.composing = true;\n            flags |= $controller.flags;\n            const ret = onResolve(this.deactivate(this.view, null, flags), () => {\n                // TODO(fkleuver): handle & test race condition\n                return this.compose(void 0, newValue, null, flags);\n            });\n            if (ret instanceof Promise) {\n                ret.catch(err => { throw err; });\n            }\n        }\n        compose(view, subject, initiator, flags) {\n            return onResolve(view === void 0\n                ? onResolve(subject, resolvedSubject => {\n                    return this.resolveView(resolvedSubject, flags);\n                })\n                : view, resolvedView => {\n                return this.activate(resolvedView, initiator, flags);\n            });\n        }\n        deactivate(view, initiator, flags) {\n            return view === null || view === void 0 ? void 0 : view.deactivate(initiator !== null && initiator !== void 0 ? initiator : view, this.$controller, flags);\n        }\n        activate(view, initiator, flags) {\n            const { $controller } = this;\n            return onResolve(view === null || view === void 0 ? void 0 : view.activate(initiator !== null && initiator !== void 0 ? initiator : view, $controller, flags, $controller.scope, $controller.hostScope), () => {\n                this.composing = false;\n            });\n        }\n        resolveView(subject, flags) {\n            const view = this.provideViewFor(subject, flags);\n            if (view) {\n                view.setLocation(this.$controller.projector.host, 1 /* insertBefore */);\n                view.lockScope(this.$controller.scope);\n                return view;\n            }\n            return void 0;\n        }\n        provideViewFor(subject, flags) {\n            if (!subject) {\n                return void 0;\n            }\n            if (isController(subject)) { // IController\n                return subject;\n            }\n            if ('createView' in subject) { // RenderPlan\n                return subject.createView(this.$controller.context);\n            }\n            if ('create' in subject) { // IViewFactory\n                return subject.create(flags);\n            }\n            if ('template' in subject) { // Raw Template Definition\n                const definition = CustomElementDefinition.getOrCreate(subject);\n                return getRenderContext(definition, this.$controller.context).getViewFactory().create(flags);\n            }\n            // Constructable (Custom Element Constructor)\n            return createElement(this.dom, subject, this.properties, this.$controller.projector === void 0\n                ? PLATFORM.emptyArray\n                : this.$controller.projector.children).createView(this.$controller.context);\n        }\n        onCancel(initiator, parent, flags) {\n            var _a;\n            (_a = this.view) === null || _a === void 0 ? void 0 : _a.cancel(initiator, this.$controller, flags);\n        }\n        dispose() {\n            var _a;\n            (_a = this.view) === null || _a === void 0 ? void 0 : _a.dispose();\n            this.view = (void 0);\n        }\n        accept(visitor) {\n            var _a;\n            if (((_a = this.view) === null || _a === void 0 ? void 0 : _a.accept(visitor)) === true) {\n                return true;\n            }\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], Compose.prototype, \"subject\", void 0);\n    __decorate([\n        bindable({ mode: BindingMode.fromView }),\n        __metadata(\"design:type\", Boolean)\n    ], Compose.prototype, \"composing\", void 0);\n    Compose = __decorate([\n        customElement({ name: 'au-compose', template: null, containerless: true }),\n        __param(0, IDOM),\n        __param(1, ITargetedInstruction),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], Compose);\n    return Compose;\n})();\nexport { Compose };\nfunction isController(subject) {\n    return 'lockScope' in subject;\n}\n//# sourceMappingURL=compose.js.map","import { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol as $CustomElementSymbol, LetElementSymbol as $LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol as $PlainElementSymbol, TemplateControllerSymbol as $TemplateControllerSymbol, TextSymbol as $TextSymbol, ProjectionSymbol as $ProjectionSymbol } from '@aurelia/runtime';\nexport const CustomElementSymbol = $CustomElementSymbol;\nexport const LetElementSymbol = $LetElementSymbol;\nexport const PlainElementSymbol = $PlainElementSymbol;\nexport const ProjectionSymbol = $ProjectionSymbol;\nexport const TemplateControllerSymbol = $TemplateControllerSymbol;\nexport const TextSymbol = $TextSymbol;\nexport { BindingSymbol, CustomAttributeSymbol, PlainAttributeSymbol, };\n//# sourceMappingURL=semantic-model.js.map","/* eslint-disable compat/compat */\nimport { camelCase, } from '@aurelia/kernel';\nimport { BindingMode, BindableInfo, } from '@aurelia/runtime';\nimport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, TemplateControllerSymbol, TextSymbol, ProjectionSymbol, } from './semantic-model';\nconst invalidSurrogateAttribute = Object.assign(Object.create(null), {\n    'id': true,\n    'au-slot': true,\n});\nconst attributesToIgnore = Object.assign(Object.create(null), {\n    'as-element': true,\n});\nfunction hasInlineBindings(rawValue) {\n    const len = rawValue.length;\n    let ch = 0;\n    for (let i = 0; i < len; ++i) {\n        ch = rawValue.charCodeAt(i);\n        if (ch === 92 /* Backslash */) {\n            ++i;\n            // Ignore whatever comes next because it's escaped\n        }\n        else if (ch === 58 /* Colon */) {\n            return true;\n        }\n        else if (ch === 36 /* Dollar */ && rawValue.charCodeAt(i + 1) === 123 /* OpenBrace */) {\n            return false;\n        }\n    }\n    return false;\n}\nfunction processInterpolationText(symbol) {\n    const node = symbol.physicalNode;\n    const parentNode = node.parentNode;\n    while (node.nextSibling !== null && node.nextSibling.nodeType === 3 /* Text */) {\n        parentNode.removeChild(node.nextSibling);\n    }\n    node.textContent = '';\n    parentNode.insertBefore(symbol.marker, node);\n}\nfunction isTemplateControllerOf(proxy, manifest) {\n    return proxy !== manifest;\n}\n/**\n * A (temporary) standalone function that purely does the DOM processing (lifting) related to template controllers.\n * It's a first refactoring step towards separating DOM parsing/binding from mutations.\n */\nfunction processTemplateControllers(dom, manifestProxy, manifest) {\n    const manifestNode = manifest.physicalNode;\n    let current = manifestProxy;\n    let currentTemplate;\n    while (isTemplateControllerOf(current, manifest)) {\n        if (current.template === manifest) {\n            // the DOM linkage is still in its original state here so we can safely assume the parentNode is non-null\n            manifestNode.parentNode.replaceChild(current.marker, manifestNode);\n            // if the manifest is a template element (e.g. <template repeat.for=\"...\">) then we can skip one lift operation\n            // and simply use the template directly, saving a bit of work\n            if (manifestNode.nodeName === 'TEMPLATE') {\n                current.physicalNode = manifestNode;\n                // the template could safely stay without affecting anything visible, but let's keep the DOM tidy\n                manifestNode.remove();\n            }\n            else {\n                // the manifest is not a template element so we need to wrap it in one\n                currentTemplate = current.physicalNode = dom.createTemplate();\n                currentTemplate.content.appendChild(manifestNode);\n            }\n        }\n        else {\n            currentTemplate = current.physicalNode = dom.createTemplate();\n            currentTemplate.content.appendChild(current.marker);\n        }\n        manifestNode.removeAttribute(current.syntax.rawName);\n        current = current.template;\n    }\n}\n/**\n * TemplateBinder. Todo: describe goal of this class\n */\nexport class TemplateBinder {\n    constructor(dom, resources, attrParser, exprParser, attrSyntaxTransformer) {\n        this.dom = dom;\n        this.resources = resources;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxTransformer = attrSyntaxTransformer;\n    }\n    bind(node) {\n        const surrogate = new PlainElementSymbol(this.dom, node);\n        const resources = this.resources;\n        const attrSyntaxTransformer = this.attrSyntaxTransformer;\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            if (invalidSurrogateAttribute[attrSyntax.target] === true) {\n                throw new Error(`Invalid surrogate attribute: ${attrSyntax.target}`);\n                // TODO: use reporter\n            }\n            const bindingCommand = resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ surrogate);\n                }\n                else if (attrInfo.isTemplateController) {\n                    throw new Error('Cannot have template controller on surrogate element.');\n                    // TODO: use reporter\n                }\n                else {\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ surrogate);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ surrogate);\n            }\n            ++i;\n        }\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ surrogate, \n        /* manifestRoot       */ null, \n        /* parentManifestRoot */ null);\n        return surrogate;\n    }\n    bindManifest(parentManifest, node, surrogate, manifest, manifestRoot, parentManifestRoot) {\n        var _a;\n        let isAuSlot = false;\n        switch (node.nodeName) {\n            case 'LET':\n                // let cannot have children and has some different processing rules, so return early\n                this.bindLetElement(\n                /* parentManifest */ parentManifest, \n                /* node           */ node);\n                return;\n            case 'SLOT':\n                surrogate.hasSlots = true;\n                break;\n            case 'AU-SLOT':\n                isAuSlot = true;\n                break;\n        }\n        let name = node.getAttribute('as-element');\n        if (name === null) {\n            name = node.nodeName.toLowerCase();\n        }\n        const elementInfo = this.resources.getElementInfo(name);\n        if (elementInfo === null) {\n            // there is no registered custom element with this name\n            manifest = new PlainElementSymbol(this.dom, node);\n        }\n        else {\n            // it's a custom element so we set the manifestRoot as well (for storing replaces)\n            parentManifestRoot = manifestRoot;\n            const ceSymbol = new CustomElementSymbol(this.dom, node, elementInfo);\n            if (isAuSlot) {\n                ceSymbol.flags = 512 /* isAuSlot */;\n                ceSymbol.slotName = (_a = node.getAttribute(\"name\")) !== null && _a !== void 0 ? _a : \"default\";\n            }\n            manifestRoot = manifest = ceSymbol;\n        }\n        // lifting operations done by template controllers and replaces effectively unlink the nodes, so start at the bottom\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot);\n        // the parentManifest will receive either the direct child nodes, or the template controllers / replaces\n        // wrapping them\n        this.bindAttributes(\n        /* node               */ node, \n        /* parentManifest     */ parentManifest, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot);\n        if (manifestRoot === manifest && manifest.isContainerless) {\n            node.parentNode.replaceChild(manifest.marker, node);\n        }\n        else if (manifest.isTarget) {\n            node.classList.add('au');\n        }\n    }\n    bindLetElement(parentManifest, node) {\n        const symbol = new LetElementSymbol(this.dom, node);\n        parentManifest.childNodes.push(symbol);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            if (attr.name === 'to-binding-context') {\n                node.removeAttribute('to-binding-context');\n                symbol.toBindingContext = true;\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const command = this.resources.getBindingCommand(attrSyntax, false);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrSyntax.rawValue, bindingType);\n            const to = camelCase(attrSyntax.target);\n            const info = new BindableInfo(to, BindingMode.toView);\n            symbol.bindings.push(new BindingSymbol(command, info, expr, attrSyntax.rawValue, to));\n            ++i;\n        }\n        node.parentNode.replaceChild(symbol.marker, node);\n    }\n    bindAttributes(node, parentManifest, surrogate, manifest, manifestRoot, parentManifestRoot) {\n        var _a;\n        // This is the top-level symbol for the current depth.\n        // If there are no template controllers or replaces, it is always the manifest itself.\n        // If there are template controllers, then this will be the outer-most TemplateControllerSymbol.\n        let manifestProxy = manifest;\n        let previousController = (void 0);\n        let currentController = (void 0);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            ++i;\n            if (attributesToIgnore[attr.name] === true) {\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const bindingCommand = this.resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = this.resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    this.attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ manifest);\n                }\n                else if (attrInfo.isTemplateController) {\n                    // the manifest is wrapped by the inner-most template controller (if there are multiple on the same element)\n                    // so keep setting manifest.templateController to the latest template controller we find\n                    currentController = manifest.templateController = this.declareTemplateController(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo);\n                    // the proxy and the manifest are only identical when we're at the first template controller (since the controller\n                    // is assigned to the proxy), so this evaluates to true at most once per node\n                    if (manifestProxy === manifest) {\n                        currentController.template = manifest;\n                        manifestProxy = currentController;\n                    }\n                    else {\n                        currentController.templateController = previousController;\n                        currentController.template = previousController.template;\n                        previousController.template = currentController;\n                    }\n                    previousController = currentController;\n                }\n                else {\n                    // a regular custom attribute\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ manifest);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                this.attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ manifest);\n            }\n        }\n        if (node.tagName === 'INPUT') {\n            const type = node.type;\n            if (type === 'checkbox' || type === 'radio') {\n                this.ensureAttributeOrder(manifest);\n            }\n        }\n        let projection = node.getAttribute('au-slot');\n        if (projection === '') {\n            projection = 'default';\n        }\n        const hasProjection = projection !== null;\n        if (hasProjection && isTemplateControllerOf(manifestProxy, manifest)) {\n            // prevents <some-el au-slot TEMPLATE.CONTROLLER></some-el>.\n            throw new Error(`Unsupported usage of [au-slot=\"${projection}\"] along with a template controller (if, else, repeat.for etc.) found (example: <some-el au-slot if.bind=\"true\"></some-el>).`);\n            /**\n             * TODO: prevent <template TEMPLATE.CONTROLLER><some-el au-slot></some-el></template>.\n             * But there is not easy way for now, as the attribute binding is done after binding the child nodes.\n             * This means by the time the template controller in the ancestor is processed, the projection is already registered.\n             */\n        }\n        const parentName = (_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.nodeName.toLowerCase();\n        if (hasProjection\n            && (manifestRoot === null\n                || parentName === void 0\n                || this.resources.getElementInfo(parentName) === null)) {\n            /**\n             * Prevents the following cases:\n             * - <template><div au-slot></div></template>\n             * - <my-ce><div><div au-slot></div></div></my-ce>\n             * - <my-ce><div au-slot=\"s1\"><div au-slot=\"s2\"></div></div></my-ce>\n             */\n            throw new Error(`Unsupported usage of [au-slot=\"${projection}\"]. It seems that projection is attempted, but not for a custom element.`);\n        }\n        processTemplateControllers(this.dom, manifestProxy, manifest);\n        const projectionOwner = manifest === manifestRoot ? parentManifestRoot : manifestRoot;\n        if (!hasProjection || projectionOwner === null) {\n            // the proxy is either the manifest itself or the outer-most controller; add it directly to the parent\n            parentManifest.childNodes.push(manifestProxy);\n        }\n        else if (hasProjection) {\n            projectionOwner.projections.push(new ProjectionSymbol(projection, manifestProxy));\n            node.removeAttribute('au-slot');\n            node.remove();\n        }\n    }\n    // TODO: refactor to use render priority slots (this logic shouldn't be in the template binder)\n    ensureAttributeOrder(manifest) {\n        // swap the order of checked and model/value attribute, so that the required observers are prepared for checked-observer\n        const attributes = manifest.plainAttributes;\n        let modelOrValueIndex = void 0;\n        let checkedIndex = void 0;\n        let found = 0;\n        for (let i = 0; i < attributes.length && found < 3; i++) {\n            switch (attributes[i].syntax.target) {\n                case 'model':\n                case 'value':\n                case 'matcher':\n                    modelOrValueIndex = i;\n                    found++;\n                    break;\n                case 'checked':\n                    checkedIndex = i;\n                    found++;\n                    break;\n            }\n        }\n        if (checkedIndex !== void 0 && modelOrValueIndex !== void 0 && checkedIndex < modelOrValueIndex) {\n            [attributes[modelOrValueIndex], attributes[checkedIndex]] = [attributes[checkedIndex], attributes[modelOrValueIndex]];\n        }\n    }\n    bindChildNodes(node, surrogate, manifest, manifestRoot, parentManifestRoot) {\n        let childNode;\n        if (node.nodeName === 'TEMPLATE') {\n            childNode = node.content.firstChild;\n        }\n        else {\n            childNode = node.firstChild;\n        }\n        let nextChild;\n        while (childNode !== null) {\n            switch (childNode.nodeType) {\n                case 1 /* Element */:\n                    nextChild = childNode.nextSibling;\n                    this.bindManifest(\n                    /* parentManifest     */ manifest, \n                    /* node               */ childNode, \n                    /* surrogate          */ surrogate, \n                    /* manifest           */ manifest, \n                    /* manifestRoot       */ manifestRoot, \n                    /* parentManifestRoot */ parentManifestRoot);\n                    childNode = nextChild;\n                    break;\n                case 3 /* Text */:\n                    childNode = this.bindText(\n                    /* textNode */ childNode, \n                    /* manifest */ manifest).nextSibling;\n                    break;\n                case 4 /* CDATASection */:\n                case 7 /* ProcessingInstruction */:\n                case 8 /* Comment */:\n                case 10 /* DocumentType */:\n                    childNode = childNode.nextSibling;\n                    break;\n                case 9 /* Document */:\n                case 11 /* DocumentFragment */:\n                    childNode = childNode.firstChild;\n            }\n        }\n    }\n    bindText(textNode, manifest) {\n        const interpolation = this.exprParser.parse(textNode.wholeText, 2048 /* Interpolation */);\n        if (interpolation !== null) {\n            const symbol = new TextSymbol(this.dom, textNode, interpolation);\n            manifest.childNodes.push(symbol);\n            processInterpolationText(symbol);\n        }\n        let next = textNode;\n        while (next.nextSibling !== null && next.nextSibling.nodeType === 3 /* Text */) {\n            next = next.nextSibling;\n        }\n        return next;\n    }\n    declareTemplateController(attrSyntax, attrInfo) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        // multi-bindings logic here is similar to (and explained in) bindCustomAttribute\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        return symbol;\n    }\n    bindCustomAttribute(attrSyntax, attrInfo, command, manifest) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax. Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            // a multiple-bindings attribute usage (semicolon separated binding) is only valid without a binding command;\n            // the binding commands must be declared in each of the property bindings\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        manifest.customAttributes.push(symbol);\n        manifest.isTarget = true;\n    }\n    bindMultiAttribute(symbol, attrInfo, value) {\n        const bindables = attrInfo.bindables;\n        const valueLength = value.length;\n        let attrName = void 0;\n        let attrValue = void 0;\n        let start = 0;\n        let ch = 0;\n        for (let i = 0; i < valueLength; ++i) {\n            ch = value.charCodeAt(i);\n            if (ch === 92 /* Backslash */) {\n                ++i;\n                // Ignore whatever comes next because it's escaped\n            }\n            else if (ch === 58 /* Colon */) {\n                attrName = value.slice(start, i);\n                // Skip whitespace after colon\n                while (value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                for (; i < valueLength; ++i) {\n                    ch = value.charCodeAt(i);\n                    if (ch === 92 /* Backslash */) {\n                        ++i;\n                        // Ignore whatever comes next because it's escaped\n                    }\n                    else if (ch === 59 /* Semicolon */) {\n                        attrValue = value.slice(start, i);\n                        break;\n                    }\n                }\n                if (attrValue === void 0) {\n                    // No semicolon found, so just grab the rest of the value\n                    attrValue = value.slice(start);\n                }\n                const attrSyntax = this.attrParser.parse(attrName, attrValue);\n                const attrTarget = camelCase(attrSyntax.target);\n                const command = this.resources.getBindingCommand(attrSyntax, false);\n                const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n                const expr = this.exprParser.parse(attrValue, bindingType);\n                let bindable = bindables[attrTarget];\n                if (bindable === undefined) {\n                    // everything in a multi-bindings expression must be used,\n                    // so if it's not a bindable then we create one on the spot\n                    bindable = bindables[attrTarget] = new BindableInfo(attrTarget, BindingMode.toView);\n                }\n                symbol.bindings.push(new BindingSymbol(command, bindable, expr, attrValue, attrTarget));\n                // Skip whitespace after semicolon\n                while (i < valueLength && value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                attrName = void 0;\n                attrValue = void 0;\n            }\n        }\n    }\n    bindPlainAttribute(attrSyntax, attr, surrogate, manifest) {\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n        const attrTarget = attrSyntax.target;\n        const attrRawValue = attrSyntax.rawValue;\n        let expr;\n        if (attrRawValue.length === 0\n            && (bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n            if ((bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n                // Default to the name of the attr for empty binding commands\n                expr = this.exprParser.parse(camelCase(attrTarget), bindingType);\n            }\n            else {\n                return;\n            }\n        }\n        else {\n            expr = this.exprParser.parse(attrRawValue, bindingType);\n        }\n        if ((manifest.flags & 16 /* isCustomElement */) > 0) {\n            const bindable = manifest.bindables[attrTarget];\n            if (bindable != null) {\n                // if the attribute name matches a bindable property name, add it regardless of whether it's a command, interpolation, or just a plain string;\n                // the template compiler will translate it to the correct instruction\n                manifest.bindings.push(new BindingSymbol(command, bindable, expr, attrRawValue, attrTarget));\n                manifest.isTarget = true;\n            }\n            else if (expr != null) {\n                // if it does not map to a bindable, only add it if we were able to parse an expression (either a command or interpolation)\n                manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n                manifest.isTarget = true;\n            }\n        }\n        else if (expr != null) {\n            // either a binding command, an interpolation, or a ref\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n            manifest.isTarget = true;\n        }\n        else if (manifest === surrogate) {\n            // any attributes, even if they are plain (no command/interpolation etc), should be added if they\n            // are on the surrogate element\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n        }\n        if (command == null && expr != null) {\n            // if it's an interpolation, clear the attribute value\n            attr.value = '';\n        }\n    }\n}\n//# sourceMappingURL=template-binder.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration } from '@aurelia/kernel';\nimport { IDOM } from '@aurelia/runtime';\n// For some reason rollup complains about `DI.createInterface<ITemplateElementFactory>().noDefault()` with this message:\n// \"semantic error TS2742 The inferred type of 'ITemplateElementFactory' cannot be named without a reference to '@aurelia/jit/node_modules/@aurelia/kernel'. This is likely not portable. A type annotation is necessary\"\n// So.. investigate why that happens (or rather, why it *only* happens here and not for the other 50)\nexport const ITemplateElementFactory = DI.createInterface('ITemplateElementFactory').noDefault();\nconst markupCache = {};\n/**\n * Default implementation for `ITemplateFactory` for use in an HTML based runtime.\n *\n * @internal\n */\nlet HTMLTemplateElementFactory = /** @class */ (() => {\n    let HTMLTemplateElementFactory = class HTMLTemplateElementFactory {\n        constructor(dom) {\n            this.dom = dom;\n            this.template = dom.createTemplate();\n        }\n        static register(container) {\n            return Registration.singleton(ITemplateElementFactory, this).register(container);\n        }\n        createTemplate(input) {\n            if (typeof input === 'string') {\n                let result = markupCache[input];\n                if (result === void 0) {\n                    const template = this.template;\n                    template.innerHTML = input;\n                    const node = template.content.firstElementChild;\n                    // if the input is either not wrapped in a template or there is more than one node,\n                    // return the whole template that wraps it/them (and create a new one for the next input)\n                    if (node == null || node.nodeName !== 'TEMPLATE' || node.nextElementSibling != null) {\n                        this.template = this.dom.createTemplate();\n                        result = template;\n                    }\n                    else {\n                        // the node to return is both a template and the only node, so return just the node\n                        // and clean up the template for the next input\n                        template.content.removeChild(node);\n                        result = node;\n                    }\n                    markupCache[input] = result;\n                }\n                return result.cloneNode(true);\n            }\n            if (input.nodeName !== 'TEMPLATE') {\n                // if we get one node that is not a template, wrap it in one\n                const template = this.dom.createTemplate();\n                template.content.appendChild(input);\n                return template;\n            }\n            // we got a template element, remove it from the DOM if it's present there and don't\n            // do any other processing\n            if (input.parentNode != null) {\n                input.parentNode.removeChild(input);\n            }\n            return input;\n        }\n    };\n    HTMLTemplateElementFactory = __decorate([\n        __param(0, IDOM),\n        __metadata(\"design:paramtypes\", [Object])\n    ], HTMLTemplateElementFactory);\n    return HTMLTemplateElementFactory;\n})();\nexport { HTMLTemplateElementFactory };\n//# sourceMappingURL=template-element-factory.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { PLATFORM, Registration, mergeArrays, toArray, ILogger, } from '@aurelia/kernel';\nimport { HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, IExpressionParser, InterpolationInstruction, ITemplateCompiler, LetBindingInstruction, LetElementInstruction, SetPropertyInstruction, CustomElementDefinition, IDOM, BindingMode, Bindable, CustomElement, SlotInfo, AuSlotContentType, ProjectionContext, IAttributeParser, ResourceModel, } from '@aurelia/runtime';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nimport { TemplateBinder } from './template-binder';\nimport { ITemplateElementFactory } from './template-element-factory';\nimport { SetAttributeInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, TextBindingInstruction } from './instructions';\nclass CustomElementCompilationUnit {\n    constructor(partialDefinition, surrogate, template) {\n        this.partialDefinition = partialDefinition;\n        this.surrogate = surrogate;\n        this.template = template;\n        this.instructions = [];\n        this.surrogates = [];\n        this.projectionsMap = new Map();\n    }\n    toDefinition() {\n        const def = this.partialDefinition;\n        return CustomElementDefinition.create({\n            ...def,\n            instructions: mergeArrays(def.instructions, this.instructions),\n            surrogates: mergeArrays(def.surrogates, this.surrogates),\n            template: this.template,\n            needsCompile: false,\n            hasSlots: this.surrogate.hasSlots,\n            projectionsMap: this.projectionsMap,\n        });\n    }\n}\nvar LocalTemplateBindableAttributes;\n(function (LocalTemplateBindableAttributes) {\n    LocalTemplateBindableAttributes[\"property\"] = \"property\";\n    LocalTemplateBindableAttributes[\"attribute\"] = \"attribute\";\n    LocalTemplateBindableAttributes[\"mode\"] = \"mode\";\n})(LocalTemplateBindableAttributes || (LocalTemplateBindableAttributes = {}));\nconst allowedLocalTemplateBindableAttributes = Object.freeze([\n    \"property\" /* property */,\n    \"attribute\" /* attribute */,\n    \"mode\" /* mode */\n]);\nconst localTemplateIdentifier = 'as-custom-element';\n/**\n * Default (runtime-agnostic) implementation for `ITemplateCompiler`.\n *\n * @internal\n */\nlet TemplateCompiler = /** @class */ (() => {\n    let TemplateCompiler = class TemplateCompiler {\n        constructor(factory, attrParser, exprParser, attrSyntaxModifier, logger, dom) {\n            this.factory = factory;\n            this.attrParser = attrParser;\n            this.exprParser = exprParser;\n            this.attrSyntaxModifier = attrSyntaxModifier;\n            this.dom = dom;\n            this.logger = logger.scopeTo('TemplateCompiler');\n        }\n        get name() {\n            return 'default';\n        }\n        static register(container) {\n            return Registration.singleton(ITemplateCompiler, this).register(container);\n        }\n        compile(partialDefinition, context, targetedProjections) {\n            const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n            if (definition.template === null || definition.template === void 0) {\n                return definition;\n            }\n            const resources = ResourceModel.getOrCreate(context);\n            const { attrParser, exprParser, attrSyntaxModifier, factory } = this;\n            const dom = context.get(IDOM);\n            const binder = new TemplateBinder(dom, resources, attrParser, exprParser, attrSyntaxModifier);\n            const template = definition.enhance === true\n                ? definition.template\n                : factory.createTemplate(definition.template);\n            processLocalTemplates(template, definition, context, dom, this.logger);\n            const surrogate = binder.bind(template);\n            const compilation = this.compilation = new CustomElementCompilationUnit(definition, surrogate, template);\n            const customAttributes = surrogate.customAttributes;\n            const plainAttributes = surrogate.plainAttributes;\n            const customAttributeLength = customAttributes.length;\n            const plainAttributeLength = plainAttributes.length;\n            if (customAttributeLength + plainAttributeLength > 0) {\n                let offset = 0;\n                for (let i = 0; customAttributeLength > i; ++i) {\n                    compilation.surrogates[offset] = this.compileCustomAttribute(customAttributes[i]);\n                    offset++;\n                }\n                for (let i = 0; i < plainAttributeLength; ++i) {\n                    compilation.surrogates[offset] = this.compilePlainAttribute(plainAttributes[i], true);\n                    offset++;\n                }\n            }\n            this.compileChildNodes(surrogate, compilation.instructions, compilation.projectionsMap, targetedProjections);\n            const compiledDefinition = compilation.toDefinition();\n            this.compilation = null;\n            return compiledDefinition;\n        }\n        compileChildNodes(parent, instructionRows, projections, targetedProjections) {\n            if ((parent.flags & 16384 /* hasChildNodes */) > 0) {\n                const childNodes = parent.childNodes;\n                const ii = childNodes.length;\n                let childNode;\n                for (let i = 0; i < ii; ++i) {\n                    childNode = childNodes[i];\n                    if ((childNode.flags & 128 /* isText */) > 0) {\n                        instructionRows.push([new TextBindingInstruction(childNode.interpolation)]);\n                    }\n                    else if ((childNode.flags & 32 /* isLetElement */) > 0) {\n                        const bindings = childNode.bindings;\n                        const instructions = [];\n                        let binding;\n                        const jj = bindings.length;\n                        for (let j = 0; j < jj; ++j) {\n                            binding = bindings[j];\n                            instructions[j] = new LetBindingInstruction(binding.expression, binding.target);\n                        }\n                        instructionRows.push([new LetElementInstruction(instructions, childNode.toBindingContext)]);\n                    }\n                    else {\n                        this.compileParentNode(childNode, instructionRows, projections, targetedProjections);\n                    }\n                }\n            }\n        }\n        compileCustomElement(symbol, instructionRows, projections, targetedProjections) {\n            var _a;\n            const isAuSlot = (symbol.flags & 512 /* isAuSlot */) > 0;\n            // offset 1 to leave a spot for the hydrate instruction so we don't need to create 2 arrays with a spread etc\n            const instructionRow = this.compileAttributes(symbol, 1);\n            const slotName = symbol.slotName;\n            let slotInfo = null;\n            if (isAuSlot) {\n                // eslint-disable-next-line @typescript-eslint/no-extra-non-null-assertion,@typescript-eslint/no-unnecessary-type-assertion\n                const targetedProjection = (_a = targetedProjections === null || targetedProjections === void 0 ? void 0 : targetedProjections.projections) === null || _a === void 0 ? void 0 : _a[slotName];\n                slotInfo = targetedProjection !== void 0\n                    ? new SlotInfo(slotName, AuSlotContentType.Projection, new ProjectionContext(targetedProjection, targetedProjections === null || targetedProjections === void 0 ? void 0 : targetedProjections.scope))\n                    : new SlotInfo(slotName, AuSlotContentType.Fallback, new ProjectionContext(this.compileProjectionFallback(symbol, projections, targetedProjections)));\n            }\n            const instruction = instructionRow[0] = new HydrateElementInstruction(symbol.res, this.compileBindings(symbol), slotInfo);\n            const compiledProjections = this.compileProjections(symbol, projections, targetedProjections);\n            if (compiledProjections !== null) {\n                projections.set(instruction, compiledProjections);\n            }\n            instructionRows.push(instructionRow);\n            if (!isAuSlot) {\n                this.compileChildNodes(symbol, instructionRows, projections, targetedProjections);\n            }\n        }\n        compilePlainElement(symbol, instructionRows, projections, targetedProjections) {\n            const attributes = this.compileAttributes(symbol, 0);\n            if (attributes.length > 0) {\n                instructionRows.push(attributes);\n            }\n            this.compileChildNodes(symbol, instructionRows, projections, targetedProjections);\n        }\n        compileParentNode(symbol, instructionRows, projections, targetedProjections) {\n            switch (symbol.flags & 1023 /* type */) {\n                case 16 /* isCustomElement */:\n                case 512 /* isAuSlot */:\n                    this.compileCustomElement(symbol, instructionRows, projections, targetedProjections);\n                    break;\n                case 64 /* isPlainElement */:\n                    this.compilePlainElement(symbol, instructionRows, projections, targetedProjections);\n                    break;\n                case 1 /* isTemplateController */:\n                    this.compileTemplateController(symbol, instructionRows, projections, targetedProjections);\n            }\n        }\n        compileTemplateController(symbol, instructionRows, projections, targetedProjections) {\n            const bindings = this.compileBindings(symbol);\n            const controllerInstructionRows = [];\n            this.compileParentNode(symbol.template, controllerInstructionRows, projections, targetedProjections);\n            const def = CustomElementDefinition.create({\n                name: symbol.res,\n                template: symbol.physicalNode,\n                instructions: controllerInstructionRows,\n                needsCompile: false,\n            });\n            instructionRows.push([new HydrateTemplateController(def, symbol.res, bindings, symbol.res === 'else')]);\n        }\n        compileBindings(symbol) {\n            let bindingInstructions;\n            if ((symbol.flags & 8192 /* hasBindings */) > 0) {\n                // either a custom element with bindings, a custom attribute / template controller with dynamic options,\n                // or a single value custom attribute binding\n                const { bindings } = symbol;\n                const len = bindings.length;\n                bindingInstructions = Array(len);\n                let i = 0;\n                for (; i < len; ++i) {\n                    bindingInstructions[i] = this.compileBinding(bindings[i]);\n                }\n            }\n            else {\n                bindingInstructions = PLATFORM.emptyArray;\n            }\n            return bindingInstructions;\n        }\n        compileBinding(symbol) {\n            if (symbol.command === null) {\n                // either an interpolation or a normal string value assigned to an element or attribute binding\n                if (symbol.expression === null) {\n                    // the template binder already filtered out non-bindables, so we know we need a setProperty here\n                    return new SetPropertyInstruction(symbol.rawValue, symbol.bindable.propName);\n                }\n                else {\n                    // either an element binding interpolation or a dynamic options attribute binding interpolation\n                    return new InterpolationInstruction(symbol.expression, symbol.bindable.propName);\n                }\n            }\n            else {\n                // either an element binding command, dynamic options attribute binding command,\n                // or custom attribute / template controller (single value) binding command\n                return symbol.command.compile(symbol);\n            }\n        }\n        compileAttributes(symbol, offset) {\n            let attributeInstructions;\n            if ((symbol.flags & 4096 /* hasAttributes */) > 0) {\n                // any attributes on a custom element (which are not bindables) or a plain element\n                const customAttributes = symbol.customAttributes;\n                const plainAttributes = symbol.plainAttributes;\n                const customAttributeLength = customAttributes.length;\n                const plainAttributesLength = plainAttributes.length;\n                attributeInstructions = Array(offset + customAttributeLength + plainAttributesLength);\n                for (let i = 0; customAttributeLength > i; ++i) {\n                    attributeInstructions[offset] = this.compileCustomAttribute(customAttributes[i]);\n                    offset++;\n                }\n                for (let i = 0; plainAttributesLength > i; ++i) {\n                    attributeInstructions[offset] = this.compilePlainAttribute(plainAttributes[i], false);\n                    offset++;\n                }\n            }\n            else if (offset > 0) {\n                attributeInstructions = Array(offset);\n            }\n            else {\n                attributeInstructions = PLATFORM.emptyArray;\n            }\n            return attributeInstructions;\n        }\n        compileCustomAttribute(symbol) {\n            // a normal custom attribute (not template controller)\n            const bindings = this.compileBindings(symbol);\n            return new HydrateAttributeInstruction(symbol.res, bindings);\n        }\n        compilePlainAttribute(symbol, isOnSurrogate) {\n            if (symbol.command === null) {\n                const syntax = symbol.syntax;\n                if (symbol.expression === null) {\n                    const attrRawValue = syntax.rawValue;\n                    if (isOnSurrogate) {\n                        switch (syntax.target) {\n                            case 'class':\n                                return new SetClassAttributeInstruction(attrRawValue);\n                            case 'style':\n                                return new SetStyleAttributeInstruction(attrRawValue);\n                            // todo:  define how to merge other attribute peacefully\n                            //        this is an existing feature request\n                        }\n                    }\n                    // a plain attribute on a surrogate\n                    return new SetAttributeInstruction(attrRawValue, syntax.target);\n                }\n                else {\n                    // a plain attribute with an interpolation\n                    return new InterpolationInstruction(symbol.expression, syntax.target);\n                }\n            }\n            else {\n                // a plain attribute with a binding command\n                return symbol.command.compile(symbol);\n            }\n        }\n        // private compileAttribute(symbol: IAttributeSymbol): HTMLAttributeInstruction {\n        //   // any attribute on a custom element (which is not a bindable) or a plain element\n        //   if (symbol.flags & SymbolFlags.isCustomAttribute) {\n        //     return this.compileCustomAttribute(symbol as CustomAttributeSymbol);\n        //   } else {\n        //     return this.compilePlainAttribute(symbol as PlainAttributeSymbol);\n        //   }\n        // }\n        compileProjections(symbol, projectionMap, targetedProjections) {\n            var _a;\n            if ((symbol.flags & 32768 /* hasProjections */) === 0) {\n                return null;\n            }\n            const dom = this.dom;\n            const projections = Object.create(null);\n            const $projections = symbol.projections;\n            const len = $projections.length;\n            for (let i = 0; i < len; ++i) {\n                const projection = $projections[i];\n                const name = projection.name;\n                const instructions = [];\n                this.compileParentNode(projection.template, instructions, projectionMap, targetedProjections);\n                const definition = projections[name];\n                if (definition === void 0) {\n                    let template = projection.template.physicalNode;\n                    if (template.tagName !== 'TEMPLATE') {\n                        const _template = dom.createTemplate();\n                        dom.appendChild(_template.content, template);\n                        template = _template;\n                    }\n                    projections[name] = CustomElementDefinition.create({ name, template, instructions, needsCompile: false });\n                }\n                else {\n                    // consolidate the projections to same slot\n                    dom.appendChild(definition.template.content, (_a = projection.template) === null || _a === void 0 ? void 0 : _a.physicalNode);\n                    definition.instructions.push(...instructions);\n                }\n            }\n            return projections;\n        }\n        compileProjectionFallback(symbol, projections, targetedProjections) {\n            const instructions = [];\n            this.compileChildNodes(symbol, instructions, projections, targetedProjections);\n            const template = this.dom.createTemplate();\n            template.content.append(...toArray(symbol.physicalNode.childNodes));\n            return CustomElementDefinition.create({ name: CustomElement.generateName(), template, instructions, needsCompile: false });\n        }\n    };\n    TemplateCompiler = __decorate([\n        __param(0, ITemplateElementFactory),\n        __param(1, IAttributeParser),\n        __param(2, IExpressionParser),\n        __param(3, IAttrSyntaxTransformer),\n        __param(4, ILogger),\n        __param(5, IDOM),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, Object, Object, Object])\n    ], TemplateCompiler);\n    return TemplateCompiler;\n})();\nexport { TemplateCompiler };\nfunction getTemplateName(localTemplate, localTemplateNames) {\n    const name = localTemplate.getAttribute(localTemplateIdentifier);\n    if (name === null || name === '') {\n        throw new Error('The value of \"as-custom-element\" attribute cannot be empty for local template');\n    }\n    if (localTemplateNames.has(name)) {\n        throw new Error(`Duplicate definition of the local template named ${name}`);\n    }\n    else {\n        localTemplateNames.add(name);\n    }\n    return name;\n}\nfunction getBindingMode(bindable) {\n    switch (bindable.getAttribute(\"mode\" /* mode */)) {\n        case 'oneTime':\n            return BindingMode.oneTime;\n        case 'toView':\n            return BindingMode.toView;\n        case 'fromView':\n            return BindingMode.fromView;\n        case 'twoWay':\n            return BindingMode.twoWay;\n        case 'default':\n        default:\n            return BindingMode.default;\n    }\n}\nfunction processLocalTemplates(template, definition, context, dom, logger) {\n    let root;\n    if (template.nodeName === 'TEMPLATE') {\n        if (template.hasAttribute(localTemplateIdentifier)) {\n            throw new Error('The root cannot be a local template itself.');\n        }\n        root = template.content;\n    }\n    else {\n        root = template;\n    }\n    const localTemplates = toArray(root.querySelectorAll('template[as-custom-element]'));\n    const numLocalTemplates = localTemplates.length;\n    if (numLocalTemplates === 0) {\n        return;\n    }\n    if (numLocalTemplates === root.childElementCount) {\n        throw new Error('The custom element does not have any content other than local template(s).');\n    }\n    const localTemplateNames = new Set();\n    for (const localTemplate of localTemplates) {\n        if (localTemplate.parentNode !== root) {\n            throw new Error('Local templates needs to be defined directly under root.');\n        }\n        const name = getTemplateName(localTemplate, localTemplateNames);\n        const localTemplateType = class LocalTemplate {\n        };\n        const content = localTemplate.content;\n        const bindableEls = toArray(content.querySelectorAll('bindable'));\n        const bindableInstructions = Bindable.for(localTemplateType);\n        const properties = new Set();\n        const attributes = new Set();\n        for (const bindableEl of bindableEls) {\n            if (bindableEl.parentNode !== content) {\n                throw new Error('Bindable properties of local templates needs to be defined directly under root.');\n            }\n            const property = bindableEl.getAttribute(\"property\" /* property */);\n            if (property === null) {\n                throw new Error(`The attribute 'property' is missing in ${bindableEl.outerHTML}`);\n            }\n            const attribute = bindableEl.getAttribute(\"attribute\" /* attribute */);\n            if (attribute !== null\n                && attributes.has(attribute)\n                || properties.has(property)) {\n                throw new Error(`Bindable property and attribute needs to be unique; found property: ${property}, attribute: ${attribute}`);\n            }\n            else {\n                if (attribute !== null) {\n                    attributes.add(attribute);\n                }\n                properties.add(property);\n            }\n            bindableInstructions.add({\n                property,\n                attribute: attribute !== null && attribute !== void 0 ? attribute : void 0,\n                mode: getBindingMode(bindableEl),\n            });\n            const ignoredAttributes = bindableEl.getAttributeNames().filter((attrName) => !allowedLocalTemplateBindableAttributes.includes(attrName));\n            if (ignoredAttributes.length > 0) {\n                logger.warn(`The attribute(s) ${ignoredAttributes.join(', ')} will be ignored for ${bindableEl.outerHTML}. Only ${allowedLocalTemplateBindableAttributes.join(', ')} are processed.`);\n            }\n            content.removeChild(bindableEl);\n        }\n        const div = dom.createElement('div');\n        div.appendChild(content);\n        const localTemplateDefinition = CustomElement.define({ name, template: div.innerHTML }, localTemplateType);\n        // the casting is needed here as the dependencies are typed as readonly array\n        definition.dependencies.push(localTemplateDefinition);\n        context.register(localTemplateDefinition);\n        root.removeChild(localTemplate);\n    }\n}\n//# sourceMappingURL=template-compiler.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { BindingMode, ensureExpression, IExpressionParser, instructionRenderer, InterpolationBinding, IObserverLocator, MultiInterpolationBinding, PropertyBinding, applyBindingBehavior, } from '@aurelia/runtime';\nimport { AttributeBinding } from './binding/attribute';\nimport { Listener } from './binding/listener';\nimport { IEventManager } from './observation/event-manager';\nlet TextBindingRenderer = /** @class */ (() => {\n    let TextBindingRenderer = \n    /** @internal */\n    class TextBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            const next = target.nextSibling;\n            if (context.dom.isMarker(target)) {\n                context.dom.remove(target);\n            }\n            let binding;\n            const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n            if (expr.isMulti) {\n                binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, next, 'textContent', BindingMode.toView, context), expr, context);\n            }\n            else {\n                binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, next, 'textContent', BindingMode.toView, this.observerLocator, context, true), expr, context);\n            }\n            controller.addBinding(binding);\n        }\n    };\n    TextBindingRenderer = __decorate([\n        instructionRenderer(\"ha\" /* textBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], TextBindingRenderer);\n    return TextBindingRenderer;\n})();\nexport { TextBindingRenderer };\nlet ListenerBindingRenderer = /** @class */ (() => {\n    let ListenerBindingRenderer = \n    /** @internal */\n    class ListenerBindingRenderer {\n        constructor(parser, eventManager) {\n            this.parser = parser;\n            this.eventManager = eventManager;\n        }\n        render(flags, context, controller, target, instruction) {\n            // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n            const expr = ensureExpression(this.parser, instruction.from, 80 /* IsEventCommand */ | (instruction.strategy + 6 /* DelegationStrategyDelta */));\n            const binding = applyBindingBehavior(new Listener(context.dom, instruction.to, instruction.strategy, expr, target, instruction.preventDefault, this.eventManager, context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    ListenerBindingRenderer = __decorate([\n        instructionRenderer(\"hb\" /* listenerBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IEventManager),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], ListenerBindingRenderer);\n    return ListenerBindingRenderer;\n})();\nexport { ListenerBindingRenderer };\nlet SetAttributeRenderer = /** @class */ (() => {\n    let SetAttributeRenderer = \n    /** @internal */\n    class SetAttributeRenderer {\n        render(flags, context, controller, target, instruction) {\n            target.setAttribute(instruction.to, instruction.value);\n        }\n    };\n    SetAttributeRenderer = __decorate([\n        instructionRenderer(\"he\" /* setAttribute */)\n        /** @internal */\n    ], SetAttributeRenderer);\n    return SetAttributeRenderer;\n})();\nexport { SetAttributeRenderer };\nlet SetClassAttributeRenderer = /** @class */ (() => {\n    let SetClassAttributeRenderer = class SetClassAttributeRenderer {\n        render(flags, context, controller, target, instruction) {\n            addClasses(target.classList, instruction.value);\n        }\n    };\n    SetClassAttributeRenderer = __decorate([\n        instructionRenderer(\"hf\" /* setClassAttribute */)\n    ], SetClassAttributeRenderer);\n    return SetClassAttributeRenderer;\n})();\nexport { SetClassAttributeRenderer };\nlet SetStyleAttributeRenderer = /** @class */ (() => {\n    let SetStyleAttributeRenderer = class SetStyleAttributeRenderer {\n        render(flags, context, controller, target, instruction) {\n            target.style.cssText += instruction.value;\n        }\n    };\n    SetStyleAttributeRenderer = __decorate([\n        instructionRenderer(\"hg\" /* setStyleAttribute */)\n    ], SetStyleAttributeRenderer);\n    return SetStyleAttributeRenderer;\n})();\nexport { SetStyleAttributeRenderer };\nlet StylePropertyBindingRenderer = /** @class */ (() => {\n    let StylePropertyBindingRenderer = \n    /** @internal */\n    class StylePropertyBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n            const binding = applyBindingBehavior(new PropertyBinding(expr, target.style, instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    StylePropertyBindingRenderer = __decorate([\n        instructionRenderer(\"hd\" /* stylePropertyBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], StylePropertyBindingRenderer);\n    return StylePropertyBindingRenderer;\n})();\nexport { StylePropertyBindingRenderer };\nlet AttributeBindingRenderer = /** @class */ (() => {\n    let AttributeBindingRenderer = \n    /** @internal */\n    class AttributeBindingRenderer {\n        constructor(parser, observerLocator) {\n            this.parser = parser;\n            this.observerLocator = observerLocator;\n        }\n        render(flags, context, controller, target, instruction) {\n            const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n            const binding = applyBindingBehavior(new AttributeBinding(expr, target, instruction.attr /* targetAttribute */, instruction.to /* targetKey */, BindingMode.toView, this.observerLocator, context), expr, context);\n            controller.addBinding(binding);\n        }\n    };\n    AttributeBindingRenderer = __decorate([\n        instructionRenderer(\"hc\" /* attributeBinding */)\n        /** @internal */\n        ,\n        __param(0, IExpressionParser),\n        __param(1, IObserverLocator),\n        __metadata(\"design:paramtypes\", [Object, Object])\n    ], AttributeBindingRenderer);\n    return AttributeBindingRenderer;\n})();\nexport { AttributeBindingRenderer };\n// http://jsben.ch/7n5Kt\nfunction addClasses(classList, className) {\n    const len = className.length;\n    let start = 0;\n    for (let i = 0; i < len; ++i) {\n        if (className.charCodeAt(i) === 0x20) {\n            if (i !== start) {\n                classList.add(className.slice(start, i));\n            }\n            start = i + 1;\n        }\n        else if (i + 1 === len) {\n            classList.add(className.slice(start));\n        }\n    }\n}\n//# sourceMappingURL=html-renderer.js.map","import { DI } from '@aurelia/kernel';\nimport { RuntimeConfiguration } from '@aurelia/runtime';\nimport { AttrBindingCommand, CaptureBindingCommand, ClassBindingCommand, DelegateBindingCommand, RefBindingCommand, StyleBindingCommand, TriggerBindingCommand } from './binding-commands';\nimport { HtmlAttrSyntaxTransformer } from './html-attribute-syntax-transformer';\nimport { TemplateCompiler } from './template-compiler';\nimport { HTMLTemplateElementFactory } from './template-element-factory';\nimport { AttributeBindingRenderer, ListenerBindingRenderer, SetAttributeRenderer, StylePropertyBindingRenderer, TextBindingRenderer, SetClassAttributeRenderer, SetStyleAttributeRenderer } from './html-renderer';\nimport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nimport { HTMLProjectorLocator } from './projectors';\nimport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nimport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nimport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nimport { Blur } from './resources/custom-attributes/blur';\nimport { Focus } from './resources/custom-attributes/focus';\nimport { Portal } from './resources/custom-attributes/portal';\nimport { Compose } from './resources/custom-elements/compose';\nexport const ITemplateCompilerRegistration = TemplateCompiler;\nexport const ITemplateElementFactoryRegistration = HTMLTemplateElementFactory;\nexport const IAttrSyntaxTransformerRegistation = HtmlAttrSyntaxTransformer;\nexport const IProjectorLocatorRegistration = HTMLProjectorLocator;\nexport const ITargetAccessorLocatorRegistration = TargetAccessorLocator;\nexport const ITargetObserverLocatorRegistration = TargetObserverLocator;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `ITemplateCompiler`\n * - `ITemplateElementFactory`\n * - `IProjectorLocator`\n * - `ITargetAccessorLocator`\n * - `ITargetObserverLocator`\n * - `ITemplateFactory`\n */\nexport const DefaultComponents = [\n    ITemplateCompilerRegistration,\n    ITemplateElementFactoryRegistration,\n    IAttrSyntaxTransformerRegistation,\n    IProjectorLocatorRegistration,\n    ITargetAccessorLocatorRegistration,\n    ITargetObserverLocatorRegistration,\n];\nexport const RefBindingCommandRegistration = RefBindingCommand;\nexport const TriggerBindingCommandRegistration = TriggerBindingCommand;\nexport const DelegateBindingCommandRegistration = DelegateBindingCommand;\nexport const CaptureBindingCommandRegistration = CaptureBindingCommand;\nexport const AttrBindingCommandRegistration = AttrBindingCommand;\nexport const ClassBindingCommandRegistration = ClassBindingCommand;\nexport const StyleBindingCommandRegistration = StyleBindingCommand;\n/**\n * Default HTML-specific (but environment-agnostic) binding commands:\n * - Event listeners: `.trigger`, `.delegate`, `.capture`\n */\nexport const DefaultBindingLanguage = [\n    RefBindingCommandRegistration,\n    TriggerBindingCommandRegistration,\n    DelegateBindingCommandRegistration,\n    CaptureBindingCommandRegistration,\n    ClassBindingCommandRegistration,\n    StyleBindingCommandRegistration,\n    AttrBindingCommandRegistration\n];\nexport const AttrBindingBehaviorRegistration = AttrBindingBehavior;\nexport const SelfBindingBehaviorRegistration = SelfBindingBehavior;\nexport const UpdateTriggerBindingBehaviorRegistration = UpdateTriggerBindingBehavior;\nexport const ComposeRegistration = Compose;\nexport const PortalRegistration = Portal;\nexport const FocusRegistration = Focus;\nexport const BlurRegistration = Blur;\n/**\n * Default HTML-specific (but environment-agnostic) resources:\n * - Binding Behaviors: `attr`, `self`, `updateTrigger`\n * - Custom Elements: `au-compose`\n * - Custom Attributes: `blur`, `focus`, `portal`\n */\nexport const DefaultResources = [\n    AttrBindingBehaviorRegistration,\n    SelfBindingBehaviorRegistration,\n    UpdateTriggerBindingBehaviorRegistration,\n    ComposeRegistration,\n    PortalRegistration,\n    FocusRegistration,\n    BlurRegistration\n];\nexport const ListenerBindingRendererRegistration = ListenerBindingRenderer;\nexport const AttributeBindingRendererRegistration = AttributeBindingRenderer;\nexport const SetAttributeRendererRegistration = SetAttributeRenderer;\nexport const SetClassAttributeRendererRegistration = SetClassAttributeRenderer;\nexport const SetStyleAttributeRendererRegistration = SetStyleAttributeRenderer;\nexport const StylePropertyBindingRendererRegistration = StylePropertyBindingRenderer;\nexport const TextBindingRendererRegistration = TextBindingRenderer;\n/**\n * Default HTML-specfic (but environment-agnostic) renderers for:\n * - Listener Bindings: `trigger`, `capture`, `delegate`\n * - SetAttribute\n * - StyleProperty: `style`, `css`\n * - TextBinding: `${}`\n */\nexport const DefaultRenderers = [\n    ListenerBindingRendererRegistration,\n    AttributeBindingRendererRegistration,\n    SetAttributeRendererRegistration,\n    SetClassAttributeRendererRegistration,\n    SetStyleAttributeRendererRegistration,\n    StylePropertyBindingRendererRegistration,\n    TextBindingRendererRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultResources, ...DefaultBindingLanguage, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { Registration } from '@aurelia/kernel';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nexport class HtmlAttrSyntaxTransformer {\n    static register(container) {\n        return Registration.singleton(IAttrSyntaxTransformer, this).register(container);\n    }\n    transform(node, attrSyntax) {\n        if (attrSyntax.command === 'bind' && shouldDefaultToTwoWay(node, attrSyntax)) {\n            attrSyntax.command = 'two-way';\n        }\n        attrSyntax.target = this.map(node.tagName, attrSyntax.target);\n    }\n    map(tagName, attr) {\n        switch (tagName) {\n            case 'LABEL':\n                switch (attr) {\n                    case 'for':\n                        return 'htmlFor';\n                    default:\n                        return attr;\n                }\n            case 'IMG':\n                switch (attr) {\n                    case 'usemap':\n                        return 'useMap';\n                    default:\n                        return attr;\n                }\n            case 'INPUT':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    case 'minlength':\n                        return 'minLength';\n                    case 'formaction':\n                        return 'formAction';\n                    case 'formenctype':\n                        return 'formEncType';\n                    case 'formmethod':\n                        return 'formMethod';\n                    case 'formnovalidate':\n                        return 'formNoValidate';\n                    case 'formtarget':\n                        return 'formTarget';\n                    case 'inputmode':\n                        return 'inputMode';\n                    default:\n                        return attr;\n                }\n            case 'TEXTAREA':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    default:\n                        return attr;\n                }\n            case 'TD':\n            case 'TH':\n                switch (attr) {\n                    case 'rowspan':\n                        return 'rowSpan';\n                    case 'colspan':\n                        return 'colSpan';\n                    default:\n                        return attr;\n                }\n            default:\n                switch (attr) {\n                    case 'accesskey':\n                        return 'accessKey';\n                    case 'contenteditable':\n                        return 'contentEditable';\n                    case 'tabindex':\n                        return 'tabIndex';\n                    case 'textcontent':\n                        return 'textContent';\n                    case 'innerhtml':\n                        return 'innerHTML';\n                    case 'scrolltop':\n                        return 'scrollTop';\n                    case 'scrollleft':\n                        return 'scrollLeft';\n                    case 'readonly':\n                        return 'readOnly';\n                    default:\n                        return attr;\n                }\n        }\n    }\n}\nfunction shouldDefaultToTwoWay(element, attr) {\n    switch (element.tagName) {\n        case 'INPUT':\n            switch (element.type) {\n                case 'checkbox':\n                case 'radio':\n                    return attr.target === 'checked';\n                default:\n                    return attr.target === 'value' || attr.target === 'files';\n            }\n        case 'TEXTAREA':\n        case 'SELECT':\n            return attr.target === 'value';\n        default:\n            switch (attr.target) {\n                case 'textcontent':\n                case 'innerhtml':\n                    return element.hasAttribute('contenteditable');\n                case 'scrolltop':\n                case 'scrollleft':\n                    return true;\n                default:\n                    return false;\n            }\n    }\n}\n//# sourceMappingURL=html-attribute-syntax-transformer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registration, DI } from '@aurelia/kernel';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles, AdoptedStyleSheetsStyles, StyleElementStyles } from './shadow-dom-styles';\nimport { HTMLDOM } from '../dom';\nimport { IDOM } from '@aurelia/runtime';\nexport function shadowCSS(...css) {\n    return new ShadowDOMRegistry(css);\n}\nconst factoryCache = new WeakMap();\nexport const IShadowDOMStyleFactory = DI.createInterface('IShadowDOMStyleFactory')\n    .withDefault(x => x.callback((handler, requestor, resolver) => {\n    let factory = factoryCache.get(resolver);\n    if (factory === void 0) {\n        factoryCache.set(resolver, factory = ShadowDOMRegistry.createStyleFactory(handler));\n    }\n    return factory;\n}));\nexport class ShadowDOMRegistry {\n    constructor(css) {\n        this.css = css;\n    }\n    register(container) {\n        const sharedStyles = container.get(IShadowDOMGlobalStyles);\n        const factory = container.get(IShadowDOMStyleFactory);\n        container.register(Registration.instance(IShadowDOMStyles, factory.createStyles(this.css, sharedStyles)));\n    }\n    static createStyleFactory(container) {\n        if (AdoptedStyleSheetsStyles.supported(container.get(HTMLDOM))) {\n            return container.get(AdoptedStyleSheetsStylesFactory);\n        }\n        return container.get(StyleElementStylesFactory);\n    }\n}\nlet AdoptedStyleSheetsStylesFactory = /** @class */ (() => {\n    let AdoptedStyleSheetsStylesFactory = class AdoptedStyleSheetsStylesFactory {\n        constructor(dom) {\n            this.dom = dom;\n            this.cache = new Map();\n        }\n        createStyles(localStyles, sharedStyles) {\n            return new AdoptedStyleSheetsStyles(this.dom, localStyles, this.cache, sharedStyles);\n        }\n    };\n    AdoptedStyleSheetsStylesFactory = __decorate([\n        __param(0, IDOM),\n        __metadata(\"design:paramtypes\", [HTMLDOM])\n    ], AdoptedStyleSheetsStylesFactory);\n    return AdoptedStyleSheetsStylesFactory;\n})();\nlet StyleElementStylesFactory = /** @class */ (() => {\n    let StyleElementStylesFactory = class StyleElementStylesFactory {\n        constructor(dom) {\n            this.dom = dom;\n        }\n        createStyles(localStyles, sharedStyles) {\n            if (localStyles.some(x => typeof x !== 'string')) {\n                // TODO: use reporter\n                throw new Error('Shadow DOM CSS must be a string.');\n            }\n            return new StyleElementStyles(this.dom, localStyles, sharedStyles);\n        }\n    };\n    StyleElementStylesFactory = __decorate([\n        __param(0, IDOM),\n        __metadata(\"design:paramtypes\", [HTMLDOM])\n    ], StyleElementStylesFactory);\n    return StyleElementStylesFactory;\n})();\n//# sourceMappingURL=shadow-dom-registry.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nconst defaultNow = PLATFORM.now.bind(PLATFORM);\nexport const Now = DI.createInterface('Now').withDefault(x => x.instance(defaultNow));\n//# sourceMappingURL=now.js.map","export var TaskQueuePriority;\n(function (TaskQueuePriority) {\n    TaskQueuePriority[TaskQueuePriority[\"microTask\"] = 0] = \"microTask\";\n    TaskQueuePriority[TaskQueuePriority[\"render\"] = 1] = \"render\";\n    TaskQueuePriority[TaskQueuePriority[\"macroTask\"] = 2] = \"macroTask\";\n    TaskQueuePriority[TaskQueuePriority[\"postRender\"] = 3] = \"postRender\";\n    TaskQueuePriority[TaskQueuePriority[\"idle\"] = 4] = \"idle\";\n})(TaskQueuePriority || (TaskQueuePriority = {}));\nexport const defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    persistent: false,\n    reusable: true,\n    async: false,\n};\nlet $resolve;\nlet $reject;\nfunction executor(resolve, reject) {\n    $resolve = resolve;\n    $reject = reject;\n}\n/**\n * Efficiently create a promise where the `resolve` and `reject` functions are stored as properties on the prommise itself.\n */\nexport function createExposedPromise() {\n    const p = new Promise(executor);\n    p.resolve = $resolve;\n    p.reject = $reject;\n    return p;\n}\n//# sourceMappingURL=types.js.map","import { TaskQueue } from './task-queue';\nexport const { enter, leave, trace, } = (function () {\n    const enabled = false;\n    let depth = 0;\n    function round(num) {\n        return ((num * 10 + .5) | 0) / 10;\n    }\n    function log(prefix, obj, method) {\n        if (obj instanceof TaskQueue) {\n            const processing = obj['processingSize'];\n            const pending = obj['pendingSize'];\n            const delayed = obj['delayedSize'];\n            const flushReq = obj['flushRequested'];\n            const prio = obj['priority'];\n            const procAsync = !!obj['processingAsync'];\n            const info = `processing=${processing} pending=${pending} delayed=${delayed} flushReq=${flushReq} prio=${prio} procAsync=${procAsync}`;\n            console.log(`${prefix}[Q.${method}] ${info}`);\n        }\n        else {\n            const id = obj['id'];\n            const created = round(obj['createdTime']);\n            const queue = round(obj['queueTime']);\n            const preempt = obj['preempt'];\n            const reusable = obj['reusable'];\n            const persistent = obj['persistent'];\n            const async = obj['async'];\n            const status = obj['_status'];\n            const info = `id=${id} created=${created} queue=${queue} preempt=${preempt} persistent=${persistent} reusable=${reusable} status=${status} async=${async}`;\n            console.log(`${prefix}[T.${method}] ${info}`);\n        }\n    }\n    function $enter(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(depth++)}> `, obj, method);\n        }\n    }\n    function $leave(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(--depth)}< `, obj, method);\n        }\n    }\n    function $trace(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(depth)}- `, obj, method);\n        }\n    }\n    return {\n        enter: $enter,\n        leave: $leave,\n        trace: $trace,\n    };\n})();\n//# sourceMappingURL=log.js.map","import { createExposedPromise, } from './types';\nimport { enter, trace, leave } from './log';\nexport class TaskAbortError extends Error {\n    constructor(task) {\n        super('Task was canceled.');\n        this.task = task;\n    }\n}\nlet id = 0;\nexport class Task {\n    constructor(taskQueue, createdTime, queueTime, preempt, persistent, async, reusable, callback) {\n        this.taskQueue = taskQueue;\n        this.createdTime = createdTime;\n        this.queueTime = queueTime;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.async = async;\n        this.reusable = reusable;\n        this.callback = callback;\n        this.id = ++id;\n        this.next = void 0;\n        this.prev = void 0;\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        this._status = 'pending';\n        this.priority = taskQueue.priority;\n    }\n    get result() {\n        const result = this._result;\n        if (result === void 0) {\n            switch (this._status) {\n                case 'pending': {\n                    const promise = this._result = createExposedPromise();\n                    this.resolve = promise.resolve;\n                    this.reject = promise.reject;\n                    return promise;\n                }\n                case 'running':\n                    throw new Error('Trying to await task from within task will cause a deadlock.');\n                case 'completed':\n                    return this._result = Promise.resolve();\n                case 'canceled':\n                    return this._result = Promise.reject(new TaskAbortError(this));\n            }\n        }\n        return result;\n    }\n    get status() {\n        return this._status;\n    }\n    run() {\n        enter(this, 'run');\n        if (this._status !== 'pending') {\n            leave(this, 'run error');\n            throw new Error(`Cannot run task in ${this._status} state`);\n        }\n        // this.persistent could be changed while the task is running (this can only be done by the task itself if canceled, and is a valid way of stopping a loop)\n        // so we deliberately reference this.persistent instead of the local variable, but we keep it around to know whether the task *was* persistent before running it,\n        // so we can set the correct cancelation state.\n        const { persistent, reusable, taskQueue, callback, resolve, reject, createdTime, async, } = this;\n        taskQueue.remove(this);\n        this._status = 'running';\n        try {\n            const ret = callback(taskQueue.now() - createdTime);\n            if (async === true || (async === 'auto' && ret instanceof Promise)) {\n                ret\n                    .then($ret => {\n                    if (this.persistent) {\n                        taskQueue.resetPersistentTask(this);\n                    }\n                    else {\n                        if (persistent) {\n                            // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n                            this._status = 'canceled';\n                        }\n                        else {\n                            this._status = 'completed';\n                        }\n                        this.dispose();\n                        if (reusable) {\n                            taskQueue.returnToPool(this);\n                        }\n                    }\n                    taskQueue.completeAsyncTask(this);\n                    leave(this, 'run async then');\n                    if (resolve !== void 0) {\n                        resolve($ret);\n                    }\n                })\n                    .catch(err => {\n                    if (!this.persistent) {\n                        this.dispose();\n                    }\n                    taskQueue.completeAsyncTask(this);\n                    leave(this, 'run async catch');\n                    if (reject !== void 0) {\n                        reject(err);\n                    }\n                    else {\n                        throw err;\n                    }\n                });\n            }\n            else {\n                if (this.persistent) {\n                    taskQueue.resetPersistentTask(this);\n                }\n                else {\n                    if (persistent) {\n                        // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n                        this._status = 'canceled';\n                    }\n                    else {\n                        this._status = 'completed';\n                    }\n                    this.dispose();\n                    if (reusable) {\n                        taskQueue.returnToPool(this);\n                    }\n                }\n                leave(this, 'run sync success');\n                if (resolve !== void 0) {\n                    resolve(ret);\n                }\n            }\n        }\n        catch (err) {\n            if (!this.persistent) {\n                this.dispose();\n            }\n            leave(this, 'run sync error');\n            if (reject !== void 0) {\n                reject(err);\n            }\n            else {\n                throw err;\n            }\n        }\n    }\n    cancel() {\n        enter(this, 'cancel');\n        if (this._status === 'pending') {\n            const taskQueue = this.taskQueue;\n            const reusable = this.reusable;\n            const reject = this.reject;\n            taskQueue.remove(this);\n            if (taskQueue.isEmpty) {\n                taskQueue.cancel();\n            }\n            this._status = 'canceled';\n            this.dispose();\n            if (reusable) {\n                taskQueue.returnToPool(this);\n            }\n            if (reject !== void 0) {\n                reject(new TaskAbortError(this));\n            }\n            leave(this, 'cancel true =pending');\n            return true;\n        }\n        else if (this._status === 'running' && this.persistent) {\n            this.persistent = false;\n            leave(this, 'cancel true =running+persistent');\n            return true;\n        }\n        leave(this, 'cancel false');\n        return false;\n    }\n    reset(time) {\n        enter(this, 'reset');\n        const delay = this.queueTime - this.createdTime;\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this._status = 'pending';\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        leave(this, 'reset');\n    }\n    reuse(time, delay, preempt, persistent, async, callback) {\n        enter(this, 'reuse');\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.async = async;\n        this.callback = callback;\n        this._status = 'pending';\n        leave(this, 'reuse');\n    }\n    dispose() {\n        trace(this, 'dispose');\n        this.prev = void 0;\n        this.next = void 0;\n        this.callback = (void 0);\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n}\n//# sourceMappingURL=task.js.map","import { createExposedPromise, defaultQueueTaskOptions, } from './types';\nimport { Task, } from './task';\nimport { enter, trace, leave, } from './log';\nexport class TaskQueue {\n    constructor(now, priority, scheduler, flushRequestorFactory) {\n        this.now = now;\n        this.priority = priority;\n        this.scheduler = scheduler;\n        this.processingSize = 0;\n        this.processingHead = void 0;\n        this.processingTail = void 0;\n        this.processingAsync = void 0;\n        this.pendingSize = 0;\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.delayedSize = 0;\n        this.delayedHead = void 0;\n        this.delayedTail = void 0;\n        this.flushRequested = false;\n        this.yieldPromise = void 0;\n        this.taskPool = [];\n        this.taskPoolSize = 0;\n        this.lastRequest = 0;\n        this.microTaskRequestFlushTask = null;\n        this.flushRequestor = flushRequestorFactory.create(this);\n        this.requestFlush = this.requestFlush.bind(this);\n    }\n    get isEmpty() {\n        return this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0;\n    }\n    /**\n     * Persistent tasks will re-queue themselves indefinitely until they are explicitly canceled,\n     * so we consider them 'infinite work' whereas non-persistent (one-off) tasks are 'finite work'.\n     *\n     * This `hasNoMoreFiniteWork` getters returns true if either all remaining tasks are persistent, or if there are no more tasks.\n     *\n     * If that is the case, we can resolve the promise that was created when `yield()` is called.\n     */\n    get hasNoMoreFiniteWork() {\n        let cur = this.processingHead;\n        while (cur !== void 0) {\n            if (!cur.persistent) {\n                return false;\n            }\n            cur = cur.next;\n        }\n        cur = this.pendingHead;\n        while (cur !== void 0) {\n            if (!cur.persistent) {\n                return false;\n            }\n            cur = cur.next;\n        }\n        cur = this.delayedHead;\n        while (cur !== void 0) {\n            if (!cur.persistent) {\n                return false;\n            }\n            cur = cur.next;\n        }\n        return true;\n    }\n    flush() {\n        enter(this, 'flush');\n        if (this.microTaskRequestFlushTask !== null) {\n            // This may only exist if this is a microtask queue, in which case the macrotask queue is used to poll\n            // async task readiness state and/or re-queue persistent microtasks.\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.flushRequested = false;\n        // Only process normally if we are *not* currently waiting for an async task to finish\n        if (this.processingAsync === void 0) {\n            if (this.pendingSize > 0) {\n                this.movePendingToProcessing();\n            }\n            if (this.delayedSize > 0) {\n                this.moveDelayedToProcessing();\n            }\n            let cur;\n            while (this.processingSize > 0) {\n                cur = this.processingHead;\n                cur.run();\n                // If it's still running, it can only be an async task\n                if (cur.status === 'running') {\n                    this.processingAsync = cur;\n                    this.requestFlushClamped();\n                    leave(this, 'flush early async');\n                    return;\n                }\n            }\n            if (this.pendingSize > 0) {\n                this.movePendingToProcessing();\n            }\n            if (this.delayedSize > 0) {\n                this.moveDelayedToProcessing();\n            }\n            if (this.processingSize > 0) {\n                this.requestFlush();\n            }\n            else if (this.delayedSize > 0) {\n                this.requestFlushClamped();\n            }\n            if (this.yieldPromise !== void 0 &&\n                this.hasNoMoreFiniteWork) {\n                const p = this.yieldPromise;\n                this.yieldPromise = void 0;\n                p.resolve();\n            }\n        }\n        else {\n            // If we are still waiting for an async task to finish, just schedule the next flush and do nothing else.\n            // Should the task finish before the next flush is invoked,\n            // the callback to `completeAsyncTask` will have reset `this.processingAsync` back to undefined so processing can return back to normal next flush.\n            this.requestFlushClamped();\n        }\n        leave(this, 'flush full');\n    }\n    /**\n     * Cancel the next flush cycle (and/or the macrotask that schedules the next flush cycle, in case this is a microtask queue), if it was requested.\n     *\n     * This operation is idempotent and will do nothing if no flush is scheduled.\n     */\n    cancel() {\n        enter(this, 'cancel');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        if (this.flushRequested) {\n            this.flushRequestor.cancel();\n            this.flushRequested = false;\n        }\n        leave(this, 'cancel');\n    }\n    /**\n     * Returns a promise that, when awaited, resolves when:\n     * - all *non*-persistent (including async) tasks have finished;\n     * - the last-added persistent task has run exactly once;\n     *\n     * This operation is idempotent: the same promise will be returned until it resolves.\n     *\n     * If `yield()` is called multiple times in a row when there are one or more persistent tasks in the queue, each call will await exactly one cycle of those tasks.\n     */\n    async yield() {\n        enter(this, 'yield');\n        if (this.isEmpty) {\n            leave(this, 'yield empty');\n        }\n        else {\n            if (this.yieldPromise === void 0) {\n                trace(this, 'yield - creating promise');\n                this.yieldPromise = createExposedPromise();\n            }\n            await this.yieldPromise;\n            leave(this, 'yield task');\n        }\n    }\n    queueTask(callback, opts) {\n        enter(this, 'queueTask');\n        const { delay, preempt, persistent, reusable, async } = { ...defaultQueueTaskOptions, ...opts };\n        if (preempt) {\n            if (delay > 0) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with a greater-than-zero delay`);\n            }\n            if (persistent) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with persistent`);\n            }\n        }\n        if (persistent && this.priority === 0 /* microTask */) {\n            throw new Error(`Invalid arguments: cannot queue persistent tasks on the micro task queue`);\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        const time = this.now();\n        let task;\n        if (reusable) {\n            const taskPool = this.taskPool;\n            const index = this.taskPoolSize - 1;\n            if (index >= 0) {\n                task = taskPool[index];\n                taskPool[index] = (void 0);\n                this.taskPoolSize = index;\n                task.reuse(time, delay, preempt, persistent, async, callback);\n            }\n            else {\n                task = new Task(this, time, time + delay, preempt, persistent, async, reusable, callback);\n            }\n        }\n        else {\n            task = new Task(this, time, time + delay, preempt, persistent, async, reusable, callback);\n        }\n        if (preempt) {\n            if (this.processingSize++ === 0) {\n                this.processingHead = this.processingTail = task;\n            }\n            else {\n                this.processingTail = (task.prev = this.processingTail).next = task;\n            }\n        }\n        else if (delay === 0) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n            }\n        }\n        leave(this, 'queueTask');\n        return task;\n    }\n    /**\n     * Take this task from the taskQueue it's currently queued to, and add it to this queue.\n     */\n    take(task) {\n        enter(this, 'take');\n        if (task.status !== 'pending') {\n            leave(this, 'take error');\n            throw new Error('Can only take pending tasks.');\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        task.taskQueue.remove(task);\n        if (task.preempt) {\n            this.addToProcessing(task);\n        }\n        else if (task.queueTime <= this.now()) {\n            this.addToPending(task);\n        }\n        else {\n            this.addToDelayed(task);\n        }\n        leave(this, 'take');\n    }\n    /**\n     * Remove the task from this queue.\n     */\n    remove(task) {\n        enter(this, 'remove');\n        if (task.preempt) {\n            // Fast path - preempt task can only ever end up in the processing queue\n            this.removeFromProcessing(task);\n            leave(this, 'remove processing fast');\n            return;\n        }\n        if (task.queueTime > this.now()) {\n            // Fast path - task with queueTime in the future can only ever be in the delayed queue\n            this.removeFromDelayed(task);\n            leave(this, 'remove delayed fast');\n            return;\n        }\n        // Scan everything (we can make this faster by using the queueTime property, but this is good enough for now)\n        let cur = this.processingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromProcessing(task);\n                leave(this, 'remove processing slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.pendingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromPending(task);\n                leave(this, 'remove pending slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.delayedHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromDelayed(task);\n                leave(this, 'remove delayed slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        leave(this, 'remove error');\n        throw new Error(`Task #${task.id} could not be found`);\n    }\n    /**\n     * Return a reusable task to the shared task pool.\n     * The next queued callback will reuse this task object instead of creating a new one, to save overhead of creating additional objects.\n     */\n    returnToPool(task) {\n        trace(this, 'returnToPool');\n        this.taskPool[this.taskPoolSize++] = task;\n    }\n    /**\n     * Reset the persistent task back to its pending state, preparing it for being invoked again on the next flush.\n     */\n    resetPersistentTask(task) {\n        enter(this, 'resetPersistentTask');\n        task.reset(this.now());\n        if (task.createdTime === task.queueTime) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n                task.next = void 0;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n                task.next = void 0;\n            }\n        }\n        leave(this, 'resetPersistentTask');\n    }\n    /**\n     * Notify the queue that this async task has had its promise resolved, so that the queue can proceed with consecutive tasks on the next flush.\n     */\n    completeAsyncTask(task) {\n        var _a;\n        enter(this, 'completeAsyncTask');\n        if (this.processingAsync !== task) {\n            leave(this, 'completeAsyncTask error');\n            throw new Error(`Async task completion mismatch: processingAsync=${(_a = this.processingAsync) === null || _a === void 0 ? void 0 : _a.id}, task=${task.id}`);\n        }\n        this.processingAsync = void 0;\n        if (this.yieldPromise !== void 0 &&\n            this.hasNoMoreFiniteWork) {\n            const p = this.yieldPromise;\n            this.yieldPromise = void 0;\n            p.resolve();\n        }\n        if (this.isEmpty) {\n            this.cancel();\n        }\n        leave(this, 'completeAsyncTask');\n    }\n    finish(task) {\n        enter(this, 'finish');\n        if (task.next !== void 0) {\n            task.next.prev = task.prev;\n        }\n        if (task.prev !== void 0) {\n            task.prev.next = task.next;\n        }\n        leave(this, 'finish');\n    }\n    removeFromProcessing(task) {\n        enter(this, 'removeFromProcessing');\n        if (this.processingHead === task) {\n            this.processingHead = task.next;\n        }\n        if (this.processingTail === task) {\n            this.processingTail = task.prev;\n        }\n        --this.processingSize;\n        this.finish(task);\n        leave(this, 'removeFromProcessing');\n    }\n    removeFromPending(task) {\n        enter(this, 'removeFromPending');\n        if (this.pendingHead === task) {\n            this.pendingHead = task.next;\n        }\n        if (this.pendingTail === task) {\n            this.pendingTail = task.prev;\n        }\n        --this.pendingSize;\n        this.finish(task);\n        leave(this, 'removeFromPending');\n    }\n    removeFromDelayed(task) {\n        enter(this, 'removeFromDelayed');\n        if (this.delayedHead === task) {\n            this.delayedHead = task.next;\n        }\n        if (this.delayedTail === task) {\n            this.delayedTail = task.prev;\n        }\n        --this.delayedSize;\n        this.finish(task);\n        leave(this, 'removeFromDelayed');\n    }\n    addToProcessing(task) {\n        enter(this, 'addToProcessing');\n        if (this.processingSize++ === 0) {\n            this.processingHead = this.processingTail = task;\n        }\n        else {\n            this.processingTail = (task.prev = this.processingTail).next = task;\n        }\n        leave(this, 'addToProcessing');\n    }\n    addToPending(task) {\n        enter(this, 'addToPending');\n        if (this.pendingSize++ === 0) {\n            this.pendingHead = this.pendingTail = task;\n        }\n        else {\n            this.pendingTail = (task.prev = this.pendingTail).next = task;\n        }\n        leave(this, 'addToPending');\n    }\n    addToDelayed(task) {\n        enter(this, 'addToDelayed');\n        if (this.delayedSize++ === 0) {\n            this.delayedHead = this.delayedTail = task;\n        }\n        else {\n            this.delayedTail = (task.prev = this.delayedTail).next = task;\n        }\n        leave(this, 'addToDelayed');\n    }\n    movePendingToProcessing() {\n        enter(this, 'movePendingToProcessing');\n        // Add the previously pending tasks to the currently processing tasks\n        if (this.processingSize === 0) {\n            this.processingHead = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize = this.pendingSize;\n        }\n        else {\n            this.processingTail.next = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize += this.pendingSize;\n        }\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.pendingSize = 0;\n        leave(this, 'movePendingToProcessing');\n    }\n    moveDelayedToProcessing() {\n        enter(this, 'moveDelayedToProcessing');\n        const time = this.now();\n        // Add any delayed tasks whose delay have expired to the currently processing tasks\n        const delayedHead = this.delayedHead;\n        if (delayedHead.queueTime <= time) {\n            let delayedTail = delayedHead;\n            let next = delayedTail.next;\n            let count = 1;\n            while (next !== void 0 && next.queueTime <= time) {\n                delayedTail = next;\n                next = delayedTail.next;\n                ++count;\n            }\n            if (this.processingSize === 0) {\n                this.processingHead = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize = count;\n            }\n            else {\n                this.processingTail.next = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize += count;\n            }\n            this.delayedHead = next;\n            this.delayedSize -= count;\n            if (this.delayedSize === 0) {\n                this.delayedTail = void 0;\n            }\n        }\n        leave(this, 'moveDelayedToProcessing');\n    }\n    requestFlush() {\n        enter(this, 'requestFlush');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        if (!this.flushRequested) {\n            this.flushRequested = true;\n            this.lastRequest = this.now();\n            this.flushRequestor.request();\n        }\n        leave(this, 'requestFlush');\n    }\n    requestFlushClamped() {\n        enter(this, 'requestFlushClamped');\n        if (this.priority <= 0 /* microTask */) {\n            // MicroTasks are not clamped so we have to clamp them with setTimeout or they'll block forever\n            this.microTaskRequestFlushTask = this.scheduler.queueMacroTask(this.requestFlush, microTaskRequestFlushTaskOptions);\n        }\n        else {\n            // Otherwise just let this queue handle itself\n            this.requestFlush();\n        }\n        leave(this, 'requestFlushClamped');\n    }\n}\nconst microTaskRequestFlushTaskOptions = {\n    delay: 0,\n    preempt: true,\n    persistent: false,\n    reusable: true,\n    async: false,\n};\n//# sourceMappingURL=task-queue.js.map","import { DI } from '@aurelia/kernel';\nimport { defaultQueueTaskOptions, } from './types';\nimport { TaskQueue, } from './task-queue';\nconst store = new WeakMap();\nexport const IScheduler = DI.createInterface('IScheduler').noDefault();\nexport class Scheduler {\n    constructor(now, microtaskFactory, renderFactory, macroTaskFactory, postRenderFactory, idleFactory) {\n        this.taskQueues = [\n            this.microtask = (new TaskQueue(now, 0 /* microTask */, this, microtaskFactory)),\n            this.render = (new TaskQueue(now, 1 /* render */, this, renderFactory)),\n            this.macroTask = (new TaskQueue(now, 2 /* macroTask */, this, macroTaskFactory)),\n            this.postRender = (new TaskQueue(now, 3 /* postRender */, this, postRenderFactory)),\n            this.idle = (new TaskQueue(now, 4 /* idle */, this, idleFactory)),\n        ];\n        this.yieldMicroTask = this.yieldMicroTask.bind(this);\n        this.yieldRenderTask = this.yieldRenderTask.bind(this);\n        this.yieldMacroTask = this.yieldMacroTask.bind(this);\n        this.yieldPostRenderTask = this.yieldPostRenderTask.bind(this);\n        this.yieldIdleTask = this.yieldIdleTask.bind(this);\n        this.yieldAll = this.yieldAll.bind(this);\n    }\n    static get(key) {\n        return store.get(key);\n    }\n    static set(key, instance) {\n        store.set(key, instance);\n    }\n    getTaskQueue(priority) {\n        return this.taskQueues[priority];\n    }\n    yield(priority) {\n        return this.taskQueues[priority].yield();\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, priority, persistent, reusable, async } = { ...defaultQueueTaskOptions, ...opts };\n        return this.taskQueues[priority].queueTask(callback, { delay, preempt, persistent, reusable, async });\n    }\n    getMicroTaskQueue() {\n        return this.microtask;\n    }\n    getRenderTaskQueue() {\n        return this.render;\n    }\n    getMacroTaskQueue() {\n        return this.macroTask;\n    }\n    getPostRenderTaskQueue() {\n        return this.postRender;\n    }\n    getIdleTaskQueue() {\n        return this.idle;\n    }\n    yieldMicroTask() {\n        return this.microtask.yield();\n    }\n    yieldRenderTask() {\n        return this.render.yield();\n    }\n    yieldMacroTask() {\n        return this.macroTask.yield();\n    }\n    yieldPostRenderTask() {\n        return this.postRender.yield();\n    }\n    yieldIdleTask() {\n        return this.idle.yield();\n    }\n    async yieldAll(repeat = 1) {\n        while (repeat-- > 0) {\n            await this.yieldMicroTask();\n            await this.yieldRenderTask();\n            await this.yieldMacroTask();\n            await this.yieldPostRenderTask();\n            await this.yieldIdleTask();\n        }\n    }\n    queueMicroTask(callback, opts) {\n        return this.microtask.queueTask(callback, opts);\n    }\n    queueRenderTask(callback, opts) {\n        return this.render.queueTask(callback, opts);\n    }\n    queueMacroTask(callback, opts) {\n        return this.macroTask.queueTask(callback, opts);\n    }\n    queuePostRenderTask(callback, opts) {\n        return this.postRender.queueTask(callback, opts);\n    }\n    queueIdleTask(callback, opts) {\n        return this.idle.queueTask(callback, opts);\n    }\n}\n//# sourceMappingURL=scheduler.js.map","function $noop() { return; }\nconst $global = (function () {\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    try {\n        // Not all environments allow eval and Function. Use only as a last resort:\n        // eslint-disable-next-line no-new-func\n        return new Function('return this')();\n    }\n    catch (_a) {\n        // If all fails, give up and create an object.\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return {};\n    }\n})();\nconst isBrowserLike = (typeof window !== 'undefined'\n    && typeof window.document !== 'undefined');\nconst isWebWorkerLike = (typeof self === 'object'\n    && self.constructor != null\n    && self.constructor.name === 'DedicatedWorkerGlobalScope');\nconst isNodeLike = (typeof process !== 'undefined'\n    && process.versions != null\n    && process.versions.node != null);\n// performance.now polyfill for non-browser envs based on https://github.com/myrne/performance-now\nconst $now = (function () {\n    var _a, _b;\n    let getNanoSeconds;\n    let hrtime;\n    let moduleLoadTime;\n    let nodeLoadTime;\n    let upTime;\n    if (((_a = $global.performance) === null || _a === void 0 ? void 0 : _a.now) != null) {\n        const $performance = $global.performance;\n        return function () {\n            return $performance.now();\n        };\n    }\n    else if (((_b = $global.process) === null || _b === void 0 ? void 0 : _b.hrtime) != null) {\n        const now = function () {\n            return (getNanoSeconds() - nodeLoadTime) / 1e6;\n        };\n        hrtime = $global.process.hrtime;\n        getNanoSeconds = function () {\n            const hr = hrtime();\n            return hr[0] * 1e9 + hr[1];\n        };\n        moduleLoadTime = getNanoSeconds();\n        upTime = $global.process.uptime() * 1e9;\n        nodeLoadTime = moduleLoadTime - upTime;\n        return now;\n    }\n    else {\n        const now = function () {\n            return Date.now() - nodeLoadTime;\n        };\n        nodeLoadTime = Date.now();\n        return now;\n    }\n})();\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst emptyArray = Object.freeze([]);\nconst emptyObject = Object.freeze({});\nconst $PLATFORM = {\n    /**\n     * `true` if there is a `window` variable in the global scope with a `document` property.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a browser, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `window` global is available and likely behaves similar to how it would in a browser.\n     */\n    isBrowserLike,\n    /**\n     * `true` if there is a `self` variable (of type `object`) in the global scope with constructor name `'DedicatedWorkerGlobalScope'`.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a web worker, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `self` global is available and likely behaves similar to how it would in a web worker.\n     */\n    isWebWorkerLike,\n    /**\n     * `true` if there is a `process` variable in the global scope with a `versions` property which has a `node` property.\n     *\n     * NOTE: this is not a guarantee that the code is actually running in nodejs, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `process` global is available and likely behaves similar to how it would in nodejs.\n     */\n    isNodeLike,\n    global: $global,\n    emptyArray,\n    emptyObject,\n    noop: $noop,\n    now: $now,\n    hasOwnProperty,\n    restore() {\n        Object.assign(PLATFORM, $PLATFORM);\n    },\n};\nexport const PLATFORM = { ...$PLATFORM };\n//# sourceMappingURL=platform.js.map","import * as AST from '@aurelia/runtime';\nconst astTypeMap = [\n    { type: AST.AccessKeyedExpression, name: 'AccessKeyedExpression' },\n    { type: AST.AccessMemberExpression, name: 'AccessMemberExpression' },\n    { type: AST.AccessScopeExpression, name: 'AccessScopeExpression' },\n    { type: AST.AccessThisExpression, name: 'AccessThisExpression' },\n    { type: AST.ArrayBindingPattern, name: 'ArrayBindingPattern' },\n    { type: AST.ArrayLiteralExpression, name: 'ArrayLiteralExpression' },\n    { type: AST.AssignExpression, name: 'AssignExpression' },\n    { type: AST.BinaryExpression, name: 'BinaryExpression' },\n    { type: AST.BindingBehaviorExpression, name: 'BindingBehaviorExpression' },\n    { type: AST.BindingIdentifier, name: 'BindingIdentifier' },\n    { type: AST.CallFunctionExpression, name: 'CallFunctionExpression' },\n    { type: AST.CallMemberExpression, name: 'CallMemberExpression' },\n    { type: AST.CallScopeExpression, name: 'CallScopeExpression' },\n    { type: AST.ConditionalExpression, name: 'ConditionalExpression' },\n    { type: AST.ForOfStatement, name: 'ForOfStatement' },\n    { type: AST.HtmlLiteralExpression, name: 'HtmlLiteralExpression' },\n    { type: AST.Interpolation, name: 'Interpolation' },\n    { type: AST.ObjectBindingPattern, name: 'ObjectBindingPattern' },\n    { type: AST.ObjectLiteralExpression, name: 'ObjectLiteralExpression' },\n    { type: AST.PrimitiveLiteralExpression, name: 'PrimitiveLiteralExpression' },\n    { type: AST.TaggedTemplateExpression, name: 'TaggedTemplateExpression' },\n    { type: AST.TemplateExpression, name: 'TemplateExpression' },\n    { type: AST.UnaryExpression, name: 'UnaryExpression' },\n    { type: AST.ValueConverterExpression, name: 'ValueConverterExpression' }\n];\nexport function enableImprovedExpressionDebugging() {\n    astTypeMap.forEach(x => { adoptDebugMethods(x.type, x.name); });\n}\n/** @internal */\nexport function adoptDebugMethods($type, name) {\n    $type.prototype.toString = function () { return Unparser.unparse(this); };\n}\nexport class Unparser {\n    constructor() {\n        this.text = '';\n    }\n    static unparse(expr) {\n        const visitor = new Unparser();\n        expr.accept(visitor);\n        return visitor.text;\n    }\n    visitAccessMember(expr) {\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n    }\n    visitAccessKeyed(expr) {\n        expr.object.accept(this);\n        this.text += '[';\n        expr.key.accept(this);\n        this.text += ']';\n    }\n    visitAccessThis(expr) {\n        if (expr.ancestor === 0) {\n            this.text += '$this';\n            return;\n        }\n        this.text += '$parent';\n        let i = expr.ancestor - 1;\n        while (i--) {\n            this.text += '.$parent';\n        }\n    }\n    visitAccessScope(expr) {\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n    }\n    visitArrayLiteral(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectLiteral(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitPrimitiveLiteral(expr) {\n        this.text += '(';\n        if (typeof expr.value === 'string') {\n            const escaped = expr.value.replace(/'/g, '\\\\\\'');\n            this.text += `'${escaped}'`;\n        }\n        else {\n            this.text += `${expr.value}`;\n        }\n        this.text += ')';\n    }\n    visitCallFunction(expr) {\n        this.text += '(';\n        expr.func.accept(this);\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallMember(expr) {\n        this.text += '(';\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallScope(expr) {\n        this.text += '(';\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitTaggedTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        expr.func.accept(this);\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitUnary(expr) {\n        this.text += `(${expr.operation}`;\n        if (expr.operation.charCodeAt(0) >= /* a */ 97) {\n            this.text += ' ';\n        }\n        expr.expression.accept(this);\n        this.text += ')';\n    }\n    visitBinary(expr) {\n        this.text += '(';\n        expr.left.accept(this);\n        if (expr.operation.charCodeAt(0) === /* i */ 105) {\n            this.text += ` ${expr.operation} `;\n        }\n        else {\n            this.text += expr.operation;\n        }\n        expr.right.accept(this);\n        this.text += ')';\n    }\n    visitConditional(expr) {\n        this.text += '(';\n        expr.condition.accept(this);\n        this.text += '?';\n        expr.yes.accept(this);\n        this.text += ':';\n        expr.no.accept(this);\n        this.text += ')';\n    }\n    visitAssign(expr) {\n        this.text += '(';\n        expr.target.accept(this);\n        this.text += '=';\n        expr.value.accept(this);\n        this.text += ')';\n    }\n    visitValueConverter(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `|${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitBindingBehavior(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `&${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitArrayBindingPattern(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectBindingPattern(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitBindingIdentifier(expr) {\n        this.text += expr.name;\n    }\n    visitHtmlLiteral(expr) { throw new Error('visitHtmlLiteral'); }\n    visitForOfStatement(expr) {\n        expr.declaration.accept(this);\n        this.text += ' of ';\n        expr.iterable.accept(this);\n    }\n    visitInterpolation(expr) {\n        const { parts, expressions } = expr;\n        const length = expressions.length;\n        this.text += '${';\n        this.text += parts[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += parts[i + 1];\n        }\n        this.text += '}';\n    }\n    writeArgs(args) {\n        this.text += '(';\n        for (let i = 0, length = args.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            args[i].accept(this);\n        }\n        this.text += ')';\n    }\n}\n//# sourceMappingURL=unparser.js.map","import { Reporter as RuntimeReporter } from '@aurelia/kernel';\nfunction applyFormat(message, ...params) {\n    while (message.includes('%s')) {\n        message = message.replace('%s', String(params.shift()));\n    }\n    return message;\n}\nexport const Reporter = {\n    ...RuntimeReporter,\n    get level() {\n        return RuntimeReporter.level;\n    },\n    write(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const message = `Code ${code}: ${info.message}`;\n        switch (info.level) {\n            case 1 /* debug */:\n                if (this.level <= 1 /* debug */) {\n                    console.debug(message, ...params);\n                }\n                break;\n            case 2 /* info */:\n                if (this.level <= 2 /* info */) {\n                    console.info(message, ...params);\n                }\n                break;\n            case 3 /* warn */:\n                if (this.level <= 3 /* warn */) {\n                    console.warn(message, ...params);\n                }\n                break;\n            case 4 /* error */: {\n                throw this.error(code, ...params);\n            }\n        }\n    },\n    error(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const error = new Error(`Code ${code}: ${applyFormat(info.message, ...params)}`);\n        error.data = params;\n        return error;\n    }\n};\nfunction getMessageInfoForCode(code) {\n    const info = codeLookup[code];\n    return info !== undefined ? info : createInvalidCodeMessageInfo(code);\n}\nfunction createInvalidCodeMessageInfo(code) {\n    return {\n        level: 4 /* error */,\n        message: `Attempted to report with unknown code ${code}.`\n    };\n}\nconst codeLookup = {\n    0: {\n        level: 3 /* warn */,\n        message: 'Cannot add observers to object.'\n    },\n    1: {\n        level: 3 /* warn */,\n        message: 'Cannot observe property of object.'\n    },\n    2: {\n        level: 2 /* info */,\n        message: 'Starting application in debug mode.'\n    },\n    3: {\n        level: 4 /* error */,\n        message: 'Runtime expression compilation is only available when including JIT support.'\n    },\n    4: {\n        level: 4 /* error */,\n        message: 'Invalid animation direction.'\n    },\n    5: {\n        level: 4 /* error */,\n        message: 'key/value cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    6: {\n        level: 4 /* error */,\n        message: 'Invalid resolver strategy specified.'\n    },\n    7: {\n        level: 4 /* error */,\n        message: 'Constructor Parameter with index cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    8: {\n        level: 4 /* error */,\n        message: 'Self binding behavior only supports events.'\n    },\n    9: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">'\n    },\n    10: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.'\n    },\n    11: {\n        level: 4 /* error */,\n        message: 'Only property bindings and string interpolation bindings can be signaled. Trigger, delegate and call bindings cannot be signaled.'\n    },\n    12: {\n        level: 4 /* error */,\n        message: 'Signal name is required.'\n    },\n    14: {\n        level: 4 /* error */,\n        message: 'Property cannot be assigned.'\n    },\n    15: {\n        level: 4 /* error */,\n        message: 'Unexpected call context.'\n    },\n    16: {\n        level: 4 /* error */,\n        message: 'A dependency registration is missing for the interface %s.'\n    },\n    17: {\n        level: 4 /* error */,\n        message: 'You can only define one default implementation for an interface.'\n    },\n    18: {\n        level: 4 /* error */,\n        message: 'You cannot observe a setter only property.'\n    },\n    19: {\n        level: 4 /* error */,\n        message: 'Value for expression is non-repeatable.'\n    },\n    20: {\n        level: 4 /* error */,\n        message: 'No template compiler found with the specified name. JIT support or a custom compiler is required.'\n    },\n    21: {\n        level: 4 /* error */,\n        message: 'You cannot combine the containerless custom element option with Shadow DOM.'\n    },\n    22: {\n        level: 4 /* error */,\n        message: 'A containerless custom element cannot be the root component of an application.'\n    },\n    30: {\n        level: 4 /* error */,\n        message: 'There are more targets than there are target instructions.'\n    },\n    31: {\n        level: 4 /* error */,\n        message: 'There are more target instructions than there are targets.'\n    },\n    100: {\n        level: 4 /* error */,\n        message: 'Invalid start of expression.'\n    },\n    101: {\n        level: 4 /* error */,\n        message: 'Unconsumed token.'\n    },\n    102: {\n        level: 4 /* error */,\n        message: 'Double dot and spread operators are not supported.'\n    },\n    103: {\n        level: 4 /* error */,\n        message: 'Invalid member expression.'\n    },\n    104: {\n        level: 4 /* error */,\n        message: 'Unexpected end of expression.'\n    },\n    105: {\n        level: 4 /* error */,\n        message: 'Expected identifier.'\n    },\n    106: {\n        level: 4 /* error */,\n        message: 'Invalid BindingIdentifier at left hand side of \"of\".'\n    },\n    107: {\n        level: 4 /* error */,\n        message: 'Invalid or unsupported property definition in object literal.'\n    },\n    108: {\n        level: 4 /* error */,\n        message: 'Unterminated quote in string literal.'\n    },\n    109: {\n        level: 4 /* error */,\n        message: 'Unterminated template string.'\n    },\n    110: {\n        level: 4 /* error */,\n        message: 'Missing expected token.'\n    },\n    111: {\n        level: 4 /* error */,\n        message: 'Unexpected character.'\n    },\n    150: {\n        level: 4 /* error */,\n        message: 'Left hand side of expression is not assignable.'\n    },\n    151: {\n        level: 4 /* error */,\n        message: 'Unexpected keyword \"of\"'\n    },\n    401: {\n        level: 3 /* warn */,\n        message: `AttributePattern is missing a handler for '%s'.`\n    },\n    402: {\n        level: 3 /* warn */,\n        message: `AttributePattern handler for '%s' is not a function.`\n    },\n    800: {\n        level: 4 /* error */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    801: {\n        level: 3 /* warn */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    2000: {\n        level: 4 /* error */,\n        message: 'Router has not been activated.'\n    },\n    2001: {\n        level: 4 /* error */,\n        message: 'Router has already been activated.'\n    },\n    2002: {\n        level: 4 /* error */,\n        message: 'Failed to resolve all viewports.'\n    },\n    2003: {\n        level: 4 /* error */,\n        message: 'Browser navigation has already been activated.'\n    },\n    2004: {\n        level: 4 /* error */,\n        message: 'LinkHandler has already been activated.'\n    },\n    1001: {\n        level: 2 /* info */,\n        message: 'DOM already initialized. Destroying and re-initializing..'\n    },\n    10000: {\n        level: 1 /* debug */,\n        message: '%s'\n    }\n};\n//# sourceMappingURL=reporter.js.map","import { PLATFORM, Reporter, Tracer } from '@aurelia/kernel';\nconst marker = {\n    objName: 'marker',\n    methodName: 'noop',\n    params: PLATFORM.emptyArray,\n    depth: -1,\n    prev: null,\n    next: null\n};\nlet TraceInfo = /** @class */ (() => {\n    class TraceInfo {\n        constructor(objName, methodName, params) {\n            this.objName = objName;\n            this.methodName = methodName;\n            this.params = params;\n            this.objName = objName;\n            this.methodName = methodName;\n            this.depth = TraceInfo.stack.length;\n            this.params = params;\n            this.next = marker;\n            this.prev = TraceInfo.tail;\n            TraceInfo.tail.next = this;\n            TraceInfo.tail = this;\n            TraceInfo.stack.push(this);\n        }\n        static reset() {\n            let current = TraceInfo.head;\n            let next = null;\n            while (current != null) {\n                next = current.next;\n                current.next = null;\n                current.prev = null;\n                current.params = null;\n                current = next;\n            }\n            TraceInfo.head = marker;\n            TraceInfo.tail = marker;\n            TraceInfo.stack = [];\n        }\n        static enter(objName, methodName, params) {\n            return new TraceInfo(objName, methodName, params);\n        }\n        static leave() {\n            return TraceInfo.stack.pop();\n        }\n    }\n    TraceInfo.head = marker;\n    TraceInfo.tail = marker;\n    TraceInfo.stack = [];\n    return TraceInfo;\n})();\nexport const DebugTracer = {\n    ...Tracer,\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) {\n        if (this.enabled) {\n            const info = TraceInfo.enter(objName, methodName, args);\n            if (this.liveLoggingEnabled) {\n                this.liveWriter.write(info);\n            }\n        }\n    },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() {\n        if (this.enabled) {\n            TraceInfo.leave();\n        }\n    },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) {\n        let i = 0;\n        const stack = TraceInfo.stack;\n        const len = stack.length;\n        while (i < len) {\n            writer.write(stack[i]);\n            ++i;\n        }\n    },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) {\n        if (writer != null) {\n            let current = TraceInfo.head.next; // skip the marker\n            while (current != null && current !== marker) {\n                writer.write(current);\n                current = current.next;\n            }\n        }\n        TraceInfo.reset();\n    },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() {\n        this.liveLoggingEnabled = false;\n        this.liveWriter = null;\n    }\n};\nconst defaultOptions = {\n    rendering: true,\n    binding: true,\n    observation: true,\n    attaching: true,\n    mounting: true,\n    di: true,\n    lifecycle: true,\n    jit: true\n};\nfunction enableLiveLogging(optionsOrWriter) {\n    this.liveLoggingEnabled = true;\n    if (optionsOrWriter && 'write' in optionsOrWriter) {\n        this.liveWriter = optionsOrWriter;\n    }\n    else {\n        const options = optionsOrWriter !== undefined ? optionsOrWriter : defaultOptions;\n        this.liveWriter = createLiveTraceWriter(options);\n    }\n}\nconst toString = Object.prototype.toString;\nfunction flagsText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return stringifyLifecycleFlags(info.params[i]);\n    }\n    return 'none';\n}\nfunction _ctorName(obj) {\n    let name;\n    if (obj === undefined) {\n        name = 'undefined';\n    }\n    else if (obj === null) {\n        name = 'null';\n    }\n    else if (obj.constructor !== undefined) {\n        if (obj.constructor.description) {\n            name = `Resource{'${obj.constructor.description.name}'}`;\n        }\n        else {\n            name = obj.constructor.name;\n        }\n    }\n    else if (typeof obj === 'string') {\n        name = `'${obj}'`;\n    }\n    else {\n        name = toString.call(obj);\n    }\n    return name;\n}\nfunction ctorName(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return _ctorName(info.params[i]);\n    }\n    return 'undefined';\n}\nfunction scopeText(info, i = 0) {\n    let $ctorName;\n    if (info.params != null && info.params.length > i) {\n        const $scope = info.params[i];\n        if ($scope != null && $scope.bindingContext != null) {\n            $ctorName = _ctorName($scope.bindingContext);\n        }\n        else {\n            $ctorName = 'undefined';\n        }\n        return `Scope{${$ctorName}}`;\n    }\n    return 'undefined';\n}\nfunction keyText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        if ($key !== undefined && Reflect.has($key, 'friendlyName')) {\n            return $key['friendlyName'];\n        }\n        return _ctorName($key);\n    }\n    return 'undefined';\n}\nfunction primitive(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        return $key.toString();\n    }\n    return 'undefined';\n}\nconst RenderingArgsProcessor = {\n    $hydrate(info) {\n        return flagsText(info);\n    },\n    render(info) {\n        return `${flagsText(info)},IDOM,IContainer,${ctorName(info, 3)}`;\n    },\n    addBinding(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    },\n    addComponent(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    }\n};\nconst BindingArgsProcessor = {\n    $bind(info) {\n        return flagsText(info);\n    },\n    $unbind(info) {\n        return flagsText(info);\n    },\n    connect(info) {\n        return flagsText(info);\n    },\n    // currently only observers trace constructor calls but keep an eye on this if others are added, then we'd need additional filtering\n    constructor(info) {\n        switch (info.objName) {\n            case 'ArrayObserver':\n            case 'MapObserver':\n            case 'SetObserver':\n                return flagsText(info);\n            case 'SetterObserver':\n            case 'BindableObserver':\n                return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'ProxyObserver':\n                return ctorName(info);\n            case 'ProxySubscriberCollection':\n            case 'DirtyCheckProperty':\n                return `${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'PrimitiveObserver':\n            case 'PropertyAccessor':\n                return `${ctorName(info)},${primitive(info, 1)}`;\n            default:\n                return '';\n        }\n    },\n    lockedBind(info) {\n        return flagsText(info);\n    },\n    lockedUnbind(info) {\n        return flagsText(info);\n    },\n    InternalObserversLookup(info) {\n        return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n    },\n    BindingContext(info) {\n        switch (info.methodName) {\n            case 'get':\n                return `${scopeText(info)},${primitive(info, 1)},${primitive(info, 2)},${flagsText(info, 3)}`;\n            case 'getObservers':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    Scope(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'fromOverride':\n                return `${flagsText(info)},${ctorName(info, 1)}`;\n            case 'fromParent':\n                return `${flagsText(info)},${scopeText(info, 1)},${ctorName(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    },\n    OverrideContext(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'getObservers':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst ObservationArgsProcessor = {\n    callSource(info) {\n        const names = [];\n        switch (info.objName) {\n            case 'Listener':\n                return (info.params[0]).type;\n            case 'CallBinding':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(ctorName(info, i));\n                    }\n                }\n                return names.join(',');\n            default:\n                return 'unknown';\n        }\n    },\n    setValue(info) {\n        let valueText;\n        const value = info.params[0];\n        switch (typeof value) {\n            case 'undefined':\n                valueText = 'undefined';\n                break;\n            case 'object':\n                if (value === null) {\n                    valueText = 'null';\n                }\n                else {\n                    valueText = _ctorName(value);\n                }\n                break;\n            case 'string':\n                valueText = `'${value}'`;\n                break;\n            case 'number':\n                valueText = value.toString();\n                break;\n            default:\n                valueText = _ctorName(value);\n        }\n        return `${valueText},${flagsText(info, 1)}`;\n    },\n    flush(info) {\n        return flagsText(info);\n    },\n    handleChange(info) {\n        return `${primitive(info)},${primitive(info, 1)},${flagsText(info, 2)}`;\n    },\n    lockScope(info) {\n        return scopeText(info);\n    }\n};\nconst AttachingArgsProcessor = {\n    $attach(info) {\n        return flagsText(info);\n    },\n    $detach(info) {\n        return flagsText(info);\n    },\n    $cache(info) {\n        return flagsText(info);\n    },\n    setLocation(info) {\n        return `Node{'${(info.params[0]).textContent}'}`;\n    },\n};\nconst MountingArgsProcessor = {\n    project(info) {\n        return ctorName(info);\n    },\n    take(info) {\n        return ctorName(info);\n    }\n};\nconst DIArgsProcessor = {\n    construct(info) {\n        return ctorName(info);\n    },\n    Container(info) {\n        const names = [];\n        switch (info.methodName) {\n            case 'get':\n            case 'getAll':\n                return keyText(info);\n            case 'register':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(keyText(info, i));\n                    }\n                }\n                return names.join(',');\n            case 'createChild':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst LifecycleArgsProcessor = {\n    Lifecycle(info) {\n        switch (info.methodName.slice(0, 3)) {\n            case 'beg':\n                return '';\n            case 'enq':\n                return ctorName(info);\n            case 'end':\n            case 'pro':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    CompositionCoordinator(info) {\n        switch (info.methodName) {\n            case 'enqueue':\n                return 'IController';\n            case 'swap':\n                return `IController,${flagsText(info, 1)}`;\n            case 'processNext':\n                return '';\n            default:\n                return 'unknown';\n        }\n    },\n    AggregateLifecycleTask(info) {\n        switch (info.methodName) {\n            case 'addTask':\n            case 'removeTask':\n                return ctorName(info);\n            case 'complete':\n                return `${primitive(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst JitArgsProcessor = {\n    TemplateBinder(info) {\n        return ''; // TODO\n    }\n};\nfunction createLiveTraceWriter(options) {\n    const Processors = {};\n    if (options.rendering) {\n        Object.assign(Processors, RenderingArgsProcessor);\n    }\n    if (options.binding) {\n        Object.assign(Processors, BindingArgsProcessor);\n    }\n    if (options.observation) {\n        Object.assign(Processors, ObservationArgsProcessor);\n    }\n    if (options.attaching) {\n        Object.assign(Processors, AttachingArgsProcessor);\n    }\n    if (options.mounting) {\n        Object.assign(Processors, MountingArgsProcessor);\n    }\n    if (options.di) {\n        Object.assign(Processors, DIArgsProcessor);\n    }\n    if (options.lifecycle) {\n        Object.assign(Processors, LifecycleArgsProcessor);\n    }\n    if (options.jit) {\n        Object.assign(Processors, JitArgsProcessor);\n    }\n    return {\n        write(info) {\n            let output;\n            if (Processors[info.methodName] !== undefined) {\n                output = Processors[info.methodName](info);\n            }\n            else if (Processors[info.objName] !== undefined) {\n                output = Processors[info.objName](info);\n            }\n            else {\n                return;\n            }\n            Reporter.write(10000, `${'-'.repeat(info.depth)}${info.objName}.${info.methodName}(${output})`);\n        }\n    };\n}\nexport function stringifyLifecycleFlags(flags) {\n    const flagNames = [];\n    if (flags & 128 /* mustEvaluate */) {\n        flagNames.push('mustEvaluate');\n    }\n    if (flags & 8 /* updateTargetInstance */) {\n        flagNames.push('updateTargetInstance');\n    }\n    if (flags & 16 /* updateSourceExpression */) {\n        flagNames.push('updateSourceExpression');\n    }\n    if (flags & 32 /* fromBind */) {\n        flagNames.push('fromBind');\n    }\n    if (flags & 64 /* fromUnbind */) {\n        flagNames.push('fromUnbind');\n    }\n    if (flags & 256 /* isTraversingParentScope */) {\n        flagNames.push('isTraversingParentScope');\n    }\n    if (flags & 1024 /* allowParentScopeTraversal */) {\n        flagNames.push('allowParentScopeTraversal');\n    }\n    if (flags & 1 /* getterSetterStrategy */) {\n        flagNames.push('getterSetterStrategy');\n    }\n    if (flags & 2 /* proxyStrategy */) {\n        flagNames.push('proxyStrategy');\n    }\n    if (flags & 16384 /* secondaryExpression */) {\n        flagNames.push('secondaryExpression');\n    }\n    if (flagNames.length === 0) {\n        return 'none';\n    }\n    return flagNames.join('|');\n}\n//# sourceMappingURL=tracer.js.map","import { Scheduler, Now, } from '@aurelia/scheduler';\nimport { isNativeFunction, PLATFORM, } from '@aurelia/kernel';\nfunction createMicroTaskFlushRequestorFactory() {\n    return {\n        create(taskQueue) {\n            let requested = false;\n            let canceled = false;\n            const p = Promise.resolve();\n            function flush() {\n                if (canceled) {\n                    canceled = false;\n                }\n                else {\n                    requested = false;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                request() {\n                    if (!requested) {\n                        canceled = false;\n                        requested = true;\n                        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                        p.then(flush);\n                    }\n                },\n                cancel() {\n                    canceled = true;\n                    requested = false;\n                },\n            };\n        },\n    };\n}\nfunction createSetTimeoutFlushRequestorFactory(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                cancel() {\n                    if (handle > -1) {\n                        w.clearTimeout(handle);\n                        handle = -1;\n                    }\n                },\n                request() {\n                    if (handle === -1) {\n                        handle = w.setTimeout(flush, 0);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createRequestAnimationFrameFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                cancel() {\n                    if (handle > -1) {\n                        w.cancelAnimationFrame(handle);\n                        handle = -1;\n                    }\n                },\n                request() {\n                    if (handle === -1) {\n                        handle = w.requestAnimationFrame(flush);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createPostRequestAnimationFrameFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let rafHandle = -1;\n            let timeoutHandle = -1;\n            function flush() {\n                if (timeoutHandle > -1) {\n                    timeoutHandle = -1;\n                    taskQueue.flush();\n                }\n            }\n            function queueFlush() {\n                if (rafHandle > -1) {\n                    rafHandle = -1;\n                    if (timeoutHandle === -1) {\n                        timeoutHandle = w.setTimeout(flush, 0);\n                    }\n                }\n            }\n            return {\n                cancel() {\n                    if (rafHandle > -1) {\n                        w.cancelAnimationFrame(rafHandle);\n                        rafHandle = -1;\n                    }\n                    if (timeoutHandle > -1) {\n                        w.clearTimeout(timeoutHandle);\n                        timeoutHandle = -1;\n                    }\n                },\n                request() {\n                    if (rafHandle === -1) {\n                        rafHandle = w.requestAnimationFrame(queueFlush);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createRequestIdleCallbackFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            if (typeof w.requestIdleCallback === 'function' &&\n                isNativeFunction(w.requestIdleCallback)) {\n                return {\n                    cancel() {\n                        if (handle > -1) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            w.cancelIdleCallback(handle);\n                            handle = -1;\n                        }\n                    },\n                    request() {\n                        if (handle === -1) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            handle = w.requestIdleCallback(flush);\n                        }\n                    },\n                };\n            }\n            else {\n                return {\n                    cancel() {\n                        if (handle > -1) {\n                            w.clearTimeout(handle);\n                            handle = -1;\n                        }\n                    },\n                    request() {\n                        if (handle === -1) {\n                            // Instead of trying anything fancy with event handler debouncers (we could do that if there was a request for it),\n                            // we just wait 45ms which is approximately the interval in a native idleCallback loop in chrome, to at least make it look\n                            // the same from a timing perspective\n                            handle = w.setTimeout(flush, 45);\n                        }\n                    },\n                };\n            }\n        },\n    };\n}\nexport function createDOMScheduler(container, w) {\n    let scheduler = Scheduler.get(PLATFORM.global);\n    if (scheduler === void 0) {\n        Scheduler.set(PLATFORM.global, scheduler = new Scheduler(container.get(Now), createMicroTaskFlushRequestorFactory(), createRequestAnimationFrameFlushRequestor(w), createSetTimeoutFlushRequestorFactory(w), createPostRequestAnimationFrameFlushRequestor(w), createRequestIdleCallbackFlushRequestor(w)));\n    }\n    return scheduler;\n}\n//# sourceMappingURL=index.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, IContainer, Registration } from '@aurelia/kernel';\nimport { IDOM, IDOMInitializer, IScheduler } from '@aurelia/runtime';\nimport { RuntimeHtmlConfiguration, HTMLDOM } from '@aurelia/runtime-html';\nimport { createDOMScheduler } from '@aurelia/scheduler-dom';\nlet BrowserDOMInitializer = /** @class */ (() => {\n    let BrowserDOMInitializer = class BrowserDOMInitializer {\n        constructor(container) {\n            this.container = container;\n        }\n        static register(container) {\n            return Registration.singleton(IDOMInitializer, this).register(container);\n        }\n        initialize(config) {\n            if (this.container.has(IDOM, false)) {\n                return this.container.get(IDOM);\n            }\n            let dom;\n            if (config !== undefined) {\n                if (config.dom !== undefined) {\n                    dom = config.dom;\n                }\n                else if (config.host.ownerDocument !== null) {\n                    dom = new HTMLDOM(window, config.host.ownerDocument, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n                }\n                else {\n                    dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n                }\n            }\n            else {\n                dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n            Registration.instance(IDOM, dom).register(this.container);\n            Registration.instance(IScheduler, createDOMScheduler(this.container, window)).register(this.container);\n            return dom;\n        }\n    };\n    BrowserDOMInitializer = __decorate([\n        __param(0, IContainer),\n        __metadata(\"design:paramtypes\", [Object])\n    ], BrowserDOMInitializer);\n    return BrowserDOMInitializer;\n})();\nexport const IDOMInitializerRegistration = BrowserDOMInitializer;\n/**\n * Default HTML-specific, browser-specific implementations for the following interfaces:\n * - `IDOMInitializer`\n */\nexport const DefaultComponents = [\n    IDOMInitializerRegistration,\n];\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents`\n */\nexport const RuntimeHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...DefaultComponents);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport { BrowserDOMInitializer, };\n//# sourceMappingURL=index.js.map","import { DebugConfiguration } from '@aurelia/debug';\nimport { RuntimeHtmlBrowserConfiguration } from '@aurelia/runtime-html-browser';\nimport { DI } from '@aurelia/kernel';\nimport { Aurelia as $Aurelia, CustomElement } from '@aurelia/runtime';\n// TODO: SSR?? abstract HTMLElement and document.\nfunction createAurelia() {\n    const au = new Aurelia();\n    au.register(RuntimeHtmlBrowserConfiguration);\n    // eslint-disable-next-line sonarjs/no-collapsible-if\n    if (typeof process !== 'undefined' && typeof process.env === 'object') {\n        // Just use NODE_ENV to control build process.\n        // Bundlers (at least webpack/dumber/parcel) have feature to remove this branch in production.\n        // Then tree-shaking/minifier will remove unused DebugConfiguration import.\n        if (process.env.NODE_ENV !== 'production') {\n            au.register(DebugConfiguration);\n        }\n    }\n    return au;\n}\nexport class Aurelia extends $Aurelia {\n    constructor(container = DI.createContainer()) {\n        super(container);\n    }\n    static start(root) {\n        return createAurelia().start(root);\n    }\n    static app(config) {\n        return createAurelia().app(config);\n    }\n    static enhance(config) {\n        return createAurelia().enhance(config);\n    }\n    static register(...params) {\n        return createAurelia().register(...params);\n    }\n    app(config) {\n        if (CustomElement.isType(config)) {\n            // Default to custom element element name\n            const definition = CustomElement.getDefinition(config);\n            let host = document.querySelector(definition.name);\n            if (host === null) {\n                // When no target is found, default to body.\n                // For example, when user forgot to write <my-app></my-app> in html.\n                host = document.body;\n            }\n            return super.app({\n                host: host,\n                component: config\n            });\n        }\n        return super.app(config);\n    }\n}\n//# sourceMappingURL=quick-start.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import { DOM } from '@aurelia/runtime-html';\nexport const retryStrategy = {\n    fixed: 0,\n    incremental: 1,\n    exponential: 2,\n    random: 3\n};\nconst defaultRetryConfig = {\n    maxRetries: 3,\n    interval: 1000,\n    strategy: retryStrategy.fixed\n};\n/**\n * Interceptor that retries requests on error, based on a given RetryConfiguration.\n */\nexport class RetryInterceptor {\n    /**\n     * Creates an instance of RetryInterceptor.\n     */\n    constructor(retryConfig) {\n        this.retryConfig = { ...defaultRetryConfig, ...(retryConfig !== undefined ? retryConfig : {}) };\n        if (this.retryConfig.strategy === retryStrategy.exponential &&\n            this.retryConfig.interval <= 1000) {\n            throw new Error('An interval less than or equal to 1 second is not allowed when using the exponential retry strategy');\n        }\n    }\n    /**\n     * Called with the request before it is sent. It remembers the request so it can be retried on error.\n     *\n     * @param request - The request to be sent.\n     * @returns The existing request, a new request or a response; or a Promise for any of these.\n     */\n    request(request) {\n        if (!request.retryConfig) {\n            request.retryConfig = { ...this.retryConfig };\n            request.retryConfig.counter = 0;\n        }\n        // do this on every request\n        request.retryConfig.requestClone = request.clone();\n        return request;\n    }\n    /**\n     * Called with the response after it is received. Clears the remembered request, as it was succesfull.\n     *\n     * @param response - The response.\n     * @returns The response; or a Promise for one.\n     */\n    response(response, request) {\n        // retry was successful, so clean up after ourselves\n        Reflect.deleteProperty(request, 'retryConfig');\n        return response;\n    }\n    /**\n     * Handles fetch errors and errors generated by previous interceptors. This\n     * function acts as a Promise rejection handler. It wil retry the remembered request based on the\n     * configured RetryConfiguration.\n     *\n     * @param error - The rejection value from the fetch request or from a\n     * previous interceptor.\n     * @returns The response of the retry; or a Promise for one.\n     */\n    responseError(error, request, httpClient) {\n        const { retryConfig } = request;\n        const { requestClone } = retryConfig;\n        return Promise.resolve().then(() => {\n            if (retryConfig.counter < retryConfig.maxRetries) {\n                const result = retryConfig.doRetry !== undefined ? retryConfig.doRetry(error, request) : true;\n                return Promise.resolve(result).then(doRetry => {\n                    if (doRetry) {\n                        retryConfig.counter++;\n                        const delay = calculateDelay(retryConfig);\n                        return new Promise((resolve) => DOM.window.setTimeout(resolve, !isNaN(delay) ? delay : 0))\n                            .then(() => {\n                            const newRequest = requestClone.clone();\n                            if (typeof (retryConfig.beforeRetry) === 'function') {\n                                return retryConfig.beforeRetry(newRequest, httpClient);\n                            }\n                            return newRequest;\n                        })\n                            .then(newRequest => {\n                            const retryableRequest = { ...newRequest, retryConfig };\n                            return httpClient.fetch(retryableRequest);\n                        });\n                    }\n                    // no more retries, so clean up\n                    Reflect.deleteProperty(request, 'retryConfig');\n                    throw error;\n                });\n            }\n            // no more retries, so clean up\n            Reflect.deleteProperty(request, 'retryConfig');\n            throw error;\n        });\n    }\n}\nfunction calculateDelay(retryConfig) {\n    const { interval, strategy, minRandomInterval, maxRandomInterval, counter } = retryConfig;\n    if (typeof (strategy) === 'function') {\n        return retryConfig.strategy(counter);\n    }\n    switch (strategy) {\n        case (retryStrategy.fixed):\n            return retryStrategies[retryStrategy.fixed](interval);\n        case (retryStrategy.incremental):\n            return retryStrategies[retryStrategy.incremental](counter, interval);\n        case (retryStrategy.exponential):\n            return retryStrategies[retryStrategy.exponential](counter, interval);\n        case (retryStrategy.random):\n            return retryStrategies[retryStrategy.random](counter, interval, minRandomInterval, maxRandomInterval);\n        default:\n            throw new Error('Unrecognized retry strategy');\n    }\n}\nconst retryStrategies = [\n    // fixed\n    interval => interval,\n    // incremental\n    (retryCount, interval) => interval * retryCount,\n    // exponential\n    (retryCount, interval) => retryCount === 1 ? interval : interval ** retryCount / 1000,\n    // random\n    (retryCount, interval, minRandomInterval = 0, maxRandomInterval = 60000) => {\n        return Math.random() * (maxRandomInterval - minRandomInterval) + minRandomInterval;\n    }\n];\n//# sourceMappingURL=retry-interceptor.js.map","import { RetryInterceptor } from './retry-interceptor';\n/**\n * A class for configuring HttpClients.\n */\nexport class HttpClientConfiguration {\n    constructor() {\n        /**\n         * The base URL to be prepended to each Request's url before sending.\n         */\n        this.baseUrl = '';\n        /**\n         * Default values to apply to init objects when creating Requests. Note that\n         * defaults cannot be applied when Request objects are manually created because\n         * Request provides its own defaults and discards the original init object.\n         * See also https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n         */\n        this.defaults = {};\n        /**\n         * Interceptors to be added to the HttpClient.\n         */\n        this.interceptors = [];\n    }\n    /**\n     * Sets the baseUrl.\n     *\n     * @param baseUrl - The base URL.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withBaseUrl(baseUrl) {\n        this.baseUrl = baseUrl;\n        return this;\n    }\n    /**\n     * Sets the defaults.\n     *\n     * @param defaults - The defaults.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withDefaults(defaults) {\n        this.defaults = defaults;\n        return this;\n    }\n    /**\n     * Adds an interceptor to be run on all requests or responses.\n     *\n     * @param interceptor - An object with request, requestError,\n     * response, or responseError methods. request and requestError act as\n     * resolve and reject handlers for the Request before it is sent.\n     * response and responseError act as resolve and reject handlers for\n     * the Response after it has been received.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withInterceptor(interceptor) {\n        this.interceptors.push(interceptor);\n        return this;\n    }\n    /**\n     * Applies a configuration that addresses common application needs, including\n     * configuring same-origin credentials, and using rejectErrorResponses.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    useStandardConfiguration() {\n        const standardConfig = { credentials: 'same-origin' };\n        Object.assign(this.defaults, standardConfig, this.defaults);\n        return this.rejectErrorResponses();\n    }\n    /**\n     * Causes Responses whose status codes fall outside the range 200-299 to reject.\n     * The fetch API only rejects on network errors or other conditions that prevent\n     * the request from completing, meaning consumers must inspect Response.ok in the\n     * Promise continuation to determine if the server responded with a success code.\n     * This method adds a response interceptor that causes Responses with error codes\n     * to be rejected, which is common behavior in HTTP client libraries.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    rejectErrorResponses() {\n        return this.withInterceptor({ response: rejectOnError });\n    }\n    withRetry(config) {\n        const interceptor = new RetryInterceptor(config);\n        return this.withInterceptor(interceptor);\n    }\n}\nfunction rejectOnError(response) {\n    if (!response.ok) {\n        throw response;\n    }\n    return response;\n}\n//# sourceMappingURL=http-client-configuration.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IDOM } from '@aurelia/runtime';\nimport { DOM, HTMLDOM } from '@aurelia/runtime-html';\nimport { HttpClientConfiguration } from './http-client-configuration';\nimport { RetryInterceptor } from './retry-interceptor';\nconst absoluteUrlRegexp = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n/**\n * An HTTP client based on the Fetch API.\n */\nlet HttpClient = /** @class */ (() => {\n    let HttpClient = class HttpClient {\n        /**\n         * Creates an instance of HttpClient.\n         */\n        constructor(dom) {\n            this.dom = dom;\n            if (dom.window.fetch === undefined) {\n                throw new Error('HttpClient requires a Fetch API implementation, but the current environment doesn\\'t support it. You may need to load a polyfill such as https://github.com/github/fetch');\n            }\n            this.dom = dom;\n            this.activeRequestCount = 0;\n            this.isRequesting = false;\n            this.isConfigured = false;\n            this.baseUrl = '';\n            this.defaults = null;\n            this.interceptors = [];\n        }\n        /**\n         * Configure this client with default settings to be used by all requests.\n         *\n         * @param config - A configuration object, or a function that takes a config\n         * object and configures it.\n         * @returns The chainable instance of this HttpClient.\n         * @chainable\n         */\n        configure(config) {\n            let normalizedConfig;\n            if (typeof config === 'object') {\n                const requestInitConfiguration = { defaults: config };\n                normalizedConfig = requestInitConfiguration;\n            }\n            else if (typeof config === 'function') {\n                normalizedConfig = new HttpClientConfiguration();\n                normalizedConfig.baseUrl = this.baseUrl;\n                normalizedConfig.defaults = { ...this.defaults };\n                normalizedConfig.interceptors = this.interceptors;\n                const c = config(normalizedConfig);\n                if (Object.prototype.isPrototypeOf.call(HttpClientConfiguration.prototype, c)) {\n                    normalizedConfig = c;\n                }\n            }\n            else {\n                throw new Error('invalid config');\n            }\n            const defaults = normalizedConfig.defaults;\n            if (defaults !== undefined && Object.prototype.isPrototypeOf.call(Headers.prototype, defaults.headers)) {\n                // Headers instances are not iterable in all browsers. Require a plain\n                // object here to allow default headers to be merged into request headers.\n                throw new Error('Default headers must be a plain object.');\n            }\n            const interceptors = normalizedConfig.interceptors;\n            if (interceptors !== undefined && interceptors.length) {\n                // find if there is a RetryInterceptor\n                if (interceptors.filter(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x)).length > 1) {\n                    throw new Error('Only one RetryInterceptor is allowed.');\n                }\n                const retryInterceptorIndex = interceptors.findIndex(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x));\n                if (retryInterceptorIndex >= 0 && retryInterceptorIndex !== interceptors.length - 1) {\n                    throw new Error('The retry interceptor must be the last interceptor defined.');\n                }\n            }\n            this.baseUrl = normalizedConfig.baseUrl;\n            this.defaults = defaults;\n            this.interceptors = normalizedConfig.interceptors !== undefined ? normalizedConfig.interceptors : [];\n            this.isConfigured = true;\n            return this;\n        }\n        /**\n         * Starts the process of fetching a resource. Default configuration parameters\n         * will be applied to the Request. The constructed Request will be passed to\n         * registered request interceptors before being sent. The Response will be passed\n         * to registered Response interceptors before it is returned.\n         *\n         * See also https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n         *\n         * @param input - The resource that you wish to fetch. Either a\n         * Request object, or a string containing the URL of the resource.\n         * @param init - An options object containing settings to be applied to\n         * the Request.\n         * @returns A Promise for the Response from the fetch request.\n         */\n        fetch(input, init) {\n            this.trackRequestStart();\n            let request = this.buildRequest(input, init);\n            return this.processRequest(request, this.interceptors).then(result => {\n                let response;\n                if (Object.prototype.isPrototypeOf.call(Response.prototype, result)) {\n                    response = Promise.resolve(result);\n                }\n                else if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                    request = result;\n                    response = fetch(request);\n                }\n                else {\n                    throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${result}]`);\n                }\n                return this.processResponse(response, this.interceptors, request);\n            })\n                .then(result => {\n                if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                    return this.fetch(result);\n                }\n                return result;\n            })\n                .then(result => {\n                this.trackRequestEnd();\n                return result;\n            }, error => {\n                this.trackRequestEnd();\n                throw error;\n            });\n        }\n        buildRequest(input, init) {\n            const defaults = this.defaults !== null ? this.defaults : {};\n            let request;\n            let body;\n            let requestContentType;\n            const parsedDefaultHeaders = parseHeaderValues(defaults.headers);\n            if (Object.prototype.isPrototypeOf.call(Request.prototype, input)) {\n                request = input;\n                requestContentType = new Headers(request.headers).get('Content-Type');\n            }\n            else {\n                if (!init) {\n                    init = {};\n                }\n                body = init.body;\n                const bodyObj = body !== undefined ? { body: body } : null;\n                const requestInit = { ...defaults, headers: {}, ...init, ...bodyObj };\n                requestContentType = new Headers(requestInit.headers).get('Content-Type');\n                request = new Request(getRequestUrl(this.baseUrl, input), requestInit);\n            }\n            if (!requestContentType) {\n                if (new Headers(parsedDefaultHeaders).has('content-type')) {\n                    request.headers.set('Content-Type', new Headers(parsedDefaultHeaders).get('content-type'));\n                }\n                else if (body !== undefined && isJSON(body)) {\n                    request.headers.set('Content-Type', 'application/json');\n                }\n            }\n            setDefaultHeaders(request.headers, parsedDefaultHeaders);\n            if (body !== undefined && Object.prototype.isPrototypeOf.call(Blob.prototype, body) && body.type) {\n                // work around bug in IE & Edge where the Blob type is ignored in the request\n                // https://connect.microsoft.com/IE/feedback/details/2136163\n                request.headers.set('Content-Type', body.type);\n            }\n            return request;\n        }\n        /**\n         * Calls fetch as a GET request.\n         *\n         * @param input - The resource that you wish to fetch. Either a\n         * Request object, or a string containing the URL of the resource.\n         * @param init - An options object containing settings to be applied to\n         * the Request.\n         * @returns A Promise for the Response from the fetch request.\n         */\n        get(input, init) {\n            return this.fetch(input, init);\n        }\n        /**\n         * Calls fetch with request method set to POST.\n         *\n         * @param input - The resource that you wish to fetch. Either a\n         * Request object, or a string containing the URL of the resource.\n         * @param body - The body of the request.\n         * @param init - An options object containing settings to be applied to\n         * the Request.\n         * @returns A Promise for the Response from the fetch request.\n         */\n        post(input, body, init) {\n            return this.callFetch(input, body, init, 'POST');\n        }\n        /**\n         * Calls fetch with request method set to PUT.\n         *\n         * @param input - The resource that you wish to fetch. Either a\n         * Request object, or a string containing the URL of the resource.\n         * @param body - The body of the request.\n         * @param init - An options object containing settings to be applied to\n         * the Request.\n         * @returns A Promise for the Response from the fetch request.\n         */\n        put(input, body, init) {\n            return this.callFetch(input, body, init, 'PUT');\n        }\n        /**\n         * Calls fetch with request method set to PATCH.\n         *\n         * @param input - The resource that you wish to fetch. Either a\n         * Request object, or a string containing the URL of the resource.\n         * @param body - The body of the request.\n         * @param init - An options object containing settings to be applied to\n         * the Request.\n         * @returns A Promise for the Response from the fetch request.\n         */\n        patch(input, body, init) {\n            return this.callFetch(input, body, init, 'PATCH');\n        }\n        /**\n         * Calls fetch with request method set to DELETE.\n         *\n         * @param input - The resource that you wish to fetch. Either a\n         * Request object, or a string containing the URL of the resource.\n         * @param body - The body of the request.\n         * @param init - An options object containing settings to be applied to\n         * the Request.\n         * @returns A Promise for the Response from the fetch request.\n         */\n        delete(input, body, init) {\n            return this.callFetch(input, body, init, 'DELETE');\n        }\n        trackRequestStart() {\n            this.isRequesting = !!(++this.activeRequestCount);\n            if (this.isRequesting) {\n                const evt = DOM.createCustomEvent('aurelia-fetch-client-request-started', { bubbles: true, cancelable: true });\n                DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n            }\n        }\n        trackRequestEnd() {\n            this.isRequesting = !!(--this.activeRequestCount);\n            if (!this.isRequesting) {\n                const evt = DOM.createCustomEvent('aurelia-fetch-client-requests-drained', { bubbles: true, cancelable: true });\n                DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n            }\n        }\n        processRequest(request, interceptors) {\n            return this.applyInterceptors(request, interceptors, 'request', 'requestError', this);\n        }\n        processResponse(response, interceptors, request) {\n            return this.applyInterceptors(response, interceptors, 'response', 'responseError', request, this);\n        }\n        applyInterceptors(input, interceptors, successName, errorName, ...interceptorArgs) {\n            return (interceptors !== undefined ? interceptors : [])\n                .reduce((chain, interceptor) => {\n                const successHandler = interceptor[successName];\n                const errorHandler = interceptor[errorName];\n                // TODO: Fix this, as it violates `strictBindCallApply`.\n                return chain.then(successHandler ? (value => successHandler.call(interceptor, value, ...interceptorArgs)) : identity, errorHandler ? (reason => errorHandler.call(interceptor, reason, ...interceptorArgs)) : thrower);\n            }, Promise.resolve(input));\n        }\n        callFetch(input, body, init, method) {\n            if (!init) {\n                init = {};\n            }\n            init.method = method;\n            if (body) {\n                init.body = body;\n            }\n            return this.fetch(input, init);\n        }\n    };\n    HttpClient = __decorate([\n        __param(0, IDOM),\n        __metadata(\"design:paramtypes\", [HTMLDOM])\n    ], HttpClient);\n    return HttpClient;\n})();\nexport { HttpClient };\nfunction parseHeaderValues(headers) {\n    const parsedHeaders = {};\n    const $headers = headers !== undefined ? headers : {};\n    for (const name in $headers) {\n        if (Object.prototype.hasOwnProperty.call($headers, name)) {\n            parsedHeaders[name] = (typeof $headers[name] === 'function')\n                ? $headers[name]()\n                : $headers[name];\n        }\n    }\n    return parsedHeaders;\n}\nfunction getRequestUrl(baseUrl, url) {\n    if (absoluteUrlRegexp.test(url)) {\n        return url;\n    }\n    return (baseUrl !== undefined ? baseUrl : '') + url;\n}\nfunction setDefaultHeaders(headers, defaultHeaders) {\n    const $defaultHeaders = defaultHeaders !== undefined ? defaultHeaders : {};\n    for (const name in $defaultHeaders) {\n        if (Object.prototype.hasOwnProperty.call($defaultHeaders, name) && !headers.has(name)) {\n            headers.set(name, $defaultHeaders[name]);\n        }\n    }\n}\nfunction isJSON(str) {\n    try {\n        JSON.parse(str);\n    }\n    catch (err) {\n        return false;\n    }\n    return true;\n}\nfunction identity(x) {\n    return x;\n}\nfunction thrower(x) {\n    throw x;\n}\n//# sourceMappingURL=http-client.js.map","import { IDOM, CustomAttribute } from '@aurelia/runtime';\n/**\n * Class responsible for handling interactions that should trigger navigation.\n *\n * @internal - Shouldn't be used directly.\n */\nlet LinkHandler = /** @class */ (() => {\n    class LinkHandler {\n        constructor(dom) {\n            this.options = {\n                useHref: true,\n                callback: () => { return; }\n            };\n            this.isActive = false;\n            this.handler = (e) => {\n                const info = LinkHandler.getEventInfo(e, this.window, this.options);\n                if (info.shouldHandleEvent) {\n                    e.preventDefault();\n                    this.options.callback(info);\n                }\n            };\n            this.window = dom.window;\n            this.document = dom.document;\n        }\n        /**\n         * Gets the href and a \"should handle\" recommendation, given an Event.\n         *\n         * @param event - The Event to inspect for target anchor and href.\n         */\n        static getEventInfo(event, win, options) {\n            var _a;\n            const info = {\n                shouldHandleEvent: false,\n                instruction: null,\n                anchor: null\n            };\n            const target = info.anchor = event.currentTarget;\n            // Switch to this for delegation:\n            // const target = info.anchor = LinkHandler.closestAnchor(event.target as Element);\n            if (!target || !LinkHandler.targetIsThisWindow(target, win)) {\n                return info;\n            }\n            if (target.hasAttribute('external')) {\n                return info;\n            }\n            if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\n                return info;\n            }\n            const gotoAttr = CustomAttribute.for(target, 'goto');\n            const goto = gotoAttr !== void 0 ? gotoAttr.viewModel.value : null;\n            const loadAttr = CustomAttribute.for(target, 'load');\n            const load = loadAttr !== void 0 ? loadAttr.viewModel.value : null;\n            const href = options.useHref && target.hasAttribute('href') ? target.getAttribute('href') : null;\n            if ((goto === null || goto.length === 0) && (load === null || load.length === 0) && (href === null || href.length === 0)) {\n                return info;\n            }\n            info.anchor = target;\n            info.instruction = (_a = load !== null && load !== void 0 ? load : goto) !== null && _a !== void 0 ? _a : href;\n            const leftButtonClicked = event.button === 0;\n            info.shouldHandleEvent = leftButtonClicked;\n            return info;\n        }\n        /**\n         * Finds the closest ancestor that's an anchor element.\n         *\n         * @param el - The element to search upward from.\n         * @returns The link element that is the closest ancestor.\n         */\n        // private static closestAnchor(el: Element): Element | null {\n        //   while (el !== null && el !== void 0) {\n        //     if (el.tagName === 'A') {\n        //       return el;\n        //     }\n        //     el = el.parentNode as Element;\n        //   }\n        //   return null;\n        // }\n        /**\n         * Gets a value indicating whether or not an anchor targets the current window.\n         *\n         * @param target - The anchor element whose target should be inspected.\n         * @returns True if the target of the link element is this window; false otherwise.\n         */\n        static targetIsThisWindow(target, win) {\n            const targetWindow = target.getAttribute('target');\n            return !targetWindow ||\n                targetWindow === win.name ||\n                targetWindow === '_self';\n        }\n        /**\n         * Start the instance.\n         *\n         */\n        start(options) {\n            if (this.isActive) {\n                throw new Error('Link handler has already been started');\n            }\n            this.isActive = true;\n            this.options = { ...options };\n        }\n        /**\n         * Stop the instance. Event handlers and other resources should be cleaned up here.\n         */\n        stop() {\n            if (!this.isActive) {\n                throw new Error('Link handler has not been started');\n            }\n            this.isActive = false;\n        }\n    }\n    LinkHandler.inject = [IDOM];\n    return LinkHandler;\n})();\nexport { LinkHandler };\n//# sourceMappingURL=link-handler.js.map","/**\n * @internal - Shouldn't be used directly\n */\nexport function arrayRemove(arr, func) {\n    const removed = [];\n    let arrIndex = arr.findIndex(func);\n    while (arrIndex >= 0) {\n        removed.push(arr.splice(arrIndex, 1)[0]);\n        arrIndex = arr.findIndex(func);\n    }\n    return removed;\n}\nexport function resolvePossiblePromise(value, callback) {\n    // If we've got a Promise, wait for it's resolve\n    if (value instanceof Promise) {\n        return value.then((resolvedValue) => {\n            if (callback !== void 0) {\n                callback(resolvedValue);\n            }\n            return resolvedValue;\n        });\n    }\n    if (callback !== void 0) {\n        callback(value);\n    }\n    return value;\n}\nexport function deprecationWarning(oldFeature, newFeature) {\n    console.warn(`[Deprecated] The ${oldFeature} has been deprecated. Please use the ${newFeature} instead.`);\n}\n//# sourceMappingURL=utils.js.map","/**\n * @internal - Shouldn't be used directly\n */\nexport function parseQuery(query) {\n    if (!query || !query.length) {\n        return {};\n    }\n    const parameters = {};\n    // TODO: Deal with complex parameters such as lists and objects\n    const params = query.replace('+', ' ').split('&');\n    for (const param of params) {\n        const [key, value] = param.split('=');\n        parameters[decodeURIComponent(key)] = decodeURIComponent(value !== void 0 ? value : key);\n    }\n    return parameters;\n}\n//# sourceMappingURL=parser.js.map","export class Navigation {\n    constructor(entry = {\n        instruction: '',\n        fullStateInstruction: '',\n    }) {\n        var _a;\n        this.navigation = (_a = entry.navigation) !== null && _a !== void 0 ? _a : {\n            first: false,\n            new: false,\n            refresh: false,\n            forward: false,\n            back: false,\n            replace: false,\n        };\n        this.repeating = entry.repeating;\n        // INavigatorEntry\n        this.fromBrowser = entry.fromBrowser;\n        this.origin = entry.origin;\n        this.replacing = entry.replacing;\n        this.refreshing = entry.refreshing;\n        this.untracked = entry.untracked;\n        this.historyMovement = entry.historyMovement;\n        this.resolve = entry.resolve;\n        this.reject = entry.reject;\n        // IStoredNavigatorEntry\n        this.instruction = entry.instruction;\n        this.fullStateInstruction = entry.fullStateInstruction;\n        this.scope = entry.scope;\n        this.index = entry.index;\n        this.firstEntry = entry.firstEntry;\n        this.route = entry.route;\n        this.path = entry.path;\n        this.title = entry.title;\n        this.query = entry.query;\n        this.parameters = entry.parameters;\n        this.data = entry.data;\n    }\n    get useFullStateInstruction() {\n        var _a, _b;\n        return ((_a = this.navigation.back) !== null && _a !== void 0 ? _a : false) || ((_b = this.navigation.forward) !== null && _b !== void 0 ? _b : false);\n    }\n    toStored() {\n        return {\n            navigation: this.navigation,\n            repeating: this.repeating,\n            // IStoredNavigatorEntry\n            instruction: this.instruction,\n            fullStateInstruction: this.fullStateInstruction,\n            scope: this.scope,\n            index: this.index,\n            firstEntry: this.firstEntry,\n            route: this.route,\n            path: this.path,\n            title: this.title,\n            query: this.query,\n            parameters: this.parameters,\n            data: this.data,\n        };\n    }\n}\n//# sourceMappingURL=navigation.js.map","/**\n * Class for running a sequence of steps with values,\n * functions and promises. Stays sync if possible.\n *\n * Usage:\n *\n * ```ts\n * const promise = Runner.run(\n *   'one',\n *   prev => `${previous}, two`,\n *   prev => createPromise(prev), // creates a promise that resolves to `${prev}, three`\n * );\n *\n * // Run can be cancelled with Runner.cancel(promise);\n *\n * const stepsRunner = Runner.runner(promise);\n * const result = await promise;\n * if (stepsRunner?.isResolved) { // Make sure promise wasn't rejected\n *   // result === 'one, two, three'\n * }\n * ```\n */\nlet Runner = /** @class */ (() => {\n    class Runner {\n        constructor() {\n            this.isDone = false;\n            this.isCancelled = false;\n            this.isResolved = false;\n            this.isRejected = false;\n            this.isAsync = false;\n        }\n        get stop() {\n            return this.isCancelled || this.isRejected;\n        }\n        /**\n         * Runs a set of steps and retuns the last value\n         *\n         * Steps are processed in sequence and can be either a\n         *\n         * - value - which is then propagated as input into the next step\n         * - function - which is executed in time. The result is replacing the step which is then reprocessed\n         * - promise - which is awaited\n         *\n         * ```ts\n         * result = await Runner.run(\n         *   'one',\n         *   prev => `${previous}, two`,\n         *   prev => createPromise(prev), // creates a promise that resolves to `${prev}, three`\n         * ); // result === 'one, two, three'\n         * ```\n         *\n         */\n        static run(...steps) {\n            // debugger; // FIX ARRAY CHECK!\n            const $runner = new Runner();\n            const value = Runner.$run($runner, ...steps);\n            if (value instanceof Promise) {\n                this.runners.set(value, $runner);\n                value.then(() => {\n                    $runner.isDone = true;\n                    if ($runner.isAsync && !$runner.stop) {\n                        $runner.isResolved = true;\n                    }\n                    this.runners.delete(value);\n                    // console.log('$runner done', $runner, this.runners);\n                }).catch(err => { throw err; });\n            }\n            return value;\n        }\n        /**\n         * Gets the runner for a promise returned by Runner.run\n         *\n         * The runner can be used to check status and outcome of\n         * the run as well as cancel it\n         *\n         */\n        static runner(value) {\n            if (value instanceof Promise) {\n                return Runner.runners.get(value);\n            }\n        }\n        /**\n         * Cancels the runner for a promise returned by Runner.run\n         *\n         * Once a runner has been cancelled, it's no longer possible\n         * to retrieve it from the promise\n         *\n         */\n        static cancel(value) {\n            const $runner = Runner.runner(value);\n            if ($runner !== void 0) {\n                $runner.cancel();\n            }\n        }\n        static runAll(steps) {\n            const $runner = new Runner();\n            const values = Runner.$runAll($runner, steps);\n            if ($runner.isAsync) {\n                const promise = Promise.all(values);\n                this.runners.set(promise, $runner);\n                promise.then(() => {\n                    $runner.isDone = true;\n                    if ($runner.isAsync && !$runner.stop) {\n                        $runner.isResolved = true;\n                    }\n                    this.runners.delete(promise);\n                    // console.log('$runner done', $runner, this.runners);\n                }).catch(err => { throw err; });\n                return promise;\n            }\n            return values;\n        }\n        static runOne(step) {\n            let value;\n            // Iteratively resolve Functions (until value or Promise)\n            while (step instanceof Function) {\n                step = step(value);\n                if (!(step instanceof Function) && !(step instanceof Promise)) { // === isValue(step)\n                    value = step;\n                }\n            }\n            // In case there wasn't a Function before the value\n            if (!(step instanceof Function) && !(step instanceof Promise)) { // === isValue(step)\n                value = step;\n            }\n            // If we've got a Promise, run the remaining\n            if (step instanceof Promise) {\n                return step.then((resolvedValue) => {\n                    return Runner.runOne(resolvedValue);\n                }).catch((err) => { throw err; });\n            }\n            return value;\n        }\n        cancel() {\n            this.isCancelled = true;\n        }\n        static $run($runner, ...steps) {\n            let step;\n            while (steps.length > 0 && !$runner.stop) {\n                step = steps.shift();\n                // Iteratively resolve Functions (until value or Promise)\n                while (step instanceof Function && !$runner.stop) {\n                    step = step($runner.value);\n                    if (!(step instanceof Function) && !(step instanceof Promise)) { // === isValue(step)\n                        $runner.value = step;\n                    }\n                }\n                // In case there wasn't a Function before the value\n                if (!(step instanceof Function) && !(step instanceof Promise)) { // === isValue(step)\n                    $runner.value = step;\n                }\n                // Run steps until done or we get a Promise\n                if (step instanceof Promise) {\n                    break;\n                }\n            }\n            // If we've got a Promise, run the remaining\n            if (step instanceof Promise && !$runner.stop) {\n                $runner.isAsync = true;\n                return step.then((resolvedValue) => {\n                    return Runner.$run($runner, resolvedValue, ...steps);\n                }).catch((err) => {\n                    $runner.isRejected = true;\n                    throw err;\n                });\n            }\n            return $runner.value;\n        }\n        static $runAll($runner, steps) {\n            const results = new Array(steps.length);\n            steps.forEach((step, index) => {\n                // Iteratively resolve Functions (until value or Promise)\n                while (step instanceof Function) {\n                    step = step(results[index]);\n                    if (!(step instanceof Function) && !(step instanceof Promise)) { // === isValue(step)\n                        results[index] = step;\n                    }\n                }\n                // In case there wasn't a Function before the value\n                if (!(step instanceof Function)) { // === isValue(step)\n                    results[index] = step;\n                }\n                // If we've got a Promise, run the remaining\n                if (step instanceof Promise) {\n                    $runner.isAsync = true;\n                }\n            });\n            return results;\n        }\n    }\n    Runner.runners = new WeakMap();\n    return Runner;\n})();\nexport { Runner };\n//# sourceMappingURL=runner.js.map","export class OpenPromise {\n    constructor() {\n        this.isPending = true;\n        this.promise = new Promise((res, rej) => {\n            this.res = res;\n            this.rej = rej;\n        });\n    }\n    resolve(value) {\n        this.res(value);\n        this.isPending = false;\n    }\n    reject(value) {\n        this.rej(value);\n        this.isPending = false;\n    }\n}\n//# sourceMappingURL=open-promise.js.map","// export class OpenPromise<T> {\n//   public isPending: boolean = true;\n//   public promise!: Promise<T>;\n//   public resolve!: (value: T | PromiseLike<T>) => void;\n//   public reject!: () => void;\n// }\nimport { OpenPromise } from './open-promise';\nexport class AwaitableMap {\n    constructor() {\n        this.map = new Map();\n    }\n    set(key, value) {\n        const openPromise = this.map.get(key);\n        if (openPromise instanceof OpenPromise) {\n            openPromise.resolve(value);\n            // openPromise.isPending = false;\n        }\n        this.map.set(key, value);\n    }\n    delete(key) {\n        const current = this.map.get(key);\n        if (current instanceof OpenPromise) {\n            current.reject();\n            // current.isPending = false;\n        }\n        this.map.delete(key);\n    }\n    await(key) {\n        if (!this.map.has(key)) {\n            const openPromise = new OpenPromise();\n            // openPromise.promise = new Promise((res, rej) => {\n            //   openPromise.resolve = res;\n            //   openPromise.reject = rej;\n            // });\n            this.map.set(key, openPromise);\n            return openPromise.promise;\n        }\n        const current = this.map.get(key);\n        if (current instanceof OpenPromise) {\n            return current.promise;\n        }\n        return current;\n    }\n    has(key) {\n        return this.map.has(key) && !(this.map.get(key) instanceof OpenPromise);\n    }\n    clone() {\n        const clone = new AwaitableMap();\n        clone.map = new Map(this.map);\n        return clone;\n    }\n}\n//# sourceMappingURL=awaitable-map.js.map","import { Controller, ILifecycle } from '@aurelia/runtime';\nimport { parseQuery } from './parser';\nimport { ViewportInstruction } from './viewport-instruction';\nimport { Navigation } from './navigation';\nimport { Runner } from './runner';\nimport { AwaitableMap } from './awaitable-map';\n/**\n * @internal - Shouldn't be used directly\n */\nexport var ContentStatus;\n(function (ContentStatus) {\n    ContentStatus[ContentStatus[\"none\"] = 0] = \"none\";\n    ContentStatus[ContentStatus[\"created\"] = 1] = \"created\";\n    ContentStatus[ContentStatus[\"activated\"] = 3] = \"activated\";\n})(ContentStatus || (ContentStatus = {}));\n/**\n * @internal - Shouldn't be used directly\n */\nexport class ViewportContent {\n    constructor(\n    // Can (and wants) be a (resolved) type or a string (to be resolved later)\n    // public content: ViewportInstruction = new ViewportInstruction(''),\n    content = ViewportInstruction.create(null, ''), instruction = new Navigation({\n        instruction: '',\n        fullStateInstruction: '',\n    }), connectedCE = null) {\n        var _a;\n        this.content = content;\n        this.instruction = instruction;\n        // public contentStatus: ContentStatus = ContentStatus.none;\n        this.contentStates = new AwaitableMap();\n        // public contentStates: Map<ContentState, undefined> = new Map();\n        this.loaded = false;\n        this.fromCache = false;\n        this.fromHistory = false;\n        this.reentry = false;\n        // If we've got a container, we're good to resolve type\n        if (!this.content.isComponentType() && ((_a = connectedCE === null || connectedCE === void 0 ? void 0 : connectedCE.container) !== null && _a !== void 0 ? _a : null) !== null) {\n            this.content.componentType = this.toComponentType(connectedCE.container);\n        }\n    }\n    get componentInstance() {\n        return this.content.componentInstance;\n    }\n    get viewport() {\n        return this.content.viewport;\n    }\n    equalComponent(other) {\n        return this.content.sameComponent(other.content);\n    }\n    equalParameters(other) {\n        return this.content.sameComponent(other.content, true) &&\n            // TODO: Review whether query is relevant\n            this.instruction.query === other.instruction.query;\n    }\n    reentryBehavior() {\n        return (this.content.componentInstance !== null &&\n            'reentryBehavior' in this.content.componentInstance &&\n            this.content.componentInstance.reentryBehavior !== void 0)\n            ? this.content.componentInstance.reentryBehavior\n            : \"default\" /* default */;\n    }\n    isCacheEqual(other) {\n        return this.content.sameComponent(other.content, true);\n    }\n    contentController(connectedCE) {\n        return Controller.forCustomElement(this.content.componentInstance, connectedCE.container.get(ILifecycle), connectedCE.element, connectedCE.container, null, void 0);\n    }\n    createComponent(connectedCE, fallback) {\n        // if (this.contentStatus !== ContentStatus.none) {\n        if (this.contentStates.has('created')) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache && !this.fromHistory) {\n            try {\n                this.content.componentInstance = this.toComponentInstance(connectedCE.container);\n            }\n            catch (e) {\n                if (fallback !== void 0) {\n                    this.content.setParameters({ id: this.content.componentName });\n                    this.content.setComponent(fallback);\n                    try {\n                        this.content.componentInstance = this.toComponentInstance(connectedCE.container);\n                    }\n                    catch (ee) {\n                        throw e;\n                    }\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        this.contentStates.set('created', void 0);\n        // this.contentStatus = ContentStatus.created;\n        // if (this.contentStatus !== ContentStatus.created || !this.loaded || !this.content.componentInstance) {\n        // if (this.contentStatus !== ContentStatus.created || this.loaded || !this.content.componentInstance) {\n        if (this.contentStates.has('loaded') || !this.content.componentInstance) {\n            return;\n        }\n        // this.contentStatus = ContentStatus.loaded;\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache || !this.fromHistory) {\n            const controller = this.contentController(connectedCE);\n            controller.parent = connectedCE.controller; // CustomElement.for(connectedCE.element)!;\n        }\n    }\n    // public destroyComponent(): void {\n    //   // TODO: We might want to do something here eventually, who knows?\n    //   // if (this.contentStatus !== ContentStatus.created) {\n    //   if (!this.contentStates.has('created')) {\n    //     return;\n    //   }\n    //   // Don't destroy components when stateful\n    //   // this.contentStatus = ContentStatus.none;\n    //   this.contentStates.delete('created');\n    // }\n    canLoad(viewport, previousInstruction) {\n        if (!this.contentStates.has('created') || (this.contentStates.has('guarded') && !this.reentry)) {\n            return true;\n        }\n        this.contentStates.set('guarded', void 0);\n        if (!this.content.componentInstance) {\n            return false;\n        }\n        if (!this.content.componentInstance.canLoad) {\n            return true;\n        }\n        const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n        this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n        const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n        const result = this.content.componentInstance.canLoad(merged, this.instruction, previousInstruction);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        if (typeof result === 'string') {\n            return [viewport.router.createViewportInstruction(result, viewport)];\n        }\n        return result;\n    }\n    canUnload(nextInstruction) {\n        if (!this.content.componentInstance || !this.content.componentInstance.canUnload) {\n            return true;\n        }\n        if (!this.contentStates.has('loaded')) {\n            return true;\n        }\n        return this.content.componentInstance.canUnload(nextInstruction, this.instruction);\n    }\n    // public async canUnload(nextInstruction: Navigation | null): Promise<boolean> {\n    //   if (!this.content.componentInstance || !this.content.componentInstance.canUnload) {\n    //     return true;\n    //   }\n    //   const result = this.content.componentInstance.canUnload(nextInstruction, this.instruction);\n    //   if (typeof result === 'boolean') {\n    //     return result;\n    //   }\n    //   return result;\n    // }\n    load(previousInstruction) {\n        // if (!this.reentry && (this.contentStatus !== ContentStatus.created || this.loaded)) {\n        // if (!this.reentry && this.loaded) {\n        // if (!this.contentStates.has('created') || (this.contentStates.has('loaded') && !this.reentry)) {\n        //   return;\n        // }\n        // this.reentry = false;\n        return Runner.run(() => this.contentStates.await('guarded'), () => {\n            if (!this.contentStates.has('created') || (this.contentStates.has('loaded') && !this.reentry)) {\n                return;\n            }\n            this.reentry = false;\n            // this.loaded = true;\n            // console.log('loaded', this.content.componentName);\n            this.contentStates.set('loaded', void 0);\n            if (this.content.componentInstance && this.content.componentInstance.load) {\n                const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n                this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n                const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n                return this.content.componentInstance.load(merged, this.instruction, previousInstruction);\n            }\n        });\n    }\n    unload(nextInstruction) {\n        // if (!this.loaded) {\n        if (!this.contentStates.has('loaded')) {\n            return;\n        }\n        // this.loaded = false;\n        // console.log('loaded', this.content.componentName, 'deleted');\n        this.contentStates.delete('loaded');\n        if (this.content.componentInstance && this.content.componentInstance.unload) {\n            return this.content.componentInstance.unload(nextInstruction, this.instruction);\n        }\n    }\n    // public unloadComponent(cache: ViewportContent[], stateful: boolean = false): void {\n    //   // TODO: We might want to do something here eventually, who knows?\n    //   // if (this.contentStatus !== ContentStatus.activated) {\n    //   if (!this.contentStates.has('created')) {\n    //     return;\n    //   }\n    //   // Don't unload components when stateful\n    //   // TODO: We're missing stuff here\n    //   if (!stateful) {\n    //     // this.contentStatus = ContentStatus.created;\n    //     this.contentStates.delete('created');\n    //   } else {\n    //     cache.push(this);\n    //   }\n    // }\n    activateComponent(initiator, parent, flags, connectedCE, parentActivated) {\n        // if (this.contentStates.has('activated') || !this.contentStates.has('created')) {\n        // if (this.contentStates.has('activated')) {\n        //   return;\n        // }\n        // this.contentStates.set('activated', void 0);\n        // // if (parentActivated) { // Parent is already part of an activation\n        // //   return ;\n        // // }\n        // const contentController = this.contentController(connectedCE);\n        return Runner.run(() => this.contentStates.await('loaded'), () => {\n            if (this.contentStates.has('activated')) {\n                return;\n            }\n            this.contentStates.set('activated', void 0);\n            // if (parentActivated) { // Parent is already part of an activation\n            //   return ;\n            // }\n            const contentController = this.contentController(connectedCE);\n            return contentController.activate(initiator !== null && initiator !== void 0 ? initiator : contentController, null /* TODO: take back: parent! */, flags);\n        }, () => {\n            if (this.fromCache || this.fromHistory) {\n                const elements = Array.from(connectedCE.element.getElementsByTagName('*'));\n                for (const el of elements) {\n                    const attr = el.getAttribute('au-element-scroll');\n                    if (attr) {\n                        const [top, left] = attr.split(',');\n                        el.removeAttribute('au-element-scroll');\n                        el.scrollTo(+left, +top);\n                    }\n                }\n            }\n        });\n    }\n    // public async activateComponent(initiator: IHydratedController<Element> | null, parent: ICustomElementController<Element, ICustomElementViewModel<Element>> | null, flags: LifecycleFlags, connectedCE: IConnectedCustomElement): Promise<void> {\n    //   // if (this.contentStatus !== ContentStatus.created) {\n    //   if (!this.contentStates.has('created')) {\n    //     return;\n    //   }\n    //   // this.contentStatus = ContentStatus.activated;\n    //   this.contentStates.add('activated');\n    //   const contentController = this.contentController(connectedCE);\n    //   await contentController.activate(initiator ?? contentController, parent!, flags);\n    //   if (this.fromCache || this.fromHistory) {\n    //     const elements = Array.from(connectedCE.element.getElementsByTagName('*'));\n    //     for (const el of elements) {\n    //       const attr = el.getAttribute('au-element-scroll');\n    //       if (attr) {\n    //         const [top, left] = attr.split(',');\n    //         el.removeAttribute('au-element-scroll');\n    //         el.scrollTo(+left, +top);\n    //       }\n    //     }\n    //   }\n    // }\n    deactivateComponent(initiator, parent, flags, connectedCE, stateful = false) {\n        // if (this.contentStatus !== ContentStatus.activated) {\n        if (!this.contentStates.has('activated')) {\n            return;\n        }\n        // this.contentStatus = ContentStatus.created;\n        this.contentStates.delete('activated');\n        if (stateful && connectedCE.element !== null) {\n            // const contentController = this.content.componentInstance!.$controller!;\n            const elements = Array.from(connectedCE.element.getElementsByTagName('*'));\n            for (const el of elements) {\n                if (el.scrollTop > 0 || el.scrollLeft) {\n                    el.setAttribute('au-element-scroll', `${el.scrollTop},${el.scrollLeft}`);\n                }\n            }\n        }\n        const contentController = this.contentController(connectedCE);\n        return Runner.run(() => contentController.deactivate(initiator !== null && initiator !== void 0 ? initiator : contentController, parent, flags));\n    }\n    disposeComponent(connectedCE, cache, stateful = false) {\n        if (!this.contentStates.has('created')) {\n            return;\n        }\n        // Don't unload components when stateful\n        // TODO: We're missing stuff here\n        if (!stateful) {\n            this.contentStates.delete('created');\n            const contentController = this.contentController(connectedCE);\n            return contentController.dispose();\n        }\n        else {\n            cache.push(this);\n        }\n    }\n    freeContent(connectedCE, nextInstruction, cache, stateful = false) {\n        // switch (this.contentStatus) {\n        //   case ContentStatus.activated:\n        //     await this.unload(nextInstruction);\n        //     await this.deactivateComponent(null, connectedCE!.controller, LifecycleFlags.none, connectedCE!, stateful);\n        //     this.unloadComponent(cache, stateful); // TODO: Hook up to new dispose\n        //   case ContentStatus.created:\n        //     this.destroyComponent();\n        // }\n        // TODO: Fix execution order on these\n        // These are all safe to run\n        return Runner.run(() => this.unload(nextInstruction), () => this.deactivateComponent(null, connectedCE.controller, 0 /* none */, connectedCE, stateful), \n        // () => this.unloadComponent(cache, stateful), // TODO: Hook up to new dispose\n        // () => this.destroyComponent(),\n        () => this.disposeComponent(connectedCE, cache, stateful));\n    }\n    toComponentName() {\n        return this.content.componentName;\n    }\n    toComponentType(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentType(container);\n    }\n    toComponentInstance(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentInstance(container);\n    }\n}\n//# sourceMappingURL=viewport-content.js.map","/* eslint-disable @typescript-eslint/no-unnecessary-type-assertion */\nexport class ConfigurableRoute {\n    constructor(path, caseSensitive, handler) {\n        this.path = path;\n        this.caseSensitive = caseSensitive;\n        this.handler = handler;\n    }\n}\nexport class Endpoint {\n    constructor(route, paramNames) {\n        this.route = route;\n        this.paramNames = paramNames;\n    }\n}\nexport class RecognizedRoute {\n    constructor(endpoint, params, searchParams, isDynamic, queryString) {\n        this.endpoint = endpoint;\n        this.params = params;\n        this.searchParams = searchParams;\n        this.isDynamic = isDynamic;\n        this.queryString = queryString;\n    }\n}\nclass Candidate {\n    constructor(chars, states, skippedStates, result) {\n        var _a;\n        this.chars = chars;\n        this.states = states;\n        this.skippedStates = skippedStates;\n        this.result = result;\n        this.head = states[states.length - 1];\n        this.endpoint = (_a = this.head) === null || _a === void 0 ? void 0 : _a.endpoint;\n    }\n    advance(ch) {\n        const { chars, states, skippedStates, result } = this;\n        let stateToAdd = null;\n        let matchCount = 0;\n        const state = states[states.length - 1];\n        function $process(nextState, skippedState) {\n            if (nextState.isMatch(ch)) {\n                if (++matchCount === 1) {\n                    stateToAdd = nextState;\n                }\n                else {\n                    result.add(new Candidate(chars.concat(ch), states.concat(nextState), skippedState === null ? skippedStates : skippedStates.concat(skippedState), result));\n                }\n            }\n            if (state.segment === null && nextState.isOptional && nextState.nextStates !== null) {\n                if (nextState.nextStates.length > 1) {\n                    throw new Error(`${nextState.nextStates.length} nextStates`);\n                }\n                const separator = nextState.nextStates[0];\n                if (!separator.isSeparator) {\n                    throw new Error(`Not a separator`);\n                }\n                if (separator.nextStates !== null) {\n                    for (const $nextState of separator.nextStates) {\n                        $process($nextState, nextState);\n                    }\n                }\n            }\n        }\n        if (state.isDynamic) {\n            $process(state, null);\n        }\n        if (state.nextStates !== null) {\n            for (const nextState of state.nextStates) {\n                $process(nextState, null);\n            }\n        }\n        if (stateToAdd !== null) {\n            states.push(this.head = stateToAdd);\n            chars.push(ch);\n            if (stateToAdd.endpoint !== null) {\n                this.endpoint = stateToAdd.endpoint;\n            }\n        }\n        if (matchCount === 0) {\n            result.remove(this);\n        }\n    }\n    finalize() {\n        function collectSkippedStates(skippedStates, state) {\n            const nextStates = state.nextStates;\n            if (nextStates !== null) {\n                if (nextStates.length === 1 && nextStates[0].segment === null) {\n                    collectSkippedStates(skippedStates, nextStates[0]);\n                }\n                else {\n                    for (const nextState of nextStates) {\n                        if (nextState.isOptional && nextState.endpoint !== null) {\n                            skippedStates.push(nextState);\n                            if (nextState.nextStates !== null) {\n                                for (const $nextState of nextState.nextStates) {\n                                    collectSkippedStates(skippedStates, $nextState);\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        collectSkippedStates(this.skippedStates, this.head);\n    }\n    getParams() {\n        const { states, chars, endpoint } = this;\n        const params = {};\n        // First initialize all properties with undefined so they all exist (even if they're not filled, e.g. non-matched optional params)\n        for (const name of endpoint.paramNames) {\n            params[name] = void 0;\n        }\n        for (let i = 0, ii = states.length; i < ii; ++i) {\n            const state = states[i];\n            if (state.isDynamic) {\n                const name = state.segment.name;\n                if (params[name] === void 0) {\n                    params[name] = chars[i];\n                }\n                else {\n                    params[name] += chars[i];\n                }\n            }\n        }\n        return params;\n    }\n    /**\n     * Compares this candidate to another candidate to determine the correct sorting order.\n     *\n     * This algorithm is different from `sortSolutions` in v1's route-recognizer in that it compares\n     * the candidates segment-by-segment, rather than merely comparing the cumulative of segment types\n     *\n     * This resolves v1's ambiguity in situations like `/foo/:id/bar` vs. `/foo/bar/:id`, which had the\n     * same sorting value because they both consist of two static segments and one dynamic segment.\n     *\n     * With this algorithm, `/foo/bar/:id` would always be sorted first because the second segment is different,\n     * and static wins over dynamic.\n     *\n     * ### NOTE\n     * This algorithm violates some of the invariants of v1's algorithm,\n     * but those invariants were arguably not very sound to begin with. Example:\n     *\n     * `/foo/*path/bar/baz` vs. `/foo/bar/*path1/*path2`\n     * - in v1, the first would win because that match has fewer stars\n     * - in v2, the second will win because there is a bigger static match at the start of the pattern\n     *\n     * The algorithm should be more logical and easier to reason about in v2, but it's important to be aware of\n     * subtle difference like this which might surprise some users who happened to rely on this behavior from v1,\n     * intentionally or unintentionally.\n     *\n     * @param b - The candidate to compare this to.\n     * Parameter name is `b` because the method should be used like so: `states.sort((a, b) => a.compareTo(b))`.\n     * This will bring the candidate with the highest score to the first position of the array.\n     */\n    compareTo(b) {\n        const statesA = this.states;\n        const statesB = b.states;\n        for (let iA = 0, iB = 0, ii = Math.max(statesA.length, statesB.length); iA < ii; ++iA) {\n            let stateA = statesA[iA];\n            if (stateA === void 0) {\n                return 1;\n            }\n            let stateB = statesB[iB];\n            if (stateB === void 0) {\n                return -1;\n            }\n            let segmentA = stateA.segment;\n            let segmentB = stateB.segment;\n            if (segmentA === null) {\n                if (segmentB === null) {\n                    ++iB;\n                    continue;\n                }\n                if ((stateA = statesA[++iA]) === void 0) {\n                    return 1;\n                }\n                segmentA = stateA.segment;\n            }\n            else if (segmentB === null) {\n                if ((stateB = statesB[++iB]) === void 0) {\n                    return -1;\n                }\n                segmentB = stateB.segment;\n            }\n            if (segmentA.kind < segmentB.kind) {\n                return 1;\n            }\n            if (segmentA.kind > segmentB.kind) {\n                return -1;\n            }\n            ++iB;\n        }\n        const skippedStatesA = this.skippedStates;\n        const skippedStatesB = b.skippedStates;\n        const skippedStatesALen = skippedStatesA.length;\n        const skippedStatesBLen = skippedStatesB.length;\n        if (skippedStatesALen < skippedStatesBLen) {\n            return 1;\n        }\n        if (skippedStatesALen > skippedStatesBLen) {\n            return -1;\n        }\n        for (let i = 0; i < skippedStatesALen; ++i) {\n            const skippedStateA = skippedStatesA[i];\n            const skippedStateB = skippedStatesB[i];\n            if (skippedStateA.length < skippedStateB.length) {\n                return 1;\n            }\n            if (skippedStateA.length > skippedStateB.length) {\n                return -1;\n            }\n        }\n        // This should only be possible with a single pattern with multiple consecutive star segments.\n        // TODO: probably want to warn or even throw here, but leave it be for now.\n        return 0;\n    }\n}\nfunction hasEndpoint(candidate) {\n    return candidate.head.endpoint !== null;\n}\nfunction compareChains(a, b) {\n    return a.compareTo(b);\n}\nclass RecognizeResult {\n    constructor(rootState) {\n        this.candidates = [];\n        this.candidates = [new Candidate([''], [rootState], [], this)];\n    }\n    get isEmpty() {\n        return this.candidates.length === 0;\n    }\n    getSolution() {\n        const candidates = this.candidates.filter(hasEndpoint);\n        if (candidates.length === 0) {\n            return null;\n        }\n        for (const candidate of candidates) {\n            candidate.finalize();\n        }\n        candidates.sort(compareChains);\n        return candidates[0];\n    }\n    add(candidate) {\n        this.candidates.push(candidate);\n    }\n    remove(candidate) {\n        this.candidates.splice(this.candidates.indexOf(candidate), 1);\n    }\n    advance(ch) {\n        const candidates = this.candidates.slice();\n        for (const candidate of candidates) {\n            candidate.advance(ch);\n        }\n    }\n}\nexport class RouteRecognizer {\n    constructor() {\n        this.rootState = new State(null, null, '');\n    }\n    add(routeOrRoutes) {\n        if (routeOrRoutes instanceof Array) {\n            for (const route of routeOrRoutes) {\n                this.add(route);\n            }\n            return;\n        }\n        const route = routeOrRoutes;\n        const $route = new ConfigurableRoute(route.path, route.caseSensitive === true, route.handler);\n        const parts = parsePath($route.path);\n        const paramNames = [];\n        let state = this.rootState;\n        for (const part of parts) {\n            // Each segment always begins with a slash, so we represent this with a non-segment state\n            state = state.append(null, '/');\n            switch (part.charAt(0)) {\n                case ':': { // route parameter\n                    const isOptional = part.endsWith('?');\n                    const name = isOptional ? part.slice(1, -1) : part.slice(1);\n                    paramNames.push(name);\n                    state = new DynamicSegment(name, isOptional).appendTo(state);\n                    break;\n                }\n                case '*': { // dynamic route\n                    const name = part.slice(1);\n                    paramNames.push(name);\n                    state = new StarSegment(name).appendTo(state);\n                    break;\n                }\n                default: { // standard path route\n                    state = new StaticSegment(part, $route.caseSensitive).appendTo(state);\n                    break;\n                }\n            }\n        }\n        const endpoint = new Endpoint($route, paramNames);\n        state.setEndpoint(endpoint);\n    }\n    recognize(path) {\n        let searchParams;\n        let queryString = '';\n        const queryStart = path.indexOf('?');\n        if (queryStart >= 0) {\n            queryString = path.slice(queryStart + 1);\n            path = path.slice(0, queryStart);\n            searchParams = new URLSearchParams(queryString);\n        }\n        else {\n            searchParams = new URLSearchParams();\n        }\n        path = decodeURI(path);\n        if (!path.startsWith('/')) {\n            path = `/${path}`;\n        }\n        if (path.length > 1 && path.endsWith('/')) {\n            path = path.slice(0, -1);\n        }\n        const result = new RecognizeResult(this.rootState);\n        for (let i = 0, ii = path.length; i < ii; ++i) {\n            const ch = path.charAt(i);\n            result.advance(ch);\n            if (result.isEmpty) {\n                return null;\n            }\n        }\n        const candidate = result.getSolution();\n        if (candidate === null) {\n            return null;\n        }\n        const { endpoint } = candidate;\n        const params = candidate.getParams();\n        const isDynamic = candidate.endpoint.paramNames.length > 0;\n        return new RecognizedRoute(endpoint, params, searchParams, isDynamic, queryString);\n    }\n}\nclass State {\n    constructor(prevState, segment, value) {\n        this.prevState = prevState;\n        this.segment = segment;\n        this.value = value;\n        this.nextStates = null;\n        this.endpoint = null;\n        switch (segment === null || segment === void 0 ? void 0 : segment.kind) {\n            case 2 /* dynamic */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = true;\n                this.isOptional = segment.optional;\n                break;\n            case 1 /* star */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = true;\n                this.isOptional = false;\n                break;\n            case 3 /* static */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = false;\n                this.isOptional = false;\n                break;\n            case undefined:\n                this.length = prevState === null ? 0 : prevState.length;\n                this.isSeparator = true;\n                this.isDynamic = false;\n                this.isOptional = false;\n                break;\n        }\n    }\n    append(segment, value) {\n        let state;\n        let nextStates = this.nextStates;\n        if (nextStates === null) {\n            state = void 0;\n            nextStates = this.nextStates = [];\n        }\n        else if (segment === null) {\n            state = nextStates.find(s => s.value === value);\n        }\n        else {\n            state = nextStates.find(s => { var _a; return (_a = s.segment) === null || _a === void 0 ? void 0 : _a.equals(segment); });\n        }\n        if (state === void 0) {\n            nextStates.push(state = new State(this, segment, value));\n        }\n        return state;\n    }\n    setEndpoint(endpoint) {\n        if (this.endpoint !== null) {\n            throw new Error(`Cannot add ambiguous route. The pattern ${endpoint.route.path} clashes with ${this.endpoint.route.path}`);\n        }\n        this.endpoint = endpoint;\n        if (this.isOptional) {\n            this.prevState.setEndpoint(endpoint);\n            if (this.prevState.isSeparator && this.prevState.prevState !== null) {\n                this.prevState.prevState.setEndpoint(endpoint);\n            }\n        }\n    }\n    isMatch(ch) {\n        const segment = this.segment;\n        switch (segment === null || segment === void 0 ? void 0 : segment.kind) {\n            case 2 /* dynamic */:\n                return !this.value.includes(ch);\n            case 1 /* star */:\n                return true;\n            case 3 /* static */:\n            case undefined:\n                // segment separators (slashes) are non-segments. We could say return ch === '/' as well, technically.\n                return this.value.includes(ch);\n        }\n    }\n}\nfunction isNotEmpty(segment) {\n    return segment.length > 0;\n}\nfunction parsePath(path) {\n    // Normalize leading, trailing and double slashes by ignoring empty segments\n    return path.split('/').filter(isNotEmpty);\n}\nvar SegmentKind;\n(function (SegmentKind) {\n    SegmentKind[SegmentKind[\"star\"] = 1] = \"star\";\n    SegmentKind[SegmentKind[\"dynamic\"] = 2] = \"dynamic\";\n    SegmentKind[SegmentKind[\"static\"] = 3] = \"static\";\n})(SegmentKind || (SegmentKind = {}));\nclass StaticSegment {\n    constructor(value, caseSensitive) {\n        this.value = value;\n        this.caseSensitive = caseSensitive;\n    }\n    get kind() { return 3 /* static */; }\n    appendTo(state) {\n        const { value, value: { length } } = this;\n        if (this.caseSensitive) {\n            for (let i = 0; i < length; ++i) {\n                state = state.append(\n                /* segment */ this, \n                /* value   */ value.charAt(i));\n            }\n        }\n        else {\n            for (let i = 0; i < length; ++i) {\n                const ch = value.charAt(i);\n                state = state.append(\n                /* segment */ this, \n                /* value   */ ch.toUpperCase() + ch.toLowerCase());\n            }\n        }\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 3 /* static */ &&\n            b.caseSensitive === this.caseSensitive &&\n            b.value === this.value);\n    }\n}\nclass DynamicSegment {\n    constructor(name, optional) {\n        this.name = name;\n        this.optional = optional;\n    }\n    get kind() { return 2 /* dynamic */; }\n    appendTo(state) {\n        state = state.append(\n        /* segment */ this, \n        /* value   */ '/');\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 2 /* dynamic */ &&\n            b.optional === this.optional &&\n            b.name === this.name);\n    }\n}\nclass StarSegment {\n    constructor(name) {\n        this.name = name;\n    }\n    get kind() { return 1 /* star */; }\n    appendTo(state) {\n        state = state.append(\n        /* segment */ this, \n        /* value   */ '');\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 1 /* star */ &&\n            b.name === this.name);\n    }\n}\n//# sourceMappingURL=index.js.map","import { Scope } from './scope';\nimport { arrayRemove } from './utils';\nimport { Runner } from './runner';\nexport class ViewportScope {\n    constructor(name, router, connectedCE, owningScope, scope, rootComponentType = null, // temporary. Metadata will probably eliminate it\n    options = {\n        catches: [],\n        source: null,\n    }) {\n        this.name = name;\n        this.router = router;\n        this.connectedCE = connectedCE;\n        this.rootComponentType = rootComponentType;\n        this.options = options;\n        this.path = null;\n        this.content = null;\n        this.nextContent = null;\n        this.available = true;\n        this.sourceItem = null;\n        this.sourceItemIndex = -1;\n        this.remove = false;\n        this.add = false;\n        this.connectedScope = new Scope(router, scope, owningScope, null, this);\n        if (this.catches.length > 0) {\n            this.content = router.createViewportInstruction(this.catches[0], this.name);\n        }\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return false;\n    }\n    get isViewportScope() {\n        return true;\n    }\n    get isEmpty() {\n        return this.content === null;\n    }\n    get passThroughScope() {\n        return this.rootComponentType === null && this.catches.length === 0;\n    }\n    get siblings() {\n        const parent = this.connectedScope.parent;\n        if (parent === null) {\n            return [this];\n        }\n        return parent.enabledChildren\n            .filter(child => child.isViewportScope && child.viewportScope.name === this.name)\n            .map(child => child.viewportScope);\n    }\n    get source() {\n        return this.options.source || null;\n    }\n    get catches() {\n        let catches = this.options.catches || [];\n        if (typeof catches === 'string') {\n            catches = catches.split(',');\n        }\n        return catches;\n    }\n    get default() {\n        if (this.catches.length > 0) {\n            return this.catches[0];\n        }\n    }\n    get nextContentActivated() {\n        var _a, _b, _c;\n        return (_c = (_b = (_a = this.scope.parent) === null || _a === void 0 ? void 0 : _a.owner) === null || _b === void 0 ? void 0 : _b.nextContentActivated) !== null && _c !== void 0 ? _c : false;\n    }\n    get parentNextContentActivated() {\n        var _a, _b, _c;\n        return (_c = (_b = (_a = this.scope.parent) === null || _a === void 0 ? void 0 : _a.owner) === null || _b === void 0 ? void 0 : _b.nextContentActivated) !== null && _c !== void 0 ? _c : false;\n    }\n    get nextContentAction() {\n        return '';\n    }\n    toString() {\n        var _a, _b, _c, _d;\n        const contentName = (_b = (_a = this.content) === null || _a === void 0 ? void 0 : _a.componentName) !== null && _b !== void 0 ? _b : '';\n        const nextContentName = (_d = (_c = this.nextContent) === null || _c === void 0 ? void 0 : _c.componentName) !== null && _d !== void 0 ? _d : '';\n        return `vs:${this.name}[${contentName}->${nextContentName}]`;\n    }\n    setNextContent(viewportInstruction, navigation) {\n        viewportInstruction.viewportScope = this;\n        this.remove = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction)\n            || this.router.instructionResolver.isClearAllViewportsInstruction(viewportInstruction);\n        this.add = this.router.instructionResolver.isAddViewportInstruction(viewportInstruction)\n            && Array.isArray(this.source);\n        if (this.add) {\n            viewportInstruction.componentName = null;\n        }\n        if (this.default !== void 0 && viewportInstruction.componentName === null) {\n            viewportInstruction.componentName = this.default;\n        }\n        this.nextContent = viewportInstruction;\n        return 'swap';\n    }\n    transition(coordinator) {\n        // console.log('ViewportScope swap'/*, this, coordinator*/);\n        Runner.run(() => coordinator.addEntityState(this, 'guardedUnload'), () => coordinator.addEntityState(this, 'guardedLoad'), () => coordinator.addEntityState(this, 'guarded'), () => coordinator.addEntityState(this, 'loaded'), () => coordinator.addEntityState(this, 'unloaded'), () => coordinator.addEntityState(this, 'routed'), () => coordinator.addEntityState(this, 'swapped'), () => {\n            this.content = !this.remove ? this.nextContent : null;\n            this.nextContent = null;\n            coordinator.addEntityState(this, 'completed');\n        });\n    }\n    canUnload() {\n        return true;\n    }\n    canLoad() {\n        return true;\n    }\n    unload() {\n        return;\n    }\n    load() {\n        return;\n    }\n    // public loadContent(): Promise<boolean> {\n    //   this.content = !this.remove ? this.nextContent : null;\n    //   this.nextContent = null;\n    //   return Promise.resolve(true);\n    // }\n    finalizeContentChange() {\n        // console.log('ViewportScope finalizing', this.content);\n        if (this.remove && Array.isArray(this.source)) {\n            this.removeSourceItem();\n        }\n    }\n    abortContentChange() {\n        this.nextContent = null;\n        if (this.add) {\n            const index = this.source.indexOf(this.sourceItem);\n            this.source.splice(index, 1);\n            this.sourceItem = null;\n        }\n        return Promise.resolve();\n    }\n    acceptSegment(segment) {\n        if (segment === null && segment === void 0 || segment.length === 0) {\n            return true;\n        }\n        if (segment === this.router.instructionResolver.clearViewportInstruction\n            || segment === this.router.instructionResolver.addViewportInstruction\n            || segment === this.name) {\n            return true;\n        }\n        if (this.catches.length === 0) {\n            return true;\n        }\n        if (this.catches.includes(segment)) {\n            return true;\n        }\n        if (this.catches.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind() {\n        const source = this.source || [];\n        if (source.length > 0 && this.sourceItem === null) {\n            this.sourceItem = this.getAvailableSourceItem();\n        }\n    }\n    beforeUnbind() {\n        if (this.sourceItem !== null && this.source !== null) {\n            arrayRemove(this.source, (item) => item === this.sourceItem);\n        }\n        this.sourceItem = null;\n    }\n    getAvailableSourceItem() {\n        if (this.source === null) {\n            return null;\n        }\n        const siblings = this.siblings;\n        for (const item of this.source) {\n            if (siblings.every(sibling => sibling.sourceItem !== item)) {\n                return item;\n            }\n        }\n        return null;\n    }\n    addSourceItem() {\n        const item = {};\n        this.source.push(item);\n        return item;\n    }\n    removeSourceItem() {\n        this.sourceItemIndex = this.source.indexOf(this.sourceItem);\n        if (this.sourceItemIndex >= 0) {\n            this.source.splice(this.sourceItemIndex, 1);\n        }\n    }\n    getRoutes() {\n        if (this.rootComponentType !== null) {\n            return this.rootComponentType.routes;\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=viewport-scope.js.map","/**\n * @internal - Used when founding route/instructions\n */\nexport class FoundRoute {\n    constructor(match = null, matching = '', instructions = [], remaining = '', \n    // public remaining: string | null = null,\n    params = {}) {\n        this.match = match;\n        this.matching = matching;\n        this.instructions = instructions;\n        this.remaining = remaining;\n        this.params = params;\n    }\n    get foundConfiguration() {\n        return this.match !== null;\n    }\n    get foundInstructions() {\n        return this.instructions.length > 0;\n    }\n    get hasRemaining() {\n        return this.remaining !== null && this.remaining.length > 0;\n    }\n}\n//# sourceMappingURL=found-route.js.map","import { arrayRemove } from './utils';\n/**\n * @internal - Helper class\n */\nexport class Collection extends Array {\n    constructor() {\n        super(...arguments);\n        this.currentIndex = -1;\n    }\n    next() {\n        if (this.length > this.currentIndex + 1) {\n            return this[++this.currentIndex];\n        }\n        else {\n            this.currentIndex = -1;\n            return null;\n        }\n    }\n    removeCurrent() {\n        this.splice(this.currentIndex--, 1);\n    }\n    remove(instruction) {\n        arrayRemove(this, value => value === instruction);\n    }\n}\n//# sourceMappingURL=collection.js.map","import { RouteRecognizer as $RouteRecognizer, ConfigurableRoute as $ConfigurableRoute, RecognizedRoute as $RecognizedRoute, Endpoint as $Endpoint, } from '@aurelia/route-recognizer';\nexport const RouteRecognizer = $RouteRecognizer;\nexport const ConfigurableRoute = $ConfigurableRoute;\nexport const RecognizedRoute = $RecognizedRoute;\nexport const Endpoint = $Endpoint;\n//# sourceMappingURL=route-recognizer.js.map","import { ViewportScope } from './viewport-scope';\nimport { FoundRoute } from './found-route';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { Viewport } from './viewport';\nimport { arrayRemove } from './utils';\nimport { Collection } from './collection';\nimport { RouteRecognizer } from './route-recognizer';\nimport { Runner } from './runner';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Scope {\n    constructor(router, hasScope, owningScope, viewport = null, viewportScope = null, rootComponentType = null) {\n        this.router = router;\n        this.hasScope = hasScope;\n        this.owningScope = owningScope;\n        this.viewport = viewport;\n        this.viewportScope = viewportScope;\n        this.rootComponentType = rootComponentType;\n        this.id = '.';\n        this.parent = null;\n        this.children = [];\n        this.replacedChildren = [];\n        this.path = null;\n        this.enabled = true;\n        // Support collection feature in viewport scopes\n        this.childCollections = {};\n        this.owningScope = owningScope !== null && owningScope !== void 0 ? owningScope : this;\n        this.scope = this.hasScope ? this : this.owningScope.scope;\n        // console.log('Created scope', this.toString());\n    }\n    toString(recurse = false) {\n        return `${this.owningScope !== this ? this.owningScope.toString() : ''}/${this.owner.toString()}` +\n            // eslint-disable-next-line prefer-template\n            `${recurse ? `\\n` + this.children.map(child => child.toString(true)).join('') : ''}`;\n    }\n    get isViewport() {\n        return this.viewport !== null;\n    }\n    get isViewportScope() {\n        return this.viewportScope !== null;\n    }\n    get passThroughScope() {\n        return this.isViewportScope && this.viewportScope.passThroughScope;\n    }\n    get owner() {\n        if (this.isViewport) {\n            return this.viewport;\n        }\n        if (this.isViewportScope) {\n            return this.viewportScope;\n        }\n        return null;\n    }\n    get enabledChildren() {\n        return this.children.filter(scope => scope.enabled);\n    }\n    get hoistedChildren() {\n        const scopes = this.enabledChildren;\n        while (scopes.some(scope => scope.passThroughScope)) {\n            for (const scope of scopes.slice()) {\n                if (scope.passThroughScope) {\n                    const index = scopes.indexOf(scope);\n                    scopes.splice(index, 1, ...scope.enabledChildren);\n                }\n            }\n        }\n        return scopes;\n    }\n    get enabledViewports() {\n        return this.children\n            .filter(scope => scope.isViewport && scope.enabled)\n            .map(scope => scope.viewport);\n    }\n    get viewportInstruction() {\n        if (this.isViewportScope) {\n            return this.viewportScope.content;\n        }\n        if (this.isViewport) {\n            return this.viewport.content.content;\n        }\n        return null;\n    }\n    get parentNextContentAction() {\n        if (this.parent === null) {\n            return '';\n        }\n        const parentAction = this.parent.owner.nextContentAction;\n        if (parentAction === 'swap' || parentAction === 'skip') {\n            return parentAction;\n        }\n        return this.parent.parentNextContentAction;\n    }\n    getEnabledViewports(viewportScopes) {\n        return viewportScopes\n            .filter(scope => !scope.isViewportScope)\n            .map(scope => scope.viewport)\n            .reduce((viewports, viewport) => {\n            viewports[viewport.name] = viewport;\n            return viewports;\n        }, {});\n    }\n    getOwnedViewports(includeDisabled = false) {\n        return this.allViewports(includeDisabled).filter(viewport => viewport.owningScope === this);\n    }\n    getOwnedScopes(includeDisabled = false) {\n        const scopes = this.allScopes(includeDisabled).filter(scope => scope.owningScope === this);\n        // Hoist children to pass through scopes\n        for (const scope of scopes.slice()) {\n            if (scope.passThroughScope) {\n                const index = scopes.indexOf(scope);\n                scopes.splice(index, 1, ...scope.getOwnedScopes());\n            }\n        }\n        return scopes;\n    }\n    findInstructions(instruction) {\n        var _a, _b;\n        let route = new FoundRoute();\n        if (typeof instruction === 'string') {\n            const instructions = this.router.instructionResolver.parseViewportInstructions(instruction);\n            if (this.router.options.useConfiguredRoutes && !this.router.hasSiblingInstructions(instructions)) {\n                const foundRoute = this.findMatchingRoute(instruction);\n                if ((_a = foundRoute === null || foundRoute === void 0 ? void 0 : foundRoute.foundConfiguration) !== null && _a !== void 0 ? _a : false) {\n                    route = foundRoute;\n                }\n                else {\n                    if (this.router.options.useDirectRoutes) {\n                        route.instructions = instructions;\n                        if (route.instructions.length > 0) {\n                            const nextInstructions = (_b = route.instructions[0].nextScopeInstructions) !== null && _b !== void 0 ? _b : [];\n                            route.remaining = this.router.instructionResolver.stringifyViewportInstructions(nextInstructions);\n                            // TODO: Verify that it's okay to leave this in\n                            route.instructions[0].nextScopeInstructions = null;\n                        }\n                    }\n                }\n            }\n            else if (this.router.options.useDirectRoutes) {\n                route.instructions = instructions;\n            }\n        }\n        else {\n            route.instructions = instruction;\n        }\n        for (const instr of route.instructions) {\n            if (instr.scope === null) {\n                instr.scope = this;\n            }\n        }\n        return route;\n    }\n    // Note: This can't change state other than the instructions!\n    findViewports(instructions, alreadyFound, disregardViewports = false) {\n        var _a;\n        const foundViewports = [];\n        let remainingInstructions = [];\n        const ownedScopes = this.getOwnedScopes();\n        // Get a shallow copy of all available manual viewport scopes\n        const viewportScopes = ownedScopes.filter(scope => scope.isViewportScope).map(scope => scope.viewportScope);\n        const availableViewportScopes = viewportScopes.filter(viewportScope => alreadyFound.every(found => found.viewportScope !== viewportScope));\n        // Get a shallow copy of all available viewports\n        const availableViewports = { ...this.getEnabledViewports(ownedScopes) };\n        for (const instruction of alreadyFound.filter(found => found.scope === this)) {\n            availableViewports[instruction.viewportName] = null;\n        }\n        const viewportInstructions = new Collection(...instructions.slice());\n        let instruction = null;\n        // The viewport scope is already known\n        while ((instruction = viewportInstructions.next()) !== null) {\n            if (instruction.viewportScope !== null && !this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                remainingInstructions.push(...this.foundViewportScope(instruction, instruction.viewportScope));\n                foundViewports.push(instruction);\n                arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // The viewport is already known\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                if (instruction.viewport !== null) {\n                    remainingInstructions.push(...this.foundViewport(instruction, instruction.viewport, disregardViewports));\n                    foundViewports.push(instruction);\n                    availableViewports[instruction.viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Viewport scopes have priority\n        while ((instruction = viewportInstructions.next()) !== null) {\n            for (let viewportScope of viewportScopes) {\n                if (viewportScope.acceptSegment(instruction.componentName)) {\n                    if (Array.isArray(viewportScope.source)) {\n                        // console.log('available', viewportScope.available, source);\n                        let available = availableViewportScopes.find(available => available.name === viewportScope.name);\n                        if (available === void 0 || this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                            const item = viewportScope.addSourceItem();\n                            available = this.getOwnedScopes()\n                                .filter(scope => scope.isViewportScope)\n                                .map(scope => scope.viewportScope)\n                                .find(viewportScope => viewportScope.sourceItem === item);\n                        }\n                        viewportScope = available;\n                    }\n                    remainingInstructions.push(...this.foundViewportScope(instruction, viewportScope));\n                    foundViewports.push(instruction);\n                    arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                    viewportInstructions.removeCurrent();\n                    break;\n                }\n            }\n        }\n        // Configured viewport is ruling\n        while ((instruction = viewportInstructions.next()) !== null) {\n            instruction.needsViewportDescribed = true;\n            for (const name in availableViewports) {\n                const viewport = availableViewports[name];\n                // TODO: Also check if (resolved) component wants a specific viewport\n                if (viewport === null || viewport === void 0 ? void 0 : viewport.wantComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.removeCurrent();\n                    break;\n                }\n            }\n        }\n        // Next in line is specified viewport (but not if we're disregarding viewports)\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                const name = instruction.viewportName;\n                if (!name || !name.length) {\n                    continue;\n                }\n                const newScope = instruction.ownsScope;\n                if (!this.getEnabledViewports(ownedScopes)[name]) {\n                    continue;\n                    // TODO: No longer pre-creating viewports. Evaluate!\n                    this.addViewport(name, null, { scope: newScope, forceDescription: true });\n                    availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                }\n                const viewport = availableViewports[name];\n                if (viewport === null || viewport === void 0 ? void 0 : viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Finally, only one accepting viewport left?\n        while ((instruction = viewportInstructions.next()) !== null) {\n            const remainingViewports = [];\n            for (const name in availableViewports) {\n                const viewport = availableViewports[name];\n                if (viewport === null || viewport === void 0 ? void 0 : viewport.acceptComponent(instruction.componentName)) {\n                    remainingViewports.push(viewport);\n                }\n            }\n            if (remainingViewports.length === 1) {\n                const viewport = remainingViewports.shift();\n                const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                foundViewports.push(instruction);\n                remainingInstructions.push(...remaining);\n                availableViewports[viewport.name] = null;\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // If we're ignoring viewports, we now match them anyway\n        if (disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                let viewport = instruction.viewport;\n                if (!viewport) {\n                    const name = instruction.viewportName;\n                    if (((_a = name === null || name === void 0 ? void 0 : name.length) !== null && _a !== void 0 ? _a : 0) === 0) {\n                        continue;\n                    }\n                    const newScope = instruction.ownsScope;\n                    if (!this.getEnabledViewports(ownedScopes)[name]) {\n                        continue;\n                        // TODO: No longer pre-creating viewports. Evaluate!\n                        this.addViewport(name, null, { scope: newScope, forceDescription: true });\n                        availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                    }\n                    viewport = availableViewports[name];\n                }\n                if (viewport === null || viewport === void 0 ? void 0 : viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        remainingInstructions = [...viewportInstructions, ...remainingInstructions];\n        return {\n            foundViewports,\n            remainingInstructions,\n        };\n    }\n    foundViewportScope(instruction, viewportScope) {\n        var _a, _b;\n        instruction.viewportScope = viewportScope;\n        instruction.needsViewportDescribed = false;\n        const remaining = (_b = (_a = instruction.nextScopeInstructions) === null || _a === void 0 ? void 0 : _a.slice()) !== null && _b !== void 0 ? _b : [];\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewportScope.scope.scope;\n            }\n        }\n        return remaining;\n    }\n    foundViewport(instruction, viewport, withoutViewports, doesntNeedViewportDescribed = false) {\n        var _a, _b;\n        instruction.setViewport(viewport);\n        if (doesntNeedViewportDescribed) {\n            instruction.needsViewportDescribed = false;\n        }\n        const remaining = (_b = (_a = instruction.nextScopeInstructions) === null || _a === void 0 ? void 0 : _a.slice()) !== null && _b !== void 0 ? _b : [];\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewport.scope;\n            }\n        }\n        return remaining;\n    }\n    addViewport(name, connectedCE, options = {}) {\n        var _a, _b;\n        let viewport = this.getEnabledViewports(this.getOwnedScopes())[name];\n        // Each au-viewport element has its own Viewport\n        if (((connectedCE !== null && connectedCE !== void 0 ? connectedCE : null) !== null) &&\n            (((_a = viewport === null || viewport === void 0 ? void 0 : viewport.connectedCE) !== null && _a !== void 0 ? _a : null) !== null) &&\n            viewport.connectedCE !== connectedCE) {\n            viewport.enabled = false;\n            viewport = (_b = this.getOwnedViewports(true).find(child => child.name === name && child.connectedCE === connectedCE)) !== null && _b !== void 0 ? _b : null;\n            if ((viewport !== null && viewport !== void 0 ? viewport : null) !== null) {\n                viewport.enabled = true;\n            }\n        }\n        if ((viewport !== null && viewport !== void 0 ? viewport : null) === null) {\n            viewport = new Viewport(this.router, name, connectedCE, this.scope, !!options.scope, options);\n            this.addChild(viewport.connectedScope);\n        }\n        if ((connectedCE !== null && connectedCE !== void 0 ? connectedCE : null) !== null) {\n            viewport.setConnectedCE(connectedCE, options);\n        }\n        return viewport;\n    }\n    removeViewport(viewport, connectedCE) {\n        if (((connectedCE !== null && connectedCE !== void 0 ? connectedCE : null) !== null) || viewport.remove(connectedCE)) {\n            this.removeChild(viewport.connectedScope);\n            return true;\n        }\n        return false;\n    }\n    addViewportScope(name, connectedCE, options = {}) {\n        const viewportScope = new ViewportScope(name, this.router, connectedCE, this.scope, true, null, options);\n        this.addChild(viewportScope.connectedScope);\n        return viewportScope;\n    }\n    removeViewportScope(viewportScope) {\n        // viewportScope.remove();\n        this.removeChild(viewportScope.connectedScope);\n        return true;\n    }\n    addChild(scope) {\n        if (!this.children.some(vp => vp === scope)) {\n            if (scope.parent !== null) {\n                scope.parent.removeChild(scope);\n            }\n            this.children.push(scope);\n            scope.parent = this;\n        }\n    }\n    removeChild(scope) {\n        const index = this.children.indexOf(scope);\n        if (index >= 0) {\n            this.children.splice(index, 1);\n            scope.parent = null;\n        }\n    }\n    clearReplacedChildren() {\n        this.replacedChildren = [];\n    }\n    disableReplacedChildren() {\n        this.replacedChildren = this.enabledChildren;\n        for (const scope of this.replacedChildren) {\n            scope.enabled = false;\n        }\n    }\n    reenableReplacedChildren() {\n        for (const scope of this.replacedChildren) {\n            scope.enabled = true;\n        }\n    }\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        return this.allScopes(includeDisabled, includeReplaced).filter(scope => scope.isViewport).map(scope => scope.viewport);\n    }\n    allScopes(includeDisabled = false, includeReplaced = false) {\n        const scopes = includeDisabled ? this.children.slice() : this.enabledChildren;\n        for (const scope of scopes.slice()) {\n            scopes.push(...scope.allScopes(includeDisabled, includeReplaced));\n        }\n        return scopes;\n    }\n    reparentViewportInstructions() {\n        const scopes = this.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && scope.viewportInstruction.componentName);\n        if (!scopes.length) {\n            return null;\n        }\n        for (const scope of scopes) {\n            const childInstructions = scope.reparentViewportInstructions();\n            scope.viewportInstruction.nextScopeInstructions =\n                childInstructions !== null && childInstructions.length > 0 ? childInstructions : null;\n        }\n        return scopes.map(scope => scope.viewportInstruction);\n    }\n    findMatchingRoute(path) {\n        if (this.isViewportScope && !this.passThroughScope) {\n            return this.findMatchingRouteInRoutes(path, this.viewportScope.getRoutes());\n        }\n        if (this.isViewport) {\n            return this.findMatchingRouteInRoutes(path, this.viewport.getRoutes());\n        }\n        // TODO: Match specified names here\n        for (const child of this.enabledChildren) {\n            const found = child.findMatchingRoute(path);\n            if (found !== null) {\n                return found;\n            }\n        }\n        return null;\n    }\n    canLoad(recurse) {\n        const results = Runner.runAll(this.children.map(child => child.viewport !== null\n            ? child.viewport.canLoad(recurse)\n            : child.canLoad(recurse)));\n        if (results instanceof Promise) {\n            return results.then(resolvedResults => resolvedResults.every(result => result));\n        }\n        return results.every(result => result);\n    }\n    canUnload() {\n        const results = Runner.runAll(this.children.map(child => child.viewport !== null\n            ? child.viewport.canUnload()\n            : child.canUnload()));\n        if (results instanceof Promise) {\n            return results.then(resolvedResults => {\n                return resolvedResults.every(result => result);\n            });\n        }\n        return results.every(result => result);\n    }\n    load(recurse) {\n        const results = Runner.runAll(this.children.map(child => child.viewport !== null\n            ? child.viewport.load(recurse)\n            : child.load(recurse)));\n        if (results instanceof Promise) {\n            return results;\n        }\n    }\n    unload(recurse) {\n        const results = Runner.runAll(this.children.map(child => child.viewport !== null\n            ? child.viewport.unload(recurse)\n            : child.unload(recurse)));\n        if (results instanceof Promise) {\n            return results;\n        }\n    }\n    removeContent() {\n        const results = Runner.runAll(this.children.map(child => child.viewport !== null\n            ? child.viewport.removeContent()\n            : child.removeContent()));\n        if (results instanceof Promise) {\n            return results;\n        }\n    }\n    findMatchingRouteInRoutes(path, routes) {\n        if (!Array.isArray(routes)) {\n            return null;\n        }\n        routes = routes.map(route => this.ensureProperRoute(route));\n        const cRoutes = routes.map(route => ({\n            path: route.path,\n            handler: route,\n        }));\n        for (let i = 0, ii = cRoutes.length; i < ii; ++i) {\n            const cRoute = cRoutes[i];\n            cRoutes.push({\n                ...cRoute,\n                path: `${cRoute.path}/*remainingPath`,\n            });\n        }\n        const found = new FoundRoute();\n        if (path.startsWith('/') || path.startsWith('+')) {\n            path = path.slice(1);\n        }\n        const recognizer = new RouteRecognizer();\n        recognizer.add(cRoutes);\n        const result = recognizer.recognize(path);\n        if (result !== null) {\n            found.match = result.endpoint.route.handler;\n            found.matching = path;\n            const $params = { ...result.params };\n            if ($params.remainingPath !== void 0) {\n                found.remaining = $params.remainingPath;\n                Reflect.deleteProperty($params, 'remainingPath');\n                found.matching = found.matching.slice(0, found.matching.indexOf(found.remaining));\n            }\n            found.params = $params;\n        }\n        if (found.foundConfiguration) {\n            // clone it so config doesn't get modified\n            found.instructions = this.router.instructionResolver.cloneViewportInstructions(found.match.instructions, false, true);\n            const instructions = found.instructions.slice();\n            while (instructions.length > 0) {\n                const instruction = instructions.shift();\n                instruction.addParameters(found.params);\n                instruction.route = '';\n                if (instruction.nextScopeInstructions !== null) {\n                    instructions.unshift(...instruction.nextScopeInstructions);\n                }\n            }\n            if (found.instructions.length > 0) {\n                found.instructions[0].route = found;\n            }\n        }\n        return found;\n    }\n    ensureProperRoute(route) {\n        if (route.id === void 0) {\n            route.id = route.path;\n        }\n        if (route.instructions === void 0) {\n            route.instructions = [{\n                    component: route.component,\n                    viewport: route.viewport,\n                    parameters: route.parameters,\n                    children: route.children,\n                }];\n        }\n        route.instructions = NavigationInstructionResolver.toViewportInstructions(this.router, route.instructions);\n        return route;\n    }\n}\n//# sourceMappingURL=scope.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { arrayRemove } from './utils';\nimport { ViewportContent } from './viewport-content';\nimport { Scope } from './scope';\nimport { Runner } from './runner';\nexport class Viewport {\n    constructor(router, name, connectedCE, owningScope, scope, options = {}) {\n        this.router = router;\n        this.name = name;\n        this.connectedCE = connectedCE;\n        this.options = options;\n        this.nextContent = null;\n        this.nextContentAction = '';\n        this.forceRemove = false;\n        this.path = null;\n        this.clear = false;\n        this.connectionResolve = null;\n        this.previousViewportState = null;\n        this.cache = [];\n        this.historyCache = [];\n        this.content = new ViewportContent();\n        this.connectedScope = new Scope(router, scope, owningScope, this);\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get connectedController() {\n        var _a, _b;\n        return (_b = (_a = this.connectedCE) === null || _a === void 0 ? void 0 : _a.$controller) !== null && _b !== void 0 ? _b : null;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return true;\n    }\n    get isViewportScope() {\n        return false;\n    }\n    get isEmpty() {\n        return this.content.componentInstance === null;\n    }\n    get doForceRemove() {\n        let scope = this.connectedScope;\n        while (scope !== null) {\n            if (scope.viewport !== null && scope.viewport.forceRemove) {\n                return true;\n            }\n            scope = scope.parent;\n        }\n        return false;\n    }\n    get activeContent() {\n        var _a;\n        return (_a = this.nextContent) !== null && _a !== void 0 ? _a : this.content;\n    }\n    get nextContentActivated() {\n        var _a, _b;\n        return (_b = (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.contentStates.has('activated')) !== null && _b !== void 0 ? _b : false;\n    }\n    get parentNextContentActivated() {\n        var _a, _b, _c;\n        return (_c = (_b = (_a = this.scope.parent) === null || _a === void 0 ? void 0 : _a.owner) === null || _b === void 0 ? void 0 : _b.nextContentActivated) !== null && _c !== void 0 ? _c : false;\n    }\n    get performLoad() {\n        return true;\n        // return this.nextContentAction !== 'skip' && this.connectedScope.parentNextContentAction !== 'swap';\n        // // return this.nextContentAction !== 'skip' && ((this.nextContent?.content.topInstruction ?? false) || this.clear);\n    }\n    get performSwap() {\n        return true;\n        // return this.nextContentAction !== 'skip' && this.connectedScope.parentNextContentAction !== 'swap';\n        // // return this.nextContentAction !== 'skip' && ((this.nextContent?.content.topInstruction ?? false) || this.clear);\n    }\n    toString() {\n        var _a, _b, _c, _d;\n        const contentName = (_b = (_a = this.content) === null || _a === void 0 ? void 0 : _a.content.componentName) !== null && _b !== void 0 ? _b : '';\n        const nextContentName = (_d = (_c = this.nextContent) === null || _c === void 0 ? void 0 : _c.content.componentName) !== null && _d !== void 0 ? _d : '';\n        return `v:${this.name}[${contentName}->${nextContentName}]`;\n    }\n    setNextContent(viewportInstruction, navigation) {\n        var _a;\n        viewportInstruction.setViewport(this);\n        this.clear = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction);\n        // Can have a (resolved) type or a string (to be resolved later)\n        this.nextContent = new ViewportContent(!this.clear ? viewportInstruction : void 0, navigation, (_a = this.connectedCE) !== null && _a !== void 0 ? _a : null);\n        this.nextContent.fromHistory = this.nextContent.componentInstance && navigation.navigation\n            ? !!navigation.navigation.back || !!navigation.navigation.forward\n            : false;\n        if (this.options.stateful) {\n            // TODO: Add a parameter here to decide required equality\n            const cached = this.cache.find((item) => this.nextContent.isCacheEqual(item));\n            if (cached) {\n                this.nextContent = cached;\n                this.nextContent.fromCache = true;\n            }\n            else {\n                this.cache.push(this.nextContent);\n            }\n        }\n        // Children that will be replaced (unless added again) by next content. Will\n        // be re-enabled on cancel\n        this.connectedScope.clearReplacedChildren();\n        // If we get the same _instance_, don't do anything (happens with cached and history)\n        if (this.nextContent.componentInstance !== null && this.content.componentInstance === this.nextContent.componentInstance) {\n            this.nextContent = null;\n            return this.nextContentAction = 'skip'; // false;\n        }\n        if (!this.content.equalComponent(this.nextContent) ||\n            this.connectedScope.parentNextContentAction === 'swap' || // Some parent has been swapped, need to be new component\n            navigation.navigation.refresh || // Navigation 'refresh' performed\n            this.content.reentryBehavior() === \"refresh\" /* refresh */ // ReentryBehavior 'refresh' takes precedence\n        ) {\n            this.connectedScope.disableReplacedChildren();\n            return this.nextContentAction = 'swap'; // true;\n        }\n        // Component is the same name/type\n        // Explicitly don't allow navigation back to the same component again\n        if (this.content.reentryBehavior() === \"disallow\" /* disallow */) {\n            this.nextContent = null;\n            return this.nextContentAction = 'skip'; // false;\n        }\n        // Explicitly re-load same component again\n        if (this.content.reentryBehavior() === \"load\" /* load */) {\n            this.content.reentry = true;\n            this.nextContent.content.setComponent(this.content.componentInstance);\n            // this.nextContent.contentStatus = this.content.contentStatus;\n            this.nextContent.contentStates = this.content.contentStates.clone();\n            // this.nextContent.contentStates = new Map(this.content.contentStates);\n            this.nextContent.reentry = this.content.reentry;\n            return this.nextContentAction = 'reload'; // true;\n        }\n        // ReentryBehavior is now 'default'\n        // Requires updated parameters if viewport stateful\n        if (this.options.stateful &&\n            this.content.equalParameters(this.nextContent)) {\n            this.nextContent = null;\n            return this.nextContentAction = 'skip'; // false;\n        }\n        if (!this.content.equalParameters(this.nextContent)) {\n            // TODO: Fix a config option for this\n            // eslint-disable-next-line no-constant-condition\n            if (false) { // Re-use component, only reload with new parameters\n                this.content.reentry = true;\n                this.nextContent.content.setComponent(this.content.componentInstance);\n                this.nextContent.contentStates = this.content.contentStates.clone();\n                this.nextContent.reentry = this.content.reentry;\n                return this.nextContentAction = 'reload';\n            }\n            else { // Perform a full swap\n                this.connectedScope.disableReplacedChildren();\n                return this.nextContentAction = 'swap';\n            }\n        }\n        // Default is to do nothing\n        return 'skip';\n        // // Default is to trigger a refresh (without a check of parameters)\n        // this.connectedScope.disableReplacedChildren();\n        // return this.nextContentAction = 'reload'; // true;\n    }\n    setConnectedCE(connectedCE, options) {\n        options = options || {};\n        if (this.connectedCE !== connectedCE) {\n            // TODO: Restore this state on navigation cancel\n            this.previousViewportState = { ...this };\n            this.clearState();\n            this.connectedCE = connectedCE;\n            if (options.usedBy) {\n                this.options.usedBy = options.usedBy;\n            }\n            if (options.default) {\n                this.options.default = options.default;\n            }\n            if (options.fallback) {\n                this.options.fallback = options.fallback;\n            }\n            if (options.noLink) {\n                this.options.noLink = options.noLink;\n            }\n            if (options.noTitle) {\n                this.options.noTitle = options.noTitle;\n            }\n            if (options.noHistory) {\n                this.options.noHistory = options.noHistory;\n            }\n            if (options.stateful) {\n                this.options.stateful = options.stateful;\n            }\n            if (this.connectionResolve) {\n                this.connectionResolve();\n            }\n        }\n        // TODO: Might not need this? Figure it out\n        // if (container) {\n        //   container['viewportName'] = this.name;\n        // }\n        if (!this.content.componentInstance && (!this.nextContent || !this.nextContent.componentInstance) && this.options.default) {\n            const instructions = this.router.instructionResolver.parseViewportInstructions(this.options.default);\n            for (const instruction of instructions) {\n                // Set to name to be delayed one turn\n                instruction.setViewport(this.name);\n                instruction.scope = this.owningScope;\n                instruction.default = true;\n            }\n            this.router.load(instructions, { append: true }).catch(error => { throw error; });\n        }\n    }\n    remove(connectedCE) {\n        if (this.connectedCE === connectedCE) {\n            return Runner.run(() => {\n                if (this.content.componentInstance) {\n                    return this.content.freeContent(this.connectedCE, (this.nextContent ? this.nextContent.instruction : null), this.historyCache, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful); // .catch(error => { throw error; });\n                }\n            }, () => {\n                if (this.doForceRemove) {\n                    const removes = [];\n                    for (const content of this.historyCache) {\n                        removes.push(() => content.freeContent(null, null, this.historyCache, false));\n                    }\n                    removes.push(() => { this.historyCache = []; });\n                    return Runner.run(...removes);\n                    // return Promise.all(this.historyCache.map(content => content.freeContent(\n                    //   null,\n                    //   null,\n                    //   this.historyCache,\n                    //   false,\n                    // )));\n                    // this.historyCache = [];\n                }\n                return true;\n            });\n        }\n        return false;\n    }\n    transition(coordinator) {\n        // console.log('Viewport transition', this.toString());\n        // let run: unknown;\n        const guarded = coordinator.checkingSyncState('guarded');\n        const performLoad = this.performLoad || !guarded;\n        const performSwap = this.performSwap || !guarded;\n        // const performSwap = this.performSwap || !this.router.isRestrictedNavigation || this.clear;\n        const guardSteps = [\n            () => performLoad ? this.canUnload() : true,\n            (canUnloadResult) => {\n                if (!canUnloadResult) {\n                    Runner.cancel(void 0);\n                    coordinator.cancel();\n                    return;\n                }\n                if (this.router.isRestrictedNavigation) {\n                    this.nextContent.createComponent(this.connectedCE, this.options.fallback);\n                }\n                coordinator.addEntityState(this, 'guardedUnload');\n            },\n            () => coordinator.syncState('guardedUnload', this),\n            () => performLoad ? this.canLoad(guarded) : true,\n            (canLoadResult) => {\n                if (typeof canLoadResult === 'boolean') {\n                    if (!canLoadResult) {\n                        Runner.cancel(void 0);\n                        coordinator.cancel();\n                        return;\n                    }\n                    coordinator.addEntityState(this, 'guardedLoad');\n                    coordinator.addEntityState(this, 'guarded');\n                }\n                else { // Denied and (probably) redirected\n                    Runner.run(() => this.router.load(canLoadResult, { append: true }), () => this.abortContentChange());\n                }\n            },\n        ];\n        const routingSteps = [\n            // () => { console.log(\"I'm waiting for guarded\", this.toString()); },\n            () => coordinator.syncState('guarded', this),\n            // () => { console.log(\"I'm guarded\", this.toString()); },\n            // TODO: For consistency it should probably be this option with 'routed'\n            // () => performSwap ? this.unload(coordinator.checkingSyncState('routed')) : true,\n            () => performLoad ? this.unload(true) : true,\n            () => coordinator.addEntityState(this, 'unloaded'),\n            // () => { console.log(\"I'm waiting for unloaded\", this.toString()); },\n            () => coordinator.syncState('unloaded', this),\n            // () => { console.log(\"I'm done waiting for unloaded\", this.toString()); },\n            () => performLoad ? this.load(coordinator.checkingSyncState('routed')) : true,\n            () => coordinator.addEntityState(this, 'loaded'),\n            () => coordinator.addEntityState(this, 'routed'),\n        ];\n        const lifecycleSteps = [\n            () => coordinator.syncState('routed', this),\n        ];\n        if (performSwap) {\n            if (this.router.options.swapStrategy.includes('parallel')) {\n                lifecycleSteps.push(() => {\n                    if (this.router.options.swapStrategy.includes('add')) {\n                        return Runner.run(this.addContent(), this.removeContent());\n                    }\n                    else {\n                        return Runner.run(this.removeContent(), this.addContent());\n                    }\n                });\n            }\n            else {\n                lifecycleSteps.push(() => performSwap ? (this.router.options.swapStrategy.includes('add') ? this.addContent() : this.removeContent()) : void 0, () => performSwap ? (this.router.options.swapStrategy.includes('add') ? this.removeContent() : this.addContent()) : void 0);\n            }\n        }\n        lifecycleSteps.push(() => coordinator.addEntityState(this, 'swapped'));\n        // const lifecycleSteps = [\n        //   () => coordinator.syncState('routed'),\n        //   // () => coordinator.addEntityState(this, 'bound'),\n        //   () => performSwap ? (this.router.options.swapStrategy.includes('add') ? this.addContent() : this.removeContent()) : true,\n        //   () => performSwap ? (this.router.options.swapStrategy.includes('add') ? this.removeContent() : this.addContent()) : true,\n        //   () => coordinator.addEntityState(this, 'swapped'),\n        // ];\n        // run =\n        Runner.run(...guardSteps, ...routingSteps, ...lifecycleSteps, () => coordinator.addEntityState(this, 'completed'));\n    }\n    canUnload() {\n        return Runner.run(() => {\n            // console.log('viewport canUnload run', this.name, 'before');\n            // eslint-disable-next-line sonarjs/prefer-immediate-return\n            const result = this.connectedScope.canUnload();\n            // console.log('viewport canUnload run', this.name, 'after');\n            return result;\n        }, (canUnloadChildren) => {\n            var _a, _b;\n            // console.log('viewport canUnload result', this.name, canUnloadChildren);\n            if (!canUnloadChildren) {\n                return false;\n            }\n            // This shouldn't happen\n            // // Don't stop it because we're not going to actually do anything\n            // if (this.content.componentInstance === this.nextContent?.componentInstance) {\n            //   return true;\n            // }\n            return this.content.canUnload((_b = (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.instruction) !== null && _b !== void 0 ? _b : null);\n        });\n    }\n    canLoad(recurse) {\n        var _a, _b;\n        // console.log(this.connectedScope.toString(), 'viewport content canLoad', this.nextContent?.content?.componentName);\n        if (this.clear) {\n            return true;\n        }\n        if (((_b = (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.content) !== null && _b !== void 0 ? _b : null) === null) {\n            return true;\n        }\n        return Runner.run(() => this.waitForConnected(), () => {\n            this.nextContent.createComponent(this.connectedCE, this.options.fallback);\n            // This shouldn't happen\n            // // Don't stop it because we're not going to actually do anything\n            // if (this.content.componentInstance === this.nextContent!.componentInstance) {\n            //   return true;\n            // }\n            return this.nextContent.canLoad(this, this.content.instruction);\n        });\n    }\n    load(recurse) {\n        var _a, _b;\n        // console.log(this.connectedScope.toString(), 'viewport content load', this.nextContent?.content?.componentName);\n        if (this.clear || ((_b = (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.componentInstance) !== null && _b !== void 0 ? _b : null) === null) {\n            return;\n        }\n        // This shouldn't happen\n        // // TODO: Verify this\n        // if (this.nextContent === this.content) {\n        //   return;\n        // }\n        return Runner.run(() => { var _a; return (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.load(this.content.instruction); });\n        // return this.nextContent?.load(this.content.instruction);\n        // await this.nextContent.activateComponent(null, this.connectedCE!.$controller as ICustomElementController<Element, ICustomElementViewModel<Element>>, LifecycleFlags.none, this.connectedCE!);\n        // return true;\n    }\n    addContent() {\n        // console.log('addContent', this.toString());\n        return Runner.run(() => this.activate(null, this.connectedController, 0 /* none */, this.parentNextContentActivated));\n    }\n    removeContent() {\n        if (this.isEmpty) {\n            return;\n        }\n        // console.log('removeContent', this.toString());\n        return Runner.run(() => this.connectedScope.removeContent(), () => this.deactivate(null, null /* TODO: verify this.connectedController */, 0 /* none */), () => this.dispose());\n    }\n    removeChildrenContent() {\n        // console.log(this.name, 'removeContent', this.content.content);\n        return Runner.run(() => !this.isEmpty ? this.connectedScope.removeContent() : void 0);\n    }\n    activate(initiator, parent, flags, fromParent) {\n        // console.log('activate' /* , { ...this } */);\n        if (this.activeContent.componentInstance !== null) {\n            this.connectedScope.reenableReplacedChildren();\n            return Runner.run(() => this.activeContent.load(this.activeContent.instruction), // Only acts if not already loaded\n            () => this.activeContent.activateComponent(initiator, parent, flags, this.connectedCE, fromParent));\n        }\n    }\n    deactivate(initiator, parent, flags) {\n        var _a;\n        if (this.content.componentInstance &&\n            !this.content.reentry &&\n            this.content.componentInstance !== ((_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.componentInstance)) {\n            return Runner.run(() => { var _a; return (_a = this.content) === null || _a === void 0 ? void 0 : _a.unload(this.content.instruction); }, // Only acts if not already unloaded\n            () => { var _a; return (_a = this.content) === null || _a === void 0 ? void 0 : _a.deactivateComponent(initiator, parent, flags, this.connectedCE, this.router.statefulHistory || this.options.stateful); });\n        }\n    }\n    unload(recurse) {\n        return Runner.run(() => recurse ? this.connectedScope.unload(recurse) : true, () => {\n            // console.log(this.connectedScope.toString(), 'viewport content unload', this.content.content.componentName);\n            // This shouldn't happen\n            // // TODO: Verify this\n            // if (this.nextContent === this.content) {\n            //   return;\n            // }\n            var _a, _b;\n            if (this.content.componentInstance) {\n                return this.content.unload((_b = (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.instruction) !== null && _b !== void 0 ? _b : null);\n            }\n        });\n    }\n    dispose() {\n        var _a;\n        if (this.content.componentInstance &&\n            !this.content.reentry &&\n            this.content.componentInstance !== ((_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.componentInstance)) {\n            return Runner.run(\n            // () => this.content!.unloadComponent(\n            //   this.historyCache,\n            //   this.router.statefulHistory || this.options.stateful),\n            // () => this.content!.destroyComponent(),\n            () => this.content.disposeComponent(this.connectedCE, this.historyCache, this.router.statefulHistory || this.options.stateful));\n            // await this.content!.freeContent(\n            //   this.connectedCE,\n            //   this.nextContent!.instruction,\n            //   this.historyCache,\n            //   this.router.statefulHistory || this.options.stateful);\n        }\n    }\n    finalizeContentChange() {\n        // console.log('finalizeContent', this.nextContent!.content?.componentName);\n        if (this.nextContent.componentInstance) {\n            this.content = this.nextContent;\n            this.content.reentry = false;\n        }\n        if (this.clear) {\n            this.content = new ViewportContent(void 0, this.nextContent.instruction);\n        }\n        this.nextContent = null;\n        this.nextContentAction = '';\n        this.previousViewportState = null;\n        this.connectedScope.clearReplacedChildren();\n    }\n    abortContentChange() {\n        this.connectedScope.reenableReplacedChildren();\n        return Runner.run(() => this.nextContent.freeContent(this.connectedCE, this.nextContent.instruction, this.historyCache, this.router.statefulHistory || this.options.stateful), () => {\n            if (this.previousViewportState) {\n                Object.assign(this, this.previousViewportState);\n            }\n            this.nextContentAction = '';\n        });\n    }\n    // TODO: Deal with non-string components\n    wantComponent(component) {\n        let usedBy = this.options.usedBy || [];\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        return usedBy.includes(component);\n    }\n    // TODO: Deal with non-string components\n    acceptComponent(component) {\n        if (component === '-' || component === null) {\n            return true;\n        }\n        let usedBy = this.options.usedBy;\n        if (!usedBy || !usedBy.length) {\n            return true;\n        }\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        if (usedBy.includes(component)) {\n            return true;\n        }\n        if (usedBy.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    freeContent(component) {\n        const content = this.historyCache.find(cached => cached.componentInstance === component);\n        if (content !== void 0) {\n            return Runner.run(() => {\n                this.forceRemove = true;\n                return content.freeContent(null, null, this.historyCache, false);\n            }, () => {\n                this.forceRemove = false;\n                arrayRemove(this.historyCache, (cached => cached === content));\n            });\n        }\n    }\n    getRoutes() {\n        const componentType = this.getComponentType();\n        if (componentType === null) {\n            return null;\n        }\n        const routes = componentType.routes;\n        return Array.isArray(routes) ? routes : null;\n    }\n    getTitle(navigationInstruction) {\n        var _a, _b;\n        if (this.options.noTitle) {\n            return '';\n        }\n        const componentType = this.getComponentType();\n        if (componentType === null) {\n            return '';\n        }\n        let title = '';\n        const typeTitle = componentType.title;\n        if (typeTitle !== void 0) {\n            if (typeof typeTitle === 'string') {\n                title = typeTitle;\n            }\n            else {\n                const component = this.getComponentInstance();\n                title = typeTitle.call(component, component, navigationInstruction);\n            }\n        }\n        else if (this.router.options.title.useComponentNames) {\n            let name = (_a = this.getContentInstruction().componentName) !== null && _a !== void 0 ? _a : '';\n            const prefix = (_b = this.router.options.title.componentPrefix) !== null && _b !== void 0 ? _b : '';\n            if (name.startsWith(prefix)) {\n                name = name.slice(prefix.length);\n            }\n            name = name.replace('-', ' ');\n            title = name.slice(0, 1).toLocaleUpperCase() + name.slice(1);\n        }\n        if (this.router.options.title.transformTitle !== void 0) {\n            title = this.router.options.title.transformTitle.call(this, title, this.getContentInstruction());\n        }\n        return title;\n    }\n    getComponentType() {\n        var _a;\n        let componentType = (_a = this.getContentInstruction().componentType) !== null && _a !== void 0 ? _a : null;\n        // TODO: This is going away once Metadata is in!\n        if (componentType === null) {\n            const controller = CustomElement.for(this.connectedCE.element);\n            componentType = controller.context\n                .componentType;\n        }\n        return componentType !== null && componentType !== void 0 ? componentType : null;\n    }\n    getComponentInstance() {\n        var _a;\n        return (_a = this.getContentInstruction().componentInstance) !== null && _a !== void 0 ? _a : null;\n    }\n    getContentInstruction() {\n        var _a, _b, _c;\n        return (_c = (_b = (_a = this.nextContent) === null || _a === void 0 ? void 0 : _a.content) !== null && _b !== void 0 ? _b : this.content.content) !== null && _c !== void 0 ? _c : null;\n    }\n    clearState() {\n        this.options = {};\n        this.content = new ViewportContent();\n        this.cache = [];\n    }\n    waitForConnected() {\n        if (this.connectedCE === null) {\n            return new Promise((resolve) => {\n                this.connectionResolve = resolve;\n            });\n        }\n    }\n}\n//# sourceMappingURL=viewport.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nexport const ComponentAppellationResolver = {\n    isName(component) {\n        return typeof component === 'string';\n    },\n    isType(component) {\n        return CustomElement.isType(component);\n    },\n    isInstance(component) {\n        return !ComponentAppellationResolver.isName(component) && !ComponentAppellationResolver.isType(component);\n    },\n    getName(component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return component;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return CustomElement.getDefinition(component).name;\n        }\n        else {\n            return ComponentAppellationResolver.getName(component.constructor);\n        }\n    },\n    getType(component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return component;\n        }\n        else {\n            return component.constructor;\n        }\n    },\n    getInstance(component) {\n        if (ComponentAppellationResolver.isName(component) || ComponentAppellationResolver.isType(component)) {\n            return null;\n        }\n        else {\n            return component;\n        }\n    },\n};\nexport const ViewportHandleResolver = {\n    isName(viewport) {\n        return typeof viewport === 'string';\n    },\n    isInstance(viewport) {\n        return viewport instanceof Viewport;\n    },\n    getName(viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return viewport;\n        }\n        else {\n            return viewport ? (viewport).name : null;\n        }\n    },\n    getInstance(viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return null;\n        }\n        else {\n            return viewport;\n        }\n    },\n};\nexport const NavigationInstructionResolver = {\n    createViewportInstructions(router, navigationInstructions, options) {\n        options = options || {};\n        let scope = null;\n        if (options.context) {\n            scope = router.findScope(options.context);\n            if (typeof navigationInstructions === 'string') {\n                // If it's not from scope root, figure out which scope\n                if (!navigationInstructions.startsWith('/')) {\n                    // Scope modifications\n                    if (navigationInstructions.startsWith('.')) {\n                        // The same as no scope modification\n                        if (navigationInstructions.startsWith('./')) {\n                            navigationInstructions = navigationInstructions.slice(2);\n                        }\n                        // Find out how many scopes upwards we should move\n                        while (navigationInstructions.startsWith('../')) {\n                            scope = scope.parent || scope;\n                            navigationInstructions = navigationInstructions.slice(3);\n                        }\n                    }\n                    if (scope.path !== null) {\n                        navigationInstructions = `${scope.path}/${navigationInstructions}`;\n                        scope = router.rootScope.scope;\n                    }\n                }\n                else { // Specified root scope with /\n                    scope = router.rootScope.scope;\n                }\n            }\n            else {\n                navigationInstructions = NavigationInstructionResolver.toViewportInstructions(router, navigationInstructions);\n                for (const instruction of navigationInstructions) {\n                    if (instruction.scope === null) {\n                        instruction.scope = scope;\n                    }\n                }\n            }\n        }\n        return {\n            instructions: navigationInstructions,\n            scope,\n        };\n    },\n    toViewportInstructions(router, navigationInstructions) {\n        if (!Array.isArray(navigationInstructions)) {\n            return NavigationInstructionResolver.toViewportInstructions(router, [navigationInstructions]);\n        }\n        const instructions = [];\n        for (const instruction of navigationInstructions) {\n            if (typeof instruction === 'string') {\n                instructions.push(...router.instructionResolver.parseViewportInstructions(instruction));\n            }\n            else if (instruction instanceof ViewportInstruction) {\n                instructions.push(instruction);\n            }\n            else if (instruction.component) {\n                const viewportComponent = instruction;\n                const newInstruction = router.createViewportInstruction(viewportComponent.component, viewportComponent.viewport, viewportComponent.parameters);\n                if (viewportComponent.children !== void 0 && viewportComponent.children !== null) {\n                    newInstruction.nextScopeInstructions = NavigationInstructionResolver.toViewportInstructions(router, viewportComponent.children);\n                }\n                instructions.push(newInstruction);\n            }\n            else {\n                instructions.push(router.createViewportInstruction(instruction));\n            }\n        }\n        return instructions;\n    },\n};\n//# sourceMappingURL=type-resolvers.js.map","export class RouterOptions {\n    constructor() {\n        this.separators = {\n            viewport: '@',\n            sibling: '+',\n            scope: '/',\n            scopeStart: '(',\n            scopeEnd: ')',\n            noScope: '!',\n            parameters: '(',\n            parametersEnd: ')',\n            parameterSeparator: ',',\n            parameterKeySeparator: '=',\n            parameter: '&',\n            add: '+',\n            clear: '-',\n            action: '.',\n        };\n        this.useUrlFragmentHash = true;\n        this.useHref = true;\n        this.statefulHistoryLength = 0;\n        this.useDirectRoutes = true;\n        this.useConfiguredRoutes = true;\n        this.additiveInstructionDefault = true;\n        this.title = {\n            // eslint-disable-next-line no-useless-escape\n            appTitle: \"${componentTitles}\\${appTitleSeparator}Aurelia\",\n            appTitleSeparator: ' | ',\n            componentTitleOrder: 'top-down',\n            componentTitleSeparator: ' > ',\n            useComponentNames: true,\n            componentPrefix: 'app-',\n        };\n        this.navigationSyncStates = ['guardedUnload', 'swapped', 'completed'];\n        this.swapStrategy = 'add-first-sequential';\n        this.routingHookIntegration = 'integrated';\n    }\n}\n//# sourceMappingURL=router-options.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { ComponentAppellationResolver } from './type-resolvers';\nimport { RouterOptions } from './router-options';\n/**\n * @internal - Shouldn't be used directly\n */\nexport var ParametersType;\n(function (ParametersType) {\n    ParametersType[\"none\"] = \"none\";\n    ParametersType[\"string\"] = \"string\";\n    ParametersType[\"array\"] = \"array\";\n    ParametersType[\"object\"] = \"object\";\n})(ParametersType || (ParametersType = {}));\n/**\n * Public API - The viewport instructions are the core of the router's navigations\n */\nlet ViewportInstruction = /** @class */ (() => {\n    class ViewportInstruction {\n        constructor() {\n            this.componentName = null;\n            this.componentType = null;\n            this.componentInstance = null;\n            this.viewportName = null;\n            this.viewport = null;\n            this.parametersString = null;\n            this.parametersRecord = null;\n            this.parametersList = null;\n            this.parametersType = \"none\" /* none */;\n            this.ownsScope = true;\n            this.nextScopeInstructions = null;\n            this.scope = null;\n            this.context = '';\n            this.viewportScope = null;\n            this.needsViewportDescribed = false;\n            this.route = null;\n            this.default = false;\n            this.topInstruction = false;\n            this.instructionResolver = null;\n        }\n        // public constructor(\n        //   component: ComponentAppellation,\n        //   viewport?: ViewportHandle,\n        //   parameters?: ComponentParameters,\n        //   public ownsScope: boolean = true,\n        //   public nextScopeInstructions: ViewportInstruction[] | null = null,\n        // ) {\n        //   this.setComponent(component);\n        //   this.setViewport(viewport);\n        //   this.setParameters(parameters);\n        // }\n        static create(instructionResolver, component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n            // if (component instanceof Promise) {\n            //   return component.then((resolvedComponent) => {\n            //     return ViewportInstruction.create(instructionResolver, resolvedComponent, viewport, parameters, ownsScope, nextScopeInstructions);\n            //   });\n            // }\n            const instruction = new ViewportInstruction();\n            instruction.setComponent(component);\n            instruction.setViewport(viewport);\n            instruction.setParameters(parameters);\n            instruction.ownsScope = ownsScope;\n            instruction.nextScopeInstructions = nextScopeInstructions;\n            instruction.setInstructionResolver(instructionResolver);\n            return instruction;\n        }\n        get owner() {\n            var _a, _b;\n            return (_b = (_a = this.viewport) !== null && _a !== void 0 ? _a : this.viewportScope) !== null && _b !== void 0 ? _b : null;\n        }\n        get typedParameters() {\n            switch (this.parametersType) {\n                case \"string\" /* string */:\n                    return this.parametersString;\n                case \"array\" /* array */:\n                    return this.parametersList;\n                case \"object\" /* object */:\n                    return this.parametersRecord;\n                default:\n                    return null;\n            }\n        }\n        get parameters() {\n            if (this.instructionResolver !== null) {\n                return this.instructionResolver.parseComponentParameters(this.typedParameters);\n            }\n            return [];\n        }\n        get normalizedParameters() {\n            if (this.instructionResolver !== null && this.typedParameters !== null) {\n                return this.instructionResolver.stringifyComponentParameters(this.parameters);\n            }\n            return '';\n        }\n        setComponent(component) {\n            if (ComponentAppellationResolver.isName(component)) {\n                this.componentName = ComponentAppellationResolver.getName(component);\n                this.componentType = null;\n                this.componentInstance = null;\n            }\n            else if (ComponentAppellationResolver.isType(component)) {\n                this.componentName = this.getNewName(component);\n                this.componentType = ComponentAppellationResolver.getType(component);\n                this.componentInstance = null;\n            }\n            else if (ComponentAppellationResolver.isInstance(component)) {\n                this.componentName = this.getNewName(ComponentAppellationResolver.getType(component));\n                this.componentType = ComponentAppellationResolver.getType(component);\n                this.componentInstance = ComponentAppellationResolver.getInstance(component);\n            }\n        }\n        setViewport(viewport) {\n            if (viewport === undefined || viewport === '') {\n                viewport = null;\n            }\n            if (typeof viewport === 'string') {\n                this.viewportName = viewport;\n                this.viewport = null;\n            }\n            else {\n                this.viewport = viewport;\n                if (viewport !== null) {\n                    this.viewportName = viewport.name;\n                    this.scope = viewport.owningScope;\n                }\n            }\n        }\n        setParameters(parameters) {\n            if (parameters === undefined || parameters === null || parameters === '') {\n                this.parametersType = \"none\" /* none */;\n                parameters = null;\n            }\n            else if (typeof parameters === 'string') {\n                this.parametersType = \"string\" /* string */;\n                this.parametersString = parameters;\n            }\n            else if (Array.isArray(parameters)) {\n                this.parametersType = \"array\" /* array */;\n                this.parametersList = parameters;\n            }\n            else {\n                this.parametersType = \"object\" /* object */;\n                this.parametersRecord = parameters;\n            }\n        }\n        // This only works with objects added to objects!\n        addParameters(parameters) {\n            if (this.parametersType === \"none\" /* none */) {\n                return this.setParameters(parameters);\n            }\n            if (this.parametersType !== \"object\" /* object */) {\n                throw new Error('Can\\'t add object parameters to existing non-object parameters!');\n            }\n            this.setParameters({ ...this.parametersRecord, ...parameters });\n        }\n        setInstructionResolver(instructionResolver) {\n            this.instructionResolver = instructionResolver;\n        }\n        isEmpty() {\n            return !this.isComponentName() && !this.isComponentType() && !this.isComponentInstance();\n        }\n        isComponentName() {\n            return !!this.componentName && !this.isComponentType() && !this.isComponentInstance();\n        }\n        isComponentType() {\n            return this.componentType !== null && !this.isComponentInstance();\n        }\n        isComponentInstance() {\n            return this.componentInstance !== null;\n        }\n        toComponentType(container) {\n            if (this.componentType !== null) {\n                return this.componentType;\n            }\n            if (this.componentName !== null\n                && typeof this.componentName === 'string'\n                && container !== null\n                && container.has(CustomElement.keyFrom(this.componentName), true)) {\n                const resolver = container.getResolver(CustomElement.keyFrom(this.componentName));\n                if (resolver !== null && resolver.getFactory !== void 0) {\n                    const factory = resolver.getFactory(container);\n                    if (factory) {\n                        return factory.Type;\n                    }\n                }\n            }\n            return null;\n        }\n        toComponentInstance(container) {\n            if (this.componentInstance !== null) {\n                return this.componentInstance;\n            }\n            if (container !== void 0 && container !== null) {\n                const instance = this.isComponentType()\n                    ? container.get(this.componentType)\n                    : container.get(CustomElement.keyFrom(this.componentName));\n                if (this.isComponentType() &&\n                    !(instance instanceof this.componentType)) {\n                    console.warn('Failed to instantiate', this.componentType, instance);\n                }\n                return instance !== null && instance !== void 0 ? instance : null;\n            }\n            return null;\n        }\n        toViewportInstance(router) {\n            if (this.viewport !== null) {\n                return this.viewport;\n            }\n            return router.getViewport(this.viewportName);\n        }\n        toSpecifiedParameters(specifications) {\n            specifications = specifications || [];\n            const parameters = this.parameters;\n            const specified = {};\n            for (const spec of specifications) {\n                // First get named if it exists\n                let index = parameters.findIndex(param => param.key === spec);\n                if (index >= 0) {\n                    const [parameter] = parameters.splice(index, 1);\n                    specified[spec] = parameter.value;\n                }\n                else {\n                    // Otherwise get first unnamed\n                    index = parameters.findIndex(param => param.key === void 0);\n                    if (index >= 0) {\n                        const [parameter] = parameters.splice(index, 1);\n                        specified[spec] = parameter.value;\n                    }\n                }\n            }\n            // Add all remaining named\n            for (const parameter of parameters.filter(param => param.key !== void 0)) {\n                specified[parameter.key] = parameter.value;\n            }\n            let index = specifications.length;\n            // Add all remaining unnamed...\n            for (const parameter of parameters.filter(param => param.key === void 0)) {\n                // ..with an index\n                specified[index++] = parameter.value;\n            }\n            return specified;\n        }\n        toSortedParameters(specifications) {\n            specifications = specifications || [];\n            const parameters = this.parameters;\n            const sorted = [];\n            for (const spec of specifications) {\n                // First get named if it exists\n                let index = parameters.findIndex(param => param.key === spec);\n                if (index >= 0) {\n                    const parameter = { ...parameters.splice(index, 1)[0] };\n                    parameter.key = void 0;\n                    sorted.push(parameter);\n                }\n                else {\n                    // Otherwise get first unnamed\n                    index = parameters.findIndex(param => param.key === void 0);\n                    if (index >= 0) {\n                        const parameter = { ...parameters.splice(index, 1)[0] };\n                        sorted.push(parameter);\n                    }\n                    else {\n                        // Or an empty\n                        sorted.push({ value: void 0 });\n                    }\n                }\n            }\n            // Add all remaining named\n            const params = parameters.filter(param => param.key !== void 0);\n            params.sort((a, b) => (a.key || '') < (b.key || '') ? 1 : (b.key || '') < (a.key || '') ? -1 : 0);\n            sorted.push(...params);\n            // Add all remaining unnamed...\n            sorted.push(...parameters.filter(param => param.key === void 0));\n            return sorted;\n        }\n        sameComponent(other, compareParameters = false, compareType = false) {\n            if (compareParameters && !this.sameParameters(other, compareType)) {\n                return false;\n            }\n            return compareType ? this.componentType === other.componentType : this.componentName === other.componentName;\n        }\n        // TODO: Somewhere we need to check for format such as spaces etc\n        sameParameters(other, compareType = false) {\n            if (!this.sameComponent(other, false, compareType)) {\n                return false;\n            }\n            const typeParameters = this.componentType ? this.componentType.parameters : [];\n            const mine = this.toSpecifiedParameters(typeParameters);\n            const others = other.toSpecifiedParameters(typeParameters);\n            return Object.keys(mine).every(key => mine[key] === others[key])\n                && Object.keys(others).every(key => others[key] === mine[key]);\n        }\n        sameViewport(other) {\n            if (this.viewport !== null && other.viewport !== null) {\n                return this.viewport === other.viewport;\n            }\n            return this.scope === other.scope &&\n                (this.viewport ? this.viewport.name : this.viewportName) === (other.viewport ? other.viewport.name : other.viewportName);\n        }\n        getNewName(type) {\n            if (this.componentName === null\n            // || !type.aliases?.includes(this.componentName)\n            ) {\n                return ComponentAppellationResolver.getName(type);\n            }\n            return this.componentName;\n        }\n    }\n    ViewportInstruction.inject = [RouterOptions];\n    return ViewportInstruction;\n})();\nexport { ViewportInstruction };\n//# sourceMappingURL=viewport-instruction.js.map","import { ViewportInstruction } from './viewport-instruction';\nexport class InstructionResolver {\n    constructor() {\n        this.separators = {\n            viewport: '@',\n            sibling: '+',\n            scope: '/',\n            scopeStart: '(',\n            scopeEnd: ')',\n            noScope: '!',\n            parameters: '(',\n            parametersEnd: ')',\n            parameterSeparator: ',',\n            parameterKeySeparator: '=',\n            parameter: '&',\n            add: '+',\n            clear: '-',\n            action: '.',\n        };\n    }\n    start(options) {\n        options = options || {};\n        this.separators = { ...this.separators, ...options.separators };\n    }\n    get clearViewportInstruction() {\n        return this.separators.clear;\n    }\n    get addViewportInstruction() {\n        return this.separators.add;\n    }\n    isClearViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportName\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isAddViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction\n            : (instruction === this.addViewportInstruction\n                || instruction.startsWith(`${this.separators.add}${this.separators.viewport}`));\n    }\n    isClearViewportScopeInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportScope\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isClearAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !instruction.viewportName\n            : instruction === this.clearViewportInstruction;\n    }\n    isAddAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction && !instruction.viewportName\n            : instruction === this.addViewportInstruction;\n    }\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        if (component instanceof Promise) {\n            return component.then((resolvedComponent) => {\n                return this.createViewportInstruction(resolvedComponent, viewport, parameters, ownsScope, nextScopeInstructions);\n            });\n        }\n        // const instruction: ViewportInstruction = new ViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n        // instruction.setInstructionResolver(this);\n        // return instruction;\n        return ViewportInstruction.create(this, component, viewport, parameters, ownsScope, nextScopeInstructions);\n    }\n    parseViewportInstructions(instructions) {\n        const match = /^[./]+/.exec(instructions);\n        let context = '';\n        if (Array.isArray(match) && match.length > 0) {\n            context = match[0];\n            instructions = instructions.slice(context.length);\n        }\n        const parsedInstructions = this.parseViewportInstructionsWorker(instructions, true).instructions;\n        for (const instruction of parsedInstructions) {\n            instruction.context = context;\n        }\n        return parsedInstructions;\n    }\n    parseViewportInstruction(instruction) {\n        const instructions = this.parseViewportInstructions(instruction);\n        if (instructions.length) {\n            return instructions[0];\n        }\n        return this.createViewportInstruction('');\n    }\n    stringifyViewportInstructions(instructions, excludeViewport = false, viewportContext = false) {\n        return typeof (instructions) === 'string'\n            ? instructions\n            : instructions\n                .map(instruction => this.stringifyViewportInstruction(instruction, excludeViewport, viewportContext))\n                .filter(instruction => instruction && instruction.length)\n                .join(this.separators.sibling);\n    }\n    stringifyViewportInstruction(instruction, excludeViewport = false, viewportContext = false) {\n        var _a;\n        if (typeof instruction === 'string') {\n            return this.stringifyAViewportInstruction(instruction, excludeViewport);\n        }\n        else {\n            let excludeCurrentViewport = excludeViewport;\n            let excludeCurrentComponent = false;\n            if (viewportContext) {\n                if (instruction.viewport && instruction.viewport.options.noLink) {\n                    return '';\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewport && !instruction.viewport.options.forceDescription) {\n                    excludeCurrentViewport = true;\n                }\n                if (instruction.viewport && instruction.viewport.options.fallback === instruction.componentName) {\n                    excludeCurrentComponent = true;\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewportScope) {\n                    excludeCurrentViewport = true;\n                }\n            }\n            let route = (_a = instruction.route) !== null && _a !== void 0 ? _a : null;\n            const nextInstructions = instruction.nextScopeInstructions;\n            let stringified = instruction.context;\n            // It's a configured route\n            if (route !== null) {\n                // Already added as part of a configuration, skip to next scope\n                if (route === '') {\n                    return Array.isArray(nextInstructions)\n                        ? this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext)\n                        : '';\n                }\n                route = route.matching;\n                stringified += route.endsWith(this.separators.scope) ? route.slice(0, -this.separators.scope.length) : route;\n            }\n            else {\n                stringified += this.stringifyAViewportInstruction(instruction, excludeCurrentViewport, excludeCurrentComponent);\n            }\n            if (Array.isArray(nextInstructions) && nextInstructions.length) {\n                const nextStringified = this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext);\n                if (nextStringified.length > 0) {\n                    stringified += nextInstructions.length === 1 // TODO: This should really also check that the instructions have value\n                        ? `${this.separators.scope}${nextStringified}`\n                        : `${this.separators.scope}${this.separators.scopeStart}${nextStringified}${this.separators.scopeEnd}`;\n                }\n            }\n            return stringified;\n        }\n    }\n    stringifyScopedViewportInstructions(instructions) {\n        if (!Array.isArray(instructions)) {\n            return this.stringifyScopedViewportInstructions([instructions]);\n        }\n        return instructions.map((instruction) => this.stringifyViewportInstruction(instruction)).join(this.separators.scope);\n    }\n    encodeViewportInstructions(instructions) {\n        return encodeURIComponent(this.stringifyViewportInstructions(instructions)).replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n    }\n    decodeViewportInstructions(instructions) {\n        return this.parseViewportInstructions(decodeURIComponent(instructions));\n    }\n    buildScopedLink(scopeContext, href) {\n        if (scopeContext) {\n            href = `/${scopeContext}${this.separators.scope}${href}`;\n        }\n        return href;\n    }\n    shouldClearViewports(path) {\n        const clearViewports = (path === this.separators.clear || path.startsWith(this.separators.clear + this.separators.add));\n        const newPath = path.startsWith(this.separators.clear) ? path.slice(2) : path;\n        return { clearViewports, newPath };\n    }\n    mergeViewportInstructions(instructions) {\n        const merged = [];\n        for (let instruction of instructions) {\n            if (typeof instruction === 'string') {\n                instruction = this.parseViewportInstruction(instruction);\n            }\n            const index = merged.findIndex(merge => merge.sameViewport(instruction));\n            if (index >= 0) {\n                merged.splice(index, 1, instruction);\n            }\n            else {\n                merged.push(instruction);\n            }\n        }\n        return merged;\n    }\n    flattenViewportInstructions(instructions) {\n        const flat = [];\n        for (const instruction of instructions) {\n            flat.push(instruction);\n            if (instruction.nextScopeInstructions) {\n                flat.push(...this.flattenViewportInstructions(instruction.nextScopeInstructions));\n            }\n        }\n        return flat;\n    }\n    cloneViewportInstructions(instructions, keepInstances = false, context = false) {\n        var _a, _b, _c;\n        const clones = [];\n        for (const instruction of instructions) {\n            const clone = this.createViewportInstruction(instruction.componentName, instruction.viewportName, instruction.typedParameters !== null ? instruction.typedParameters : void 0);\n            if (keepInstances) {\n                clone.setComponent((_b = (_a = instruction.componentInstance) !== null && _a !== void 0 ? _a : instruction.componentType) !== null && _b !== void 0 ? _b : instruction.componentName);\n                clone.setViewport((_c = instruction.viewport) !== null && _c !== void 0 ? _c : instruction.viewportName);\n            }\n            clone.needsViewportDescribed = instruction.needsViewportDescribed;\n            clone.route = instruction.route;\n            if (context) {\n                clone.context = instruction.context;\n            }\n            clone.viewportScope = keepInstances ? instruction.viewportScope : null;\n            clone.scope = keepInstances ? instruction.scope : null;\n            if (instruction.nextScopeInstructions) {\n                clone.nextScopeInstructions = this.cloneViewportInstructions(instruction.nextScopeInstructions, keepInstances, context);\n            }\n            clones.push(clone);\n        }\n        return clones;\n    }\n    // TODO: Deal with separators in data and complex types\n    parseComponentParameters(parameters, uriComponent = false) {\n        if (parameters === undefined || parameters === null || parameters.length === 0) {\n            return [];\n        }\n        if (typeof parameters === 'string') {\n            const list = [];\n            const params = parameters.split(this.separators.parameterSeparator);\n            for (const param of params) {\n                let key;\n                let value;\n                [key, value] = param.split(this.separators.parameterKeySeparator);\n                if (value === void 0) {\n                    value = uriComponent ? decodeURIComponent(key) : key;\n                    key = void 0;\n                }\n                else if (uriComponent) {\n                    key = decodeURIComponent(key);\n                    value = decodeURIComponent(value);\n                }\n                list.push({ key, value });\n            }\n            return list;\n        }\n        if (Array.isArray(parameters)) {\n            return parameters.map(param => ({ key: void 0, value: param }));\n        }\n        const keys = Object.keys(parameters);\n        keys.sort();\n        return keys.map(key => ({ key, value: parameters[key] }));\n    }\n    // TODO: Deal with separators in data and complex types\n    stringifyComponentParameters(parameters, uriComponent = false) {\n        if (!Array.isArray(parameters) || parameters.length === 0) {\n            return '';\n        }\n        const seps = this.separators;\n        return parameters\n            .map(param => {\n            const key = param.key !== void 0 && uriComponent ? encodeURIComponent(param.key) : param.key;\n            const value = uriComponent ? encodeURIComponent(param.value) : param.value;\n            return key !== void 0 && key !== value ? key + seps.parameterKeySeparator + value : value;\n        })\n            .join(seps.parameterSeparator);\n    }\n    matchScope(instructions, scope) {\n        const matching = [];\n        matching.push(...instructions.filter(instruction => instruction.scope === scope));\n        matching.push(...instructions\n            .filter(instr => instr.scope !== scope)\n            .map(instr => Array.isArray(instr.nextScopeInstructions) ? this.matchScope(instr.nextScopeInstructions, scope) : [])\n            .flat());\n        return matching;\n    }\n    matchChildren(instructions, active) {\n        for (const instruction of instructions) {\n            const matching = active.filter(instr => instr.sameComponent(instruction));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    parseViewportInstructionsWorker(instructions, grouped = false) {\n        if (!instructions) {\n            return { instructions: [], remaining: '' };\n        }\n        if (instructions.startsWith(this.separators.scopeStart)) {\n            instructions = `${this.separators.scope}${instructions}`;\n        }\n        const viewportInstructions = [];\n        let guard = 1000;\n        while (instructions.length && guard) {\n            guard--;\n            if (instructions.startsWith(this.separators.scope)) {\n                instructions = instructions.slice(this.separators.scope.length);\n                const scopeStart = instructions.startsWith(this.separators.scopeStart);\n                if (scopeStart) {\n                    instructions = instructions.slice(this.separators.scopeStart.length);\n                }\n                const { instructions: found, remaining } = this.parseViewportInstructionsWorker(instructions, scopeStart);\n                if (viewportInstructions.length) {\n                    viewportInstructions[viewportInstructions.length - 1].nextScopeInstructions = found;\n                }\n                else {\n                    viewportInstructions.push(...found);\n                }\n                instructions = remaining;\n            }\n            else if (instructions.startsWith(this.separators.scopeEnd)) {\n                if (grouped) {\n                    instructions = instructions.slice(this.separators.scopeEnd.length);\n                }\n                return { instructions: viewportInstructions, remaining: instructions };\n            }\n            else if (instructions.startsWith(this.separators.sibling) && !this.isAddViewportInstruction(instructions)) {\n                if (!grouped) {\n                    return { instructions: viewportInstructions, remaining: instructions };\n                }\n                instructions = instructions.slice(this.separators.sibling.length);\n            }\n            else {\n                const { instruction: viewportInstruction, remaining } = this.parseAViewportInstruction(instructions);\n                viewportInstructions.push(viewportInstruction);\n                instructions = remaining;\n            }\n        }\n        return { instructions: viewportInstructions, remaining: instructions };\n    }\n    findNextToken(instruction, tokens) {\n        const matches = {};\n        // Tokens can have length > 1\n        for (const token of tokens) {\n            const tokenPos = instruction.indexOf(token);\n            if (tokenPos > -1) {\n                matches[token] = instruction.indexOf(token);\n            }\n        }\n        const pos = Math.min(...Object.values(matches));\n        for (const token in matches) {\n            if (matches[token] === pos) {\n                return { token, pos };\n            }\n        }\n        return { token: '', pos: -1 };\n    }\n    parseAViewportInstruction(instruction) {\n        const seps = this.separators;\n        const tokens = [seps.parameters, seps.viewport, seps.noScope, seps.scopeEnd, seps.scope, seps.sibling];\n        let component = void 0;\n        let parametersString = void 0;\n        let viewport = void 0;\n        let scope = true;\n        let token;\n        let pos;\n        const specials = [seps.add, seps.clear];\n        for (const special of specials) {\n            if (instruction === special) {\n                component = instruction;\n                instruction = '';\n                tokens.shift(); // parameters\n                tokens.shift(); // viewport\n                token = seps.viewport;\n                break;\n            }\n        }\n        if (component === void 0) {\n            for (const special of specials) {\n                if (instruction.startsWith(`${special}${seps.viewport}`)) {\n                    component = special;\n                    instruction = instruction.slice(`${special}${seps.viewport}`.length);\n                    tokens.shift(); // parameters\n                    tokens.shift(); // viewport\n                    token = seps.viewport;\n                    break;\n                }\n            }\n        }\n        if (component === void 0) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            component = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n            tokens.shift(); // parameters\n            if (token === seps.parameters) {\n                ({ token, pos } = this.findNextToken(instruction, [seps.parametersEnd]));\n                parametersString = instruction.slice(0, pos);\n                instruction = instruction.slice(pos + token.length);\n                ({ token } = this.findNextToken(instruction, tokens));\n                instruction = instruction.slice(token.length);\n            }\n            tokens.shift(); // viewport\n        }\n        if (token === seps.viewport) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            viewport = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n        }\n        tokens.shift(); // noScope\n        if (token === seps.noScope) {\n            scope = false;\n        }\n        // Restore token that belongs to next instruction\n        if (token === seps.scopeEnd || token === seps.scope || token === seps.sibling) {\n            instruction = `${token}${instruction}`;\n        }\n        const viewportInstruction = this.createViewportInstruction(component, viewport, parametersString, scope);\n        return { instruction: viewportInstruction, remaining: instruction };\n    }\n    stringifyAViewportInstruction(instruction, excludeViewport = false, excludeComponent = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyViewportInstruction(this.parseViewportInstruction(instruction), excludeViewport, excludeComponent);\n        }\n        else {\n            let instructionString = !excludeComponent ? instruction.componentName : '';\n            const specification = instruction.componentType ? instruction.componentType.parameters : null;\n            const parameters = this.stringifyComponentParameters(instruction.toSortedParameters(specification));\n            if (parameters.length > 0) {\n                instructionString += !excludeComponent\n                    ? `${this.separators.parameters}${parameters}${this.separators.parametersEnd}`\n                    : parameters;\n            }\n            if (instruction.viewportName !== null && !excludeViewport) {\n                instructionString += this.separators.viewport + instruction.viewportName;\n            }\n            if (!instruction.ownsScope) {\n                instructionString += this.separators.noScope;\n            }\n            return instructionString || '';\n        }\n    }\n}\n//# sourceMappingURL=instruction-resolver.js.map","export var ReentryBehavior;\n(function (ReentryBehavior) {\n    ReentryBehavior[\"default\"] = \"default\";\n    ReentryBehavior[\"disallow\"] = \"disallow\";\n    ReentryBehavior[\"load\"] = \"load\";\n    ReentryBehavior[\"refresh\"] = \"refresh\";\n})(ReentryBehavior || (ReentryBehavior = {}));\n//# sourceMappingURL=interfaces.js.map","import { Hook } from './hook';\n/**\n * Public API\n */\nexport var HookTypes;\n(function (HookTypes) {\n    HookTypes[\"BeforeNavigation\"] = \"beforeNavigation\";\n    HookTypes[\"TransformFromUrl\"] = \"transformFromUrl\";\n    HookTypes[\"TransformToUrl\"] = \"transformToUrl\";\n    HookTypes[\"SetTitle\"] = \"setTitle\";\n})(HookTypes || (HookTypes = {}));\n/**\n * @internal - Shouldn't be used directly\n */\nexport class HookManager {\n    constructor() {\n        this.hooks = {\n            beforeNavigation: [],\n            transformFromUrl: [],\n            transformToUrl: [],\n            setTitle: [],\n        };\n        this.lastIdentity = 0;\n    }\n    addHook(hookFunction, options) {\n        const hook = new Hook(hookFunction, options || {}, ++this.lastIdentity);\n        this.hooks[hook.type].push(hook);\n        return this.lastIdentity;\n    }\n    removeHook(id) {\n        for (const type in this.hooks) {\n            if (Object.prototype.hasOwnProperty.call(this.hooks, type)) {\n                const index = this.hooks[type].findIndex(hook => hook.id === id);\n                if (index >= 0) {\n                    this.hooks[type].splice(index, 1);\n                }\n            }\n        }\n    }\n    async invokeBeforeNavigation(viewportInstructions, navigationInstruction) {\n        return this.invoke(\"beforeNavigation\" /* BeforeNavigation */, navigationInstruction, viewportInstructions);\n    }\n    async invokeTransformFromUrl(url, navigationInstruction) {\n        return this.invoke(\"transformFromUrl\" /* TransformFromUrl */, navigationInstruction, url);\n    }\n    async invokeTransformToUrl(state, navigationInstruction) {\n        return this.invoke(\"transformToUrl\" /* TransformToUrl */, navigationInstruction, state);\n    }\n    async invokeSetTitle(title, navigationInstruction) {\n        return this.invoke(\"setTitle\" /* SetTitle */, navigationInstruction, title);\n    }\n    async invoke(type, navigationInstruction, arg) {\n        for (const hook of this.hooks[type]) {\n            if (!hook.wantsMatch || hook.matches(arg)) {\n                const outcome = await hook.invoke(navigationInstruction, arg);\n                if (typeof outcome === 'boolean') {\n                    if (!outcome) {\n                        return false;\n                    }\n                }\n                else {\n                    arg = outcome;\n                }\n            }\n        }\n        return arg;\n    }\n}\n//# sourceMappingURL=hook-manager.js.map","import { ComponentAppellationResolver, ViewportHandleResolver } from './type-resolvers';\nimport { ViewportInstruction } from './viewport-instruction';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Hook {\n    constructor(hook, options, id) {\n        this.hook = hook;\n        this.id = id;\n        this.type = \"beforeNavigation\" /* BeforeNavigation */;\n        this.includeTargets = [];\n        this.excludeTargets = [];\n        if (options.type !== void 0) {\n            this.type = options.type;\n        }\n        for (const target of options.include || []) {\n            this.includeTargets.push(new Target(target));\n        }\n        for (const target of options.exclude || []) {\n            this.excludeTargets.push(new Target(target));\n        }\n    }\n    get wantsMatch() {\n        return this.includeTargets.length > 0 || this.excludeTargets.length > 0;\n    }\n    matches(viewportInstructions) {\n        if (this.includeTargets.length && !this.includeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        if (this.excludeTargets.length && this.excludeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        return true;\n    }\n    invoke(navigationInstruction, arg) {\n        // TODO: Fix the type here\n        return this.hook(arg, navigationInstruction);\n    }\n}\nclass Target {\n    constructor(target) {\n        this.componentType = null;\n        this.componentName = null;\n        this.viewport = null;\n        this.viewportName = null;\n        if (typeof target === 'string') {\n            this.componentName = target;\n        }\n        else if (ComponentAppellationResolver.isType(target)) {\n            this.componentType = target;\n            this.componentName = ComponentAppellationResolver.getName(target);\n        }\n        else {\n            const cvTarget = target;\n            if (cvTarget.component) {\n                this.componentType = ComponentAppellationResolver.isType(cvTarget.component)\n                    ? ComponentAppellationResolver.getType(cvTarget.component)\n                    : null;\n                this.componentName = ComponentAppellationResolver.getName(cvTarget.component);\n            }\n            if (cvTarget.viewport) {\n                this.viewport = ViewportHandleResolver.isInstance(cvTarget.viewport) ? cvTarget.viewport : null;\n                this.viewportName = ViewportHandleResolver.getName(cvTarget.viewport);\n            }\n        }\n    }\n    matches(viewportInstructions) {\n        const instructions = viewportInstructions.slice();\n        if (!instructions.length) {\n            // instructions.push(new ViewportInstruction(''));\n            instructions.push(ViewportInstruction.create(null, ''));\n        }\n        for (const instruction of instructions) {\n            if ((this.componentName !== null && this.componentName === instruction.componentName) ||\n                (this.componentType !== null && this.componentType === instruction.componentType) ||\n                (this.viewportName !== null && this.viewportName === instruction.viewportName) ||\n                (this.viewport !== null && this.viewport === instruction.viewport)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=hook.js.map","import { ComponentAppellationResolver, NavigationInstructionResolver } from './type-resolvers';\n/**\n * @internal - Used by au-nav\n */\nexport class NavRoute {\n    constructor(nav, route) {\n        this.nav = nav;\n        this.instructions = [];\n        this.link = null;\n        this.linkVisible = null;\n        this.linkActive = null;\n        this.compareParameters = false;\n        this.children = null;\n        this.visible = true;\n        this.active = '';\n        this.title = route.title;\n        this.meta = route.meta;\n        if (route.route) {\n            this.instructions = this.parseRoute(route.route);\n            this.link = this.computeLink(this.instructions);\n        }\n        this.linkActive = route.consideredActive !== null && route.consideredActive !== void 0 ? route.consideredActive : this.link;\n        if (this.linkActive !== null && (!(this.linkActive instanceof Function) || ComponentAppellationResolver.isType(this.linkActive))) {\n            this.linkActive = NavigationInstructionResolver.toViewportInstructions(this.nav.router, this.linkActive);\n        }\n        this.execute = route.execute;\n        this.compareParameters = !!route.compareParameters;\n        this.linkVisible = route.condition === undefined ? true : route.condition;\n        this.update();\n    }\n    get hasChildren() {\n        return (this.children && this.children.length ? 'nav-has-children' : '');\n    }\n    update() {\n        this.visible = this.computeVisible();\n        if ((this.link && this.link.length) || this.execute) {\n            this.active = this.computeActive();\n        }\n        else {\n            this.active = (this.active === 'nav-active' ? 'nav-active' : (this.activeChild() ? 'nav-active-child' : ''));\n        }\n    }\n    executeAction(event) {\n        if (this.execute) {\n            this.execute(this);\n        }\n        event.stopPropagation();\n    }\n    toggleActive() {\n        this.active = (this.active.startsWith('nav-active') ? '' : 'nav-active');\n    }\n    parseRoute(routes) {\n        return NavigationInstructionResolver.toViewportInstructions(this.nav.router, routes);\n    }\n    computeVisible() {\n        if (this.linkVisible instanceof Function) {\n            return this.linkVisible(this);\n        }\n        return !!this.linkVisible;\n    }\n    computeActive() {\n        if (!Array.isArray(this.linkActive)) {\n            return this.linkActive(this) ? 'nav-active' : '';\n        }\n        const components = this.linkActive;\n        const activeComponents = this.nav.router.instructionResolver.flattenViewportInstructions(this.nav.router.activeComponents);\n        for (const component of components) {\n            if (activeComponents.every((active) => !active.sameComponent(component, this.compareParameters && component.typedParameters !== null))) {\n                return '';\n            }\n        }\n        return 'nav-active';\n    }\n    computeLink(instructions) {\n        return this.nav.router.instructionResolver.stringifyViewportInstructions(instructions);\n    }\n    activeChild() {\n        if (this.children) {\n            for (const child of this.children) {\n                if (child.active.startsWith('nav-active') || child.activeChild()) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=nav-route.js.map","import { NavRoute } from './nav-route';\n/**\n * Public API - Used by au-nav and Router add/setNav\n */\nexport class Nav {\n    constructor(router, name, routes = [], classes = {}) {\n        this.router = router;\n        this.name = name;\n        this.routes = routes;\n        this.classes = classes;\n        this.update();\n    }\n    addRoutes(routes) {\n        for (const route of routes) {\n            this.addRoute(this.routes, route);\n        }\n        this.update();\n    }\n    update() {\n        this.updateRoutes(this.routes);\n        this.routes = this.routes.slice();\n    }\n    addRoute(routes, route) {\n        const newRoute = new NavRoute(this, route);\n        routes.push(newRoute);\n        if (route.children) {\n            newRoute.children = [];\n            for (const child of route.children) {\n                this.addRoute(newRoute.children, child);\n            }\n        }\n    }\n    updateRoutes(routes) {\n        for (const route of routes) {\n            route.update();\n            if (route.children && route.children.length) {\n                this.updateRoutes(route.children);\n            }\n        }\n    }\n}\n//# sourceMappingURL=nav.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bound } from '@aurelia/kernel';\n/**\n * A first-in-first-out queue that only processes the next queued item\n * when the current one has been resolved or rejected. Sends queued items\n * one at a time to a specified callback function. The callback function\n * should resolve or reject the queued item when processing is done.\n * Enqueued items can be awaited. Enqueued items can specify an (arbitrary)\n * execution cost and the queue can be set up (started) to only process\n * a specific amount of execution cost per RAF/tick.\n *\n * @internal - Shouldn't be used directly.\n */\nlet Queue = /** @class */ (() => {\n    class Queue {\n        constructor(callback) {\n            this.callback = callback;\n            this.pending = [];\n            this.processing = null;\n            this.allowedExecutionCostWithinTick = null;\n            this.currentExecutionCostInCurrentTick = 0;\n            this.scheduler = null;\n            this.task = null;\n        }\n        get isActive() {\n            return this.task !== null;\n        }\n        get length() {\n            return this.pending.length;\n        }\n        start(options) {\n            if (this.isActive) {\n                throw new Error('Queue has already been started');\n            }\n            this.scheduler = options.scheduler;\n            this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n            this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n        }\n        stop() {\n            if (!this.isActive) {\n                throw new Error('Queue has not been started');\n            }\n            this.task.cancel();\n            this.task = null;\n            this.allowedExecutionCostWithinTick = null;\n            this.clear();\n        }\n        enqueue(itemOrItems, costOrCosts) {\n            const list = Array.isArray(itemOrItems);\n            const items = list ? itemOrItems : [itemOrItems];\n            const costs = items\n                .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n                .map(value => value !== undefined ? value : 1);\n            const promises = [];\n            for (const item of items) {\n                const qItem = { ...item };\n                qItem.cost = costs.shift();\n                promises.push(new Promise((resolve, reject) => {\n                    qItem.resolve = () => {\n                        resolve();\n                        this.processing = null;\n                        this.dequeue();\n                    };\n                    qItem.reject = (reason) => {\n                        reject(reason);\n                        this.processing = null;\n                        this.dequeue();\n                    };\n                }));\n                this.pending.push(qItem);\n            }\n            this.dequeue();\n            return list ? promises : promises[0];\n        }\n        dequeue(delta) {\n            if (this.processing !== null) {\n                return;\n            }\n            if (delta !== undefined) {\n                this.currentExecutionCostInCurrentTick = 0;\n            }\n            if (!this.pending.length) {\n                return;\n            }\n            if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n                return;\n            }\n            this.processing = this.pending.shift() || null;\n            if (this.processing) {\n                this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n                this.callback(this.processing);\n            }\n        }\n        clear() {\n            this.pending.splice(0, this.pending.length);\n        }\n    }\n    __decorate([\n        bound,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", [Number]),\n        __metadata(\"design:returntype\", void 0)\n    ], Queue.prototype, \"dequeue\", null);\n    return Queue;\n})();\nexport { Queue };\n//# sourceMappingURL=queue.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Queue } from './queue';\nimport { Navigation } from './navigation';\nimport { Runner } from './runner';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Navigator {\n    constructor() {\n        this.entries = [];\n        this.options = {\n            statefulHistoryLength: 0,\n        };\n        this.isActive = false;\n        this.processNavigations = (qEntry) => {\n            const entry = qEntry;\n            const navigationFlags = {\n                first: false,\n                new: false,\n                refresh: false,\n                forward: false,\n                back: false,\n                replace: false,\n            };\n            if (this.currentEntry === this.uninitializedEntry) { // Refresh or first entry\n                this.loadState();\n                if (this.currentEntry !== this.uninitializedEntry) {\n                    navigationFlags.refresh = true;\n                }\n                else {\n                    navigationFlags.first = true;\n                    navigationFlags.new = true;\n                    // TODO: Should this really be created here? Shouldn't it be in the viewer?\n                    this.currentEntry = new Navigation({\n                        index: 0,\n                        instruction: '',\n                        fullStateInstruction: '',\n                    });\n                    this.entries = [];\n                }\n            }\n            if (entry.index !== void 0 && !entry.replacing && !entry.refreshing) { // History navigation\n                entry.historyMovement = entry.index - (this.currentEntry.index !== void 0 ? this.currentEntry.index : 0);\n                entry.instruction = this.entries[entry.index] !== void 0 && this.entries[entry.index] !== null ? this.entries[entry.index].fullStateInstruction : entry.fullStateInstruction;\n                entry.replacing = true;\n                if (entry.historyMovement > 0) {\n                    navigationFlags.forward = true;\n                }\n                else if (entry.historyMovement < 0) {\n                    navigationFlags.back = true;\n                }\n            }\n            else if (entry.refreshing || navigationFlags.refresh) { // Refreshing\n                entry.index = this.currentEntry.index;\n            }\n            else if (entry.replacing) { // Replacing\n                navigationFlags.replace = true;\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index;\n            }\n            else { // New entry\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index !== void 0 ? this.currentEntry.index + 1 : this.entries.length;\n            }\n            this.invokeCallback(entry, navigationFlags, this.currentEntry);\n        };\n        this.uninitializedEntry = new Navigation({\n            instruction: 'NAVIGATOR UNINITIALIZED',\n            fullStateInstruction: '',\n        });\n        this.currentEntry = this.uninitializedEntry;\n        this.pendingNavigations = new Queue(this.processNavigations);\n    }\n    get queued() {\n        return this.pendingNavigations.length;\n    }\n    start(router, options) {\n        if (this.isActive) {\n            throw new Error('Navigator has already been started');\n        }\n        this.isActive = true;\n        this.router = router;\n        this.options = { ...options };\n    }\n    stop() {\n        if (!this.isActive) {\n            throw new Error('Navigator has not been started');\n        }\n        this.pendingNavigations.clear();\n        this.isActive = false;\n    }\n    async navigate(entry) {\n        return this.pendingNavigations.enqueue(entry);\n    }\n    async refresh() {\n        const entry = this.currentEntry;\n        if (entry === this.uninitializedEntry) {\n            return Promise.reject();\n        }\n        entry.replacing = true;\n        entry.refreshing = true;\n        return this.navigate(entry);\n    }\n    async go(movement) {\n        const newIndex = (this.currentEntry.index !== undefined ? this.currentEntry.index : 0) + movement;\n        if (newIndex >= this.entries.length) {\n            return Promise.reject();\n        }\n        const entry = this.entries[newIndex];\n        return this.navigate(entry);\n    }\n    async setEntryTitle(title) {\n        this.currentEntry.title = title;\n        return this.saveState();\n    }\n    get titles() {\n        if (this.currentEntry === this.uninitializedEntry) {\n            return [];\n        }\n        const index = this.currentEntry.index !== void 0 ? this.currentEntry.index : 0;\n        return this.entries.slice(0, index + 1).filter((value) => !!value.title).map((value) => value.title ? value.title : '');\n    }\n    // Get the stored navigator state (json okay)\n    getState() {\n        var _a, _b;\n        const state = this.options.store ? { ...this.options.store.state } : {};\n        const entries = ((_a = state.entries) !== null && _a !== void 0 ? _a : []);\n        const currentEntry = ((_b = state.currentEntry) !== null && _b !== void 0 ? _b : null);\n        return { state, entries, currentEntry };\n    }\n    // Load a stored state into Navigation entries\n    loadState() {\n        const state = this.getState();\n        this.entries = state.entries.map(entry => new Navigation(entry));\n        this.currentEntry = state.currentEntry !== null\n            ? new Navigation(state.currentEntry)\n            : this.uninitializedEntry;\n    }\n    // Save storeable versions of Navigation entries\n    async saveState(push = false) {\n        var _a;\n        if (this.currentEntry === this.uninitializedEntry) {\n            return Promise.resolve();\n        }\n        const storedEntry = this.currentEntry.toStored();\n        this.entries[storedEntry.index !== void 0 ? storedEntry.index : 0] = new Navigation(storedEntry);\n        // If preserving history, serialize entries that aren't preserved\n        if (this.options.statefulHistoryLength > 0) {\n            const index = this.entries.length - this.options.statefulHistoryLength;\n            for (let i = 0; i < index; i++) {\n                const entry = this.entries[i];\n                if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                    await this.serializeEntry(entry, this.entries.slice(index));\n                }\n            }\n        }\n        if (!this.options.store) {\n            return Promise.resolve();\n        }\n        const state = {\n            entries: ((_a = this.entries) !== null && _a !== void 0 ? _a : []).map((entry) => this.toStoreableEntry(entry)),\n            currentEntry: this.toStoreableEntry(storedEntry),\n        };\n        // for (const entry of this.entries) {\n        //   state.entries.push(this.toStoreableEntry(entry));\n        // }\n        if (state.currentEntry.title !== void 0) {\n            this.options.store.setTitle(state.currentEntry.title);\n        }\n        if (push) {\n            return this.options.store.pushNavigatorState(state);\n        }\n        else {\n            return this.options.store.replaceNavigatorState(state);\n        }\n    }\n    toStoredEntry(entry) {\n        const { previous, fromBrowser, origin, replacing, refreshing, untracked, historyMovement, navigation, scope, resolve, reject, ...storableEntry } = entry;\n        return storableEntry;\n    }\n    async finalize(instruction) {\n        this.currentEntry = instruction;\n        let index = this.currentEntry.index !== undefined ? this.currentEntry.index : 0;\n        if (this.currentEntry.untracked) {\n            if (instruction.fromBrowser && this.options.store) {\n                await this.options.store.popNavigatorState();\n            }\n            index--;\n            this.currentEntry.index = index;\n            this.entries[index] = this.currentEntry;\n            await this.saveState();\n        }\n        else if (this.currentEntry.replacing) {\n            this.entries[index] = this.currentEntry;\n            await this.saveState();\n        }\n        else { // New entry (add and discard later entries)\n            if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n                // Need to clear the instructions we discard!\n                const indexPreserve = this.entries.length - this.options.statefulHistoryLength;\n                for (const entry of this.entries.slice(index)) {\n                    if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                        await this.options.serializeCallback(entry, this.entries.slice(indexPreserve, index));\n                    }\n                }\n            }\n            this.entries = this.entries.slice(0, index);\n            this.entries.push(this.currentEntry);\n            await this.saveState(true);\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    async cancel(instruction) {\n        if (instruction.fromBrowser && this.options.store) {\n            if (instruction.navigation && instruction.navigation.new) {\n                await this.options.store.popNavigatorState();\n            }\n            else {\n                await this.options.store.go(-(instruction.historyMovement || 0), true);\n            }\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    invokeCallback(entry, navigationFlags, previousEntry) {\n        const instruction = new Navigation({ ...entry });\n        instruction.navigation = navigationFlags;\n        instruction.previous = previousEntry;\n        Reporter.write(10000, 'callback', instruction, instruction.previous, this.entries);\n        if (this.options.callback) {\n            this.options.callback(instruction);\n        }\n    }\n    toStoreableEntry(entry) {\n        const storeable = entry instanceof Navigation ? entry.toStored() : entry;\n        storeable.instruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.instruction);\n        storeable.fullStateInstruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.fullStateInstruction);\n        if (typeof storeable.scope !== 'string') {\n            storeable.scope = null;\n        }\n        return storeable;\n    }\n    async serializeEntry(entry, preservedEntries) {\n        const instructionResolver = this.router.instructionResolver;\n        let excludeComponents = [];\n        // Components in preserved entries should not be serialized/freed\n        for (const preservedEntry of preservedEntries) {\n            if (typeof preservedEntry.instruction !== 'string') {\n                excludeComponents.push(...instructionResolver.flattenViewportInstructions(preservedEntry.instruction)\n                    .filter(instruction => instruction.viewport !== null)\n                    .map(instruction => instruction.componentInstance));\n            }\n            if (typeof preservedEntry.fullStateInstruction !== 'string') {\n                excludeComponents.push(...instructionResolver.flattenViewportInstructions(preservedEntry.fullStateInstruction)\n                    .filter(instruction => instruction.viewport !== null)\n                    .map(instruction => instruction.componentInstance));\n            }\n        }\n        // Make unique\n        excludeComponents = excludeComponents.filter((component, i, arr) => component !== null && arr.indexOf(component) === i);\n        let instructions = [];\n        // The instructions, one or two, with possible components to free\n        if (typeof entry.fullStateInstruction !== 'string') {\n            instructions.push(...entry.fullStateInstruction);\n            entry.fullStateInstruction = instructionResolver.stringifyViewportInstructions(entry.fullStateInstruction);\n        }\n        if (typeof entry.instruction !== 'string') {\n            instructions.push(...entry.instruction);\n            entry.instruction = instructionResolver.stringifyViewportInstructions(entry.instruction);\n        }\n        // Process only those with instances and make unique\n        instructions = instructions.filter((instruction, i, arr) => instruction !== null\n            && instruction.componentInstance !== null\n            && arr.indexOf(instruction) === i);\n        // Already freed components (updated when component is freed)\n        const alreadyDone = [];\n        for (const instruction of instructions) {\n            await this.freeInstructionComponents(instruction, excludeComponents, alreadyDone);\n        }\n    }\n    freeInstructionComponents(instruction, excludeComponents, alreadyDone) {\n        const component = instruction.componentInstance;\n        const viewport = instruction.viewport;\n        if (component === null || viewport === null || alreadyDone.some(done => done === component)) {\n            return;\n        }\n        if (!excludeComponents.some(exclude => exclude === component)) {\n            return Runner.run(() => viewport.freeContent(component), () => {\n                alreadyDone.push(component);\n            });\n        }\n        if (instruction.nextScopeInstructions !== null) {\n            for (const nextInstruction of instruction.nextScopeInstructions) {\n                return Runner.run(() => this.freeInstructionComponents(nextInstruction, excludeComponents, alreadyDone));\n            }\n        }\n    }\n}\n//# sourceMappingURL=navigator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bound } from '@aurelia/kernel';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class QueueTask {\n    constructor(taskQueue, item, cost = 0) {\n        this.taskQueue = taskQueue;\n        this.item = item;\n        this.cost = cost;\n        this.done = false;\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve = () => {\n                this.taskQueue.resolve(this, resolve);\n            };\n            this.reject = (reason) => {\n                this.taskQueue.reject(this, reject, reason);\n            };\n        });\n    }\n    async execute() {\n        if ('execute' in this.item) {\n            await this.item.execute(this);\n        }\n        else {\n            await this.item(this);\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() { return; }\n}\n/**\n * A first-in-first-out task queue that only processes the next queued item\n * when the current one has been resolved or rejected. If a callback function\n * is specified, it receives the queued items as tasks one at a time. If no\n * callback is specified, the tasks themselves are either executed (if a\n * function) or the execute method in them are run. The executed function\n * should resolve or reject the task when processing is done.\n * Enqueued items' tasks can be awaited. Enqueued items can specify an\n * (arbitrary) execution cost and the queue can be set up (started) to\n * only process a specific amount of execution cost per RAF/tick.\n *\n * @internal - Shouldn't be used directly.\n */\nlet TaskQueue = /** @class */ (() => {\n    class TaskQueue {\n        constructor(callback) {\n            this.callback = callback;\n            this.pending = [];\n            this.processing = null;\n            this.allowedExecutionCostWithinTick = null;\n            this.currentExecutionCostInCurrentTick = 0;\n            this.scheduler = null;\n            this.task = null;\n        }\n        get isActive() {\n            return this.task !== null;\n        }\n        get length() {\n            return this.pending.length;\n        }\n        start(options) {\n            if (this.isActive) {\n                throw new Error('TaskQueue has already been started');\n            }\n            this.scheduler = options.scheduler;\n            this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n            this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n        }\n        stop() {\n            if (!this.isActive) {\n                throw new Error('TaskQueue has not been started');\n            }\n            this.task.cancel();\n            this.task = null;\n            this.allowedExecutionCostWithinTick = null;\n            this.clear();\n        }\n        enqueue(itemOrItems, costOrCosts) {\n            const list = Array.isArray(itemOrItems);\n            const items = (list ? itemOrItems : [itemOrItems]);\n            const costs = items\n                .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n                .map((value) => value !== undefined ? value : 1);\n            const tasks = [];\n            for (const item of items) {\n                tasks.push(item instanceof QueueTask\n                    ? item\n                    : this.createQueueTask(item, costs.shift())); // TODO: Get cancellable in as well\n            }\n            this.pending.push(...tasks);\n            this.dequeue();\n            return list ? tasks : tasks[0];\n        }\n        createQueueTask(item, cost) {\n            return new QueueTask(this, item, cost);\n        }\n        dequeue(delta) {\n            var _a;\n            if (this.processing !== null) {\n                return;\n            }\n            if (delta !== undefined) {\n                this.currentExecutionCostInCurrentTick = 0;\n            }\n            if (!this.pending.length) {\n                return;\n            }\n            if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n                return;\n            }\n            this.processing = this.pending.shift() || null;\n            if (this.processing) {\n                this.currentExecutionCostInCurrentTick += (_a = this.processing.cost) !== null && _a !== void 0 ? _a : 0;\n                if (this.callback !== void 0) {\n                    this.callback(this.processing);\n                }\n                else {\n                    // Don't need to await this since next task won't be dequeued until\n                    // executed function is resolved\n                    this.processing.execute().catch(error => { throw error; });\n                }\n            }\n        }\n        clear() {\n            this.pending.splice(0, this.pending.length);\n        }\n        resolve(task, resolve) {\n            resolve();\n            this.processing = null;\n            this.dequeue();\n        }\n        reject(task, reject, reason) {\n            reject(reason);\n            this.processing = null;\n            this.dequeue();\n        }\n    }\n    __decorate([\n        bound,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", [Number]),\n        __metadata(\"design:returntype\", void 0)\n    ], TaskQueue.prototype, \"dequeue\", null);\n    return TaskQueue;\n})();\nexport { TaskQueue };\n//# sourceMappingURL=task-queue.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IScheduler } from '@aurelia/runtime';\nimport { TaskQueue } from './task-queue';\nimport { IWindow, IHistory, ILocation } from '@aurelia/runtime-html';\n/**\n * @internal - Shouldn't be used directly\n */\nlet BrowserViewerStore = /** @class */ (() => {\n    let BrowserViewerStore = class BrowserViewerStore {\n        constructor(scheduler, window, history, location) {\n            this.scheduler = scheduler;\n            this.window = window;\n            this.history = history;\n            this.location = location;\n            this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n            this.isActive = false;\n            this.options = {\n                useUrlFragmentHash: true,\n                callback: () => { return; },\n            };\n            this.forwardedState = { eventTask: null, suppressPopstate: false };\n            this.handlePopstate = async (event) => {\n                const { eventTask, suppressPopstate } = this.forwardedState;\n                this.forwardedState = { eventTask: null, suppressPopstate: false };\n                return this.pendingCalls.enqueue(async (task) => {\n                    const store = this;\n                    const ev = event;\n                    const evTask = eventTask;\n                    const suppressPopstateEvent = suppressPopstate;\n                    await store.popstate(ev, evTask, suppressPopstateEvent);\n                    task.resolve();\n                }, 1).wait();\n            };\n            this.pendingCalls = new TaskQueue();\n        }\n        start(options) {\n            if (this.isActive) {\n                throw new Error('Browser navigation has already been started');\n            }\n            this.isActive = true;\n            this.options.callback = options.callback;\n            if (options.useUrlFragmentHash != void 0) {\n                this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n            }\n            this.pendingCalls.start({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n            this.window.addEventListener('popstate', this.handlePopstate);\n        }\n        stop() {\n            if (!this.isActive) {\n                throw new Error('Browser navigation has not been started');\n            }\n            this.window.removeEventListener('popstate', this.handlePopstate);\n            this.pendingCalls.stop();\n            this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n            this.isActive = false;\n        }\n        get length() {\n            return this.history.length;\n        }\n        get state() {\n            return this.history.state;\n        }\n        get viewerState() {\n            const { pathname, search, hash } = this.location;\n            return {\n                path: pathname,\n                query: search,\n                hash,\n                instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n            };\n        }\n        async go(delta, suppressPopstateEvent = false) {\n            const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n            this.pendingCalls.enqueue([\n                (task) => {\n                    const store = this;\n                    const eventTask = doneTask;\n                    const suppressPopstate = suppressPopstateEvent;\n                    store.forwardState({ eventTask, suppressPopstate });\n                    task.resolve();\n                },\n                (task) => {\n                    const history = this.history;\n                    const steps = delta;\n                    history.go(steps);\n                    task.resolve();\n                },\n            ], [0, 1]);\n            return doneTask.wait();\n        }\n        async pushNavigatorState(state) {\n            const { title, path } = state.currentEntry;\n            const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n            return this.pendingCalls.enqueue((task) => {\n                const history = this.history;\n                const data = state;\n                const titleOrEmpty = title || '';\n                const url = `${fragment}${path}`;\n                history.pushState(data, titleOrEmpty, url);\n                task.resolve();\n            }, 1).wait();\n        }\n        async replaceNavigatorState(state) {\n            const { title, path } = state.currentEntry;\n            const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n            return this.pendingCalls.enqueue((task) => {\n                const history = this.history;\n                const data = state;\n                const titleOrEmpty = title || '';\n                const url = `${fragment}${path}`;\n                history.replaceState(data, titleOrEmpty, url);\n                task.resolve();\n            }, 1).wait();\n        }\n        async popNavigatorState() {\n            const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n            this.pendingCalls.enqueue(async (task) => {\n                const store = this;\n                const eventTask = doneTask;\n                await store.popState(eventTask);\n                task.resolve();\n            }, 1);\n            return doneTask.wait();\n        }\n        async popState(doneTask) {\n            await this.go(-1, true);\n            const state = this.history.state;\n            // TODO: Fix browser forward bug after pop on first entry\n            if (state && state.currentEntry && !state.currentEntry.firstEntry) {\n                await this.go(-1, true);\n                await this.pushNavigatorState(state);\n            }\n            await doneTask.execute();\n        }\n        forwardState(state) {\n            this.forwardedState = state;\n        }\n        async popstate(ev, eventTask, suppressPopstate = false) {\n            if (!suppressPopstate) {\n                this.options.callback({\n                    ...this.viewerState,\n                    ...{\n                        event: ev,\n                        state: this.history.state,\n                    },\n                });\n            }\n            if (eventTask !== null) {\n                await eventTask.execute();\n            }\n        }\n        setTitle(title) {\n            this.window.document.title = title;\n        }\n    };\n    BrowserViewerStore = __decorate([\n        __param(0, IScheduler),\n        __param(1, IWindow),\n        __param(2, IHistory),\n        __param(3, ILocation),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n    ], BrowserViewerStore);\n    return BrowserViewerStore;\n})();\nexport { BrowserViewerStore };\n//# sourceMappingURL=browser-viewer-store.js.map","import { OpenPromise } from './open-promise';\nexport class Entity {\n    constructor(entity) {\n        this.entity = entity;\n        this.running = false;\n        this.states = [];\n        this.checkedStates = [];\n        this.syncState = null;\n        this.syncPromise = null;\n    }\n}\nexport class StateCoordinator {\n    constructor() {\n        this.entities = [];\n        this.hasAllEntities = false;\n        this.syncStates = new Map();\n        this.checkedSyncStates = new Set();\n    }\n    // public constructor(@ILogger private readonly logger: ILogger) {\n    //   this.logger = logger.root.scopeTo('StateCoordinator');\n    //   this.logger.trace('constructor()');\n    // }\n    addSyncState(state) {\n        const openPromise = new OpenPromise();\n        this.syncStates.set(state, openPromise);\n    }\n    addEntity(entity) {\n        // console.log('Entity received', entity);\n        const ent = new Entity(entity);\n        this.entities.push(ent);\n        this.resetSyncStates();\n        return ent;\n    }\n    addEntityState(entity, state) {\n        // console.log(`#### EntityState received ${state}`, (entity as any).name);\n        let ent = this.entities.find(e => e.entity === entity);\n        if (ent === void 0) {\n            ent = this.addEntity(entity);\n        }\n        ent.states.push(state);\n        this.checkSyncState(state);\n    }\n    syncState(state, entity = null) {\n        const openPromise = this.syncStates.get(state);\n        if (openPromise === void 0) {\n            return;\n        }\n        if (entity !== null) {\n            const ent = this.entities.find(e => e.entity === entity);\n            if ((ent === null || ent === void 0 ? void 0 : ent.syncPromise) === null && openPromise.isPending) {\n                ent.syncState = state;\n                ent.syncPromise = new OpenPromise();\n                ent.checkedStates.push(state);\n                this.checkedSyncStates.add(state);\n                Promise.resolve().then(() => { this.checkSyncState(state); }).catch(err => { throw err; });\n                return ent.syncPromise.promise;\n            }\n        }\n        // this.checkSyncState(state);\n        return openPromise.promise;\n    }\n    checkingSyncState(state) {\n        return this.syncStates.has(state);\n    }\n    finalEntity() {\n        this.hasAllEntities = true;\n        // console.log('Final entity received', this.entities.length);\n        this.syncStates.forEach((_promise, state) => this.checkSyncState(state));\n    }\n    finalize() { }\n    cancel() { }\n    // A new navigation should cancel replaced instructions\n    cancelReplaced(navigation) { }\n    checkSyncState(state) {\n        var _a;\n        // console.log('StateCoordinator check state', state, this);\n        const openPromise = this.syncStates.get(state);\n        if (openPromise === void 0) {\n            return;\n        }\n        if (this.hasAllEntities &&\n            openPromise.isPending &&\n            // Check that this state has been done by all state entities and if so resolve the promise\n            this.entities.every(ent => ent.states.includes(state)) &&\n            // Check that this state has been checked (reached) by all state entities and if so resolve the promise\n            (!this.checkedSyncStates.has(state) || this.entities.every(ent => ent.checkedStates.includes(state)))) {\n            for (const entity of this.entities) {\n                if (entity.syncState === state) {\n                    // console.log('Resolving entity promise for ', state, (entity.entity as any).toString());\n                    (_a = entity.syncPromise) === null || _a === void 0 ? void 0 : _a.resolve();\n                    entity.syncPromise = null;\n                    entity.syncState = null;\n                }\n            }\n            openPromise.resolve();\n            // console.log('#### StateCoordinator state resolved', state /*, this */);\n        }\n    }\n    resetSyncStates() {\n        this.syncStates.forEach((promise, state) => {\n            if (!promise.isPending &&\n                !this.entities.every(entity => entity.states.includes(state))) {\n                this.addSyncState(state);\n            }\n        });\n    }\n}\n//# sourceMappingURL=state-coordinator.js.map","import { StateCoordinator } from './state-coordinator';\nexport class NavigationCoordinatorOptions {\n    constructor(input) {\n        var _a;\n        // console.log('NavigationCoordinatorOptions constructor', input);\n        this.syncStates = (_a = input.syncStates) !== null && _a !== void 0 ? _a : [];\n    }\n}\nexport class NavigationCoordinator extends StateCoordinator {\n    constructor() {\n        super(...arguments);\n        this.running = false;\n    }\n    static create(router, navigation, options) {\n        const coordinator = new NavigationCoordinator();\n        coordinator.router = router;\n        coordinator.navigation = navigation;\n        // TODO: Set flow options from router\n        options.syncStates.forEach((state) => coordinator.addSyncState(state));\n        // console.log('NavigationCoordinator created', coordinator);\n        return coordinator;\n    }\n    // public get isRestrictedNavigation(): boolean {\n    //   return this.syncStates.has('guardedLoad') ||\n    //     this.syncStates.has('unloaded') ||\n    //     this.syncStates.has('loaded') ||\n    //     this.syncStates.has('guarded') ||\n    //     this.syncStates.has('routed');\n    // }\n    run() {\n        if (!this.running) {\n            // console.log('NavigationCoordinator RUN' /*, { ...this } */);\n            this.running = true;\n            for (const entity of this.entities) {\n                if (!entity.running) {\n                    entity.running = true;\n                    entity.entity.transition(this);\n                }\n            }\n        }\n    }\n    addEntity(entity) {\n        const ent = super.addEntity(entity);\n        if (this.running) {\n            ent.entity.transition(this);\n        }\n        return ent;\n    }\n    finalize() {\n        this.entities.forEach(entity => entity.entity.finalizeContentChange());\n    }\n    cancel() {\n        // TODO: Take care of disabling viewports when cancelling and stateful!\n        this.entities.forEach(entity => {\n            const abort = entity.entity.abortContentChange();\n            if (abort instanceof Promise) {\n                abort.catch(error => { throw error; });\n            }\n        });\n        this.router.navigator.cancel(this.navigation).then(() => {\n            this.router.processingNavigation = null;\n            this.navigation.resolve();\n        }).catch(error => { throw error; });\n    }\n    // A new navigation should cancel replaced instructions\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    cancelReplaced(navigation) { }\n}\n//# sourceMappingURL=navigation-coordinator.js.map","/* eslint-disable no-template-curly-in-string */\n/* eslint-disable prefer-template */\n/* eslint-disable max-lines-per-function */\nimport { DI, IContainer, Registration, Metadata } from '@aurelia/kernel';\nimport { Aurelia, CustomElement, DOM, isRenderContext } from '@aurelia/runtime';\nimport { InstructionResolver } from './instruction-resolver';\nimport { LinkHandler } from './link-handler';\nimport { Nav } from './nav';\nimport { Navigator } from './navigator';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { arrayRemove, deprecationWarning } from './utils';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nimport { FoundRoute } from './found-route';\nimport { HookManager } from './hook-manager';\nimport { Scope } from './scope';\nimport { ViewportScope } from './viewport-scope';\nimport { BrowserViewerStore } from './browser-viewer-store';\nimport { Navigation } from './navigation';\nimport { NavigationCoordinator } from './navigation-coordinator';\nimport { RouterOptions } from './router-options';\nimport { OpenPromise } from './open-promise';\n// export type SwapStrategy = 'add-first-sequential' | 'add-first-parallel' | 'remove-first-sequential' | 'remove-first-parallel';\n// export type RoutingHookIntegration = 'integrated' | 'separate';\n// /**\n//  * Public API\n//  */\n// export interface IRouterActivateOptions extends Omit<Partial<IRouterOptions>, 'title'> {\n//   title?: string | IRouterTitle;\n// }\n// /**\n//  * Public API\n//  */\n// export interface IRouterOptions extends INavigatorOptions {\n//   separators?: IRouteSeparators;\n//   useUrlFragmentHash: boolean;\n//   useHref: boolean;\n//   statefulHistoryLength: number;\n//   useDirectRoutes: boolean;\n//   useConfiguredRoutes: boolean;\n//   additiveInstructionDefault: boolean;\n//   title: ITitleConfiguration;\n//   hooks?: IHookDefinition[];\n//   reportCallback?(instruction: Navigation): void;\n//   navigationSyncStates: NavigationState[];\n//   swapStrategy: SwapStrategy;\n//   routingHookIntegration: RoutingHookIntegration;\n// }\n// /**\n//  * Public API\n//  */\n// export interface IRouterTitle extends Partial<ITitleConfiguration> { }\n// /**\n//  * Public API\n//  */\n// export interface ITitleConfiguration {\n//   appTitle: string;\n//   appTitleSeparator: string;\n//   componentTitleOrder: 'top-down' | 'bottom-up';\n//   componentTitleSeparator: string;\n//   useComponentNames: boolean;\n//   componentPrefix: string;\n//   transformTitle?: (title: string, instruction: string | ViewportInstruction | FoundRoute) => string;\n// }\n/**\n * Public API\n */\nexport const IRouter = DI.createInterface('IRouter').withDefault(x => x.singleton(Router));\nclass ClosestViewportCustomElement {\n}\n/**\n * @internal\n */\nclass ClosestScope {\n}\nlet Router = /** @class */ (() => {\n    class Router {\n        constructor(\n        /**\n         * @internal - Shouldn't be used directly.\n         */\n        container, \n        /**\n         * @internal - Shouldn't be used directly.\n         */\n        navigator, navigation, \n        /**\n         * @internal - Shouldn't be used directly.\n         */\n        linkHandler, \n        /**\n         * @internal - Shouldn't be used directly. Probably.\n         */\n        instructionResolver, \n        /**\n         * @internal - Shouldn't be used directly. Probably.\n         */\n        hookManager, options) {\n            this.container = container;\n            this.navigator = navigator;\n            this.navigation = navigation;\n            this.linkHandler = linkHandler;\n            this.instructionResolver = instructionResolver;\n            this.hookManager = hookManager;\n            this.options = options;\n            this.rootScope = null;\n            /**\n             * @internal\n             */\n            // public hookManager: HookManager;\n            /**\n             * @internal\n             */\n            this.navs = {};\n            /**\n             * Public API\n             */\n            this.activeComponents = [];\n            /**\n             * @internal\n             */\n            this.appendedInstructions = [];\n            // /**\n            //  * @internal\n            //  */\n            // public options: IRouterOptions = {\n            //   useUrlFragmentHash: true,\n            //   useHref: true,\n            //   statefulHistoryLength: 0,\n            //   useDirectRoutes: true,\n            //   useConfiguredRoutes: true,\n            //   additiveInstructionDefault: true,\n            //   title: {\n            //     appTitle: \"${componentTitles}\\${appTitleSeparator}Aurelia\",\n            //     appTitleSeparator: ' | ',\n            //     componentTitleOrder: 'top-down',\n            //     componentTitleSeparator: ' > ',\n            //     useComponentNames: true,\n            //     componentPrefix: 'app-',\n            //   },\n            //   swapStrategy: 'add-first-sequential',\n            //   routingHookIntegration: 'integrated',\n            //   navigationSyncStates: ['guardedUnload', 'swapped', 'completed'],\n            // };\n            this.processingNavigation = null;\n            this.isActive = false;\n            this.pendingConnects = new Map();\n            this.loadedFirst = false;\n            this.lastNavigation = null;\n            this.staleChecks = {};\n            // TODO: Switch this to use (probably) an event instead\n            this.starters = [];\n            /**\n             * @internal\n             */\n            // TODO: use @bound and improve name (eslint-disable is temp)\n            // eslint-disable-next-line @typescript-eslint/typedef\n            this.linkCallback = (info) => {\n                let instruction = info.instruction || '';\n                if (typeof instruction === 'string' && instruction.startsWith('#')) {\n                    instruction = instruction.slice(1);\n                    // '#' === '/' === '#/'\n                    if (!instruction.startsWith('/')) {\n                        instruction = \"/\" + instruction;\n                    }\n                }\n                // Adds to Navigator's Queue, which makes sure it's serial\n                this.load(instruction, { origin: info.anchor }).catch(error => { throw error; });\n            };\n            /**\n             * @internal\n             */\n            // TODO: use @bound and improve name (eslint-disable is temp)\n            // eslint-disable-next-line @typescript-eslint/typedef\n            this.navigatorCallback = (instruction) => {\n                // Instructions extracted from queue, one at a time\n                this.processNavigations(instruction).catch(error => { throw error; });\n            };\n            /**\n             * @internal\n             */\n            // TODO: use @bound and improve name (eslint-disable is temp)\n            // eslint-disable-next-line @typescript-eslint/typedef\n            this.navigatorSerializeCallback = async (entry, preservedEntries) => {\n                let excludeComponents = [];\n                for (const preservedEntry of preservedEntries) {\n                    if (typeof preservedEntry.instruction !== 'string') {\n                        excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.instruction)\n                            .filter(instruction => instruction.viewport !== null)\n                            .map(instruction => instruction.componentInstance));\n                    }\n                    if (typeof preservedEntry.fullStateInstruction !== 'string') {\n                        excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.fullStateInstruction)\n                            .filter(instruction => instruction.viewport !== null)\n                            .map(instruction => instruction.componentInstance));\n                    }\n                }\n                excludeComponents = excludeComponents.filter((component, i, arr) => component !== null && arr.indexOf(component) === i);\n                const serialized = { ...entry };\n                let instructions = [];\n                if (serialized.fullStateInstruction && typeof serialized.fullStateInstruction !== 'string') {\n                    instructions.push(...serialized.fullStateInstruction);\n                    serialized.fullStateInstruction = this.instructionResolver.stringifyViewportInstructions(serialized.fullStateInstruction);\n                }\n                if (serialized.instruction && typeof serialized.instruction !== 'string') {\n                    instructions.push(...serialized.instruction);\n                    serialized.instruction = this.instructionResolver.stringifyViewportInstructions(serialized.instruction);\n                }\n                instructions = instructions.filter((instruction, i, arr) => instruction !== null\n                    && instruction.componentInstance !== null\n                    && arr.indexOf(instruction) === i);\n                const alreadyDone = [];\n                for (const instruction of instructions) {\n                    await this.freeComponents(instruction, excludeComponents, alreadyDone);\n                }\n                return serialized;\n            };\n            /**\n             * @internal\n             */\n            // TODO: use @bound and improve name (eslint-disable is temp)\n            // eslint-disable-next-line @typescript-eslint/typedef\n            this.browserNavigatorCallback = (browserNavigationEvent) => {\n                var _a;\n                const entry = new Navigation((_a = browserNavigationEvent.state) === null || _a === void 0 ? void 0 : _a.currentEntry);\n                entry.instruction = browserNavigationEvent.instruction;\n                entry.fromBrowser = true;\n                this.navigator.navigate(entry).catch(error => { throw error; });\n            };\n            /**\n             * @internal\n             */\n            // TODO: use @bound and improve name (eslint-disable is temp)\n            // eslint-disable-next-line @typescript-eslint/typedef\n            this.processNavigations = async (qInstruction) => {\n                var _a, _b, _c;\n                const instruction = this.processingNavigation = qInstruction;\n                // console.log('pendingConnects', [...this.pendingConnects]);\n                this.pendingConnects.clear();\n                if (this.options.reportCallback) {\n                    this.options.reportCallback(instruction);\n                }\n                // let {\n                //   fullStateInstruction,\n                //   instructionNavigation,\n                //   configuredRoute,\n                //   configuredRoutePath,\n                //   instructions,\n                //   clearScopeOwners,\n                //   clearViewportScopes,\n                // }\n                const coordinator = NavigationCoordinator.create(this, instruction, { syncStates: this.options.navigationSyncStates });\n                // const steps = [\n                //   () => coordinator.syncState('loaded'),\n                //   () => { console.log('SyncState loaded resolved!', steps); },\n                //   () => coordinator.syncState('swapped'),\n                //   () => { console.log('SyncState swapped resolved!', steps); },\n                //   () => coordinator.syncState('left'),\n                //   () => { console.log('SyncState left resolved!', steps); },\n                // ];\n                // run(...steps);\n                // const loadedPromise = ;\n                // if (loadedPromise !== void 0) {\n                //   loadedPromise.then((value: any) => {\n                //     console.log('SyncState loaded resolved!', value);\n                //   });\n                // }\n                // console.log(instruction.instruction);\n                // console.log(this.rootScope?.scope.toString(true));\n                let transformedInstruction = typeof instruction.instruction === 'string' && !instruction.useFullStateInstruction\n                    ? await this.hookManager.invokeTransformFromUrl(instruction.instruction, this.processingNavigation)\n                    : instruction.instruction;\n                // TODO: Review this\n                if (transformedInstruction === '/') {\n                    transformedInstruction = '';\n                }\n                instruction.scope = (_a = instruction.scope) !== null && _a !== void 0 ? _a : this.rootScope.scope;\n                let configuredRoute = instruction.scope.findInstructions(transformedInstruction);\n                let configuredRoutePath = null;\n                // let configuredRoute = await this.findInstructions(\n                //   this.rootScope!.scope,\n                //   instruction.instruction,\n                //   instruction.scope ?? this.rootScope!.scope,\n                //   !instruction.useFullStateInstruction);\n                if (instruction.instruction.length > 0 && !configuredRoute.foundConfiguration && !configuredRoute.foundInstructions) {\n                    // TODO: Do something here!\n                    this.unknownRoute(configuredRoute.remaining);\n                }\n                let instructions = configuredRoute.instructions;\n                if (configuredRoute.foundConfiguration) {\n                    instruction.path = instruction.instruction.startsWith('/')\n                        ? instruction.instruction.slice(1)\n                        : instruction.instruction;\n                    configuredRoutePath = (configuredRoutePath !== null && configuredRoutePath !== void 0 ? configuredRoutePath : '') + configuredRoute.matching;\n                    this.rootScope.path = configuredRoutePath;\n                }\n                // TODO: Used to have an early exit if no instructions. Restore it?\n                if (!this.options.additiveInstructionDefault &&\n                    instructions.length > 0 &&\n                    !this.instructionResolver.isAddAllViewportsInstruction(instructions[0]) &&\n                    !this.instructionResolver.isClearAllViewportsInstruction(instructions[0])) {\n                    const instr = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction);\n                    instr.scope = instructions[0].scope;\n                    instructions.unshift(instr);\n                }\n                const clearScopeOwners = [];\n                let clearViewportScopes = [];\n                for (const clearInstruction of instructions.filter(instr => this.instructionResolver.isClearAllViewportsInstruction(instr))) {\n                    const scope = clearInstruction.scope || this.rootScope.scope;\n                    const scopes = scope.allScopes().filter(scope => !scope.owner.isEmpty).map(scope => scope.owner);\n                    // TODO: Tell Fred about the need for reverse\n                    // scopes.reverse();\n                    clearScopeOwners.push(...scopes);\n                    if (scope.viewportScope !== null && scope.viewportScope !== this.rootScope) {\n                        clearViewportScopes.push(scope.viewportScope);\n                    }\n                }\n                instructions = instructions.filter(instr => !this.instructionResolver.isClearAllViewportsInstruction(instr));\n                for (const addInstruction of instructions.filter(instr => this.instructionResolver.isAddAllViewportsInstruction(instr))) {\n                    addInstruction.setViewport((addInstruction.scope || this.rootScope.scope).viewportScope.name);\n                    addInstruction.scope = addInstruction.scope.owningScope;\n                }\n                for (const instr of instructions) {\n                    instr.topInstruction = true;\n                }\n                const updatedScopeOwners = [];\n                const alreadyFoundInstructions = [];\n                // TODO: Take care of cancellations down in subsets/iterations\n                let { found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(instructions, alreadyFoundInstructions);\n                let guard = 100;\n                do {\n                    if (!guard--) { // Guard against endless loop\n                        const err = new Error(remainingInstructions.length + ' remaining instructions after 100 iterations; there is likely an infinite loop.');\n                        err['remainingInstructions'] = remainingInstructions;\n                        console.log('remainingInstructions', remainingInstructions);\n                        throw err;\n                    }\n                    const changedScopeOwners = [];\n                    // TODO: Review whether this await poses a problem (it's currently necessary for new viewports to load)\n                    const hooked = await this.hookManager.invokeBeforeNavigation(viewportInstructions, instruction);\n                    if (hooked === false) {\n                        coordinator.cancel();\n                        return;\n                        // return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                    }\n                    else {\n                        viewportInstructions = hooked;\n                    }\n                    for (const viewportInstruction of viewportInstructions) {\n                        const scopeOwner = viewportInstruction.owner;\n                        if (scopeOwner !== null) {\n                            scopeOwner.path = configuredRoutePath;\n                            const action = scopeOwner.setNextContent(viewportInstruction, instruction);\n                            if (action !== 'skip') {\n                                changedScopeOwners.push(scopeOwner);\n                                coordinator.addEntity(scopeOwner);\n                            }\n                            const dontClear = [scopeOwner];\n                            if (action === 'swap') {\n                                dontClear.push(...scopeOwner.scope.allScopes(true, true).map(scope => scope.owner));\n                            }\n                            arrayRemove(clearScopeOwners, value => dontClear.includes(value));\n                            // arrayRemove(clearScopeOwners, value => value === scopeOwner);\n                            if (!this.instructionResolver.isClearViewportInstruction(viewportInstruction)\n                                && viewportInstruction.scope !== null\n                                && viewportInstruction.scope.parent !== null\n                                && viewportInstruction.scope.parent.isViewportScope) {\n                                arrayRemove(clearViewportScopes, value => value === viewportInstruction.scope.parent.viewportScope);\n                            }\n                        }\n                    }\n                    if (!this.isRestrictedNavigation) {\n                        coordinator.finalEntity();\n                    }\n                    coordinator.run();\n                    // await coordinator.syncState('routed');\n                    // // eslint-disable-next-line no-await-in-loop\n                    // let results = await Promise.all(changedScopeOwners.map((scopeOwner) => scopeOwner.canUnload()));\n                    // if (results.some(result => result === false)) {\n                    //   return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                    // }\n                    // // eslint-disable-next-line no-await-in-loop\n                    // results = await Promise.all(changedScopeOwners.map(async (scopeOwner) => {\n                    //   const canLoad = await scopeOwner.canLoad();\n                    //   if (typeof canLoad === 'boolean') {\n                    //     if (canLoad) {\n                    //       coordinator.addEntityState(scopeOwner, 'loaded');\n                    //       return scopeOwner.load();\n                    //     } else {\n                    //       return false;\n                    //     }\n                    //   }\n                    //   await this.load(canLoad, { append: true });\n                    //   await scopeOwner.abortContentChange();\n                    //   // TODO: Abort content change in the viewports\n                    //   return true;\n                    // }));\n                    // if (results.some(result => result === false)) {\n                    //   return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], qInstruction);\n                    // }\n                    for (const viewport of changedScopeOwners) {\n                        if (updatedScopeOwners.every(scopeOwner => scopeOwner !== viewport)) {\n                            updatedScopeOwners.push(viewport);\n                        }\n                    }\n                    // TODO: Fix multi level recursiveness!\n                    alreadyFoundInstructions.push(...viewportInstructions);\n                    ({ found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(remainingInstructions, alreadyFoundInstructions));\n                    // Look for configured child routes (once we've loaded everything so far?)\n                    if (configuredRoute.hasRemaining &&\n                        viewportInstructions.length === 0 &&\n                        remainingInstructions.length === 0) {\n                        let configured = new FoundRoute();\n                        const routeScopeOwners = alreadyFoundInstructions\n                            .filter(instr => instr.owner !== null && instr.owner.path === configuredRoutePath)\n                            .map(instr => instr.owner)\n                            .filter((value, index, arr) => arr.indexOf(value) === index);\n                        // Need to await new viewports being bound\n                        if (!this.isRestrictedNavigation) {\n                            // await Promise.resolve();\n                            // console.log('Awaiting swapped');\n                            await coordinator.syncState('swapped');\n                            // console.log('Awaited swapped');\n                            // console.log('pendingConnects before find new', [...this.pendingConnects]);\n                            // const pending = [...this.pendingConnects.values()].filter(connect => connect.isPending);\n                            // if (pending.length > 0) {\n                            //   console.log('Beginning await for ', pending.length);\n                            //   await Promise.all(pending.map(connect => connect.promise));\n                            //   console.log('Await done');\n                            // }\n                        }\n                        for (const owner of routeScopeOwners) {\n                            configured = owner.scope.findInstructions(configuredRoute.remaining);\n                            // configured = await this.findInstructions(owner.scope, configuredRoute.remaining, owner.scope);\n                            if (configured.foundConfiguration) {\n                                break;\n                            }\n                        }\n                        if (configured.foundInstructions) {\n                            configuredRoute = configured;\n                            configuredRoutePath = (configuredRoutePath !== null && configuredRoutePath !== void 0 ? configuredRoutePath : '') + \"/\" + configuredRoute.matching;\n                        }\n                        else {\n                            // TODO: Do something here!\n                            this.unknownRoute(configured.remaining);\n                        }\n                        this.appendInstructions(configured.instructions);\n                    }\n                    // Don't use defaults when it's a full state navigation\n                    if (instruction.useFullStateInstruction) {\n                        this.appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                    }\n                    // Process non-defaults first\n                    let appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                    this.appendedInstructions = this.appendedInstructions.filter(instruction => instruction.default);\n                    if (appendedInstructions.length === 0) {\n                        const index = this.appendedInstructions.findIndex(instruction => instruction.default);\n                        if (index >= 0) {\n                            appendedInstructions = this.appendedInstructions.splice(index, 1);\n                        }\n                    }\n                    while (appendedInstructions.length > 0) {\n                        const appendedInstruction = appendedInstructions.shift();\n                        const existingAlreadyFound = alreadyFoundInstructions.some(instruction => instruction.sameViewport(appendedInstruction));\n                        const existingFound = viewportInstructions.find(value => value.sameViewport(appendedInstruction));\n                        const existingRemaining = remainingInstructions.find(value => value.sameViewport(appendedInstruction));\n                        if (appendedInstruction.default &&\n                            (existingAlreadyFound ||\n                                (existingFound !== void 0 && !existingFound.default) ||\n                                (existingRemaining !== void 0 && !existingRemaining.default))) {\n                            continue;\n                        }\n                        if (existingFound !== void 0) {\n                            arrayRemove(viewportInstructions, value => value === existingFound);\n                        }\n                        if (existingRemaining !== void 0) {\n                            arrayRemove(remainingInstructions, value => value === existingRemaining);\n                        }\n                        if (appendedInstruction.viewport !== null) {\n                            viewportInstructions.push(appendedInstruction);\n                        }\n                        else {\n                            remainingInstructions.push(appendedInstruction);\n                        }\n                    }\n                    if (viewportInstructions.length === 0 && remainingInstructions.length === 0) {\n                        viewportInstructions = clearScopeOwners.map(owner => {\n                            const instruction = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction, owner.isViewport ? owner : void 0);\n                            if (owner.isViewportScope) {\n                                instruction.viewportScope = owner;\n                            }\n                            return instruction;\n                        });\n                        viewportInstructions.push(...clearViewportScopes.map(viewportScope => {\n                            const instr = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction);\n                            instr.viewportScope = viewportScope;\n                            return instr;\n                        }));\n                        clearViewportScopes = [];\n                    }\n                    // await new Promise(res => setTimeout(res, 100));\n                } while (viewportInstructions.length > 0 || remainingInstructions.length > 0);\n                coordinator.finalEntity();\n                // await Promise.all(updatedScopeOwners.map((value) => value.loadContent()));\n                await coordinator.syncState('completed');\n                coordinator.finalize();\n                // updatedScopeOwners.forEach((viewport) => {\n                //   viewport.finalizeContentChange();\n                // });\n                await this.replacePaths(instruction);\n                // this.updateNav();\n                // Remove history entry if no history viewports updated\n                if (instruction.navigation.new && !instruction.navigation.first && !instruction.repeating && updatedScopeOwners.every(viewport => viewport.options.noHistory)) {\n                    instruction.untracked = true;\n                }\n                // updatedScopeOwners.forEach((viewport) => {\n                //   viewport.finalizeContentChange();\n                // });\n                this.lastNavigation = this.processingNavigation;\n                if ((_c = (_b = this.lastNavigation) === null || _b === void 0 ? void 0 : _b.repeating) !== null && _c !== void 0 ? _c : false) {\n                    this.lastNavigation.repeating = false;\n                }\n                this.processingNavigation = null;\n                await this.navigator.finalize(instruction);\n            };\n            // this.hookManager = new HookManager();\n        }\n        /**\n         * Public API\n         */\n        get isNavigating() {\n            return this.processingNavigation !== null;\n        }\n        get isRestrictedNavigation() {\n            const syncStates = this.options.navigationSyncStates;\n            return syncStates.includes('guardedLoad') ||\n                syncStates.includes('unloaded') ||\n                syncStates.includes('loaded') ||\n                syncStates.includes('guarded') ||\n                syncStates.includes('routed');\n        }\n        /**\n         * @internal\n         */\n        get statefulHistory() {\n            return this.options.statefulHistoryLength !== void 0 && this.options.statefulHistoryLength > 0;\n        }\n        /**\n         * Public API\n         */\n        start(options) {\n            var _a;\n            if (this.isActive) {\n                throw new Error('Router has already been started');\n            }\n            this.isActive = true;\n            options = options !== null && options !== void 0 ? options : {};\n            const titleOptions = {\n                ...this.options.title,\n                ...(typeof options.title === 'string' ? { appTitle: options.title } : options.title),\n            };\n            options.title = titleOptions;\n            const separatorOptions = {\n                ...this.options.separators,\n                ...(_a = options.separators) !== null && _a !== void 0 ? _a : {},\n            };\n            options.separators = separatorOptions;\n            Object.assign(this.options, options);\n            if (this.options.hooks !== void 0) {\n                this.addHooks(this.options.hooks);\n            }\n            this.instructionResolver.start({ separators: this.options.separators });\n            this.navigator.start(this, {\n                callback: this.navigatorCallback,\n                store: this.navigation,\n                statefulHistoryLength: this.options.statefulHistoryLength,\n                serializeCallback: this.statefulHistory ? this.navigatorSerializeCallback : void 0,\n            });\n            this.linkHandler.start({ callback: this.linkCallback, useHref: this.options.useHref });\n            this.navigation.start({\n                callback: this.browserNavigatorCallback,\n                useUrlFragmentHash: this.options.useUrlFragmentHash\n            });\n            this.ensureRootScope();\n            // TODO: Switch this to use (probably) an event instead\n            for (const starter of this.starters) {\n                starter();\n            }\n        }\n        /**\n         * Public API\n         */\n        async loadUrl() {\n            const entry = new Navigation({\n                ...this.navigation.viewerState,\n                ...{\n                    fullStateInstruction: '',\n                    replacing: true,\n                    fromBrowser: false,\n                }\n            });\n            const result = this.navigator.navigate(entry);\n            this.loadedFirst = true;\n            return result;\n        }\n        /**\n         * Public API\n         */\n        stop() {\n            if (!this.isActive) {\n                throw new Error('Router has not been started');\n            }\n            this.linkHandler.stop();\n            this.navigator.stop();\n            this.navigation.stop();\n        }\n        /**\n         * @internal\n         */\n        findScope(origin) {\n            // this.ensureRootScope();\n            if (origin === void 0 || origin === null) {\n                return this.rootScope.scope;\n            }\n            if (origin instanceof Scope || origin instanceof Viewport) {\n                return origin.scope;\n            }\n            return this.getClosestScope(origin) || this.rootScope.scope;\n        }\n        /**\n         * @internal\n         */\n        findParentScope(container) {\n            if (container === null) {\n                return this.rootScope.scope;\n            }\n            // Already (prematurely) set on this view model so get it from container's parent instead\n            if (container.has(ClosestScope, false)) {\n                container = container.parent;\n                if (container === null) {\n                    return this.rootScope.scope;\n                }\n            }\n            if (container.has(ClosestScope, true)) {\n                return container.get(ClosestScope);\n            }\n            return this.rootScope.scope;\n        }\n        /**\n         * Public API - Get viewport by name\n         */\n        getViewport(name) {\n            return this.allViewports().find(viewport => viewport.name === name) || null;\n        }\n        /**\n         * Public API (not yet implemented)\n         */\n        addViewport(...args) {\n            throw new Error('Not implemented');\n        }\n        /**\n         * Public API (not yet implemented)\n         */\n        findViewportScope(...args) {\n            throw new Error('Not implemented');\n        }\n        /**\n         * Public API (not yet implemented)\n         */\n        addViewportScope(...args) {\n            throw new Error('Not implemented');\n        }\n        /**\n         * @internal - Called from the viewport scope custom element in created()\n         */\n        setClosestScope(viewModelOrContainer, scope) {\n            const container = this.getContainer(viewModelOrContainer);\n            Registration.instance(ClosestScope, scope).register(container);\n        }\n        /**\n         * @internal\n         */\n        getClosestScope(viewModelOrElement) {\n            const container = 'resourceResolvers' in viewModelOrElement\n                ? viewModelOrElement\n                : this.getClosestContainer(viewModelOrElement);\n            if (container === null) {\n                return null;\n            }\n            if (!container.has(ClosestScope, true)) {\n                return null;\n            }\n            return container.get(ClosestScope) || null;\n        }\n        /**\n         * @internal\n         */\n        unsetClosestScope(viewModelOrContainer) {\n            const container = this.getContainer(viewModelOrContainer);\n            // TODO: Get an 'unregister' on container\n            container.resolvers.delete(ClosestScope);\n        }\n        /**\n         * @internal - Called from the viewport custom element\n         */\n        connectViewport(viewport, connectedCE, name, options) {\n            var _a, _b, _c;\n            const parentScope = this.findParentScope(connectedCE.container);\n            // console.log('Viewport parentScope', parentScope.toString(), (connectedCE as any).getClosestCustomElement());\n            const parentViewportScope = ((_b = (_a = connectedCE.parentViewport) === null || _a === void 0 ? void 0 : _a.viewport) !== null && _b !== void 0 ? _b : this.rootScope).scope;\n            if (parentScope !== parentViewportScope) {\n                console.error('Viewport parentScope !== parentViewportScope', parentScope.toString(true), parentViewportScope.toString(true), connectedCE.getClosestCustomElement());\n            }\n            if (viewport === null) {\n                viewport = parentScope.addViewport(name, connectedCE, options);\n                this.setClosestScope(connectedCE.container, viewport.connectedScope);\n                if (!this.isRestrictedNavigation) {\n                    this.pendingConnects.set(connectedCE, new OpenPromise());\n                }\n            }\n            else {\n                (_c = this.pendingConnects.get(connectedCE)) === null || _c === void 0 ? void 0 : _c.resolve();\n            }\n            return viewport;\n        }\n        /**\n         * @internal - Called from the viewport custom element\n         */\n        disconnectViewport(viewport, connectedCE) {\n            if (!viewport.connectedScope.parent.removeViewport(viewport, connectedCE)) {\n                throw new Error(\"Failed to remove viewport: \" + viewport.name);\n            }\n            this.unsetClosestScope(connectedCE.container);\n        }\n        /**\n         * @internal - Called from the viewport scope custom element\n         */\n        connectViewportScope(viewportScope, connectedCE, name, options) {\n            const parentScope = this.findParentScope(connectedCE.container);\n            // console.log('ViewportScope parentScope', parentScope.toString(), (connectedCE as any).getClosestCustomElement());\n            if (viewportScope === null) {\n                viewportScope = parentScope.addViewportScope(name, connectedCE, options);\n                this.setClosestScope(connectedCE.container, viewportScope.connectedScope);\n            }\n            return viewportScope;\n        }\n        /**\n         * @internal - Called from the viewport scope custom element\n         */\n        disconnectViewportScope(viewportScope, connectedCE) {\n            if (!viewportScope.connectedScope.parent.removeViewportScope(viewportScope)) {\n                throw new Error(\"Failed to remove viewport scope: \" + viewportScope.path);\n            }\n            this.unsetClosestScope(connectedCE.container);\n        }\n        allViewports(includeDisabled = false, includeReplaced = false) {\n            // this.ensureRootScope();\n            return this.rootScope.scope.allViewports(includeDisabled, includeReplaced);\n        }\n        /**\n         * Public API - THE navigation API\n         */\n        async goto(instructions, options) {\n            deprecationWarning('\"goto\" method', '\"load\" method');\n            return this.load(instructions, options);\n        }\n        async load(instructions, options) {\n            options = options || {};\n            // TODO: Review query extraction; different pos for path and fragment!\n            if (typeof instructions === 'string' && !options.query) {\n                const [path, search] = instructions.split('?');\n                instructions = path;\n                options.query = search;\n            }\n            const toOptions = {};\n            if (options.origin) {\n                toOptions.context = options.origin;\n            }\n            let scope = null;\n            ({ instructions, scope } = NavigationInstructionResolver.createViewportInstructions(this, instructions, toOptions));\n            if (options.append && this.processingNavigation) {\n                instructions = NavigationInstructionResolver.toViewportInstructions(this, instructions);\n                this.appendInstructions(instructions, scope);\n                // Can't return current navigation promise since it can lead to deadlock in load\n                return Promise.resolve();\n            }\n            const entry = new Navigation({\n                instruction: instructions,\n                fullStateInstruction: '',\n                scope: scope,\n                title: options.title,\n                data: options.data,\n                query: options.query,\n                replacing: options.replace,\n                repeating: options.append,\n                fromBrowser: false,\n                origin: options.origin,\n            });\n            return this.navigator.navigate(entry);\n        }\n        /**\n         * Public API\n         */\n        refresh() {\n            return this.navigator.refresh();\n        }\n        /**\n         * Public API\n         */\n        back() {\n            return this.navigator.go(-1);\n        }\n        /**\n         * Public API\n         */\n        forward() {\n            return this.navigator.go(1);\n        }\n        /**\n         * Public API\n         */\n        go(delta) {\n            return this.navigator.go(delta);\n        }\n        /**\n         * Public API\n         */\n        checkActive(instructions) {\n            for (const instruction of instructions) {\n                const scopeInstructions = this.instructionResolver.matchScope(this.activeComponents, instruction.scope);\n                const matching = scopeInstructions.filter(instr => instr.sameComponent(instruction, true));\n                if (matching.length === 0) {\n                    return false;\n                }\n                if (Array.isArray(instruction.nextScopeInstructions)\n                    && instruction.nextScopeInstructions.length > 0\n                    && this.instructionResolver.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        /**\n         * Public API\n         */\n        setNav(name, routes, classes) {\n            const nav = this.findNav(name);\n            if (nav !== void 0 && nav !== null) {\n                nav.routes = [];\n            }\n            this.addNav(name, routes, classes);\n        }\n        /**\n         * Public API\n         */\n        addNav(name, routes, classes) {\n            let nav = this.navs[name];\n            if (nav === void 0 || nav === null) {\n                nav = this.navs[name] = new Nav(this, name, [], classes);\n            }\n            nav.addRoutes(routes);\n            nav.update();\n        }\n        /**\n         * Public API\n         */\n        updateNav(name) {\n            const navs = name\n                ? [name]\n                : Object.keys(this.navs);\n            for (const nav of navs) {\n                if (this.navs[nav] !== void 0 && this.navs[nav] !== null) {\n                    this.navs[nav].update();\n                }\n            }\n        }\n        /**\n         * Public API\n         */\n        findNav(name) {\n            return this.navs[name];\n        }\n        /**\n         * Public API\n         */\n        addRoutes(routes, context) {\n            // TODO: This should add to the context instead\n            // TODO: Add routes without context to rootScope content (which needs to be created)?\n            return [];\n            // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n            // return viewport.addRoutes(routes);\n        }\n        /**\n         * Public API\n         */\n        removeRoutes(routes, context) {\n            // TODO: This should remove from the context instead\n            // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n            // return viewport.removeRoutes(routes);\n        }\n        /**\n         * Public API\n         */\n        addHooks(hooks) {\n            return hooks.map(hook => this.addHook(hook.hook, hook.options));\n        }\n        addHook(hook, options) {\n            return this.hookManager.addHook(hook, options);\n        }\n        /**\n         * Public API\n         */\n        removeHooks(hooks) {\n            return;\n        }\n        /**\n         * Public API - The right way to create ViewportInstructions\n         */\n        createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n            return this.instructionResolver.createViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n        }\n        hasSiblingInstructions(instructions) {\n            if (instructions === null) {\n                return false;\n            }\n            if (instructions.length > 1) {\n                return true;\n            }\n            return instructions.some(instruction => this.hasSiblingInstructions(instruction.nextScopeInstructions));\n        }\n        appendInstructions(instructions, scope = null) {\n            if (scope === null) {\n                scope = this.rootScope.scope;\n            }\n            for (const instruction of instructions) {\n                if (instruction.scope === null) {\n                    instruction.scope = scope;\n                }\n            }\n            this.appendedInstructions.push(...instructions);\n        }\n        checkStale(name, instructions) {\n            const staleCheck = this.staleChecks[name];\n            if (staleCheck === void 0) {\n                this.staleChecks[name] = instructions.slice();\n                return false;\n            }\n            if (staleCheck.length !== instructions.length) {\n                this.staleChecks[name] = instructions.slice();\n                return false;\n            }\n            for (let i = 0, ii = instructions.length; i < ii; i++) {\n                if (staleCheck[i] !== instructions[i]) {\n                    this.staleChecks[name] = instructions.slice();\n                    return false;\n                }\n            }\n            return true;\n        }\n        unknownRoute(route) {\n            if (typeof route !== 'string' || route.length === 0) {\n                return;\n            }\n            if (this.options.useConfiguredRoutes && this.options.useDirectRoutes) {\n                // TODO: Add missing/unknown route handling\n                throw new Error(\"No matching configured route or component found for '\" + route + \"'\");\n            }\n            else if (this.options.useConfiguredRoutes) {\n                // TODO: Add missing/unknown route handling\n                throw new Error(\"No matching configured route found for '\" + route + \"'\");\n            }\n            else {\n                // TODO: Add missing/unknown route handling\n                throw new Error(\"No matching route/component found for '\" + route + \"'\");\n            }\n        }\n        findViewports(instructions, alreadyFound, withoutViewports = false) {\n            const found = [];\n            const remaining = [];\n            while (instructions.length) {\n                if (instructions[0].scope === null) {\n                    instructions[0].scope = this.rootScope.scope;\n                }\n                const scope = instructions[0].scope;\n                const { foundViewports, remainingInstructions } = scope.findViewports(instructions.filter(instruction => instruction.scope === scope), alreadyFound, withoutViewports);\n                found.push(...foundViewports);\n                remaining.push(...remainingInstructions);\n                instructions = instructions.filter(instruction => instruction.scope !== scope);\n            }\n            return { found: found.slice(), remaining };\n        }\n        async cancelNavigation(updatedScopeOwners, qInstruction) {\n            // TODO: Take care of disabling viewports when cancelling and stateful!\n            updatedScopeOwners.forEach((viewport) => {\n                const abort = viewport.abortContentChange();\n                if (abort instanceof Promise) {\n                    abort.catch(error => { throw error; });\n                }\n            });\n            await this.navigator.cancel(qInstruction);\n            this.processingNavigation = null;\n            qInstruction.resolve();\n        }\n        ensureRootScope() {\n            if (!this.rootScope) {\n                const root = this.container.get(Aurelia).root;\n                // root.config.component shouldn't be used in the end. Metadata will probably eliminate it\n                this.rootScope = new ViewportScope('rootScope', this, root.viewModel, null, true, root.config.component);\n            }\n            return this.rootScope;\n        }\n        async replacePaths(instruction) {\n            var _a;\n            this.rootScope.scope.reparentViewportInstructions();\n            let instructions = this.rootScope.scope.hoistedChildren\n                .filter(scope => scope.viewportInstruction !== null && !scope.viewportInstruction.isEmpty())\n                .map(scope => scope.viewportInstruction);\n            instructions = this.instructionResolver.cloneViewportInstructions(instructions, true);\n            // The following makes sure right viewport/viewport scopes are set and update\n            // whether viewport name is necessary or not\n            const alreadyFound = [];\n            let { found, remaining } = this.findViewports(instructions, alreadyFound, true);\n            let guard = 100;\n            while (remaining.length > 0) {\n                // Guard against endless loop\n                if (guard-- === 0) {\n                    throw new Error('Failed to find viewport when updating viewer paths.');\n                }\n                alreadyFound.push(...found);\n                ({ found, remaining } = this.findViewports(remaining, alreadyFound, true));\n            }\n            this.activeComponents = instructions;\n            this.activeRoute = instruction.route;\n            // First invoke with viewport instructions (should it perhaps get full state?)\n            let state = await this.hookManager.invokeTransformToUrl(instructions, instruction);\n            if (typeof state !== 'string') {\n                // Convert to string if necessary\n                state = this.instructionResolver.stringifyViewportInstructions(state, false, true);\n            }\n            // Invoke again with string\n            state = await this.hookManager.invokeTransformToUrl(state, instruction);\n            const query = (instruction.query && instruction.query.length ? \"?\" + instruction.query : '');\n            // if (instruction.path === void 0 || instruction.path.length === 0 || instruction.path === '/') {\n            instruction.path = state + query;\n            // }\n            const fullViewportStates = [this.createViewportInstruction(this.instructionResolver.clearViewportInstruction)];\n            fullViewportStates.push(...this.instructionResolver.cloneViewportInstructions(instructions, this.statefulHistory));\n            instruction.fullStateInstruction = fullViewportStates;\n            if (((_a = instruction.title) !== null && _a !== void 0 ? _a : null) === null) {\n                const title = await this.getTitle(instructions, instruction);\n                if (title !== null) {\n                    instruction.title = title;\n                }\n            }\n            return Promise.resolve();\n        }\n        async getTitle(instructions, instruction) {\n            // First invoke with viewport instructions\n            let title = await this.hookManager.invokeSetTitle(instructions, instruction);\n            if (typeof title !== 'string') {\n                // Hook didn't return a title, so run title logic\n                const componentTitles = this.stringifyTitles(title, instruction);\n                title = this.options.title.appTitle;\n                title = title.replace(\"${componentTitles}\", componentTitles);\n                title = title.replace(\"${appTitleSeparator}\", componentTitles !== ''\n                    ? this.options.title.appTitleSeparator\n                    : '');\n            }\n            // Invoke again with complete string\n            title = await this.hookManager.invokeSetTitle(title, instruction);\n            return title;\n        }\n        stringifyTitles(instructions, navigationInstruction) {\n            const titles = instructions\n                .map(instruction => this.stringifyTitle(instruction, navigationInstruction))\n                .filter(instruction => { var _a; return ((_a = instruction === null || instruction === void 0 ? void 0 : instruction.length) !== null && _a !== void 0 ? _a : 0) > 0; });\n            return titles.join(' + ');\n        }\n        stringifyTitle(instruction, navigationInstruction) {\n            var _a;\n            if (typeof instruction === 'string') {\n                return this.resolveTitle(instruction, navigationInstruction);\n            }\n            const route = (_a = instruction.route) !== null && _a !== void 0 ? _a : null;\n            const nextInstructions = instruction.nextScopeInstructions;\n            let stringified = '';\n            // It's a configured route\n            if (route !== null) {\n                // Already added as part of a configuration, skip to next scope\n                if (route === '') {\n                    return Array.isArray(nextInstructions)\n                        ? this.stringifyTitles(nextInstructions, navigationInstruction)\n                        : '';\n                }\n                else {\n                    stringified += this.resolveTitle(route, navigationInstruction);\n                }\n            }\n            else {\n                stringified += this.resolveTitle(instruction, navigationInstruction);\n            }\n            if (Array.isArray(nextInstructions) && nextInstructions.length > 0) {\n                let nextStringified = this.stringifyTitles(nextInstructions, navigationInstruction);\n                if (nextStringified.length > 0) {\n                    if (nextInstructions.length !== 1) { // TODO: This should really also check that the instructions have value\n                        nextStringified = \"[ \" + nextStringified + \" ]\";\n                    }\n                    if (stringified.length > 0) {\n                        stringified = this.options.title.componentTitleOrder === 'top-down'\n                            ? stringified + this.options.title.componentTitleSeparator + nextStringified\n                            : nextStringified + this.options.title.componentTitleSeparator + stringified;\n                    }\n                    else {\n                        stringified = nextStringified;\n                    }\n                }\n            }\n            return stringified;\n        }\n        resolveTitle(instruction, navigationInstruction) {\n            var _a;\n            let title = '';\n            if (typeof instruction === 'string') {\n                title = instruction;\n            }\n            else if (instruction instanceof ViewportInstruction) {\n                return instruction.viewport.getTitle(navigationInstruction);\n            }\n            else if (instruction instanceof FoundRoute) {\n                const routeTitle = (_a = instruction.match) === null || _a === void 0 ? void 0 : _a.title;\n                if (routeTitle !== void 0) {\n                    if (typeof routeTitle === 'string') {\n                        title = routeTitle;\n                    }\n                    else {\n                        title = routeTitle.call(instruction, instruction, navigationInstruction);\n                    }\n                }\n            }\n            if (this.options.title.transformTitle !== void 0) {\n                title = this.options.title.transformTitle.call(this, title, instruction);\n            }\n            return title;\n        }\n        async freeComponents(instruction, excludeComponents, alreadyDone) {\n            const component = instruction.componentInstance;\n            const viewport = instruction.viewport;\n            if (component === null || viewport === null || alreadyDone.some(done => done === component)) {\n                return;\n            }\n            if (!excludeComponents.some(exclude => exclude === component)) {\n                await viewport.freeContent(component);\n                alreadyDone.push(component);\n                return;\n            }\n            if (instruction.nextScopeInstructions !== null) {\n                for (const nextInstruction of instruction.nextScopeInstructions) {\n                    await this.freeComponents(nextInstruction, excludeComponents, alreadyDone);\n                }\n            }\n        }\n        getClosestContainer(viewModelOrElement) {\n            if ('context' in viewModelOrElement) {\n                return viewModelOrElement.context;\n            }\n            if ('$controller' in viewModelOrElement) {\n                return viewModelOrElement.$controller.context;\n            }\n            const controller = this.CustomElementFor(viewModelOrElement);\n            if (controller === void 0) {\n                return null;\n            }\n            return controller.context;\n        }\n        getContainer(viewModelOrContainer) {\n            if ('resourceResolvers' in viewModelOrContainer) {\n                return viewModelOrContainer;\n            }\n            if (isRenderContext(viewModelOrContainer)) {\n                return viewModelOrContainer.get(IContainer);\n            }\n            if ('$controller' in viewModelOrContainer) {\n                return viewModelOrContainer.$controller.context.get(IContainer);\n            }\n            return null;\n        }\n        // TODO: This is probably wrong since it caused test fails when in CustomElement.for\n        // Fred probably knows and will need to look at it\n        // This can most likely also be changed so that the node traversal isn't necessary\n        CustomElementFor(node) {\n            let cur = node;\n            while (cur !== null) {\n                const nodeResourceName = cur.nodeName.toLowerCase();\n                const controller = Metadata.getOwn(CustomElement.name + \":\" + nodeResourceName, cur)\n                    || Metadata.getOwn(CustomElement.name, cur);\n                if (controller !== void 0) {\n                    return controller;\n                }\n                cur = DOM.getEffectiveParentNode(cur);\n            }\n            return (void 0);\n        }\n    }\n    Router.inject = [IContainer, Navigator, BrowserViewerStore, LinkHandler, InstructionResolver, HookManager, RouterOptions];\n    return Router;\n})();\nexport { Router };\n//# sourceMappingURL=router.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, customElement } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nlet NavCustomElement = /** @class */ (() => {\n    let NavCustomElement = class NavCustomElement {\n        constructor(router) {\n            this.router = router;\n            this.name = null;\n            this.routes = null;\n            this.level = 0;\n            this.classes = {};\n        }\n        get navRoutes() {\n            const nav = this.router.navs[this.name];\n            return (nav !== void 0 && nav !== null ? nav.routes : []);\n        }\n        get navClasses() {\n            const nav = this.router.navs[this.name];\n            const navClasses = (nav !== void 0 && nav !== null ? nav.classes : {});\n            return {\n                ...{\n                    nav: '',\n                    ul: '',\n                    li: '',\n                    a: '',\n                    ulActive: '',\n                    liActive: 'nav-active',\n                    aActive: '',\n                }, ...navClasses\n            };\n        }\n        active(route) {\n            return 'Active';\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], NavCustomElement.prototype, \"name\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], NavCustomElement.prototype, \"routes\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Number)\n    ], NavCustomElement.prototype, \"level\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], NavCustomElement.prototype, \"classes\", void 0);\n    NavCustomElement = __decorate([\n        customElement({\n            name: 'au-nav', template: `<template>\n  <nav if.bind=\"name\" class=\"\\${name} \\${navClasses.nav}\">\n    <au-nav routes.bind=\"navRoutes\" classes.bind=\"navClasses\" containerless></au-nav>\n  </nav>\n  <ul if.bind=\"routes\" class=\"nav-level-\\${level} \\${classes.ul}\">\n    <li repeat.for=\"route of routes\" if.bind=\"route.visible\" class=\"\\${route.active ? classes.liActive : ''} \\${route.hasChildren} \\${classes.li}\">\n      <a if.bind=\"route.link && route.link.length\" load=\"\\${route.link}\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <a if.bind=\"route.execute\" click.trigger=\"route.executeAction($event)\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <span if.bind=\"(!route.link || !route.link.length) && !route.execute && !route.children\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.span} nav-separator\" innerhtml.bind=\"route.title\"></span>\n      <a if.bind=\"(!route.link || !route.link.length) && !route.execute && route.children\" click.delegate=\"route.toggleActive()\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <au-nav if.bind=\"route.children\" routes.bind=\"route.children\" level.bind=\"level + 1\" classes.bind=\"classes\" containerless></au-nav>\n    </li>\n  </ul>\n</template>`\n        }),\n        __param(0, IRouter),\n        __metadata(\"design:paramtypes\", [Object])\n    ], NavCustomElement);\n    return NavCustomElement;\n})();\nexport { NavCustomElement };\n//# sourceMappingURL=nav.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, INode, customElement, CustomElement, IController, isCustomElementController, isCustomElementViewModel, } from '@aurelia/runtime';\nimport { IContainer } from '@aurelia/kernel';\nimport { IRouter } from '../router';\nimport { ViewportCustomElement } from './viewport';\nexport const ParentViewportScope = CustomElement.createInjectable();\nlet ViewportScopeCustomElement = /** @class */ (() => {\n    var ViewportScopeCustomElement_1;\n    let ViewportScopeCustomElement = ViewportScopeCustomElement_1 = class ViewportScopeCustomElement {\n        constructor(router, element, container, parent, parentController) {\n            this.router = router;\n            this.container = container;\n            this.parent = parent;\n            this.parentController = parentController;\n            this.name = 'default';\n            this.catches = '';\n            this.collection = false;\n            this.source = null;\n            this.viewportScope = null;\n            this.isBound = false;\n            this.element = element;\n        }\n        // Maybe this really should be here. Check with Fred\n        // public create(\n        //   controller: IDryCustomElementController<Element, this>,\n        //   parentContainer: IContainer,\n        //   definition: CustomElementDefinition,\n        //   parts: PartialCustomElementDefinitionParts | undefined,\n        // ): PartialCustomElementDefinition {\n        //   // TODO(fkleuver): describe this somewhere in the docs instead\n        //   // Under the condition that there is no `replace` attribute on this custom element's declaration,\n        //   // and this custom element is containerless, its content will be placed in a part named 'default'\n        //   // See packages/jit-html/src/template-binder.ts line 411 (`replace = 'default';`) for the logic that governs this.\n        //   // We could tidy this up into a formal api in the future. For now, there are two ways to do this:\n        //   // 1. inject the `@ITargetedInstruction` (IHydrateElementInstruction) and grab .parts['default'] from there, manually creating a view factory from that, etc.\n        //   // 2. what we're doing right here: grab the 'default' part from the create hook and return it as the definition, telling the render context to use that part to compile this element instead\n        //   // This effectively causes this element to render its declared content as if it was its own template.\n        //   // We do need to set `containerless` to true on the part definition so that the correct projector is used since parts default to non-containerless.\n        //   // Otherwise, the controller will try to do `appendChild` on a comment node when it has to do `insertBefore`.\n        //   // Also, in this particular scenario (specific to viewport-scope) we need to clone the part so as to prevent the resulting compiled definition\n        //   // from ever being cached. That's the only reason why we're spreading the part into a new object for `getOrCreate`. If we didn't clone the object, this specific element wouldn't work correctly.\n        //   const part = parts!['default'];\n        //   return CustomElementDefinition.getOrCreate({ ...part, containerless: true });\n        // }\n        afterCompile(controller) {\n            this.controller = controller;\n            // Don't update the container here (probably because it wants to be a part of the structure)\n            // this.container = controller.context.get(IContainer);\n            // console.log('ViewportScope creating', this.getAttribute('name', this.name), this.container, this.parent, controller, this);\n            // this.connect();\n        }\n        afterBind(initiator, parent, flags) {\n            this.isBound = true;\n            this.$controller.scope = this.parentController.scope;\n            this.connect();\n            if (this.viewportScope !== null) {\n                this.viewportScope.beforeBind();\n            }\n        }\n        beforeUnbind(initiator, parent, flags) {\n            if (this.viewportScope !== null) {\n                this.viewportScope.beforeUnbind();\n            }\n            return Promise.resolve();\n        }\n        afterUnbind(initiator, parent, flags) {\n            this.disconnect();\n            return Promise.resolve();\n        }\n        afterUnbound() {\n            this.isBound = false;\n        }\n        connect() {\n            if (this.router.rootScope === null) {\n                return;\n            }\n            const name = this.getAttribute('name', this.name);\n            const options = {};\n            let value = this.getAttribute('catches', this.catches);\n            if (value !== void 0) {\n                options.catches = value;\n            }\n            value = this.getAttribute('collection', this.collection, true);\n            if (value !== void 0) {\n                options.collection = value;\n            }\n            // TODO: Needs to be bound? How to solve?\n            options.source = this.source || null;\n            this.controller.routingContainer = this.container;\n            this.viewportScope = this.router.connectViewportScope(this.viewportScope, this, name, options);\n        }\n        disconnect() {\n            if (this.viewportScope) {\n                this.router.disconnectViewportScope(this.viewportScope, this);\n            }\n            this.viewportScope = null;\n        }\n        getAttribute(key, value, checkExists = false) {\n            const result = {};\n            if (this.isBound) {\n                return value;\n            }\n            else {\n                if (this.element.hasAttribute(key)) {\n                    if (checkExists) {\n                        return true;\n                    }\n                    else {\n                        value = this.element.getAttribute(key);\n                        if (value.length > 0) {\n                            return value;\n                        }\n                    }\n                }\n            }\n            return void 0;\n        }\n        isCustomElementController(value) {\n            return isCustomElementController(value);\n        }\n        isCustomElementViewModel(value) {\n            return isCustomElementViewModel(value);\n        }\n        getClosestCustomElement() {\n            let parent = this.controller.parent;\n            let customElement = null;\n            while (parent !== null && customElement === null) {\n                if (parent.viewModel instanceof ViewportCustomElement || parent.viewModel instanceof ViewportScopeCustomElement_1) {\n                    customElement = parent.viewModel;\n                }\n                parent = parent.parent;\n            }\n            return customElement;\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", String)\n    ], ViewportScopeCustomElement.prototype, \"name\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", String)\n    ], ViewportScopeCustomElement.prototype, \"catches\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], ViewportScopeCustomElement.prototype, \"collection\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Object)\n    ], ViewportScopeCustomElement.prototype, \"source\", void 0);\n    ViewportScopeCustomElement = ViewportScopeCustomElement_1 = __decorate([\n        customElement({\n            name: 'au-viewport-scope',\n            template: '<template></template>',\n            containerless: false,\n            injectable: ParentViewportScope\n        }),\n        __param(0, IRouter),\n        __param(1, INode),\n        __param(2, IContainer),\n        __param(3, ParentViewportScope),\n        __param(4, IController),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportScopeCustomElement, Object])\n    ], ViewportScopeCustomElement);\n    return ViewportScopeCustomElement;\n})();\nexport { ViewportScopeCustomElement };\n//# sourceMappingURL=viewport-scope.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContainer } from '@aurelia/kernel';\nimport { bindable, INode, customElement, CustomElement, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { ViewportScopeCustomElement } from './viewport-scope';\nimport { Runner } from '../runner';\nexport const ParentViewport = CustomElement.createInjectable();\nlet ViewportCustomElement = /** @class */ (() => {\n    var ViewportCustomElement_1;\n    let ViewportCustomElement = ViewportCustomElement_1 = class ViewportCustomElement {\n        constructor(router, element, container, parentViewport) {\n            this.router = router;\n            this.container = container;\n            this.parentViewport = parentViewport;\n            this.name = 'default';\n            this.usedBy = '';\n            this.default = '';\n            this.fallback = '';\n            this.noScope = false;\n            this.noLink = false;\n            this.noTitle = false;\n            this.noHistory = false;\n            this.stateful = false;\n            this.viewport = null;\n            this.isBound = false;\n            this.element = element;\n        }\n        afterCompile(controller) {\n            // console.log('afterCompile', this.name, this.router.isActive);\n            this.controller = controller;\n            this.container = controller.context.get(IContainer);\n            // The first viewport(s) might be compiled before the router is active\n            return Runner.run(() => this.waitForRouterStart(), () => {\n                if (this.router.isRestrictedNavigation) {\n                    this.connect();\n                }\n            });\n        }\n        beforeBind(initiator, parent, flags) {\n            this.isBound = true;\n            return Runner.run(() => this.waitForRouterStart(), () => {\n                if (!this.router.isRestrictedNavigation) {\n                    this.connect();\n                }\n            });\n        }\n        afterAttach(initiator, parent, flags) {\n            var _a;\n            if (this.viewport !== null && ((_a = this.viewport.nextContent) !== null && _a !== void 0 ? _a : null) === null) {\n                // console.log('afterAttach', this.viewport?.toString());\n                this.viewport.enabled = true;\n                return this.viewport.activate(initiator, this.$controller, flags, true);\n                // TODO: Restore scroll state\n            }\n        }\n        beforeUnbind(initiator, parent, flags) {\n            var _a;\n            if (this.viewport !== null && ((_a = this.viewport.nextContent) !== null && _a !== void 0 ? _a : null) === null) {\n                // console.log('beforeUnbind', this.viewport?.toString());\n                // TODO: Save to cache, something like\n                // this.viewport.cacheContent();\n                // From viewport-content:\n                // public unloadComponent(cache: ViewportContent[], stateful: boolean = false): void {\n                //   // TODO: We might want to do something here eventually, who knows?\n                //   if (this.contentStatus !== ContentStatus.loaded) {\n                //     return;\n                //   }\n                //   // Don't unload components when stateful\n                //   if (!stateful) {\n                //     this.contentStatus = ContentStatus.created;\n                //   } else {\n                //     cache.push(this);\n                //   }\n                // }\n                // TODO: Save scroll state before detach\n                return Runner.run(() => this.viewport.deactivate(initiator, parent, flags), () => {\n                    this.isBound = false;\n                    this.viewport.enabled = false;\n                });\n                // this.isBound = false;\n                // this.viewport.enabled = false;\n                // return this.viewport.deactivate(initiator, parent, flags);\n                // // this.viewport.enabled = false;\n            }\n        }\n        // public beforeDetach(initiator: IHydratedController<Element>, parent: ISyntheticView<Element> | ICustomElementController<Element, ICustomElementViewModel<Element>> | null, flags: LifecycleFlags): void | Promise<void> {\n        //   if (this.viewport !== null && (this.viewport.nextContent ?? null) === null) {\n        //     console.log('beforeDetach', this.viewport?.toString());\n        //   }\n        // }\n        dispose() {\n            if (this.viewport !== null) {\n                return Runner.run(() => { var _a, _b, _c; return ((_b = (_a = this.viewport) === null || _a === void 0 ? void 0 : _a.nextContent) !== null && _b !== void 0 ? _b : null) === null ? (_c = this.viewport) === null || _c === void 0 ? void 0 : _c.dispose() : void 0; }, () => this.disconnect());\n            }\n        }\n        connect() {\n            if (this.router.rootScope === null || (this.viewport !== null && this.router.isRestrictedNavigation)) {\n                return;\n            }\n            // let controllerContainer = (this.controller.context as any).container;\n            // let output = '';\n            // do {\n            //   console.log(output, ':', controllerContainer === this.container, this.controller, controllerContainer, this.container);\n            //   if (controllerContainer === this.container) {\n            //     break;\n            //   }\n            //   controllerContainer = controllerContainer.parent;\n            //   output += '.parent';\n            // } while (controllerContainer);\n            const name = this.getAttribute('name', this.name);\n            let value = this.getAttribute('no-scope', this.noScope);\n            const options = { scope: value === void 0 || !value ? true : false };\n            value = this.getAttribute('used-by', this.usedBy);\n            if (value !== void 0) {\n                options.usedBy = value;\n            }\n            value = this.getAttribute('default', this.default);\n            if (value !== void 0) {\n                options.default = value;\n            }\n            value = this.getAttribute('fallback', this.fallback);\n            if (value !== void 0) {\n                options.fallback = value;\n            }\n            value = this.getAttribute('no-link', this.noLink, true);\n            if (value !== void 0) {\n                options.noLink = value;\n            }\n            value = this.getAttribute('no-title', this.noTitle, true);\n            if (value !== void 0) {\n                options.noTitle = value;\n            }\n            value = this.getAttribute('no-history', this.noHistory, true);\n            if (value !== void 0) {\n                options.noHistory = value;\n            }\n            value = this.getAttribute('stateful', this.stateful, true);\n            if (value !== void 0) {\n                options.stateful = value;\n            }\n            this.controller.routingContainer = this.container;\n            this.viewport = this.router.connectViewport(this.viewport, this, name, options);\n        }\n        disconnect() {\n            if (this.viewport) {\n                this.router.disconnectViewport(this.viewport, this);\n            }\n            this.viewport = null;\n        }\n        getAttribute(key, value, checkExists = false) {\n            const result = {};\n            if (this.isBound && !checkExists) {\n                return value;\n            }\n            else {\n                if (this.element.hasAttribute(key)) {\n                    if (checkExists) {\n                        return true;\n                    }\n                    else {\n                        value = this.element.getAttribute(key);\n                        if (value.length > 0) {\n                            return value;\n                        }\n                    }\n                }\n            }\n            return value;\n        }\n        getClosestCustomElement() {\n            let parent = this.controller.parent;\n            let customElement = null;\n            while (parent !== null && customElement === null) {\n                if (parent.viewModel instanceof ViewportCustomElement_1 || parent.viewModel instanceof ViewportScopeCustomElement) {\n                    customElement = parent.viewModel;\n                }\n                parent = parent.parent;\n            }\n            return customElement;\n        }\n        // TODO: Switch this to use (probably) an event instead\n        waitForRouterStart() {\n            if (this.router.isActive) {\n                return;\n            }\n            return new Promise((resolve) => {\n                this.router.starters.push(resolve);\n            });\n        }\n    };\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", String)\n    ], ViewportCustomElement.prototype, \"name\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", String)\n    ], ViewportCustomElement.prototype, \"usedBy\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", String)\n    ], ViewportCustomElement.prototype, \"default\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", String)\n    ], ViewportCustomElement.prototype, \"fallback\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], ViewportCustomElement.prototype, \"noScope\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], ViewportCustomElement.prototype, \"noLink\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], ViewportCustomElement.prototype, \"noTitle\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], ViewportCustomElement.prototype, \"noHistory\", void 0);\n    __decorate([\n        bindable,\n        __metadata(\"design:type\", Boolean)\n    ], ViewportCustomElement.prototype, \"stateful\", void 0);\n    ViewportCustomElement = ViewportCustomElement_1 = __decorate([\n        customElement({\n            name: 'au-viewport',\n            injectable: ParentViewport\n        }),\n        __param(0, IRouter),\n        __param(1, INode),\n        __param(2, IContainer),\n        __param(3, ParentViewport),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportCustomElement])\n    ], ViewportCustomElement);\n    return ViewportCustomElement;\n})();\nexport { ViewportCustomElement };\n//# sourceMappingURL=viewport.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy, IObserverLocator, CustomAttribute } from '@aurelia/runtime';\nimport { IEventManager } from '@aurelia/runtime-html';\nimport { IRouter } from '../router';\nimport { NavigationInstructionResolver } from '../type-resolvers';\nimport { deprecationWarning } from '../utils';\nlet GotoCustomAttribute = /** @class */ (() => {\n    let GotoCustomAttribute = class GotoCustomAttribute {\n        constructor(dom, element, router, eventManager) {\n            this.dom = dom;\n            this.router = router;\n            this.eventManager = eventManager;\n            this.listener = null;\n            this.hasHref = null;\n            this.activeClass = 'goto-active';\n            deprecationWarning('\"goto\" custom attribute', '\"load\" custom attribute');\n            this.element = element;\n        }\n        beforeBind() {\n            this.listener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n            this.updateValue();\n            const observerLocator = this.router.container.get(IObserverLocator);\n            this.observer = observerLocator.getObserver(0 /* none */, this.router, 'activeComponents');\n            this.observer.subscribe(this);\n        }\n        beforeUnbind() {\n            if (this.listener !== null) {\n                this.listener.dispose();\n            }\n            this.observer.unsubscribe(this);\n        }\n        valueChanged(newValue) {\n            this.updateValue();\n        }\n        updateValue() {\n            if (this.hasHref === null) {\n                this.hasHref = this.element.hasAttribute('href');\n            }\n            if (!this.hasHref) {\n                // TODO: Figure out a better value here for non-strings (using InstructionResolver?)\n                const value = typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n                this.element.setAttribute('href', value);\n            }\n        }\n        handleChange() {\n            const controller = CustomAttribute.for(this.element, 'goto').parent;\n            const created = NavigationInstructionResolver.createViewportInstructions(this.router, this.value, { context: controller });\n            const instructions = NavigationInstructionResolver.toViewportInstructions(this.router, created.instructions);\n            for (const instruction of instructions) {\n                if (instruction.scope === null) {\n                    instruction.scope = created.scope;\n                }\n            }\n            // TODO: Use router configuration for class name and update target\n            if (this.router.checkActive(instructions)) {\n                this.element.classList.add(this.activeClass);\n            }\n            else {\n                this.element.classList.remove(this.activeClass);\n            }\n        }\n    };\n    __decorate([\n        bindable({ mode: BindingMode.toView }),\n        __metadata(\"design:type\", Object)\n    ], GotoCustomAttribute.prototype, \"value\", void 0);\n    GotoCustomAttribute = __decorate([\n        customAttribute('goto'),\n        __param(0, IDOM),\n        __param(1, INode),\n        __param(2, IRouter),\n        __param(3, IEventManager),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n    ], GotoCustomAttribute);\n    return GotoCustomAttribute;\n})();\nexport { GotoCustomAttribute };\n//# sourceMappingURL=goto.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy, IObserverLocator, CustomAttribute } from '@aurelia/runtime';\nimport { IEventManager } from '@aurelia/runtime-html';\nimport { IRouter } from '../router';\nimport { NavigationInstructionResolver } from '../type-resolvers';\nlet LoadCustomAttribute = /** @class */ (() => {\n    let LoadCustomAttribute = class LoadCustomAttribute {\n        constructor(dom, element, router, eventManager) {\n            this.dom = dom;\n            this.router = router;\n            this.eventManager = eventManager;\n            this.listener = null;\n            this.hasHref = null;\n            this.activeClass = 'load-active';\n            this.element = element;\n        }\n        beforeBind() {\n            this.listener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n            this.updateValue();\n            const observerLocator = this.router.container.get(IObserverLocator);\n            this.observer = observerLocator.getObserver(0 /* none */, this.router, 'activeComponents');\n            this.observer.subscribe(this);\n        }\n        beforeUnbind() {\n            if (this.listener !== null) {\n                this.listener.dispose();\n            }\n            this.observer.unsubscribe(this);\n        }\n        valueChanged(newValue) {\n            this.updateValue();\n        }\n        updateValue() {\n            if (this.hasHref === null) {\n                this.hasHref = this.element.hasAttribute('href');\n            }\n            if (!this.hasHref) {\n                // TODO: Figure out a better value here for non-strings (using InstructionResolver?)\n                const value = typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n                this.element.setAttribute('href', value);\n            }\n        }\n        handleChange() {\n            const controller = CustomAttribute.for(this.element, 'load').parent;\n            const created = NavigationInstructionResolver.createViewportInstructions(this.router, this.value, { context: controller });\n            const instructions = NavigationInstructionResolver.toViewportInstructions(this.router, created.instructions);\n            for (const instruction of instructions) {\n                if (instruction.scope === null) {\n                    instruction.scope = created.scope;\n                }\n            }\n            // TODO: Use router configuration for class name and update target\n            if (this.router.checkActive(instructions)) {\n                this.element.classList.add(this.activeClass);\n            }\n            else {\n                this.element.classList.remove(this.activeClass);\n            }\n        }\n    };\n    __decorate([\n        bindable({ mode: BindingMode.toView }),\n        __metadata(\"design:type\", Object)\n    ], LoadCustomAttribute.prototype, \"value\", void 0);\n    LoadCustomAttribute = __decorate([\n        customAttribute('load'),\n        __param(0, IDOM),\n        __param(1, INode),\n        __param(2, IRouter),\n        __param(3, IEventManager),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n    ], LoadCustomAttribute);\n    return LoadCustomAttribute;\n})();\nexport { LoadCustomAttribute };\n//# sourceMappingURL=load.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { GotoCustomAttribute } from '../configuration';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet HrefCustomAttribute = /** @class */ (() => {\n    let HrefCustomAttribute = class HrefCustomAttribute {\n        constructor(dom, element, router, eventManager) {\n            this.dom = dom;\n            this.router = router;\n            this.eventManager = eventManager;\n            this.eventListener = null;\n            this.element = element;\n        }\n        beforeBind() {\n            if (this.router.options.useHref && !this.hasGoto()) {\n                this.eventListener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n            }\n            this.updateValue();\n        }\n        beforeUnbind() {\n            if (this.eventListener !== null) {\n                this.eventListener.dispose();\n            }\n        }\n        valueChanged() {\n            this.updateValue();\n        }\n        updateValue() {\n            this.element.setAttribute('href', this.value);\n        }\n        hasGoto() {\n            const parent = this.$controller.parent;\n            const siblings = parent.children;\n            return siblings !== void 0\n                && siblings.some(c => c.vmKind === 1 /* customAttribute */ && c.viewModel instanceof GotoCustomAttribute);\n        }\n    };\n    __decorate([\n        bindable({ mode: BindingMode.toView }),\n        __metadata(\"design:type\", Object)\n    ], HrefCustomAttribute.prototype, \"value\", void 0);\n    HrefCustomAttribute = __decorate([\n        customAttribute({\n            name: 'href',\n            noMultiBindings: true\n        }),\n        __param(0, IDOM),\n        __param(1, INode),\n        __param(2, IRouter),\n        __param(3, IEventManager),\n        __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n    ], HrefCustomAttribute);\n    return HrefCustomAttribute;\n})();\nexport { HrefCustomAttribute };\n//# sourceMappingURL=href.js.map","import { DI } from '@aurelia/kernel';\nimport { StartTask } from '@aurelia/runtime';\nimport { NavCustomElement } from './resources/nav';\nimport { ViewportCustomElement } from './resources/viewport';\nimport { ViewportScopeCustomElement } from './resources/viewport-scope';\nimport { GotoCustomAttribute } from './resources/goto';\nimport { LoadCustomAttribute } from './resources/load';\nimport { HrefCustomAttribute } from './resources/href';\nimport { IRouter } from './router';\nexport const RouterRegistration = IRouter;\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IRouter`\n */\nexport const DefaultComponents = [\n    RouterRegistration,\n];\nexport { ViewportCustomElement, ViewportScopeCustomElement, NavCustomElement, GotoCustomAttribute, LoadCustomAttribute, HrefCustomAttribute, };\nexport const ViewportCustomElementRegistration = ViewportCustomElement;\nexport const ViewportScopeCustomElementRegistration = ViewportScopeCustomElement;\nexport const NavCustomElementRegistration = NavCustomElement;\nexport const GotoCustomAttributeRegistration = GotoCustomAttribute;\nexport const LoadCustomAttributeRegistration = LoadCustomAttribute;\nexport const HrefCustomAttributeRegistration = HrefCustomAttribute;\n/**\n * Default router resources:\n * - Custom Elements: `au-viewport`, `au-nav`\n * - Custom Attributes: `goto`, `load`, `href`\n */\nexport const DefaultResources = [\n    ViewportCustomElement,\n    ViewportScopeCustomElement,\n    NavCustomElement,\n    GotoCustomAttribute,\n    LoadCustomAttribute,\n    HrefCustomAttribute,\n];\nlet configurationOptions = {};\nlet configurationCall = (router) => {\n    router.start(configurationOptions);\n};\n/**\n * A DI configuration object containing router resource registrations.\n */\nconst routerConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, StartTask.with(IRouter).beforeBind().call(configurationCall), StartTask.with(IRouter).afterAttach().call(router => router.loadUrl()));\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport const RouterConfiguration = {\n    /**\n     * Make it possible to specify options to Router activation.\n     * Parameter is either a config object that's passed to Router's start\n     * or a config function that's called instead of Router's start.\n     */\n    customize(config) {\n        if (config === undefined) {\n            configurationOptions = {};\n            configurationCall = (router) => {\n                router.start(configurationOptions);\n            };\n        }\n        else if (config instanceof Function) {\n            configurationCall = config;\n        }\n        else {\n            configurationOptions = config;\n        }\n        return { ...routerConfiguration };\n    },\n    ...routerConfiguration,\n};\n//# sourceMappingURL=configuration.js.map","<h5></h5>\n<span>3<a href=\"https://ischca.github.io/\"></a></span>","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport * as __au2ViewDef from './jump.html';\nimport { customElement } from '@aurelia/runtime';\nlet Jump = class Jump {\n};\nJump = __decorate([\n    customElement(__au2ViewDef)\n], Jump);\nexport { Jump };\n","import Aurelia from 'aurelia';\nimport { Jump } from './jump';\n//import * as globalComponents from './components/registry';\n//import * as globalValueConverters from './value-converters/registry';\n//import 'flatpickr/dist/flatpickr.min.css';\nAurelia\n    // .register(\n    //   globalComponents,\n    //   globalValueConverters\n    // )\n    .app(Jump)\n    .start();\n"],"sourceRoot":""}